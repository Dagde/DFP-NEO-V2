(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[913],{63:(e,r,t)=>{"use strict";var s=t(7260);t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(r,{useSearchParams:function(){return s.useSearchParams}})},575:(e,r,t)=>{Promise.resolve().then(t.bind(t,9659))},9659:(e,r,t)=>{"use strict";t.d(r,{EditUserForm:()=>d});var s=t(5155),a=t(2115),i=t(63),l=t(2619),n=t.n(l);function d(e){let{user:r,roles:t}=e,l=(0,i.useRouter)(),[d,o]=(0,a.useState)(!1),[c,u]=(0,a.useState)(""),[m,x]=(0,a.useState)(""),[h,g]=(0,a.useState)(""),[b,p]=(0,a.useState)(!1),y=r.firstName&&r.lastName?"".concat(r.firstName," ").concat(r.lastName):r.username,[f,j]=(0,a.useState)({displayName:y,email:r.email||"",role:r.role,isActive:r.isActive}),v=async e=>{e.preventDefault(),u(""),x(""),o(!0);try{let e=await fetch("/api/admin/users/".concat(r.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),t=await e.json();if(!e.ok){u(t.error||"Failed to update user"),o(!1);return}x("User updated successfully"),o(!1),setTimeout(()=>l.refresh(),1e3)}catch(e){u("An error occurred. Please try again."),o(!1)}},N=async()=>{if(confirm("Force this user to change their password on next login?")){u(""),x(""),o(!0);try{let e=await fetch("/api/admin/users/".concat(r.id,"/force-password-reset"),{method:"POST"}),t=await e.json();if(!e.ok){u(t.error||"Failed to force password reset"),o(!1);return}x("User will be required to change password on next login"),o(!1),setTimeout(()=>l.refresh(),1e3)}catch(e){u("An error occurred. Please try again."),o(!1)}}},w=async()=>{u(""),x(""),o(!0);try{let e=await fetch("/api/admin/users/".concat(r.id,"/generate-invite"),{method:"POST"}),t=await e.json();if(!e.ok){u(t.error||"Failed to generate invite link"),o(!1);return}g(t.inviteLink),p(!0),o(!1)}catch(e){u("An error occurred. Please try again."),o(!1)}},k=async()=>{if(confirm("Are you sure you want to delete user ".concat(r.userId,"? This action cannot be undone."))){u(""),o(!0);try{let e=await fetch("/api/admin/users/".concat(r.id),{method:"DELETE"}),t=await e.json();if(!e.ok){u(t.error||"Failed to delete user"),o(!1);return}l.push("/admin/users")}catch(e){u("An error occurred. Please try again."),o(!1)}}};return b?(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-8 border border-gray-700",children:[(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-white mb-2",children:"Invite Link Generated"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Share this link with the user"})]}),(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Invite Link (expires in 72 hours)"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("input",{type:"text",value:h,readOnly:!0,className:"flex-1 px-4 py-2 bg-gray-600 border border-gray-500 rounded-md text-white text-sm"}),(0,s.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(h),alert("Invite link copied to clipboard!")},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:"Copy"})]})]}),(0,s.jsx)("button",{onClick:()=>p(!1),className:"w-full px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-md transition-colors",children:"Close"})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"User Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"User ID:"}),(0,s.jsx)("span",{className:"ml-2 text-white font-medium",children:r.userId})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Status:"}),(0,s.jsx)("span",{className:"ml-2 px-2 py-1 text-xs font-medium rounded-md border ".concat(r.isActive?"bg-green-900/30 text-green-300 border-green-700":"bg-red-900/30 text-red-300 border-red-700"),children:r.isActive?"Active":"Inactive"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Last Login:"}),(0,s.jsx)("span",{className:"ml-2 text-white",children:r.lastLogin?new Date(r.lastLogin).toLocaleString():"Never"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Created:"}),(0,s.jsx)("span",{className:"ml-2 text-white",children:new Date(r.createdAt).toLocaleString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Must Change Password:"}),(0,s.jsx)("span",{className:"ml-2 text-white",children:"N/A"})]})]})]}),(0,s.jsxs)("form",{onSubmit:v,className:"bg-gray-800 rounded-lg p-6 border border-gray-700 space-y-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Edit Details"}),c&&(0,s.jsx)("div",{className:"p-4 bg-red-900/50 border border-red-700 rounded-md",children:(0,s.jsx)("p",{className:"text-red-200 text-sm",children:c})}),m&&(0,s.jsx)("div",{className:"p-4 bg-green-900/50 border border-green-700 rounded-md",children:(0,s.jsx)("p",{className:"text-green-200 text-sm",children:m})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-300 mb-2",children:"Display Name"}),(0,s.jsx)("input",{id:"displayName",type:"text",value:f.displayName,onChange:e=>j({...f,displayName:e.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:d})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),(0,s.jsx)("input",{id:"email",type:"email",value:f.email,onChange:e=>j({...f,email:e.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:d})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-300 mb-2",children:"Role"}),(0,s.jsx)("select",{id:"role",value:f.role,onChange:e=>j({...f,role:e.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:d,children:t.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),(0,s.jsxs)("select",{id:"isActive",value:f.isActive.toString(),onChange:e=>j({...f,isActive:"true"===e.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:d,children:[(0,s.jsx)("option",{value:"true",children:"Active"}),(0,s.jsx)("option",{value:"false",children:"Inactive"})]})]}),(0,s.jsx)("button",{type:"submit",disabled:d,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Updating...":"Update User"})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Actions"}),(0,s.jsx)("button",{onClick:N,disabled:d,className:"w-full px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-medium rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Force Password Reset"}),(0,s.jsx)("button",{onClick:w,disabled:d,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Generate New Invite Link"}),(0,s.jsx)("button",{onClick:k,disabled:d,className:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete User"})]}),(0,s.jsx)("div",{className:"flex space-x-3",children:(0,s.jsx)(n(),{href:"/admin/users",className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-md transition-colors text-center",children:"Back to Users"})})]})}}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=575)),_N_E=e.O()}]);