(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{5782:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(5155),l=s(6199),i=s(63),r=s(2115),n=s(5239);function c(){var e;let{data:t,status:s}=(0,l.wV)(),c=(0,i.useRouter)(),[m,d]=(0,r.useState)([]),[x,o]=(0,r.useState)(!0),[u,h]=(0,r.useState)(!1),[p,N]=(0,r.useState)({username:"",password:"",email:"",firstName:"",lastName:"",role:"USER"});(0,r.useEffect)(()=>{var e,a;"unauthenticated"===s?c.push("/login"):(null==t||null==(e=t.user)?void 0:e.role)!=="ADMIN"&&(null==t||null==(a=t.user)?void 0:a.role)!=="SUPER_ADMIN"?c.push("/select"):j()},[s,t,c]);let j=async()=>{try{let e=await fetch("/api/admin/users"),t=await e.json();d(t)}catch(e){console.error("Failed to fetch users:",e)}finally{o(!1)}},f=async e=>{e.preventDefault();try{(await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).ok&&(h(!1),N({username:"",password:"",email:"",firstName:"",lastName:"",role:"USER"}),j())}catch(e){console.error("Failed to create user:",e)}},g=async(e,t)=>{try{await fetch("/api/admin/users/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!t})}),j()}catch(e){console.error("Failed to update user:",e)}};return"loading"===s||x?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-neo-silver text-xl",children:"Loading..."})}):(0,a.jsx)("div",{className:"min-h-screen p-8",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-12",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(n.default,{src:"/images/logo.png",alt:"DFP-NEO",width:200,height:80,className:"h-16 w-auto"}),(0,a.jsx)("div",{className:"h-8 w-px bg-gray-700"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Admin Panel"})]}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsx)("button",{onClick:()=>c.push("/select"),className:"text-gray-400 hover:text-white transition-colors",children:"â† Back to Selection"})})]}),(0,a.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white",children:"User Management"}),(0,a.jsx)("button",{onClick:()=>h(!0),className:"metal-button",children:"+ Add New User"})]}),u&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"metal-plate max-w-md w-full",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-white mb-6",children:"Create New User"}),(0,a.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Username *"}),(0,a.jsx)("input",{type:"text",value:p.username,onChange:e=>N({...p,username:e.target.value}),className:"metal-input w-full",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Password *"}),(0,a.jsx)("input",{type:"password",value:p.password,onChange:e=>N({...p,password:e.target.value}),className:"metal-input w-full",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Email"}),(0,a.jsx)("input",{type:"email",value:p.email,onChange:e=>N({...p,email:e.target.value}),className:"metal-input w-full"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"First Name"}),(0,a.jsx)("input",{type:"text",value:p.firstName,onChange:e=>N({...p,firstName:e.target.value}),className:"metal-input w-full"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Last Name"}),(0,a.jsx)("input",{type:"text",value:p.lastName,onChange:e=>N({...p,lastName:e.target.value}),className:"metal-input w-full"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Role"}),(0,a.jsxs)("select",{value:p.role,onChange:e=>N({...p,role:e.target.value}),className:"metal-input w-full",children:[(0,a.jsx)("option",{value:"USER",children:"User"}),(0,a.jsx)("option",{value:"ADMIN",children:"Admin"}),(null==t||null==(e=t.user)?void 0:e.role)==="SUPER_ADMIN"&&(0,a.jsx)("option",{value:"SUPER_ADMIN",children:"Super Admin"})]})]}),(0,a.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,a.jsx)("button",{type:"submit",className:"metal-button flex-1",children:"Create User"}),(0,a.jsx)("button",{type:"button",onClick:()=>h(!1),className:"metal-button flex-1 bg-gray-700",children:"Cancel"})]})]})]})}),(0,a.jsx)("div",{className:"metal-plate overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,a.jsx)("th",{className:"text-left py-4 px-4 text-gray-400 font-medium",children:"Username"}),(0,a.jsx)("th",{className:"text-left py-4 px-4 text-gray-400 font-medium",children:"Name"}),(0,a.jsx)("th",{className:"text-left py-4 px-4 text-gray-400 font-medium",children:"Email"}),(0,a.jsx)("th",{className:"text-left py-4 px-4 text-gray-400 font-medium",children:"Role"}),(0,a.jsx)("th",{className:"text-left py-4 px-4 text-gray-400 font-medium",children:"Status"}),(0,a.jsx)("th",{className:"text-left py-4 px-4 text-gray-400 font-medium",children:"Last Login"}),(0,a.jsx)("th",{className:"text-left py-4 px-4 text-gray-400 font-medium",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:m.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-900/30",children:[(0,a.jsx)("td",{className:"py-4 px-4 text-white",children:e.username}),(0,a.jsx)("td",{className:"py-4 px-4 text-gray-300",children:e.firstName||e.lastName?"".concat(e.firstName||""," ").concat(e.lastName||"").trim():"-"}),(0,a.jsx)("td",{className:"py-4 px-4 text-gray-300",children:e.email||"-"}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("SUPER_ADMIN"===e.role?"bg-purple-900/30 text-purple-400":"ADMIN"===e.role?"bg-blue-900/30 text-blue-400":"bg-gray-700 text-gray-300"),children:e.role})}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(e.isActive?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"),children:e.isActive?"Active":"Inactive"})}),(0,a.jsx)("td",{className:"py-4 px-4 text-gray-400 text-sm",children:e.lastLogin?new Date(e.lastLogin).toLocaleDateString():"Never"}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsx)("button",{onClick:()=>g(e.id,e.isActive),className:"text-sm text-neo-silver hover:text-white transition-colors",children:e.isActive?"Deactivate":"Activate"})})]},e.id))})]})})]})})}},6327:(e,t,s)=>{Promise.resolve().then(s.bind(s,5782))}},e=>{e.O(0,[199,394,441,255,358],()=>e(e.s=6327)),_N_E=e.O()}]);