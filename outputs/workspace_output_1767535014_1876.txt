public/flight-school-app/assets/index-BiUszwTI.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},ye=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},xe=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),Ve=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},We=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>We("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>We("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),ye.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),Ve.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:Ve.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:xe,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{try{const Ge=T}catch{}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct",ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=X?n.student:n.flightType==="Solo"?"":n.student||"";let ue="font-semibold truncate",ye="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?ye="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(ye="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,We=n.startTime+n.duration,we=Ht>=We&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?ye="font-bold truncate text-red-500":ye+=" text-white/80"}const xe=(()=>{if(W)return K;if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof xe=="string"?xe:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,We=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[We==null?void 0:We.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[We==null?void 0:We.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate",""),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[xe,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-DfaaHY89.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),J=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(J);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{J&&K(!0)},[J]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${J?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const J=n.eventCategory==="sct";J&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const ee=J||n.flightType==="Solo"?n.pilot:n.instructor,K=J?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(J&&n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(J&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(console.log("🔍 SOLO CHECK:",{pilot:n.pilot,student:n.student,flightType:n.flightType,areEqual:n.pilot===n.student}),n.pilot&&n.student&&n.pilot===n.student)return console.log("🎯 FALLBACK SOLO DETECTION: Pilot and student are the same:",n.pilot),e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/html2canvas.esm-QH1iLAAe.js:         .`+qr+Yo+AB)},Zo=function(e,A){var t=e.ownerDocument;if(t){var r=t.createElement("style");r.textContent=A,e.appendChild(r)}},An=(function(){function e(){}return e.getOrigin=function(A){var t=e._link;return t?(t.href=A,t.href=t.href,t.protocol+t.hostname+t.port):"about:blank"},e.isSameOrigin=function(A){return e.getOrigin(A)===e._origin},e.setContext=function(A){e._link=A.document.createElement("a"),e._origin=e.getOrigin(A.location.href)},e._origin="about:blank",e})(),qo=(function(){function e(A,t){this.context=A,this._options=t,this._cache={}}return e.prototype.addImage=function(A){var t=Promise.resolve();return this.has(A)||(yr(A)||AQ(A))&&(this._cache[A]=this.loadImage(A)).catch(function(){}),t},e.prototype.match=function(A){return this._cache[A]},e.prototype.loadImage=function(A){return P(this,void 0,void 0,function(){var t,r,B,n,s=this;return _(this,function(i){switch(i.label){case 0:return t=An.isSameOrigin(A),r=!vr(A)&&this._options.useCORS===!0&&N.SUPPORT_CORS_IMAGES&&!t,B=!vr(A)&&!t&&!yr(A)&&typeof this._options.proxy=="string"&&N.SUPPORT_CORS_XHR&&!r,!t&&this._options.allowTaint===!1&&!vr(A)&&!yr(A)&&!B&&!r?[2]:(n=A,B?[4,this.proxy(n)]:[3,2]);case 1:n=i.sent(),i.label=2;case 2:return this.context.logger.debug("Added image "+A.substring(0,256)),[4,new Promise(function(a,o){var Q=new Image;Q.onload=function(){return a(Q)},Q.onerror=o,(eQ(n)||r)&&(Q.crossOrigin="anonymous"),Q.src=n,Q.complete===!0&&setTimeout(function(){return a(Q)},500),s._options.imageTimeout>0&&setTimeout(function(){return o("Timed out ("+s._options.imageTimeout+"ms) loading image")},s._options.imageTimeout)})];case 3:return[2,i.sent()]}})})},e.prototype.has=function(A){return typeof this._cache[A]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(A){var t=this,r=this._options.proxy;if(!r)throw new Error("No proxy defined");var B=A.substring(0,256);return new Promise(function(n,s){var i=N.SUPPORT_RESPONSE_TYPE?"blob":"text",a=new XMLHttpRequest;a.onload=function(){if(a.status===200)if(i==="text")n(a.response);else{var g=new FileReader;g.addEventListener("load",function(){return n(g.result)},!1),g.addEventListener("error",function(w){return s(w)},!1),g.readAsDataURL(a.response)}else s("Failed to proxy resource "+B+" with status code "+a.status)},a.onerror=s;var o=r.indexOf("?")>-1?"&":"?";if(a.open("GET",""+r+o+"url="+encodeURIComponent(A)+"&responseType="+i),i!=="text"&&a instanceof XMLHttpRequest&&(a.responseType=i),t._options.imageTimeout){var Q=t._options.imageTimeout;a.timeout=Q,a.ontimeout=function(){return s("Timed out ("+Q+"ms) proxying "+B)}}a.send()})},e})(),jo=/^data:image\/svg\+xml/i,zo=/^data:image\/.*;base64,/i,$o=/^data:image\/.*/i,AQ=function(e){return N.SUPPORT_SVG_DRAWING||!rQ(e)},vr=function(e){return $o.test(e)},eQ=function(e){return zo.test(e)},yr=function(e){return e.substr(0,4)==="blob"},rQ=function(e){return e.substr(-3).toLowerCase()==="svg"||jo.test(e)},u=(function(){function e(A,t){this.type=0,this.x=A,this.y=t}return e.prototype.add=function(A,t){return new e(this.x+A,this.y+t)},e})(),RA=function(e,A,t){return new u(e.x+(A.x-e.x)*t,e.y+(A.y-e.y)*t)},Te=(function(){function e(A,t,r,B){this.type=1,this.start=A,this.startControl=t,this.endControl=r,this.end=B}return e.prototype.subdivide=function(A,t){var r=RA(this.start,this.startControl,A),B=RA(this.startControl,this.endControl,A),n=RA(this.endControl,this.end,A),s=RA(r,B,A),i=RA(B,n,A),a=RA(s,i,A);return t?new e(this.start,r,s,a):new e(a,i,n,this.end)},e.prototype.add=function(A,t){return new e(this.start.add(A,t),this.startControl.add(A,t),this.endControl.add(A,t),this.end.add(A,t))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e})(),$=function(e){return e.type===1},tQ=(function(){function e(A){var t=A.styles,r=A.bounds,B=re(t.borderTopLeftRadius,r.width,r.height),n=B[0],s=B[1],i=re(t.borderTopRightRadius,r.width,r.height),a=i[0],o=i[1],Q=re(t.borderBottomRightRadius,r.width,r.height),g=Q[0],w=Q[1],f=re(t.borderBottomLeftRadius,r.width,r.height),c=f[0],C=f[1],H=[];H.push((n+a)/r.width),H.push((c+g)/r.width),H.push((s+C)/r.height),H.push((o+w)/r.height);var h=Math.max.apply(Math,H);h>1&&(n/=h,s/=h,a/=h,o/=h,g/=h,w/=h,c/=h,C/=h);var F=r.width-a,K=r.height-w,p=r.width-g,d=r.height-C,l=t.borderTopWidth,v=t.borderRightWidth,y=t.borderBottomWidth,E=t.borderLeftWidth,O=b(t.paddingTop,A.bounds.width),k=b(t.paddingRight,A.bounds.width),q=b(t.paddingBottom,A.bounds.width),L=b(t.paddingLeft,A.bounds.width);this.topLeftBorderDoubleOuterBox=n>0||s>0?x(r.left+E/3,r.top+l/3,n-E/3,s-l/3,m.TOP_LEFT):new u(r.left+E/3,r.top+l/3),this.topRightBorderDoubleOuterBox=n>0||s>0?x(r.left+F,r.top+l/3,a-v/3,o-l/3,m.TOP_RIGHT):new u(r.left+r.width-v/3,r.top+l/3),this.bottomRightBorderDoubleOuterBox=g>0||w>0?x(r.left+p,r.top+K,g-v/3,w-y/3,m.BOTTOM_RIGHT):new u(r.left+r.width-v/3,r.top+r.height-y/3),this.bottomLeftBorderDoubleOuterBox=c>0||C>0?x(r.left+E/3,r.top+d,c-E/3,C-y/3,m.BOTTOM_LEFT):new u(r.left+E/3,r.top+r.height-y/3),this.topLeftBorderDoubleInnerBox=n>0||s>0?x(r.left+E*2/3,r.top+l*2/3,n-E*2/3,s-l*2/3,m.TOP_LEFT):new u(r.left+E*2/3,r.top+l*2/3),this.topRightBorderDoubleInnerBox=n>0||s>0?x(r.left+F,r.top+l*2/3,a-v*2/3,o-l*2/3,m.TOP_RIGHT):new u(r.left+r.width-v*2/3,r.top+l*2/3),this.bottomRightBorderDoubleInnerBox=g>0||w>0?x(r.left+p,r.top+K,g-v*2/3,w-y*2/3,m.BOTTOM_RIGHT):new u(r.left+r.width-v*2/3,r.top+r.height-y*2/3),this.bottomLeftBorderDoubleInnerBox=c>0||C>0?x(r.left+E*2/3,r.top+d,c-E*2/3,C-y*2/3,m.BOTTOM_LEFT):new u(r.left+E*2/3,r.top+r.height-y*2/3),this.topLeftBorderStroke=n>0||s>0?x(r.left+E/2,r.top+l/2,n-E/2,s-l/2,m.TOP_LEFT):new u(r.left+E/2,r.top+l/2),this.topRightBorderStroke=n>0||s>0?x(r.left+F,r.top+l/2,a-v/2,o-l/2,m.TOP_RIGHT):new u(r.left+r.width-v/2,r.top+l/2),this.bottomRightBorderStroke=g>0||w>0?x(r.left+p,r.top+K,g-v/2,w-y/2,m.BOTTOM_RIGHT):new u(r.left+r.width-v/2,r.top+r.height-y/2),this.bottomLeftBorderStroke=c>0||C>0?x(r.left+E/2,r.top+d,c-E/2,C-y/2,m.BOTTOM_LEFT):new u(r.left+E/2,r.top+r.height-y/2),this.topLeftBorderBox=n>0||s>0?x(r.left,r.top,n,s,m.TOP_LEFT):new u(r.left,r.top),this.topRightBorderBox=a>0||o>0?x(r.left+F,r.top,a,o,m.TOP_RIGHT):new u(r.left+r.width,r.top),this.bottomRightBorderBox=g>0||w>0?x(r.left+p,r.top+K,g,w,m.BOTTOM_RIGHT):new u(r.left+r.width,r.top+r.height),this.bottomLeftBorderBox=c>0||C>0?x(r.left,r.top+d,c,C,m.BOTTOM_LEFT):new u(r.left,r.top+r.height),this.topLeftPaddingBox=n>0||s>0?x(r.left+E,r.top+l,Math.max(0,n-E),Math.max(0,s-l),m.TOP_LEFT):new u(r.left+E,r.top+l),this.topRightPaddingBox=a>0||o>0?x(r.left+Math.min(F,r.width-v),r.top+l,F>r.width+v?0:Math.max(0,a-v),Math.max(0,o-l),m.TOP_RIGHT):new u(r.left+r.width-v,r.top+l),this.bottomRightPaddingBox=g>0||w>0?x(r.left+Math.min(p,r.width-E),r.top+Math.min(K,r.height-y),Math.max(0,g-v),Math.max(0,w-y),m.BOTTOM_RIGHT):new u(r.left+r.width-v,r.top+r.height-y),this.bottomLeftPaddingBox=c>0||C>0?x(r.left+E,r.top+Math.min(d,r.height-y),Math.max(0,c-E),Math.max(0,C-y),m.BOTTOM_LEFT):new u(r.left+E,r.top+r.height-y),this.topLeftContentBox=n>0||s>0?x(r.left+E+L,r.top+l+O,Math.max(0,n-(E+L)),Math.max(0,s-(l+O)),m.TOP_LEFT):new u(r.left+E+L,r.top+l+O),this.topRightContentBox=a>0||o>0?x(r.left+Math.min(F,r.width+E+L),r.top+l+O,F>r.width+E+L?0:a-E+L,o-(l+O),m.TOP_RIGHT):new u(r.left+r.width-(v+k),r.top+l+O),this.bottomRightContentBox=g>0||w>0?x(r.left+Math.min(p,r.width-(E+L)),r.top+Math.min(K,r.height+l+O),Math.max(0,g-(v+k)),w-(y+q),m.BOTTOM_RIGHT):new u(r.left+r.width-(v+k),r.top+r.height-(y+q)),this.bottomLeftContentBox=c>0||C>0?x(r.left+E+L,r.top+d,Math.max(0,c-(E+L)),C-(y+q),m.BOTTOM_LEFT):new u(r.left+E+L,r.top+r.height-(y+q))}return e})(),m;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(m||(m={}));var x=function(e,A,t,r,B){var n=4*((Math.sqrt(2)-1)/3),s=t*n,i=r*n,a=e+t,o=A+r;switch(B){case m.TOP_LEFT:return new Te(new u(e,o),new u(e,o-i),new u(a-s,A),new u(a,A));case m.TOP_RIGHT:return new Te(new u(e,A),new u(e+s,A),new u(a,o-i),new u(a,o));case m.BOTTOM_RIGHT:return new Te(new u(a,A),new u(a,A+i),new u(e+s,o),new u(e,o));case m.BOTTOM_LEFT:default:return new Te(new u(a,o),new u(a-s,o),new u(e,A+i),new u(e,A))}},Ze=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},BQ=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},qe=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},nQ=(function(){function e(A,t,r){this.offsetX=A,this.offsetY=t,this.matrix=r,this.type=0,this.target=6}return e})(),Se=(function(){function e(A,t){this.path=A,this.target=t,this.type=1}return e})(),sQ=(function(){function e(A){this.opacity=A,this.type=2,this.target=6}return e})(),aQ=function(e){return e.type===0},en=function(e){return e.type===1},iQ=function(e){return e.type===2},eB=function(e,A){return e.length===A.length?e.some(function(t,r){return t===A[r]}):!1},oQ=function(e,A,t,r,B){return e.map(function(n,s){switch(s){case 0:return n.add(A,t);case 1:return n.add(A+r,t);case 2:return n.add(A+r,t+B);case 3:return n.add(A,t+B)}return n})},rn=(function(){function e(A){this.element=A,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e})(),tn=(function(){function e(A,t){if(this.container=A,this.parent=t,this.effects=[],this.curves=new tQ(this.container),this.container.styles.opacity<1&&this.effects.push(new sQ(this.container.styles.opacity)),this.container.styles.transform!==null){var r=this.container.bounds.left+this.container.styles.transformOrigin[0].number,B=this.container.bounds.top+this.container.styles.transformOrigin[1].number,n=this.container.styles.transform;this.effects.push(new nQ(r,B,n))}if(this.container.styles.overflowX!==0){var s=Ze(this.curves),i=qe(this.curves);eB(s,i)?this.effects.push(new Se(s,6)):(this.effects.push(new Se(s,2)),this.effects.push(new Se(i,4)))}}return e.prototype.getEffects=function(A){for(var t=[2,3].indexOf(this.container.styles.position)===-1,r=this.parent,B=this.effects.slice(0);r;){var n=r.effects.filter(function(a){return!en(a)});if(t||r.container.styles.position!==0||!r.parent){if(B.unshift.apply(B,n),t=[2,3].indexOf(r.container.styles.position)===-1,r.container.styles.overflowX!==0){var s=Ze(r.curves),i=qe(r.curves);eB(s,i)||B.unshift(new Se(i,6))}}else B.unshift.apply(B,n);r=r.parent}return B.filter(function(a){return G(a.target,A)})},e})(),jr=function(e,A,t,r){e.container.elements.forEach(function(B){var n=G(B.flags,4),s=G(B.flags,2),i=new tn(B,e);G(B.styles.display,2048)&&r.push(i);var a=G(B.flags,8)?[]:r;if(n||s){var o=n||B.styles.isPositioned()?t:A,Q=new rn(i);if(B.styles.isPositioned()||B.styles.opacity<1||B.styles.isTransformed()){var g=B.styles.zIndex.order;if(g<0){var w=0;o.negativeZIndex.some(function(c,C){return g>c.element.container.styles.zIndex.order?(w=C,!1):w>0}),o.negativeZIndex.splice(w,0,Q)}else if(g>0){var f=0;o.positiveZIndex.some(function(c,C){return g>=c.element.container.styles.zIndex.order?(f=C+1,!1):f>0}),o.positiveZIndex.splice(f,0,Q)}else o.zeroOrAutoZIndexOrTransformedOrOpacity.push(Q)}else B.styles.isFloating()?o.nonPositionedFloats.push(Q):o.nonPositionedInlineLevel.push(Q);jr(i,Q,n?Q:t,a)}else B.styles.isInlineLevel()?A.inlineLevel.push(i):A.nonInlineLevel.push(i),jr(i,A,t,a);G(B.flags,8)&&Bn(B,a)})},Bn=function(e,A){for(var t=e instanceof kr?e.start:1,r=e instanceof kr?e.reversed:!1,B=0;B<A.length;B++){var n=A[B];n.container instanceof NB&&typeof n.container.value=="number"&&n.container.value!==0&&(t=n.container.value),n.listValue=we(t,n.container.styles.listStyleType,!0),t+=r?-1:1}},QQ=function(e){var A=new tn(e,null),t=new rn(A),r=[];return jr(A,t,t,r),Bn(A.container,r),t},rB=function(e,A){switch(A){case 0:return eA(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return eA(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return eA(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return eA(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},gQ=function(e,A){switch(A){case 0:return eA(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return eA(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return eA(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return eA(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},wQ=function(e,A){switch(A){case 0:return eA(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return eA(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return eA(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return eA(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},cQ=function(e,A){switch(A){case 0:return Oe(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return Oe(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return Oe(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return Oe(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},Oe=function(e,A){var t=[];return $(e)?t.push(e.subdivide(.5,!1)):t.push(e),$(A)?t.push(A.subdivide(.5,!0)):t.push(A),t},eA=function(e,A,t,r){var B=[];return $(e)?B.push(e.subdivide(.5,!1)):B.push(e),$(t)?B.push(t.subdivide(.5,!0)):B.push(t),$(r)?B.push(r.subdivide(.5,!0).reverse()):B.push(r),$(A)?B.push(A.subdivide(.5,!1).reverse()):B.push(A),B},nn=function(e){var A=e.bounds,t=e.styles;return A.add(t.borderLeftWidth,t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth),-(t.borderTopWidth+t.borderBottomWidth))},je=function(e){var A=e.styles,t=e.bounds,r=b(A.paddingLeft,t.width),B=b(A.paddingRight,t.width),n=b(A.paddingTop,t.width),s=b(A.paddingBottom,t.width);return t.add(r+A.borderLeftWidth,n+A.borderTopWidth,-(A.borderRightWidth+A.borderLeftWidth+r+B),-(A.borderTopWidth+A.borderBottomWidth+n+s))},CQ=function(e,A){return e===0?A.bounds:e===2?je(A):nn(A)},uQ=function(e,A){return e===0?A.bounds:e===2?je(A):nn(A)},Kr=function(e,A,t){var r=CQ(XA(e.styles.backgroundOrigin,A),e),B=uQ(XA(e.styles.backgroundClip,A),e),n=lQ(XA(e.styles.backgroundSize,A),t,r),s=n[0],i=n[1],a=re(XA(e.styles.backgroundPosition,A),r.width-s,r.height-i),o=fQ(XA(e.styles.backgroundRepeat,A),a,n,r,B),Q=Math.round(r.left+a[0]),g=Math.round(r.top+a[1]);return[o,Q,g,s,i]},VA=function(e){return D(e)&&e.value===JA.AUTO},Me=function(e){return typeof e=="number"},lQ=function(e,A,t){var r=A[0],B=A[1],n=A[2],s=e[0],i=e[1];if(!s)return[0,0];if(M(s)&&i&&M(i))return[b(s,t.width),b(i,t.height)];var a=Me(n);if(D(s)&&(s.value===JA.CONTAIN||s.value===JA.COVER)){if(Me(n)){var o=t.width/t.height;return o<n!=(s.value===JA.COVER)?[t.width,t.width/n]:[t.height*n,t.height]}return[t.width,t.height]}var Q=Me(r),g=Me(B),w=Q||g;if(VA(s)&&(!i||VA(i))){if(Q&&g)return[r,B];if(!a&&!w)return[t.width,t.height];if(w&&a){var f=Q?r:B*n,c=g?B:r/n;return[f,c]}var C=Q?r:t.width,H=g?B:t.height;return[C,H]}if(a){var h=0,F=0;return M(s)?h=b(s,t.width):M(i)&&(F=b(i,t.height)),VA(s)?h=F*n:(!i||VA(i))&&(F=h/n),[h,F]}var K=null,p=null;if(M(s)?K=b(s,t.width):i&&M(i)&&(p=b(i,t.height)),K!==null&&(!i||VA(i))&&(p=Q&&g?K/r*B:t.height),p!==null&&VA(s)&&(K=Q&&g?p/B*r:t.width),K!==null&&p!==null)return[K,p];throw new Error("Unable to calculate background-size for element")},XA=function(e,A){var t=e[A];return typeof t>"u"?e[0]:t},fQ=function(e,A,t,r,B){var n=A[0],s=A[1],i=t[0],a=t[1];switch(e){case 2:return[new u(Math.round(r.left),Math.round(r.top+s)),new u(Math.round(r.left+r.width),Math.round(r.top+s)),new u(Math.round(r.left+r.width),Math.round(a+r.top+s)),new u(Math.round(r.left),Math.round(a+r.top+s))];case 3:return[new u(Math.round(r.left+n),Math.round(r.top)),new u(Math.round(r.left+n+i),Math.round(r.top)),new u(Math.round(r.left+n+i),Math.round(r.height+r.top)),new u(Math.round(r.left+n),Math.round(r.height+r.top))];case 1:return[new u(Math.round(r.left+n),Math.round(r.top+s)),new u(Math.round(r.left+n+i),Math.round(r.top+s)),new u(Math.round(r.left+n+i),Math.round(r.top+s+a)),new u(Math.round(r.left+n),Math.round(r.top+s+a))];default:return[new u(Math.round(B.left),Math.round(B.top)),new u(Math.round(B.left+B.width),Math.round(B.top)),new u(Math.round(B.left+B.width),Math.round(B.height+B.top)),new u(Math.round(B.left),Math.round(B.height+B.top))]}},UQ="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",tB="Hidden Text",FQ=(function(){function e(A){this._data={},this._document=A}return e.prototype.parseMetrics=function(A,t){var r=this._document.createElement("div"),B=this._document.createElement("img"),n=this._document.createElement("span"),s=this._document.body;r.style.visibility="hidden",r.style.fontFamily=A,r.style.fontSize=t,r.style.margin="0",r.style.padding="0",r.style.whiteSpace="nowrap",s.appendChild(r),B.src=UQ,B.width=1,B.height=1,B.style.margin="0",B.style.padding="0",B.style.verticalAlign="baseline",n.style.fontFamily=A,n.style.fontSize=t,n.style.margin="0",n.style.padding="0",n.appendChild(this._document.createTextNode(tB)),r.appendChild(n),r.appendChild(B);var i=B.offsetTop-n.offsetTop+2;r.removeChild(n),r.appendChild(this._document.createTextNode(tB)),r.style.lineHeight="normal",B.style.verticalAlign="super";var a=B.offsetTop-r.offsetTop+2;return s.removeChild(r),{baseline:i,middle:a}},e.prototype.getMetrics=function(A,t){var r=A+" "+t;return typeof this._data[r]>"u"&&(this._data[r]=this.parseMetrics(A,t)),this._data[r]},e})(),sn=(function(){function e(A,t){this.context=A,this.options=t}return e})(),hQ=1e4,dQ=(function(e){tA(A,e);function A(t,r){var B=e.call(this,t,r)||this;return B._activeEffects=[],B.canvas=r.canvas?r.canvas:document.createElement("canvas"),B.ctx=B.canvas.getContext("2d"),r.canvas||(B.canvas.width=Math.floor(r.width*r.scale),B.canvas.height=Math.floor(r.height*r.scale),B.canvas.style.width=r.width+"px",B.canvas.style.height=r.height+"px"),B.fontMetrics=new FQ(document),B.ctx.scale(B.options.scale,B.options.scale),B.ctx.translate(-r.x,-r.y),B.ctx.textBaseline="bottom",B._activeEffects=[],B.context.logger.debug("Canvas renderer initialized ("+r.width+"x"+r.height+") with scale "+r.scale),B}return A.prototype.applyEffects=function(t){for(var r=this;this._activeEffects.length;)this.popEffect();t.forEach(function(B){return r.applyEffect(B)})},A.prototype.applyEffect=function(t){this.ctx.save(),iQ(t)&&(this.ctx.globalAlpha=t.opacity),aQ(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),en(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},A.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},A.prototype.renderStack=function(t){return P(this,void 0,void 0,function(){var r;return _(this,function(B){switch(B.label){case 0:return r=t.element.container.styles,r.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:B.sent(),B.label=2;case 2:return[2]}})})},A.prototype.renderNode=function(t){return P(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:if(G(t.container.flags,16))debugger;return t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return r.sent(),[4,this.renderNodeContent(t)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},A.prototype.renderTextWithLetterSpacing=function(t,r,B){var n=this;if(r===0)this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+B);else{var s=rt(t.text);s.reduce(function(i,a){return n.ctx.fillText(a,i,t.bounds.top+B),i+n.ctx.measureText(a).width},t.bounds.left)}},A.prototype.createFontStyle=function(t){var r=t.fontVariant.filter(function(s){return s==="normal"||s==="small-caps"}).join(""),B=vQ(t.fontFamily).join(", "),n=Ce(t.fontSize)?""+t.fontSize.number+t.fontSize.unit:t.fontSize.number+"px";return[[t.fontStyle,r,t.fontWeight,n,B].join(" "),B,n]},A.prototype.renderTextNode=function(t,r){return P(this,void 0,void 0,function(){var B,n,s,i,a,o,Q,g,w=this;return _(this,function(f){return B=this.createFontStyle(r),n=B[0],s=B[1],i=B[2],this.ctx.font=n,this.ctx.direction=r.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",a=this.fontMetrics.getMetrics(s,i),o=a.baseline,Q=a.middle,g=r.paintOrder,t.textBounds.forEach(function(c){g.forEach(function(C){switch(C){case 0:w.ctx.fillStyle=R(r.color),w.renderTextWithLetterSpacing(c,r.letterSpacing,o);var H=r.textShadow;H.length&&c.text.trim().length&&(H.slice(0).reverse().forEach(function(h){w.ctx.shadowColor=R(h.color),w.ctx.shadowOffsetX=h.offsetX.number*w.options.scale,w.ctx.shadowOffsetY=h.offsetY.number*w.options.scale,w.ctx.shadowBlur=h.blur.number,w.renderTextWithLetterSpacing(c,r.letterSpacing,o)}),w.ctx.shadowColor="",w.ctx.shadowOffsetX=0,w.ctx.shadowOffsetY=0,w.ctx.shadowBlur=0),r.textDecorationLine.length&&(w.ctx.fillStyle=R(r.textDecorationColor||r.color),r.textDecorationLine.forEach(function(h){switch(h){case 1:w.ctx.fillRect(c.bounds.left,Math.round(c.bounds.top+o),c.bounds.width,1);break;case 2:w.ctx.fillRect(c.bounds.left,Math.round(c.bounds.top),c.bounds.width,1);break;case 3:w.ctx.fillRect(c.bounds.left,Math.ceil(c.bounds.top+Q),c.bounds.width,1);break}}));break;case 1:r.webkitTextStrokeWidth&&c.text.trim().length&&(w.ctx.strokeStyle=R(r.webkitTextStrokeColor),w.ctx.lineWidth=r.webkitTextStrokeWidth,w.ctx.lineJoin=window.chrome?"miter":"round",w.ctx.strokeText(c.text,c.bounds.left,c.bounds.top+o)),w.ctx.strokeStyle="",w.ctx.lineWidth=0,w.ctx.lineJoin="miter";break}})}),[2]})})},A.prototype.renderReplacedElement=function(t,r,B){if(B&&t.intrinsicWidth>0&&t.intrinsicHeight>0){var n=je(t),s=qe(r);this.path(s),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(B,0,0,t.intrinsicWidth,t.intrinsicHeight,n.left,n.top,n.width,n.height),this.ctx.restore()}},A.prototype.renderNodeContent=function(t){return P(this,void 0,void 0,function(){var r,B,n,s,i,a,F,F,o,Q,g,w,p,f,c,d,C,H,h,F,K,p,d;return _(this,function(l){switch(l.label){case 0:this.applyEffects(t.getEffects(4)),r=t.container,B=t.curves,n=r.styles,s=0,i=r.textNodes,l.label=1;case 1:return s<i.length?(a=i[s],[4,this.renderTextNode(a,n)]):[3,4];case 2:l.sent(),l.label=3;case 3:return s++,[3,1];case 4:if(!(r instanceof GB))return[3,8];l.label=5;case 5:return l.trys.push([5,7,,8]),[4,this.context.cache.match(r.src)];case 6:return F=l.sent(),this.renderReplacedElement(r,B,F),[3,8];case 7:return l.sent(),this.context.logger.error("Error loading image "+r.src),[3,8];case 8:if(r instanceof RB&&this.renderReplacedElement(r,B,r.canvas),!(r instanceof VB))return[3,12];l.label=9;case 9:return l.trys.push([9,11,,12]),[4,this.context.cache.match(r.svg)];case 10:return F=l.sent(),this.renderReplacedElement(r,B,F),[3,12];case 11:return l.sent(),this.context.logger.error("Error loading svg "+r.svg.substring(0,255)),[3,12];case 12:return r instanceof JB&&r.tree?(o=new A(this.context,{scale:this.options.scale,backgroundColor:r.backgroundColor,x:0,y:0,width:r.width,height:r.height}),[4,o.render(r.tree)]):[3,14];case 13:Q=l.sent(),r.width&&r.height&&this.ctx.drawImage(Q,0,0,r.width,r.height,r.bounds.left,r.bounds.top,r.bounds.width,r.bounds.height),l.label=14;case 14:if(r instanceof tt&&(g=Math.min(r.bounds.width,r.bounds.height),r.type===Pe?r.checked&&(this.ctx.save(),this.path([new u(r.bounds.left+g*.39363,r.bounds.top+g*.79),new u(r.bounds.left+g*.16,r.bounds.top+g*.5549),new u(r.bounds.left+g*.27347,r.bounds.top+g*.44071),new u(r.bounds.left+g*.39694,r.bounds.top+g*.5649),new u(r.bounds.left+g*.72983,r.bounds.top+g*.23),new u(r.bounds.left+g*.84,r.bounds.top+g*.34085),new u(r.bounds.left+g*.39363,r.bounds.top+g*.79)]),this.ctx.fillStyle=R(Jt),this.ctx.fill(),this.ctx.restore()):r.type===ke&&r.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(r.bounds.left+g/2,r.bounds.top+g/2,g/4,0,Math.PI*2,!0),this.ctx.fillStyle=R(Jt),this.ctx.fill(),this.ctx.restore())),EQ(r)&&r.value.length){switch(w=this.createFontStyle(n),p=w[0],f=w[1],c=this.fontMetrics.getMetrics(p,f).baseline,this.ctx.font=p,this.ctx.fillStyle=R(n.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=pQ(r.styles.textAlign),d=je(r),C=0,r.styles.textAlign){case 1:C+=d.width/2;break;case 2:C+=d.width;break}H=d.add(C,0,0,-d.height/2+1),this.ctx.save(),this.path([new u(d.left,d.top),new u(d.left+d.width,d.top),new u(d.left+d.width,d.top+d.height),new u(d.left,d.top+d.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new ie(r.value,H),n.letterSpacing,c),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!G(r.styles.display,2048))return[3,20];if(r.styles.listStyleImage===null)return[3,19];if(h=r.styles.listStyleImage,h.type!==0)return[3,18];F=void 0,K=h.url,l.label=15;case 15:return l.trys.push([15,17,,18]),[4,this.context.cache.match(K)];case 16:return F=l.sent(),this.ctx.drawImage(F,r.bounds.left-(F.width+10),r.bounds.top),[3,18];case 17:return l.sent(),this.context.logger.error("Error loading list-style-image "+K),[3,18];case 18:return[3,20];case 19:t.listValue&&r.styles.listStyleType!==-1&&(p=this.createFontStyle(n)[0],this.ctx.font=p,this.ctx.fillStyle=R(n.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",d=new cA(r.bounds.left,r.bounds.top+b(r.styles.paddingTop,r.bounds.width),r.bounds.width,yt(n.lineHeight,n.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new ie(t.listValue,d),n.letterSpacing,yt(n.lineHeight,n.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),l.label=20;case 20:return[2]}})})},A.prototype.renderStackContent=function(t){return P(this,void 0,void 0,function(){var r,B,h,n,s,h,i,a,h,o,Q,h,g,w,h,f,c,h,C,H,h;return _(this,function(F){switch(F.label){case 0:if(G(t.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:F.sent(),r=0,B=t.negativeZIndex,F.label=2;case 2:return r<B.length?(h=B[r],[4,this.renderStack(h)]):[3,5];case 3:F.sent(),F.label=4;case 4:return r++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:F.sent(),n=0,s=t.nonInlineLevel,F.label=7;case 7:return n<s.length?(h=s[n],[4,this.renderNode(h)]):[3,10];case 8:F.sent(),F.label=9;case 9:return n++,[3,7];case 10:i=0,a=t.nonPositionedFloats,F.label=11;case 11:return i<a.length?(h=a[i],[4,this.renderStack(h)]):[3,14];case 12:F.sent(),F.label=13;case 13:return i++,[3,11];case 14:o=0,Q=t.nonPositionedInlineLevel,F.label=15;case 15:return o<Q.length?(h=Q[o],[4,this.renderStack(h)]):[3,18];case 16:F.sent(),F.label=17;case 17:return o++,[3,15];case 18:g=0,w=t.inlineLevel,F.label=19;case 19:return g<w.length?(h=w[g],[4,this.renderNode(h)]):[3,22];case 20:F.sent(),F.label=21;case 21:return g++,[3,19];case 22:f=0,c=t.zeroOrAutoZIndexOrTransformedOrOpacity,F.label=23;case 23:return f<c.length?(h=c[f],[4,this.renderStack(h)]):[3,26];case 24:F.sent(),F.label=25;case 25:return f++,[3,23];case 26:C=0,H=t.positiveZIndex,F.label=27;case 27:return C<H.length?(h=H[C],[4,this.renderStack(h)]):[3,30];case 28:F.sent(),F.label=29;case 29:return C++,[3,27];case 30:return[2]}})})},A.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},A.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},A.prototype.formatPath=function(t){var r=this;t.forEach(function(B,n){var s=$(B)?B.start:B;n===0?r.ctx.moveTo(s.x,s.y):r.ctx.lineTo(s.x,s.y),$(B)&&r.ctx.bezierCurveTo(B.startControl.x,B.startControl.y,B.endControl.x,B.endControl.y,B.end.x,B.end.y)})},A.prototype.renderRepeat=function(t,r,B,n){this.path(t),this.ctx.fillStyle=r,this.ctx.translate(B,n),this.ctx.fill(),this.ctx.translate(-B,-n)},A.prototype.resizeImage=function(t,r,B){var n;if(t.width===r&&t.height===B)return t;var s=(n=this.canvas.ownerDocument)!==null&&n!==void 0?n:document,i=s.createElement("canvas");i.width=Math.max(1,r),i.height=Math.max(1,B);var a=i.getContext("2d");return a.drawImage(t,0,0,t.width,t.height,0,0,r,B),i},A.prototype.renderBackgroundImage=function(t){return P(this,void 0,void 0,function(){var r,B,n,s,i,a;return _(this,function(o){switch(o.label){case 0:r=t.styles.backgroundImage.length-1,B=function(Q){var g,w,f,O,Y,W,L,V,y,c,O,Y,W,L,V,C,H,h,F,K,p,d,l,v,y,E,O,k,q,L,V,CA,Y,W,IA,BA,uA,vA,yA,iA,KA,oA;return _(this,function(TA){switch(TA.label){case 0:if(Q.type!==0)return[3,5];g=void 0,w=Q.url,TA.label=1;case 1:return TA.trys.push([1,3,,4]),[4,n.context.cache.match(w)];case 2:return g=TA.sent(),[3,4];case 3:return TA.sent(),n.context.logger.error("Error loading background-image "+w),[3,4];case 4:return g&&(f=Kr(t,r,[g.width,g.height,g.width/g.height]),O=f[0],Y=f[1],W=f[2],L=f[3],V=f[4],y=n.ctx.createPattern(n.resizeImage(g,L,V),"repeat"),n.renderRepeat(O,y,Y,W)),[3,6];case 5:sa(Q)?(c=Kr(t,r,[null,null,null]),O=c[0],Y=c[1],W=c[2],L=c[3],V=c[4],C=ea(Q.angle,L,V),H=C[0],h=C[1],F=C[2],K=C[3],p=C[4],d=document.createElement("canvas"),d.width=L,d.height=V,l=d.getContext("2d"),v=l.createLinearGradient(h,K,F,p),It(Q.stops,H).forEach(function(YA){return v.addColorStop(YA.stop,R(YA.color))}),l.fillStyle=v,l.fillRect(0,0,L,V),L>0&&V>0&&(y=n.ctx.createPattern(d,"repeat"),n.renderRepeat(O,y,Y,W))):aa(Q)&&(E=Kr(t,r,[null,null,null]),O=E[0],k=E[1],q=E[2],L=E[3],V=E[4],CA=Q.position.length===0?[$r]:Q.position,Y=b(CA[0],L),W=b(CA[CA.length-1],V),IA=ra(Q,Y,W,L,V),BA=IA[0],uA=IA[1],BA>0&&uA>0&&(vA=n.ctx.createRadialGradient(k+Y,q+W,0,k+Y,q+W,BA),It(Q.stops,BA*2).forEach(function(YA){return vA.addColorStop(YA.stop,R(YA.color))}),n.path(O),n.ctx.fillStyle=vA,BA!==uA?(yA=t.bounds.left+.5*t.bounds.width,iA=t.bounds.top+.5*t.bounds.height,KA=uA/BA,oA=1/KA,n.ctx.save(),n.ctx.translate(yA,iA),n.ctx.transform(1,0,0,KA,0,0),n.ctx.translate(-yA,-iA),n.ctx.fillRect(k,oA*(q-iA)+iA,L,V*oA),n.ctx.restore()):n.ctx.fill())),TA.label=6;case 6:return r--,[2]}})},n=this,s=0,i=t.styles.backgroundImage.slice(0).reverse(),o.label=1;case 1:return s<i.length?(a=i[s],[5,B(a)]):[3,4];case 2:o.sent(),o.label=3;case 3:return s++,[3,1];case 4:return[2]}})})},A.prototype.renderSolidBorder=function(t,r,B){return P(this,void 0,void 0,function(){return _(this,function(n){return this.path(rB(B,r)),this.ctx.fillStyle=R(t),this.ctx.fill(),[2]})})},A.prototype.renderDoubleBorder=function(t,r,B,n){return P(this,void 0,void 0,function(){var s,i;return _(this,function(a){switch(a.label){case 0:return r<3?[4,this.renderSolidBorder(t,B,n)]:[3,2];case 1:return a.sent(),[2];case 2:return s=gQ(n,B),this.path(s),this.ctx.fillStyle=R(t),this.ctx.fill(),i=wQ(n,B),this.path(i),this.ctx.fill(),[2]}})})},A.prototype.renderNodeBackgroundAndBorders=function(t){return P(this,void 0,void 0,function(){var r,B,n,s,i,a,o,Q,g=this;return _(this,function(w){switch(w.label){case 0:return this.applyEffects(t.getEffects(2)),r=t.container.styles,B=!HA(r.backgroundColor)||r.backgroundImage.length,n=[{style:r.borderTopStyle,color:r.borderTopColor,width:r.borderTopWidth},{style:r.borderRightStyle,color:r.borderRightColor,width:r.borderRightWidth},{style:r.borderBottomStyle,color:r.borderBottomColor,width:r.borderBottomWidth},{style:r.borderLeftStyle,color:r.borderLeftColor,width:r.borderLeftWidth}],s=HQ(XA(r.backgroundClip,0),t.curves),B||r.boxShadow.length?(this.ctx.save(),this.path(s),this.ctx.clip(),HA(r.backgroundColor)||(this.ctx.fillStyle=R(r.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:w.sent(),this.ctx.restore(),r.boxShadow.slice(0).reverse().forEach(function(f){g.ctx.save();var c=Ze(t.curves),C=f.inset?0:hQ,H=oQ(c,-C+(f.inset?1:-1)*f.spread.number,(f.inset?1:-1)*f.spread.number,f.spread.number*(f.inset?-2:2),f.spread.number*(f.inset?-2:2));f.inset?(g.path(c),g.ctx.clip(),g.mask(H)):(g.mask(c),g.ctx.clip(),g.path(H)),g.ctx.shadowOffsetX=f.offsetX.number+C,g.ctx.shadowOffsetY=f.offsetY.number,g.ctx.shadowColor=R(f.color),g.ctx.shadowBlur=f.blur.number,g.ctx.fillStyle=f.inset?R(f.color):"rgba(0,0,0,1)",g.ctx.fill(),g.ctx.restore()}),w.label=2;case 2:i=0,a=0,o=n,w.label=3;case 3:return a<o.length?(Q=o[a],Q.style!==0&&!HA(Q.color)&&Q.width>0?Q.style!==2?[3,5]:[4,this.renderDashedDottedBorder(Q.color,Q.width,i,t.curves,2)]:[3,11]):[3,13];case 4:return w.sent(),[3,11];case 5:return Q.style!==3?[3,7]:[4,this.renderDashedDottedBorder(Q.color,Q.width,i,t.curves,3)];case 6:return w.sent(),[3,11];case 7:return Q.style!==4?[3,9]:[4,this.renderDoubleBorder(Q.color,Q.width,i,t.curves)];case 8:return w.sent(),[3,11];case 9:return[4,this.renderSolidBorder(Q.color,i,t.curves)];case 10:w.sent(),w.label=11;case 11:i++,w.label=12;case 12:return a++,[3,3];case 13:return[2]}})})},A.prototype.renderDashedDottedBorder=function(t,r,B,n,s){return P(this,void 0,void 0,function(){var i,a,o,Q,g,w,f,c,C,H,h,F,K,p,d,l,d,l;return _(this,function(v){return this.ctx.save(),i=cQ(n,B),a=rB(n,B),s===2&&(this.path(a),this.ctx.clip()),$(a[0])?(o=a[0].start.x,Q=a[0].start.y):(o=a[0].x,Q=a[0].y),$(a[1])?(g=a[1].end.x,w=a[1].end.y):(g=a[1].x,w=a[1].y),B===0||B===2?f=Math.abs(o-g):f=Math.abs(Q-w),this.ctx.beginPath(),s===3?this.formatPath(i):this.formatPath(a.slice(0,2)),c=r<3?r*3:r*2,C=r<3?r*2:r,s===3&&(c=r,C=r),H=!0,f<=c*2?H=!1:f<=c*2+C?(h=f/(2*c+C),c*=h,C*=h):(F=Math.floor((f+C)/(c+C)),K=(f-F*c)/(F-1),p=(f-(F+1)*c)/F,C=p<=0||Math.abs(C-K)<Math.abs(C-p)?K:p),H&&(s===3?this.ctx.setLineDash([0,c+C]):this.ctx.setLineDash([c,C])),s===3?(this.ctx.lineCap="round",this.ctx.lineWidth=r):this.ctx.lineWidth=r*2+1.1,this.ctx.strokeStyle=R(t),this.ctx.stroke(),this.ctx.setLineDash([]),s===2&&($(a[0])&&(d=a[3],l=a[0],this.ctx.beginPath(),this.formatPath([new u(d.end.x,d.end.y),new u(l.start.x,l.start.y)]),this.ctx.stroke()),$(a[1])&&(d=a[1],l=a[2],this.ctx.beginPath(),this.formatPath([new u(d.end.x,d.end.y),new u(l.start.x,l.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},A.prototype.render=function(t){return P(this,void 0,void 0,function(){var r;return _(this,function(B){switch(B.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=R(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),r=QQ(t),[4,this.renderStack(r)];case 1:return B.sent(),this.applyEffects([]),[2,this.canvas]}})})},A})(sn),EQ=function(e){return e instanceof _B||e instanceof XB?!0:e instanceof tt&&e.type!==ke&&e.type!==Pe},HQ=function(e,A){switch(e){case 0:return Ze(A);case 2:return BQ(A);case 1:default:return qe(A)}},pQ=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},IQ=["-apple-system","system-ui"],vQ=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(A){return IQ.indexOf(A)===-1}):e},yQ=(function(e){tA(A,e);function A(t,r){var B=e.call(this,t,r)||this;return B.canvas=r.canvas?r.canvas:document.createElement("canvas"),B.ctx=B.canvas.getContext("2d"),B.options=r,B.canvas.width=Math.floor(r.width*r.scale),B.canvas.height=Math.floor(r.height*r.scale),B.canvas.style.width=r.width+"px",B.canvas.style.height=r.height+"px",B.ctx.scale(B.options.scale,B.options.scale),B.ctx.translate(-r.x,-r.y),B.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+r.width+"x"+r.height+" at "+r.x+","+r.y+") with scale "+r.scale),B}return A.prototype.render=function(t){return P(this,void 0,void 0,function(){var r,B;return _(this,function(n){switch(n.label){case 0:return r=Pr(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,KQ(r)];case 1:return B=n.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=R(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(B,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},A})(sn),KQ=function(e){return new Promise(function(A,t){var r=new Image;r.onload=function(){A(r)},r.onerror=t,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},mQ=(function(){function e(A){var t=A.id,r=A.enabled;this.id=t,this.enabled=r,this.start=Date.now()}return e.prototype.debug=function(){for(var A=[],t=0;t<arguments.length;t++)A[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,ue([this.id,this.getTime()+"ms"],A)):this.info.apply(this,A))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var A=[],t=0;t<arguments.length;t++)A[t]=arguments[t];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,ue([this.id,this.getTime()+"ms"],A))},e.prototype.warn=function(){for(var A=[],t=0;t<arguments.length;t++)A[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,ue([this.id,this.getTime()+"ms"],A)):this.info.apply(this,A))},e.prototype.error=function(){for(var A=[],t=0;t<arguments.length;t++)A[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,ue([this.id,this.getTime()+"ms"],A)):this.info.apply(this,A))},e.instances={},e})(),LQ=(function(){function e(A,t){var r;this.windowBounds=t,this.instanceName="#"+e.instanceCount++,this.logger=new mQ({id:this.instanceName,enabled:A.logging}),this.cache=(r=A.cache)!==null&&r!==void 0?r:new qo(this,A)}return e.instanceCount=1,e})(),xQ=function(e,A){return A===void 0&&(A={}),DQ(e,A)};typeof window<"u"&&An.setContext(window);var DQ=function(e,A){return P(void 0,void 0,void 0,function(){var t,r,B,n,s,i,a,o,Q,g,w,f,c,C,H,h,F,K,p,d,v,l,v,y,E,O,k,q,L,V,CA,Y,W,IA,BA,uA,vA,yA,iA,KA;return _(this,function(oA){switch(oA.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(t=e.ownerDocument,!t)throw new Error("Element is not attached to a Document");if(r=t.defaultView,!r)throw new Error("Document is not attached to a Window");return B={allowTaint:(y=A.allowTaint)!==null&&y!==void 0?y:!1,imageTimeout:(E=A.imageTimeout)!==null&&E!==void 0?E:15e3,proxy:A.proxy,useCORS:(O=A.useCORS)!==null&&O!==void 0?O:!1},n=Lr({logging:(k=A.logging)!==null&&k!==void 0?k:!0,cache:A.cache},B),s={windowWidth:(q=A.windowWidth)!==null&&q!==void 0?q:r.innerWidth,windowHeight:(L=A.windowHeight)!==null&&L!==void 0?L:r.innerHeight,scrollX:(V=A.scrollX)!==null&&V!==void 0?V:r.pageXOffset,scrollY:(CA=A.scrollY)!==null&&CA!==void 0?CA:r.pageYOffset},i=new cA(s.scrollX,s.scrollY,s.windowWidth,s.windowHeight),a=new LQ(n,i),o=(Y=A.foreignObjectRendering)!==null&&Y!==void 0?Y:!1,Q={allowTaint:(W=A.allowTaint)!==null&&W!==void 0?W:!1,onclone:A.onclone,ignoreElements:A.ignoreElements,inlineImages:o,copyStyles:o},a.logger.debug("Starting document clone with size "+i.width+"x"+i.height+" scrolled to "+-i.left+","+-i.top),g=new $t(a,e,Q),w=g.clonedReferenceElement,w?[4,g.toIFrame(t,i)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return f=oA.sent(),c=Bt(w)||xo(w)?an(w.ownerDocument):ze(a,w),C=c.width,H=c.height,h=c.left,F=c.top,K=bQ(a,w,A.backgroundColor),p={canvas:A.canvas,backgroundColor:K,scale:(BA=(IA=A.scale)!==null&&IA!==void 0?IA:r.devicePixelRatio)!==null&&BA!==void 0?BA:1,x:((uA=A.x)!==null&&uA!==void 0?uA:0)+h,y:((vA=A.y)!==null&&vA!==void 0?vA:0)+F,width:(yA=A.width)!==null&&yA!==void 0?yA:Math.ceil(C),height:(iA=A.height)!==null&&iA!==void 0?iA:Math.ceil(H)},o?(a.logger.debug("Document cloned, using foreign object rendering"),v=new yQ(a,p),[4,v.render(w)]):[3,3];case 2:return d=oA.sent(),[3,5];case 3:return a.logger.debug("Document cloned, element located at "+h+","+F+" with size "+C+"x"+H+" using computed rendering"),a.logger.debug("Starting DOM parsing"),l=kB(a,w),K===l.styles.backgroundColor&&(l.styles.backgroundColor=wA.TRANSPARENT),a.logger.debug("Starting renderer for element at "+p.x+","+p.y+" with size "+p.width+"x"+p.height),v=new dQ(a,p),[4,v.render(l)];case 4:d=oA.sent(),oA.label=5;case 5:return(!((KA=A.removeContainer)!==null&&KA!==void 0)||KA)&&($t.destroy(f)||a.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),a.logger.debug("Finished rendering"),[2,d]}})})},bQ=function(e,A,t){var r=A.ownerDocument,B=r.documentElement?se(e,getComputedStyle(r.documentElement).backgroundColor):wA.TRANSPARENT,n=r.body?se(e,getComputedStyle(r.body).backgroundColor):wA.TRANSPARENT,s=typeof t=="string"?se(e,t):t===null?wA.TRANSPARENT:4294967295;return A===r.documentElement?HA(B)?HA(n)?s:n:B:s};export{xQ as default};
public/flight-school-app/assets/index-C-Gm8wkn.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct";X&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=X?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(n.eventCategory==="twr_di"&&console.log("🔍 TWR DI EVENT:",{id:n.id,flightNumber:n.flightNumber,flightType:n.flightType,pilot:n.pilot,instructor:n.instructor,student:n.student}),n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return console.log("🎯 FALLBACK SOLO DETECTION: Pilot and student are the same:",n.pilot),e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-C2PVgj_X.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{try{const Ge=T}catch{}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct",ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=X?n.student:n.flightType==="Solo"?"":n.student||"";let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-BCojCDFQ.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{try{const Ge=T}catch{}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct",ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=X?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-DPqDFPki.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},ye=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},xe=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),Ve=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},We=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>We("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>We("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),ye.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),Ve.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:Ve.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:xe,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{try{const Ge=T}catch{}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct",ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=n.flightType==="Solo"?"":X?n.student:n.student||"";let ue="font-semibold truncate",ye="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?ye="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(ye="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,We=n.startTime+n.duration,we=Ht>=We&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?ye="font-bold truncate text-red-500":ye+=" text-white/80"}const xe=(()=>{if(W)return K;if(n.flightType==="Solo")return console.log("🎯 SOLO badge returned for event:",n.id,"flightType:",n.flightType,"eventCategory:",n.eventCategory),e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&console.log("🔍 SCT event check:",n.id,"flightType:",n.flightType,"student:",n.student,"pilot:",n.pilot),X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof xe=="string"?xe:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,We=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[We==null?void 0:We.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[We==null?void 0:We.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate",""),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[xe,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-uPhlgI5U.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),J=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(J);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{J&&K(!0)},[J]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${J?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const J=n.eventCategory==="sct";J&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const ee=J||n.flightType==="Solo"?n.pilot:n.instructor,K=J?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(J&&n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(J&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-BjUJyT2V.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct";X&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=X?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return console.log("🎯 FALLBACK SOLO DETECTION: Pilot and student are the same:",n.pilot),e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-CjcVQ336.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),he=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),J=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[te,K]=C.useState(J);C.useEffect(()=>{const Re=be=>{he.current&&!he.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{J&&K(!0)},[J]);const fe=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},Ie=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(Ie).sort((Re,be)=>{const Ze=Z.indexOf(Re),lt=Z.indexOf(be);return Ze!==-1&&lt!==-1?Ze-lt:Ze!==-1?-1:lt!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,nt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),st=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),yt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},rt=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),Nt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!st?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:he,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:yt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!st?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>rt("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>rt("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:Nt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!st?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!st?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:fe,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${J?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${te?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${te?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:nt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),Ie[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const Nt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(Nt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-Nt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,he=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(he,Ne));const J=n.eventCategory==="sct";J&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const te=J||n.flightType==="Solo"?n.pilot:n.instructor,K=J?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let fe="font-semibold truncate",xe="truncate";if(W)te!=null&&te.includes("✓")?fe="font-bold truncate text-green-400":te!=null&&te.includes("✕")&&(fe="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(te||""),Nt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===te||ht&&!we?fe="font-bold truncate text-red-500":Ge&&(fe+=` ${Ge}`),x===K||Nt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(J&&n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(J&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(te),qe=pe(typeof ye=="string"?ye:""),Ie=n.callsign||"",Z=te?y.get(te):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=Ie||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const nt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,Nt=Ze=>{if(!Ze)return Ze;const lt=Ze.split(", ");if(lt.length!==2)return Ze;const Vt=lt[0],yn=lt[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?Nt(te||""):te,ze=ht?Nt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:fe,children:[te==null?void 0:te.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:fe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],qe&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:qe})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:fe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],qe&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:qe})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,st=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,yt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",rt=[Ke];W?(rt.push(n.color),rt.push("border-2 border-dashed border-sky-300")):(rt.push(Ct),rt.push(`ring-[0.92px] ${yt}`),rt.push(dn),rt.push(on)),M||rt.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${fe.replace("truncate","")}`,children:[te==null?void 0:te.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,qe&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:qe})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:rt.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),st&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),nt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-CHdj6ICi.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},ye=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},xe=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),Ve=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},We=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>We("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>We("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),ye.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),Ve.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:Ve.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:xe,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{try{const Ge=T}catch{}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct",ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=n.flightType==="Solo"?"":X?n.student:n.student||"";let ue="font-semibold truncate",ye="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?ye="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(ye="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,We=n.startTime+n.duration,we=Ht>=We&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?ye="font-bold truncate text-red-500":ye+=" text-white/80"}const xe=(()=>{if(W)return K;if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&!n.student&&n.pilot)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof xe=="string"?xe:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,We=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[We==null?void 0:We.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[We==null?void 0:We.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate",""),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[xe,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-CmDcbMTV.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{try{const Ge=T}catch{}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct",ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=X?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-Cu9GSreP.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[je,Y]=C.useState(!1),he=C.useRef(null),[ge,Ne]=C.useState(!1),[$e,se]=C.useState(!1),F=C.useRef(null),J=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[te,K]=C.useState(J);C.useEffect(()=>{const Re=be=>{he.current&&!he.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{J&&K(!0)},[J]);const fe=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},de=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},Ie=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(Ie).sort((Re,be)=>{const Ze=Z.indexOf(Re),lt=Z.indexOf(be);return Ze!==-1&&lt!==-1?Ze-lt:Ze!==-1?-1:lt!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),yt=()=>Q(!0),dn=()=>{je||Q(!1)},on=()=>{const Re=!je;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||je,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),Nt=()=>{$e||Ne(!1)},Ht=()=>{const Re=!$e;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||$e;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:he,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:yt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:Nt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:fe,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${J?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${te?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${te?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),Ie[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&de(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:de,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},je=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const Nt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(Nt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-Nt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,he=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(he,Ne));const J=n.eventCategory==="sct";J&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const te=J||n.flightType==="Solo"?n.pilot:n.instructor,K=J?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let fe="font-semibold truncate",xe="truncate";if(W)te!=null&&te.includes("✓")?fe="font-bold truncate text-green-400":te!=null&&te.includes("✕")&&(fe="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(te||""),Nt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===te||ht&&!we?fe="font-bold truncate text-red-500":Ge&&(fe+=` ${Ge}`),x===K||Nt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(J&&n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(J&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},de=pe(te),qe=pe(typeof ye=="string"?ye:""),Ie=n.callsign||"",Z=te?y.get(te):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=Ie||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,Nt=Ze=>{if(!Ze)return Ze;const lt=Ze.split(", ");if(lt.length!==2)return Ze;const Wt=lt[0],yn=lt[1].charAt(0);return`${Wt}, ${yn}`},Ht=ht?Nt(te||""):te,ze=ht?Nt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:fe,children:[te==null?void 0:te.split(" – ")[0],de&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:de})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:fe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],de&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:de})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],qe&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:qe})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:fe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],de&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:de})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],qe&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:qe})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,yt=je(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${yt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${fe.replace("truncate","")}`,children:[te==null?void 0:te.split(" – ")[0],de&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:de})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,qe&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:qe})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-B32GbIkA.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},ye=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},xe=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),Ve=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},We=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>We("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>We("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),ye.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),Ve.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:Ve.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:xe,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{try{const Ge=T}catch{}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct",ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=n.flightType==="Solo"?"":X?n.student:n.student||"";let ue="font-semibold truncate",ye="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?ye="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(ye="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,We=n.startTime+n.duration,we=Ht>=We&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?ye="font-bold truncate text-red-500":ye+=" text-white/80"}const xe=(()=>{if(W)return K;if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof xe=="string"?xe:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,We=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[We==null?void 0:We.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[We==null?void 0:We.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate",""),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[xe,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-CT8kx44m.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),J=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(J);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{J&&K(!0)},[J]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${J?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const J=n.eventCategory==="sct";J&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const ee=J||n.flightType==="Solo"?n.pilot:n.instructor,K=J?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(J&&n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(J&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.pilot&&n.student&&n.pilot===n.student)return console.log("🎯 FALLBACK SOLO DETECTION: Pilot and student are the same:",n.pilot),e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
assets/html2canvas.esm-QH1iLAAe.js:         .`+qr+Yo+AB)},Zo=function(e,A){var t=e.ownerDocument;if(t){var r=t.createElement("style");r.textContent=A,e.appendChild(r)}},An=(function(){function e(){}return e.getOrigin=function(A){var t=e._link;return t?(t.href=A,t.href=t.href,t.protocol+t.hostname+t.port):"about:blank"},e.isSameOrigin=function(A){return e.getOrigin(A)===e._origin},e.setContext=function(A){e._link=A.document.createElement("a"),e._origin=e.getOrigin(A.location.href)},e._origin="about:blank",e})(),qo=(function(){function e(A,t){this.context=A,this._options=t,this._cache={}}return e.prototype.addImage=function(A){var t=Promise.resolve();return this.has(A)||(yr(A)||AQ(A))&&(this._cache[A]=this.loadImage(A)).catch(function(){}),t},e.prototype.match=function(A){return this._cache[A]},e.prototype.loadImage=function(A){return P(this,void 0,void 0,function(){var t,r,B,n,s=this;return _(this,function(i){switch(i.label){case 0:return t=An.isSameOrigin(A),r=!vr(A)&&this._options.useCORS===!0&&N.SUPPORT_CORS_IMAGES&&!t,B=!vr(A)&&!t&&!yr(A)&&typeof this._options.proxy=="string"&&N.SUPPORT_CORS_XHR&&!r,!t&&this._options.allowTaint===!1&&!vr(A)&&!yr(A)&&!B&&!r?[2]:(n=A,B?[4,this.proxy(n)]:[3,2]);case 1:n=i.sent(),i.label=2;case 2:return this.context.logger.debug("Added image "+A.substring(0,256)),[4,new Promise(function(a,o){var Q=new Image;Q.onload=function(){return a(Q)},Q.onerror=o,(eQ(n)||r)&&(Q.crossOrigin="anonymous"),Q.src=n,Q.complete===!0&&setTimeout(function(){return a(Q)},500),s._options.imageTimeout>0&&setTimeout(function(){return o("Timed out ("+s._options.imageTimeout+"ms) loading image")},s._options.imageTimeout)})];case 3:return[2,i.sent()]}})})},e.prototype.has=function(A){return typeof this._cache[A]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(A){var t=this,r=this._options.proxy;if(!r)throw new Error("No proxy defined");var B=A.substring(0,256);return new Promise(function(n,s){var i=N.SUPPORT_RESPONSE_TYPE?"blob":"text",a=new XMLHttpRequest;a.onload=function(){if(a.status===200)if(i==="text")n(a.response);else{var g=new FileReader;g.addEventListener("load",function(){return n(g.result)},!1),g.addEventListener("error",function(w){return s(w)},!1),g.readAsDataURL(a.response)}else s("Failed to proxy resource "+B+" with status code "+a.status)},a.onerror=s;var o=r.indexOf("?")>-1?"&":"?";if(a.open("GET",""+r+o+"url="+encodeURIComponent(A)+"&responseType="+i),i!=="text"&&a instanceof XMLHttpRequest&&(a.responseType=i),t._options.imageTimeout){var Q=t._options.imageTimeout;a.timeout=Q,a.ontimeout=function(){return s("Timed out ("+Q+"ms) proxying "+B)}}a.send()})},e})(),jo=/^data:image\/svg\+xml/i,zo=/^data:image\/.*;base64,/i,$o=/^data:image\/.*/i,AQ=function(e){return N.SUPPORT_SVG_DRAWING||!rQ(e)},vr=function(e){return $o.test(e)},eQ=function(e){return zo.test(e)},yr=function(e){return e.substr(0,4)==="blob"},rQ=function(e){return e.substr(-3).toLowerCase()==="svg"||jo.test(e)},u=(function(){function e(A,t){this.type=0,this.x=A,this.y=t}return e.prototype.add=function(A,t){return new e(this.x+A,this.y+t)},e})(),RA=function(e,A,t){return new u(e.x+(A.x-e.x)*t,e.y+(A.y-e.y)*t)},Te=(function(){function e(A,t,r,B){this.type=1,this.start=A,this.startControl=t,this.endControl=r,this.end=B}return e.prototype.subdivide=function(A,t){var r=RA(this.start,this.startControl,A),B=RA(this.startControl,this.endControl,A),n=RA(this.endControl,this.end,A),s=RA(r,B,A),i=RA(B,n,A),a=RA(s,i,A);return t?new e(this.start,r,s,a):new e(a,i,n,this.end)},e.prototype.add=function(A,t){return new e(this.start.add(A,t),this.startControl.add(A,t),this.endControl.add(A,t),this.end.add(A,t))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e})(),$=function(e){return e.type===1},tQ=(function(){function e(A){var t=A.styles,r=A.bounds,B=re(t.borderTopLeftRadius,r.width,r.height),n=B[0],s=B[1],i=re(t.borderTopRightRadius,r.width,r.height),a=i[0],o=i[1],Q=re(t.borderBottomRightRadius,r.width,r.height),g=Q[0],w=Q[1],f=re(t.borderBottomLeftRadius,r.width,r.height),c=f[0],C=f[1],H=[];H.push((n+a)/r.width),H.push((c+g)/r.width),H.push((s+C)/r.height),H.push((o+w)/r.height);var h=Math.max.apply(Math,H);h>1&&(n/=h,s/=h,a/=h,o/=h,g/=h,w/=h,c/=h,C/=h);var F=r.width-a,K=r.height-w,p=r.width-g,d=r.height-C,l=t.borderTopWidth,v=t.borderRightWidth,y=t.borderBottomWidth,E=t.borderLeftWidth,O=b(t.paddingTop,A.bounds.width),k=b(t.paddingRight,A.bounds.width),q=b(t.paddingBottom,A.bounds.width),L=b(t.paddingLeft,A.bounds.width);this.topLeftBorderDoubleOuterBox=n>0||s>0?x(r.left+E/3,r.top+l/3,n-E/3,s-l/3,m.TOP_LEFT):new u(r.left+E/3,r.top+l/3),this.topRightBorderDoubleOuterBox=n>0||s>0?x(r.left+F,r.top+l/3,a-v/3,o-l/3,m.TOP_RIGHT):new u(r.left+r.width-v/3,r.top+l/3),this.bottomRightBorderDoubleOuterBox=g>0||w>0?x(r.left+p,r.top+K,g-v/3,w-y/3,m.BOTTOM_RIGHT):new u(r.left+r.width-v/3,r.top+r.height-y/3),this.bottomLeftBorderDoubleOuterBox=c>0||C>0?x(r.left+E/3,r.top+d,c-E/3,C-y/3,m.BOTTOM_LEFT):new u(r.left+E/3,r.top+r.height-y/3),this.topLeftBorderDoubleInnerBox=n>0||s>0?x(r.left+E*2/3,r.top+l*2/3,n-E*2/3,s-l*2/3,m.TOP_LEFT):new u(r.left+E*2/3,r.top+l*2/3),this.topRightBorderDoubleInnerBox=n>0||s>0?x(r.left+F,r.top+l*2/3,a-v*2/3,o-l*2/3,m.TOP_RIGHT):new u(r.left+r.width-v*2/3,r.top+l*2/3),this.bottomRightBorderDoubleInnerBox=g>0||w>0?x(r.left+p,r.top+K,g-v*2/3,w-y*2/3,m.BOTTOM_RIGHT):new u(r.left+r.width-v*2/3,r.top+r.height-y*2/3),this.bottomLeftBorderDoubleInnerBox=c>0||C>0?x(r.left+E*2/3,r.top+d,c-E*2/3,C-y*2/3,m.BOTTOM_LEFT):new u(r.left+E*2/3,r.top+r.height-y*2/3),this.topLeftBorderStroke=n>0||s>0?x(r.left+E/2,r.top+l/2,n-E/2,s-l/2,m.TOP_LEFT):new u(r.left+E/2,r.top+l/2),this.topRightBorderStroke=n>0||s>0?x(r.left+F,r.top+l/2,a-v/2,o-l/2,m.TOP_RIGHT):new u(r.left+r.width-v/2,r.top+l/2),this.bottomRightBorderStroke=g>0||w>0?x(r.left+p,r.top+K,g-v/2,w-y/2,m.BOTTOM_RIGHT):new u(r.left+r.width-v/2,r.top+r.height-y/2),this.bottomLeftBorderStroke=c>0||C>0?x(r.left+E/2,r.top+d,c-E/2,C-y/2,m.BOTTOM_LEFT):new u(r.left+E/2,r.top+r.height-y/2),this.topLeftBorderBox=n>0||s>0?x(r.left,r.top,n,s,m.TOP_LEFT):new u(r.left,r.top),this.topRightBorderBox=a>0||o>0?x(r.left+F,r.top,a,o,m.TOP_RIGHT):new u(r.left+r.width,r.top),this.bottomRightBorderBox=g>0||w>0?x(r.left+p,r.top+K,g,w,m.BOTTOM_RIGHT):new u(r.left+r.width,r.top+r.height),this.bottomLeftBorderBox=c>0||C>0?x(r.left,r.top+d,c,C,m.BOTTOM_LEFT):new u(r.left,r.top+r.height),this.topLeftPaddingBox=n>0||s>0?x(r.left+E,r.top+l,Math.max(0,n-E),Math.max(0,s-l),m.TOP_LEFT):new u(r.left+E,r.top+l),this.topRightPaddingBox=a>0||o>0?x(r.left+Math.min(F,r.width-v),r.top+l,F>r.width+v?0:Math.max(0,a-v),Math.max(0,o-l),m.TOP_RIGHT):new u(r.left+r.width-v,r.top+l),this.bottomRightPaddingBox=g>0||w>0?x(r.left+Math.min(p,r.width-E),r.top+Math.min(K,r.height-y),Math.max(0,g-v),Math.max(0,w-y),m.BOTTOM_RIGHT):new u(r.left+r.width-v,r.top+r.height-y),this.bottomLeftPaddingBox=c>0||C>0?x(r.left+E,r.top+Math.min(d,r.height-y),Math.max(0,c-E),Math.max(0,C-y),m.BOTTOM_LEFT):new u(r.left+E,r.top+r.height-y),this.topLeftContentBox=n>0||s>0?x(r.left+E+L,r.top+l+O,Math.max(0,n-(E+L)),Math.max(0,s-(l+O)),m.TOP_LEFT):new u(r.left+E+L,r.top+l+O),this.topRightContentBox=a>0||o>0?x(r.left+Math.min(F,r.width+E+L),r.top+l+O,F>r.width+E+L?0:a-E+L,o-(l+O),m.TOP_RIGHT):new u(r.left+r.width-(v+k),r.top+l+O),this.bottomRightContentBox=g>0||w>0?x(r.left+Math.min(p,r.width-(E+L)),r.top+Math.min(K,r.height+l+O),Math.max(0,g-(v+k)),w-(y+q),m.BOTTOM_RIGHT):new u(r.left+r.width-(v+k),r.top+r.height-(y+q)),this.bottomLeftContentBox=c>0||C>0?x(r.left+E+L,r.top+d,Math.max(0,c-(E+L)),C-(y+q),m.BOTTOM_LEFT):new u(r.left+E+L,r.top+r.height-(y+q))}return e})(),m;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(m||(m={}));var x=function(e,A,t,r,B){var n=4*((Math.sqrt(2)-1)/3),s=t*n,i=r*n,a=e+t,o=A+r;switch(B){case m.TOP_LEFT:return new Te(new u(e,o),new u(e,o-i),new u(a-s,A),new u(a,A));case m.TOP_RIGHT:return new Te(new u(e,A),new u(e+s,A),new u(a,o-i),new u(a,o));case m.BOTTOM_RIGHT:return new Te(new u(a,A),new u(a,A+i),new u(e+s,o),new u(e,o));case m.BOTTOM_LEFT:default:return new Te(new u(a,o),new u(a-s,o),new u(e,A+i),new u(e,A))}},Ze=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},BQ=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},qe=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},nQ=(function(){function e(A,t,r){this.offsetX=A,this.offsetY=t,this.matrix=r,this.type=0,this.target=6}return e})(),Se=(function(){function e(A,t){this.path=A,this.target=t,this.type=1}return e})(),sQ=(function(){function e(A){this.opacity=A,this.type=2,this.target=6}return e})(),aQ=function(e){return e.type===0},en=function(e){return e.type===1},iQ=function(e){return e.type===2},eB=function(e,A){return e.length===A.length?e.some(function(t,r){return t===A[r]}):!1},oQ=function(e,A,t,r,B){return e.map(function(n,s){switch(s){case 0:return n.add(A,t);case 1:return n.add(A+r,t);case 2:return n.add(A+r,t+B);case 3:return n.add(A,t+B)}return n})},rn=(function(){function e(A){this.element=A,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e})(),tn=(function(){function e(A,t){if(this.container=A,this.parent=t,this.effects=[],this.curves=new tQ(this.container),this.container.styles.opacity<1&&this.effects.push(new sQ(this.container.styles.opacity)),this.container.styles.transform!==null){var r=this.container.bounds.left+this.container.styles.transformOrigin[0].number,B=this.container.bounds.top+this.container.styles.transformOrigin[1].number,n=this.container.styles.transform;this.effects.push(new nQ(r,B,n))}if(this.container.styles.overflowX!==0){var s=Ze(this.curves),i=qe(this.curves);eB(s,i)?this.effects.push(new Se(s,6)):(this.effects.push(new Se(s,2)),this.effects.push(new Se(i,4)))}}return e.prototype.getEffects=function(A){for(var t=[2,3].indexOf(this.container.styles.position)===-1,r=this.parent,B=this.effects.slice(0);r;){var n=r.effects.filter(function(a){return!en(a)});if(t||r.container.styles.position!==0||!r.parent){if(B.unshift.apply(B,n),t=[2,3].indexOf(r.container.styles.position)===-1,r.container.styles.overflowX!==0){var s=Ze(r.curves),i=qe(r.curves);eB(s,i)||B.unshift(new Se(i,6))}}else B.unshift.apply(B,n);r=r.parent}return B.filter(function(a){return G(a.target,A)})},e})(),jr=function(e,A,t,r){e.container.elements.forEach(function(B){var n=G(B.flags,4),s=G(B.flags,2),i=new tn(B,e);G(B.styles.display,2048)&&r.push(i);var a=G(B.flags,8)?[]:r;if(n||s){var o=n||B.styles.isPositioned()?t:A,Q=new rn(i);if(B.styles.isPositioned()||B.styles.opacity<1||B.styles.isTransformed()){var g=B.styles.zIndex.order;if(g<0){var w=0;o.negativeZIndex.some(function(c,C){return g>c.element.container.styles.zIndex.order?(w=C,!1):w>0}),o.negativeZIndex.splice(w,0,Q)}else if(g>0){var f=0;o.positiveZIndex.some(function(c,C){return g>=c.element.container.styles.zIndex.order?(f=C+1,!1):f>0}),o.positiveZIndex.splice(f,0,Q)}else o.zeroOrAutoZIndexOrTransformedOrOpacity.push(Q)}else B.styles.isFloating()?o.nonPositionedFloats.push(Q):o.nonPositionedInlineLevel.push(Q);jr(i,Q,n?Q:t,a)}else B.styles.isInlineLevel()?A.inlineLevel.push(i):A.nonInlineLevel.push(i),jr(i,A,t,a);G(B.flags,8)&&Bn(B,a)})},Bn=function(e,A){for(var t=e instanceof kr?e.start:1,r=e instanceof kr?e.reversed:!1,B=0;B<A.length;B++){var n=A[B];n.container instanceof NB&&typeof n.container.value=="number"&&n.container.value!==0&&(t=n.container.value),n.listValue=we(t,n.container.styles.listStyleType,!0),t+=r?-1:1}},QQ=function(e){var A=new tn(e,null),t=new rn(A),r=[];return jr(A,t,t,r),Bn(A.container,r),t},rB=function(e,A){switch(A){case 0:return eA(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return eA(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return eA(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return eA(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},gQ=function(e,A){switch(A){case 0:return eA(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return eA(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return eA(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return eA(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},wQ=function(e,A){switch(A){case 0:return eA(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return eA(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return eA(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return eA(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},cQ=function(e,A){switch(A){case 0:return Oe(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return Oe(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return Oe(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return Oe(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},Oe=function(e,A){var t=[];return $(e)?t.push(e.subdivide(.5,!1)):t.push(e),$(A)?t.push(A.subdivide(.5,!0)):t.push(A),t},eA=function(e,A,t,r){var B=[];return $(e)?B.push(e.subdivide(.5,!1)):B.push(e),$(t)?B.push(t.subdivide(.5,!0)):B.push(t),$(r)?B.push(r.subdivide(.5,!0).reverse()):B.push(r),$(A)?B.push(A.subdivide(.5,!1).reverse()):B.push(A),B},nn=function(e){var A=e.bounds,t=e.styles;return A.add(t.borderLeftWidth,t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth),-(t.borderTopWidth+t.borderBottomWidth))},je=function(e){var A=e.styles,t=e.bounds,r=b(A.paddingLeft,t.width),B=b(A.paddingRight,t.width),n=b(A.paddingTop,t.width),s=b(A.paddingBottom,t.width);return t.add(r+A.borderLeftWidth,n+A.borderTopWidth,-(A.borderRightWidth+A.borderLeftWidth+r+B),-(A.borderTopWidth+A.borderBottomWidth+n+s))},CQ=function(e,A){return e===0?A.bounds:e===2?je(A):nn(A)},uQ=function(e,A){return e===0?A.bounds:e===2?je(A):nn(A)},Kr=function(e,A,t){var r=CQ(XA(e.styles.backgroundOrigin,A),e),B=uQ(XA(e.styles.backgroundClip,A),e),n=lQ(XA(e.styles.backgroundSize,A),t,r),s=n[0],i=n[1],a=re(XA(e.styles.backgroundPosition,A),r.width-s,r.height-i),o=fQ(XA(e.styles.backgroundRepeat,A),a,n,r,B),Q=Math.round(r.left+a[0]),g=Math.round(r.top+a[1]);return[o,Q,g,s,i]},VA=function(e){return D(e)&&e.value===JA.AUTO},Me=function(e){return typeof e=="number"},lQ=function(e,A,t){var r=A[0],B=A[1],n=A[2],s=e[0],i=e[1];if(!s)return[0,0];if(M(s)&&i&&M(i))return[b(s,t.width),b(i,t.height)];var a=Me(n);if(D(s)&&(s.value===JA.CONTAIN||s.value===JA.COVER)){if(Me(n)){var o=t.width/t.height;return o<n!=(s.value===JA.COVER)?[t.width,t.width/n]:[t.height*n,t.height]}return[t.width,t.height]}var Q=Me(r),g=Me(B),w=Q||g;if(VA(s)&&(!i||VA(i))){if(Q&&g)return[r,B];if(!a&&!w)return[t.width,t.height];if(w&&a){var f=Q?r:B*n,c=g?B:r/n;return[f,c]}var C=Q?r:t.width,H=g?B:t.height;return[C,H]}if(a){var h=0,F=0;return M(s)?h=b(s,t.width):M(i)&&(F=b(i,t.height)),VA(s)?h=F*n:(!i||VA(i))&&(F=h/n),[h,F]}var K=null,p=null;if(M(s)?K=b(s,t.width):i&&M(i)&&(p=b(i,t.height)),K!==null&&(!i||VA(i))&&(p=Q&&g?K/r*B:t.height),p!==null&&VA(s)&&(K=Q&&g?p/B*r:t.width),K!==null&&p!==null)return[K,p];throw new Error("Unable to calculate background-size for element")},XA=function(e,A){var t=e[A];return typeof t>"u"?e[0]:t},fQ=function(e,A,t,r,B){var n=A[0],s=A[1],i=t[0],a=t[1];switch(e){case 2:return[new u(Math.round(r.left),Math.round(r.top+s)),new u(Math.round(r.left+r.width),Math.round(r.top+s)),new u(Math.round(r.left+r.width),Math.round(a+r.top+s)),new u(Math.round(r.left),Math.round(a+r.top+s))];case 3:return[new u(Math.round(r.left+n),Math.round(r.top)),new u(Math.round(r.left+n+i),Math.round(r.top)),new u(Math.round(r.left+n+i),Math.round(r.height+r.top)),new u(Math.round(r.left+n),Math.round(r.height+r.top))];case 1:return[new u(Math.round(r.left+n),Math.round(r.top+s)),new u(Math.round(r.left+n+i),Math.round(r.top+s)),new u(Math.round(r.left+n+i),Math.round(r.top+s+a)),new u(Math.round(r.left+n),Math.round(r.top+s+a))];default:return[new u(Math.round(B.left),Math.round(B.top)),new u(Math.round(B.left+B.width),Math.round(B.top)),new u(Math.round(B.left+B.width),Math.round(B.height+B.top)),new u(Math.round(B.left),Math.round(B.height+B.top))]}},UQ="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",tB="Hidden Text",FQ=(function(){function e(A){this._data={},this._document=A}return e.prototype.parseMetrics=function(A,t){var r=this._document.createElement("div"),B=this._document.createElement("img"),n=this._document.createElement("span"),s=this._document.body;r.style.visibility="hidden",r.style.fontFamily=A,r.style.fontSize=t,r.style.margin="0",r.style.padding="0",r.style.whiteSpace="nowrap",s.appendChild(r),B.src=UQ,B.width=1,B.height=1,B.style.margin="0",B.style.padding="0",B.style.verticalAlign="baseline",n.style.fontFamily=A,n.style.fontSize=t,n.style.margin="0",n.style.padding="0",n.appendChild(this._document.createTextNode(tB)),r.appendChild(n),r.appendChild(B);var i=B.offsetTop-n.offsetTop+2;r.removeChild(n),r.appendChild(this._document.createTextNode(tB)),r.style.lineHeight="normal",B.style.verticalAlign="super";var a=B.offsetTop-r.offsetTop+2;return s.removeChild(r),{baseline:i,middle:a}},e.prototype.getMetrics=function(A,t){var r=A+" "+t;return typeof this._data[r]>"u"&&(this._data[r]=this.parseMetrics(A,t)),this._data[r]},e})(),sn=(function(){function e(A,t){this.context=A,this.options=t}return e})(),hQ=1e4,dQ=(function(e){tA(A,e);function A(t,r){var B=e.call(this,t,r)||this;return B._activeEffects=[],B.canvas=r.canvas?r.canvas:document.createElement("canvas"),B.ctx=B.canvas.getContext("2d"),r.canvas||(B.canvas.width=Math.floor(r.width*r.scale),B.canvas.height=Math.floor(r.height*r.scale),B.canvas.style.width=r.width+"px",B.canvas.style.height=r.height+"px"),B.fontMetrics=new FQ(document),B.ctx.scale(B.options.scale,B.options.scale),B.ctx.translate(-r.x,-r.y),B.ctx.textBaseline="bottom",B._activeEffects=[],B.context.logger.debug("Canvas renderer initialized ("+r.width+"x"+r.height+") with scale "+r.scale),B}return A.prototype.applyEffects=function(t){for(var r=this;this._activeEffects.length;)this.popEffect();t.forEach(function(B){return r.applyEffect(B)})},A.prototype.applyEffect=function(t){this.ctx.save(),iQ(t)&&(this.ctx.globalAlpha=t.opacity),aQ(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),en(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},A.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},A.prototype.renderStack=function(t){return P(this,void 0,void 0,function(){var r;return _(this,function(B){switch(B.label){case 0:return r=t.element.container.styles,r.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:B.sent(),B.label=2;case 2:return[2]}})})},A.prototype.renderNode=function(t){return P(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:if(G(t.container.flags,16))debugger;return t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return r.sent(),[4,this.renderNodeContent(t)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},A.prototype.renderTextWithLetterSpacing=function(t,r,B){var n=this;if(r===0)this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+B);else{var s=rt(t.text);s.reduce(function(i,a){return n.ctx.fillText(a,i,t.bounds.top+B),i+n.ctx.measureText(a).width},t.bounds.left)}},A.prototype.createFontStyle=function(t){var r=t.fontVariant.filter(function(s){return s==="normal"||s==="small-caps"}).join(""),B=vQ(t.fontFamily).join(", "),n=Ce(t.fontSize)?""+t.fontSize.number+t.fontSize.unit:t.fontSize.number+"px";return[[t.fontStyle,r,t.fontWeight,n,B].join(" "),B,n]},A.prototype.renderTextNode=function(t,r){return P(this,void 0,void 0,function(){var B,n,s,i,a,o,Q,g,w=this;return _(this,function(f){return B=this.createFontStyle(r),n=B[0],s=B[1],i=B[2],this.ctx.font=n,this.ctx.direction=r.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",a=this.fontMetrics.getMetrics(s,i),o=a.baseline,Q=a.middle,g=r.paintOrder,t.textBounds.forEach(function(c){g.forEach(function(C){switch(C){case 0:w.ctx.fillStyle=R(r.color),w.renderTextWithLetterSpacing(c,r.letterSpacing,o);var H=r.textShadow;H.length&&c.text.trim().length&&(H.slice(0).reverse().forEach(function(h){w.ctx.shadowColor=R(h.color),w.ctx.shadowOffsetX=h.offsetX.number*w.options.scale,w.ctx.shadowOffsetY=h.offsetY.number*w.options.scale,w.ctx.shadowBlur=h.blur.number,w.renderTextWithLetterSpacing(c,r.letterSpacing,o)}),w.ctx.shadowColor="",w.ctx.shadowOffsetX=0,w.ctx.shadowOffsetY=0,w.ctx.shadowBlur=0),r.textDecorationLine.length&&(w.ctx.fillStyle=R(r.textDecorationColor||r.color),r.textDecorationLine.forEach(function(h){switch(h){case 1:w.ctx.fillRect(c.bounds.left,Math.round(c.bounds.top+o),c.bounds.width,1);break;case 2:w.ctx.fillRect(c.bounds.left,Math.round(c.bounds.top),c.bounds.width,1);break;case 3:w.ctx.fillRect(c.bounds.left,Math.ceil(c.bounds.top+Q),c.bounds.width,1);break}}));break;case 1:r.webkitTextStrokeWidth&&c.text.trim().length&&(w.ctx.strokeStyle=R(r.webkitTextStrokeColor),w.ctx.lineWidth=r.webkitTextStrokeWidth,w.ctx.lineJoin=window.chrome?"miter":"round",w.ctx.strokeText(c.text,c.bounds.left,c.bounds.top+o)),w.ctx.strokeStyle="",w.ctx.lineWidth=0,w.ctx.lineJoin="miter";break}})}),[2]})})},A.prototype.renderReplacedElement=function(t,r,B){if(B&&t.intrinsicWidth>0&&t.intrinsicHeight>0){var n=je(t),s=qe(r);this.path(s),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(B,0,0,t.intrinsicWidth,t.intrinsicHeight,n.left,n.top,n.width,n.height),this.ctx.restore()}},A.prototype.renderNodeContent=function(t){return P(this,void 0,void 0,function(){var r,B,n,s,i,a,F,F,o,Q,g,w,p,f,c,d,C,H,h,F,K,p,d;return _(this,function(l){switch(l.label){case 0:this.applyEffects(t.getEffects(4)),r=t.container,B=t.curves,n=r.styles,s=0,i=r.textNodes,l.label=1;case 1:return s<i.length?(a=i[s],[4,this.renderTextNode(a,n)]):[3,4];case 2:l.sent(),l.label=3;case 3:return s++,[3,1];case 4:if(!(r instanceof GB))return[3,8];l.label=5;case 5:return l.trys.push([5,7,,8]),[4,this.context.cache.match(r.src)];case 6:return F=l.sent(),this.renderReplacedElement(r,B,F),[3,8];case 7:return l.sent(),this.context.logger.error("Error loading image "+r.src),[3,8];case 8:if(r instanceof RB&&this.renderReplacedElement(r,B,r.canvas),!(r instanceof VB))return[3,12];l.label=9;case 9:return l.trys.push([9,11,,12]),[4,this.context.cache.match(r.svg)];case 10:return F=l.sent(),this.renderReplacedElement(r,B,F),[3,12];case 11:return l.sent(),this.context.logger.error("Error loading svg "+r.svg.substring(0,255)),[3,12];case 12:return r instanceof JB&&r.tree?(o=new A(this.context,{scale:this.options.scale,backgroundColor:r.backgroundColor,x:0,y:0,width:r.width,height:r.height}),[4,o.render(r.tree)]):[3,14];case 13:Q=l.sent(),r.width&&r.height&&this.ctx.drawImage(Q,0,0,r.width,r.height,r.bounds.left,r.bounds.top,r.bounds.width,r.bounds.height),l.label=14;case 14:if(r instanceof tt&&(g=Math.min(r.bounds.width,r.bounds.height),r.type===Pe?r.checked&&(this.ctx.save(),this.path([new u(r.bounds.left+g*.39363,r.bounds.top+g*.79),new u(r.bounds.left+g*.16,r.bounds.top+g*.5549),new u(r.bounds.left+g*.27347,r.bounds.top+g*.44071),new u(r.bounds.left+g*.39694,r.bounds.top+g*.5649),new u(r.bounds.left+g*.72983,r.bounds.top+g*.23),new u(r.bounds.left+g*.84,r.bounds.top+g*.34085),new u(r.bounds.left+g*.39363,r.bounds.top+g*.79)]),this.ctx.fillStyle=R(Jt),this.ctx.fill(),this.ctx.restore()):r.type===ke&&r.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(r.bounds.left+g/2,r.bounds.top+g/2,g/4,0,Math.PI*2,!0),this.ctx.fillStyle=R(Jt),this.ctx.fill(),this.ctx.restore())),EQ(r)&&r.value.length){switch(w=this.createFontStyle(n),p=w[0],f=w[1],c=this.fontMetrics.getMetrics(p,f).baseline,this.ctx.font=p,this.ctx.fillStyle=R(n.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=pQ(r.styles.textAlign),d=je(r),C=0,r.styles.textAlign){case 1:C+=d.width/2;break;case 2:C+=d.width;break}H=d.add(C,0,0,-d.height/2+1),this.ctx.save(),this.path([new u(d.left,d.top),new u(d.left+d.width,d.top),new u(d.left+d.width,d.top+d.height),new u(d.left,d.top+d.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new ie(r.value,H),n.letterSpacing,c),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!G(r.styles.display,2048))return[3,20];if(r.styles.listStyleImage===null)return[3,19];if(h=r.styles.listStyleImage,h.type!==0)return[3,18];F=void 0,K=h.url,l.label=15;case 15:return l.trys.push([15,17,,18]),[4,this.context.cache.match(K)];case 16:return F=l.sent(),this.ctx.drawImage(F,r.bounds.left-(F.width+10),r.bounds.top),[3,18];case 17:return l.sent(),this.context.logger.error("Error loading list-style-image "+K),[3,18];case 18:return[3,20];case 19:t.listValue&&r.styles.listStyleType!==-1&&(p=this.createFontStyle(n)[0],this.ctx.font=p,this.ctx.fillStyle=R(n.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",d=new cA(r.bounds.left,r.bounds.top+b(r.styles.paddingTop,r.bounds.width),r.bounds.width,yt(n.lineHeight,n.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new ie(t.listValue,d),n.letterSpacing,yt(n.lineHeight,n.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),l.label=20;case 20:return[2]}})})},A.prototype.renderStackContent=function(t){return P(this,void 0,void 0,function(){var r,B,h,n,s,h,i,a,h,o,Q,h,g,w,h,f,c,h,C,H,h;return _(this,function(F){switch(F.label){case 0:if(G(t.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:F.sent(),r=0,B=t.negativeZIndex,F.label=2;case 2:return r<B.length?(h=B[r],[4,this.renderStack(h)]):[3,5];case 3:F.sent(),F.label=4;case 4:return r++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:F.sent(),n=0,s=t.nonInlineLevel,F.label=7;case 7:return n<s.length?(h=s[n],[4,this.renderNode(h)]):[3,10];case 8:F.sent(),F.label=9;case 9:return n++,[3,7];case 10:i=0,a=t.nonPositionedFloats,F.label=11;case 11:return i<a.length?(h=a[i],[4,this.renderStack(h)]):[3,14];case 12:F.sent(),F.label=13;case 13:return i++,[3,11];case 14:o=0,Q=t.nonPositionedInlineLevel,F.label=15;case 15:return o<Q.length?(h=Q[o],[4,this.renderStack(h)]):[3,18];case 16:F.sent(),F.label=17;case 17:return o++,[3,15];case 18:g=0,w=t.inlineLevel,F.label=19;case 19:return g<w.length?(h=w[g],[4,this.renderNode(h)]):[3,22];case 20:F.sent(),F.label=21;case 21:return g++,[3,19];case 22:f=0,c=t.zeroOrAutoZIndexOrTransformedOrOpacity,F.label=23;case 23:return f<c.length?(h=c[f],[4,this.renderStack(h)]):[3,26];case 24:F.sent(),F.label=25;case 25:return f++,[3,23];case 26:C=0,H=t.positiveZIndex,F.label=27;case 27:return C<H.length?(h=H[C],[4,this.renderStack(h)]):[3,30];case 28:F.sent(),F.label=29;case 29:return C++,[3,27];case 30:return[2]}})})},A.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},A.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},A.prototype.formatPath=function(t){var r=this;t.forEach(function(B,n){var s=$(B)?B.start:B;n===0?r.ctx.moveTo(s.x,s.y):r.ctx.lineTo(s.x,s.y),$(B)&&r.ctx.bezierCurveTo(B.startControl.x,B.startControl.y,B.endControl.x,B.endControl.y,B.end.x,B.end.y)})},A.prototype.renderRepeat=function(t,r,B,n){this.path(t),this.ctx.fillStyle=r,this.ctx.translate(B,n),this.ctx.fill(),this.ctx.translate(-B,-n)},A.prototype.resizeImage=function(t,r,B){var n;if(t.width===r&&t.height===B)return t;var s=(n=this.canvas.ownerDocument)!==null&&n!==void 0?n:document,i=s.createElement("canvas");i.width=Math.max(1,r),i.height=Math.max(1,B);var a=i.getContext("2d");return a.drawImage(t,0,0,t.width,t.height,0,0,r,B),i},A.prototype.renderBackgroundImage=function(t){return P(this,void 0,void 0,function(){var r,B,n,s,i,a;return _(this,function(o){switch(o.label){case 0:r=t.styles.backgroundImage.length-1,B=function(Q){var g,w,f,O,Y,W,L,V,y,c,O,Y,W,L,V,C,H,h,F,K,p,d,l,v,y,E,O,k,q,L,V,CA,Y,W,IA,BA,uA,vA,yA,iA,KA,oA;return _(this,function(TA){switch(TA.label){case 0:if(Q.type!==0)return[3,5];g=void 0,w=Q.url,TA.label=1;case 1:return TA.trys.push([1,3,,4]),[4,n.context.cache.match(w)];case 2:return g=TA.sent(),[3,4];case 3:return TA.sent(),n.context.logger.error("Error loading background-image "+w),[3,4];case 4:return g&&(f=Kr(t,r,[g.width,g.height,g.width/g.height]),O=f[0],Y=f[1],W=f[2],L=f[3],V=f[4],y=n.ctx.createPattern(n.resizeImage(g,L,V),"repeat"),n.renderRepeat(O,y,Y,W)),[3,6];case 5:sa(Q)?(c=Kr(t,r,[null,null,null]),O=c[0],Y=c[1],W=c[2],L=c[3],V=c[4],C=ea(Q.angle,L,V),H=C[0],h=C[1],F=C[2],K=C[3],p=C[4],d=document.createElement("canvas"),d.width=L,d.height=V,l=d.getContext("2d"),v=l.createLinearGradient(h,K,F,p),It(Q.stops,H).forEach(function(YA){return v.addColorStop(YA.stop,R(YA.color))}),l.fillStyle=v,l.fillRect(0,0,L,V),L>0&&V>0&&(y=n.ctx.createPattern(d,"repeat"),n.renderRepeat(O,y,Y,W))):aa(Q)&&(E=Kr(t,r,[null,null,null]),O=E[0],k=E[1],q=E[2],L=E[3],V=E[4],CA=Q.position.length===0?[$r]:Q.position,Y=b(CA[0],L),W=b(CA[CA.length-1],V),IA=ra(Q,Y,W,L,V),BA=IA[0],uA=IA[1],BA>0&&uA>0&&(vA=n.ctx.createRadialGradient(k+Y,q+W,0,k+Y,q+W,BA),It(Q.stops,BA*2).forEach(function(YA){return vA.addColorStop(YA.stop,R(YA.color))}),n.path(O),n.ctx.fillStyle=vA,BA!==uA?(yA=t.bounds.left+.5*t.bounds.width,iA=t.bounds.top+.5*t.bounds.height,KA=uA/BA,oA=1/KA,n.ctx.save(),n.ctx.translate(yA,iA),n.ctx.transform(1,0,0,KA,0,0),n.ctx.translate(-yA,-iA),n.ctx.fillRect(k,oA*(q-iA)+iA,L,V*oA),n.ctx.restore()):n.ctx.fill())),TA.label=6;case 6:return r--,[2]}})},n=this,s=0,i=t.styles.backgroundImage.slice(0).reverse(),o.label=1;case 1:return s<i.length?(a=i[s],[5,B(a)]):[3,4];case 2:o.sent(),o.label=3;case 3:return s++,[3,1];case 4:return[2]}})})},A.prototype.renderSolidBorder=function(t,r,B){return P(this,void 0,void 0,function(){return _(this,function(n){return this.path(rB(B,r)),this.ctx.fillStyle=R(t),this.ctx.fill(),[2]})})},A.prototype.renderDoubleBorder=function(t,r,B,n){return P(this,void 0,void 0,function(){var s,i;return _(this,function(a){switch(a.label){case 0:return r<3?[4,this.renderSolidBorder(t,B,n)]:[3,2];case 1:return a.sent(),[2];case 2:return s=gQ(n,B),this.path(s),this.ctx.fillStyle=R(t),this.ctx.fill(),i=wQ(n,B),this.path(i),this.ctx.fill(),[2]}})})},A.prototype.renderNodeBackgroundAndBorders=function(t){return P(this,void 0,void 0,function(){var r,B,n,s,i,a,o,Q,g=this;return _(this,function(w){switch(w.label){case 0:return this.applyEffects(t.getEffects(2)),r=t.container.styles,B=!HA(r.backgroundColor)||r.backgroundImage.length,n=[{style:r.borderTopStyle,color:r.borderTopColor,width:r.borderTopWidth},{style:r.borderRightStyle,color:r.borderRightColor,width:r.borderRightWidth},{style:r.borderBottomStyle,color:r.borderBottomColor,width:r.borderBottomWidth},{style:r.borderLeftStyle,color:r.borderLeftColor,width:r.borderLeftWidth}],s=HQ(XA(r.backgroundClip,0),t.curves),B||r.boxShadow.length?(this.ctx.save(),this.path(s),this.ctx.clip(),HA(r.backgroundColor)||(this.ctx.fillStyle=R(r.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:w.sent(),this.ctx.restore(),r.boxShadow.slice(0).reverse().forEach(function(f){g.ctx.save();var c=Ze(t.curves),C=f.inset?0:hQ,H=oQ(c,-C+(f.inset?1:-1)*f.spread.number,(f.inset?1:-1)*f.spread.number,f.spread.number*(f.inset?-2:2),f.spread.number*(f.inset?-2:2));f.inset?(g.path(c),g.ctx.clip(),g.mask(H)):(g.mask(c),g.ctx.clip(),g.path(H)),g.ctx.shadowOffsetX=f.offsetX.number+C,g.ctx.shadowOffsetY=f.offsetY.number,g.ctx.shadowColor=R(f.color),g.ctx.shadowBlur=f.blur.number,g.ctx.fillStyle=f.inset?R(f.color):"rgba(0,0,0,1)",g.ctx.fill(),g.ctx.restore()}),w.label=2;case 2:i=0,a=0,o=n,w.label=3;case 3:return a<o.length?(Q=o[a],Q.style!==0&&!HA(Q.color)&&Q.width>0?Q.style!==2?[3,5]:[4,this.renderDashedDottedBorder(Q.color,Q.width,i,t.curves,2)]:[3,11]):[3,13];case 4:return w.sent(),[3,11];case 5:return Q.style!==3?[3,7]:[4,this.renderDashedDottedBorder(Q.color,Q.width,i,t.curves,3)];case 6:return w.sent(),[3,11];case 7:return Q.style!==4?[3,9]:[4,this.renderDoubleBorder(Q.color,Q.width,i,t.curves)];case 8:return w.sent(),[3,11];case 9:return[4,this.renderSolidBorder(Q.color,i,t.curves)];case 10:w.sent(),w.label=11;case 11:i++,w.label=12;case 12:return a++,[3,3];case 13:return[2]}})})},A.prototype.renderDashedDottedBorder=function(t,r,B,n,s){return P(this,void 0,void 0,function(){var i,a,o,Q,g,w,f,c,C,H,h,F,K,p,d,l,d,l;return _(this,function(v){return this.ctx.save(),i=cQ(n,B),a=rB(n,B),s===2&&(this.path(a),this.ctx.clip()),$(a[0])?(o=a[0].start.x,Q=a[0].start.y):(o=a[0].x,Q=a[0].y),$(a[1])?(g=a[1].end.x,w=a[1].end.y):(g=a[1].x,w=a[1].y),B===0||B===2?f=Math.abs(o-g):f=Math.abs(Q-w),this.ctx.beginPath(),s===3?this.formatPath(i):this.formatPath(a.slice(0,2)),c=r<3?r*3:r*2,C=r<3?r*2:r,s===3&&(c=r,C=r),H=!0,f<=c*2?H=!1:f<=c*2+C?(h=f/(2*c+C),c*=h,C*=h):(F=Math.floor((f+C)/(c+C)),K=(f-F*c)/(F-1),p=(f-(F+1)*c)/F,C=p<=0||Math.abs(C-K)<Math.abs(C-p)?K:p),H&&(s===3?this.ctx.setLineDash([0,c+C]):this.ctx.setLineDash([c,C])),s===3?(this.ctx.lineCap="round",this.ctx.lineWidth=r):this.ctx.lineWidth=r*2+1.1,this.ctx.strokeStyle=R(t),this.ctx.stroke(),this.ctx.setLineDash([]),s===2&&($(a[0])&&(d=a[3],l=a[0],this.ctx.beginPath(),this.formatPath([new u(d.end.x,d.end.y),new u(l.start.x,l.start.y)]),this.ctx.stroke()),$(a[1])&&(d=a[1],l=a[2],this.ctx.beginPath(),this.formatPath([new u(d.end.x,d.end.y),new u(l.start.x,l.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},A.prototype.render=function(t){return P(this,void 0,void 0,function(){var r;return _(this,function(B){switch(B.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=R(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),r=QQ(t),[4,this.renderStack(r)];case 1:return B.sent(),this.applyEffects([]),[2,this.canvas]}})})},A})(sn),EQ=function(e){return e instanceof _B||e instanceof XB?!0:e instanceof tt&&e.type!==ke&&e.type!==Pe},HQ=function(e,A){switch(e){case 0:return Ze(A);case 2:return BQ(A);case 1:default:return qe(A)}},pQ=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},IQ=["-apple-system","system-ui"],vQ=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(A){return IQ.indexOf(A)===-1}):e},yQ=(function(e){tA(A,e);function A(t,r){var B=e.call(this,t,r)||this;return B.canvas=r.canvas?r.canvas:document.createElement("canvas"),B.ctx=B.canvas.getContext("2d"),B.options=r,B.canvas.width=Math.floor(r.width*r.scale),B.canvas.height=Math.floor(r.height*r.scale),B.canvas.style.width=r.width+"px",B.canvas.style.height=r.height+"px",B.ctx.scale(B.options.scale,B.options.scale),B.ctx.translate(-r.x,-r.y),B.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+r.width+"x"+r.height+" at "+r.x+","+r.y+") with scale "+r.scale),B}return A.prototype.render=function(t){return P(this,void 0,void 0,function(){var r,B;return _(this,function(n){switch(n.label){case 0:return r=Pr(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,KQ(r)];case 1:return B=n.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=R(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(B,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},A})(sn),KQ=function(e){return new Promise(function(A,t){var r=new Image;r.onload=function(){A(r)},r.onerror=t,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},mQ=(function(){function e(A){var t=A.id,r=A.enabled;this.id=t,this.enabled=r,this.start=Date.now()}return e.prototype.debug=function(){for(var A=[],t=0;t<arguments.length;t++)A[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,ue([this.id,this.getTime()+"ms"],A)):this.info.apply(this,A))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var A=[],t=0;t<arguments.length;t++)A[t]=arguments[t];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,ue([this.id,this.getTime()+"ms"],A))},e.prototype.warn=function(){for(var A=[],t=0;t<arguments.length;t++)A[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,ue([this.id,this.getTime()+"ms"],A)):this.info.apply(this,A))},e.prototype.error=function(){for(var A=[],t=0;t<arguments.length;t++)A[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,ue([this.id,this.getTime()+"ms"],A)):this.info.apply(this,A))},e.instances={},e})(),LQ=(function(){function e(A,t){var r;this.windowBounds=t,this.instanceName="#"+e.instanceCount++,this.logger=new mQ({id:this.instanceName,enabled:A.logging}),this.cache=(r=A.cache)!==null&&r!==void 0?r:new qo(this,A)}return e.instanceCount=1,e})(),xQ=function(e,A){return A===void 0&&(A={}),DQ(e,A)};typeof window<"u"&&An.setContext(window);var DQ=function(e,A){return P(void 0,void 0,void 0,function(){var t,r,B,n,s,i,a,o,Q,g,w,f,c,C,H,h,F,K,p,d,v,l,v,y,E,O,k,q,L,V,CA,Y,W,IA,BA,uA,vA,yA,iA,KA;return _(this,function(oA){switch(oA.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(t=e.ownerDocument,!t)throw new Error("Element is not attached to a Document");if(r=t.defaultView,!r)throw new Error("Document is not attached to a Window");return B={allowTaint:(y=A.allowTaint)!==null&&y!==void 0?y:!1,imageTimeout:(E=A.imageTimeout)!==null&&E!==void 0?E:15e3,proxy:A.proxy,useCORS:(O=A.useCORS)!==null&&O!==void 0?O:!1},n=Lr({logging:(k=A.logging)!==null&&k!==void 0?k:!0,cache:A.cache},B),s={windowWidth:(q=A.windowWidth)!==null&&q!==void 0?q:r.innerWidth,windowHeight:(L=A.windowHeight)!==null&&L!==void 0?L:r.innerHeight,scrollX:(V=A.scrollX)!==null&&V!==void 0?V:r.pageXOffset,scrollY:(CA=A.scrollY)!==null&&CA!==void 0?CA:r.pageYOffset},i=new cA(s.scrollX,s.scrollY,s.windowWidth,s.windowHeight),a=new LQ(n,i),o=(Y=A.foreignObjectRendering)!==null&&Y!==void 0?Y:!1,Q={allowTaint:(W=A.allowTaint)!==null&&W!==void 0?W:!1,onclone:A.onclone,ignoreElements:A.ignoreElements,inlineImages:o,copyStyles:o},a.logger.debug("Starting document clone with size "+i.width+"x"+i.height+" scrolled to "+-i.left+","+-i.top),g=new $t(a,e,Q),w=g.clonedReferenceElement,w?[4,g.toIFrame(t,i)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return f=oA.sent(),c=Bt(w)||xo(w)?an(w.ownerDocument):ze(a,w),C=c.width,H=c.height,h=c.left,F=c.top,K=bQ(a,w,A.backgroundColor),p={canvas:A.canvas,backgroundColor:K,scale:(BA=(IA=A.scale)!==null&&IA!==void 0?IA:r.devicePixelRatio)!==null&&BA!==void 0?BA:1,x:((uA=A.x)!==null&&uA!==void 0?uA:0)+h,y:((vA=A.y)!==null&&vA!==void 0?vA:0)+F,width:(yA=A.width)!==null&&yA!==void 0?yA:Math.ceil(C),height:(iA=A.height)!==null&&iA!==void 0?iA:Math.ceil(H)},o?(a.logger.debug("Document cloned, using foreign object rendering"),v=new yQ(a,p),[4,v.render(w)]):[3,3];case 2:return d=oA.sent(),[3,5];case 3:return a.logger.debug("Document cloned, element located at "+h+","+F+" with size "+C+"x"+H+" using computed rendering"),a.logger.debug("Starting DOM parsing"),l=kB(a,w),K===l.styles.backgroundColor&&(l.styles.backgroundColor=wA.TRANSPARENT),a.logger.debug("Starting renderer for element at "+p.x+","+p.y+" with size "+p.width+"x"+p.height),v=new dQ(a,p),[4,v.render(l)];case 4:d=oA.sent(),oA.label=5;case 5:return(!((KA=A.removeContainer)!==null&&KA!==void 0)||KA)&&($t.destroy(f)||a.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),a.logger.debug("Finished rendering"),[2,d]}})})},bQ=function(e,A,t){var r=A.ownerDocument,B=r.documentElement?se(e,getComputedStyle(r.documentElement).backgroundColor):wA.TRANSPARENT,n=r.body?se(e,getComputedStyle(r.body).backgroundColor):wA.TRANSPARENT,s=typeof t=="string"?se(e,t):t===null?wA.TRANSPARENT:4294967295;return A===r.documentElement?HA(B)?HA(n)?s:n:B:s};export{xQ as default};
assets/index-uPhlgI5U.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),J=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(J);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{J&&K(!0)},[J]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${J?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const J=n.eventCategory==="sct";J&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const ee=J||n.flightType==="Solo"?n.pilot:n.instructor,K=J?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(J&&n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(J&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
assets/index-ocEpyxXE.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),J=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(J);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{J&&K(!0)},[J]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${J?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const J=n.eventCategory==="sct";J&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const ee=J||n.flightType==="Solo"?n.pilot:n.instructor,K=J?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(J&&n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(J&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
