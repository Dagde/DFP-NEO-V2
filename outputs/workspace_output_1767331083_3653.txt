        const cancelledEvent: ScheduleEvent = {
            ...selectedEvent,
            isCancelled: true,
            cancellationCode: cancellationCode,
            cancellationManualEntry: manualCodeEntry,
            cancelledBy: `${currentUser}`,
            cancelledAt: new Date().toISOString(),
            resourceId: newResourceId,
        };
        
        console.log('âœ… Created cancelled event:', {
            id: cancelledEvent.id,
            isCancelled: cancelledEvent.isCancelled,
            resourceId: cancelledEvent.resourceId,
            cancellationCode: cancelledEvent.cancellationCode
        });
        
        const isNextDay = eventDate === buildDfpDate && (activeView === 'NextDayBuild' || activeView === 'Priorities' || activeView === 'ProgramData');
        
        console.log('ğŸ” Is Next Day Build?', isNextDay);
        console.log('ğŸ” Active View:', activeView);
        console.log('ğŸ” Event Date:', eventDate, 'Build Date:', buildDfpDate);
        
        if (isNextDay) {
            console.log('ğŸ“ Updating nextDayBuildEvents');
--
                const updated = prev.map(e => e.id === selectedEvent.id ? cancelledEvent : e);
                console.log('âœ… Updated nextDayBuildEvents. Found event:', updated.some(e => e.id === selectedEvent.id));
                return updated;
            });
        } else {
            console.log('ğŸ“ Updating publishedSchedules for date:', eventDate);
            setPublishedSchedules((prev: Record<string, ScheduleEvent[]>) => {
                const scheduleForDate = prev[eventDate] || [];
                console.log('ğŸ“Š Events for this date before update:', scheduleForDate.length);
                const updatedSchedule = scheduleForDate.map(e => e.id === selectedEvent.id ? cancelledEvent : e);
                console.log('âœ… Updated schedule. Found event:', updatedSchedule.some(e => e.id === selectedEvent.id));
                return { ...prev, [eventDate]: updatedSchedule };
            });
        }
        
        // Remove from highest priority events
        setHighestPriorityEvents(prev => prev.filter(e => e.id !== selectedEvent.id));
        
        // Log the cancellation to audit trail
        const pageName = isNextDay ? 'Next Day Build' : 'Program Schedule';
