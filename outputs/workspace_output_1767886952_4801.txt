            
            // NEW: Check if instructor has day events (including Active DFP)
            if (isPersonScheduledForDayEvents(ip.name)) {
                console.log(`ðŸŒ™ âŒ ${ip.name} excluded - has day events (Active DFP or NEO-Build)`);
                return false;
            }
            
            console.log(`ðŸŒ™ âœ… ${ip.name} eligible for night flying`);
            return true;
        });
        
        console.log(`ðŸŒ™ Eligible pool: ${nightEligiblePool.length} instructors`);
        
        const nightFlyingInstructors = [...nightEligiblePool].sort(() => 0.5 - Math.random()).slice(0, instructorsNeeded);
        console.log(`ðŸŒ™ Selected instructors: ${nightFlyingInstructors.map(i => i.name).join(', ')}`);
        const bnfTrainees = nextEventLists.bnf;
        
        nightFlyingInstructors.forEach((nfi, index) => {
            const trainee = bnfTrainees[index];
            if (trainee) {
                nightPairings.set(trainee.fullName, nfi.name);
