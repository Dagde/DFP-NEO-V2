public/flight-school-app/assets/index-B32GbIkA.js: */var vy;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(vy||(vy={}));var Ny;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Ny||(Ny={}));var wy;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(wy||(wy={}));var $c;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})($c||($c={}));var Sy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Sy||(Sy={}));var Cy;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Cy||(Cy={}));var Ty;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Ty||(Ty={}));var jy;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(jy||(jy={}));var Ey;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Ey||(Ey={}));var Ay;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(Ay||(Ay={}));var ky;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(ky||(ky={}));var Dy;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Dy||(Dy={}));var _y;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(_y||(_y={}));var Iy;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(Iy||(Iy={}));var Ly;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Ly||(Ly={}));var My;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(My||(My={}));var Fy;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Fy||(Fy={}));var Py;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(Py||(Py={}));var Ry;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Ry||(Ry={}));var sf;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(sf||(sf={}));var Uy;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Uy||(Uy={}));var By;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(By||(By={}));var Oy;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Oy||(Oy={}));var Mm;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Mm||(Mm={}));var $y;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})($y||($y={}));var Hy;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Hy||(Hy={}));var qy;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(qy||(qy={}));var Gy;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(Gy||(Gy={}));var zy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(zy||(zy={}));var Vy;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Vy||(Vy={}));var Wy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(Wy||(Wy={}));var Yy;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Yy||(Yy={}));var Jy;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(Jy||(Jy={}));var Xy;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(Xy||(Xy={}));var Ky;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Ky||(Ky={}));var Zy;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Zy||(Zy={}));var Qy;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Qy||(Qy={}));var e1;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(e1||(e1={}));var t1;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(t1||(t1={}));var n1;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(n1||(n1={}));var s1;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(s1||(s1={}));var r1;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(r1||(r1={}));var i1;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(i1||(i1={}));var a1;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(a1||(a1={}));var o1;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(o1||(o1={}));var l1;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(l1||(l1={}));var c1;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(c1||(c1={}));var d1;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(d1||(d1={}));var u1;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(u1||(u1={}));var f1;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(f1||(f1={}));var h1;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(h1||(h1={}));var m1;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(m1||(m1={}));var g1;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(g1||(g1={}));var p1;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(p1||(p1={}));var Zd;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Zd||(Zd={}));class Fm{constructor(t){const s={};for(const i of t.headers.entries())s[i[0]]=i[1];this.headers=s,this.responseInternal=t}json(){return this.responseInternal.json()}}class Wu{get text(){var t,s,i,o,l,d,u,f;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",m=!1;const v=[];for(const x of(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)!==null&&f!==void 0?f:[]){for(const[y,T]of Object.entries(x))y!=="text"&&y!=="thought"&&y!=="thoughtSignature"&&(T!==null||T!==void 0)&&v.push(y);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;m=!0,h+=x.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),m?h:void 0}get data(){var t,s,i,o,l,d,u,f;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const m=[];for(const v of(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)!==null&&f!==void 0?f:[]){for(const[x,y]of Object.entries(v))x!=="inlineData"&&(y!==null||y!==void 0)&&m.push(x);v.inlineData&&typeof v.inlineData.data=="string"&&(h+=atob(v.inlineData.data))}return m.length>0&&console.warn(`there are non-data parts ${m} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var t,s,i,o,l,d,u,f;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(m=>m.functionCall).map(m=>m.functionCall).filter(m=>m!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var t,s,i,o,l,d,u,f,h;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const m=(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(h=m==null?void 0:m[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var t,s,i,o,l,d,u,f,h;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const m=(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(h=m==null?void 0:m[0])===null||h===void 0?void 0:h.output}}class x1{}class y1{}class OS{}class $S{}class HS{}class qS{}class b1{}class v1{}class N1{}class GS{}class yh{_fromAPIResponse({apiResponse:t,_isVertexAI:s}){const i=new yh;let o;const l=t;return s?o=AS(l):o=ES(l),Object.assign(i,o),i}}class w1{}class S1{}class C1{}class zS{}class VS{}class WS{}class dg{_fromAPIResponse({apiResponse:t,_isVertexAI:s}){const i=new dg,l=FS(t);return Object.assign(i,l),i}}class YS{}class JS{}class XS{}class T1{}class KS{get text(){var t,s,i;let o="",l=!1;const d=[];for(const u of(i=(s=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&i!==void 0?i:[]){for(const[f,h]of Object.entries(u))f!=="text"&&f!=="thought"&&h!==null&&d.push(f);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;l=!0,o+=u.text}}return d.length>0&&console.warn(`there are non-text parts ${d} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?o:void 0}get data(){var t,s,i;let o="";const l=[];for(const d of(i=(s=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&i!==void 0?i:[]){for(const[u,f]of Object.entries(d))u!=="inlineData"&&f!==null&&l.push(u);d.inlineData&&typeof d.inlineData.data=="string"&&(o+=atob(d.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class ZS{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class ug{_fromAPIResponse({apiResponse:t,_isVertexAI:s}){const i=new ug,l=Rv(t);return Object.assign(i,l),i}}/**
public/flight-school-app/assets/index-B32GbIkA.js:This is a hard rule that cannot be violated. The event will not be saved.`,"Day/Night Separation Violation","error"),console.log("SAVE BLOCKED - Day/Night separation violation:",Sn.reason);return}}}const te=I[0],le=!te.resourceId,Ue=!!an,Ie=!le&&["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f);if(q&&!Ie){const Ut={...te,isTimeFixed:te.isTimeFixed??!0};vs(In=>{const An=In.findIndex(Sn=>Sn.id===Ut.id);if(An>-1){const Sn=[...In];return Sn[An]=Ut,Sn}return[...In,Ut]})}else{let Ut=!1;if(Ue)Ut=Cn==="nextDayBuild";else{const In=["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f);Ut=te.date===ze&&In,te.eventCategory==="sct"&&console.log("ðŸ” SCT Save Decision:",{activeView:f,isNextDayView:In,mainEventDate:te.date,buildDfpDate:ze,datesMatch:te.date===ze,saveToNextDayBuild:Ut})}if(Ut){if(le){const Ln=[];I.forEach(bn=>{if(!bn.resourceId||bn.type==="deployment"){const Gn=[...Kt.map(bs=>({...bs,date:ze})),...Ln];bn.resourceId=cr(bn,Gn),Ln.push(bn)}})}const In=new Set(I.map(Ln=>Ln.id)),An=Kt.filter(Ln=>!In.has(Ln.id)),Sn=I.map(({date:Ln,...bn})=>bn);I.forEach(Ln=>{Ln.eventCategory==="sct"&&console.log("ðŸ”„ Updating SCT event in nextDayBuildEvents:",{id:Ln.id,student:Ln.student,pilot:Ln.pilot,flightType:Ln.flightType})}),Mt([...An,...Sn])}else{if(le){const In=[];I.forEach(An=>{if(!An.resourceId||An.type==="deployment"){const Ln=[...Et[te.date]||[],...In],bn=cr(An,Ln);console.log(`Assigning resourceId to ${An.type} event:`,bn),An.resourceId=bn,In.push(An)}})}Bt(In=>{console.log("ðŸŸ¢ setPublishedSchedules: START"),console.log("ðŸŸ¢ Previous publishedSchedules keys:",Object.keys(In));const An={...In},Sn=new Map;return I.forEach(Ln=>{const bn=Ln.date;Sn.has(bn)||Sn.set(bn,[]),Sn.get(bn).push(Ln)}),console.log("ðŸŸ¢ Events grouped by date:",Array.from(Sn.entries()).map(([Ln,bn])=>({date:Ln,count:bn.length,eventIds:bn.map(gn=>gn.id),instructors:bn.map(gn=>gn.instructor)}))),Sn.forEach((Ln,bn)=>{const gn=An[bn]||[];console.log(`ðŸŸ¢ Processing date ${bn}:`,{currentEventsCount:gn.length,eventsToSaveCount:Ln.length});const Gn=new Set(Ln.map(dr=>dr.id)),bs=gn.filter(dr=>!Gn.has(dr.id));console.log(`ðŸŸ¢ Filtered out ${gn.length-bs.length} existing events`),An[bn]=[...bs,...Ln],console.log(`ðŸŸ¢ Saved ${Ln.length} events to date ${bn}`),console.log(`ðŸŸ¢ New total for ${bn}:`,An[bn].length);const Ss=An[bn].find(dr=>dr.id===Ln[0].id);console.log("ðŸŸ¢ Saved event details:",{id:Ss==null?void 0:Ss.id,instructor:Ss==null?void 0:Ss.instructor,student:Ss==null?void 0:Ss.student,pilot:Ss==null?void 0:Ss.pilot})}),console.log("ðŸŸ¢ setPublishedSchedules: COMPLETE"),console.log("ðŸŸ¢ New publishedSchedules keys:",Object.keys(An)),An}),console.log("ðŸ“‹ Triggering PT-051 sync after Active DFP change..."),setTimeout(()=>{console.log("â° Executing delayed PT-051 sync..."),Bt(In=>(dn(An=>(pl(In,An),An)),In))},500)}}I.forEach(Ut=>{if(Ut.eventCategory==="lmp_currency"&&Ut.flightNumber){const In=Ut.flightType==="Dual"?Ut.student:Ut.pilot;In?Er(In,Ut.flightNumber):Ut.groupTraineeIds&&Ut.groupTraineeIds.length>0&&Ut.groupTraineeIds.forEach(An=>{const Sn=xe.find(Ln=>Ln.idNumber===An);Sn&&Er(Sn.fullName,Ut.flightNumber)})}});const qe=te.date===ze&&["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f);I.forEach(Ut=>{var Ln;const In=qe?"Next Day Build":"Program Schedule",An=Ut.type||"event",Sn=Ut.student||Ut.pilot||Ut.instructor||"Unknown";if(le){const bn=`Added ${An} event for ${Sn}`,gn=`Event: ${Ut.syllabusItem||Ut.flightNumber||An}, Time: ${Ut.startTime}, Duration: ${Ut.duration}hrs, Resource: ${Ut.resourceId}`;Pn(In,"Add",bn,gn)}else{const bn=((Ln=Et[Ut.date])==null?void 0:Ln.find(gn=>gn.id===Ut.id))||Kt.find(gn=>gn.id===Ut.id);if(bn){const gn=[];if(Ut.instructor!==bn.instructor&&gn.push(`Instructor: ${bn.instructor||"None"} â†’ ${Ut.instructor||"None"}`),Ut.pilot!==bn.pilot&&gn.push(`Pilot: ${bn.pilot||"None"} â†’ ${Ut.pilot||"None"}`),Ut.student!==bn.student&&gn.push(`Student: ${bn.student||"None"} â†’ ${Ut.student||"None"}`),Ut.syllabusItem!==bn.syllabusItem&&gn.push(`LMP Event: ${bn.syllabusItem||"None"} â†’ ${Ut.syllabusItem||"None"}`),Ut.flightNumber!==bn.flightNumber&&gn.push(`Flight Number: ${bn.flightNumber||"None"} â†’ ${Ut.flightNumber||"None"}`),Ut.area!==bn.area&&gn.push(`Area: ${bn.area||"None"} â†’ ${Ut.area||"None"}`),Ut.startTime!==bn.startTime&&gn.push(`Start time: ${t(bn.startTime)} â†’ ${t(Ut.startTime)}`),Ut.duration!==bn.duration&&gn.push(`Duration: ${bn.duration}hrs â†’ ${Ut.duration}hrs`),Ut.resourceId!==bn.resourceId&&gn.push(`Resource: ${bn.resourceId} â†’ ${Ut.resourceId}`),Ut.type!==bn.type&&gn.push(`Type: ${bn.type} â†’ ${Ut.type}`),gn.length>0){const Gn=`Modified ${An} event for ${Sn}`;Pn(In,"Edit",Gn,gn.join(", "))}}else{const gn=`Modified ${An} event for ${Sn}`,Gn=`Event: ${Ut.syllabusItem||Ut.flightNumber||An}, Time: ${Ut.startTime}, Duration: ${Ut.duration}hrs, Resource: ${Ut.resourceId}`;Pn(In,"Edit",gn,Gn)}}}),console.log("ðŸ”µ Setting selectedEvent to null (closing modal)"),_(null),en(null),Ue&&(Fi(!1),mt(null),Yt(null)),console.log("ðŸ”µ ========== handleSaveEvents END ==========")},Fo=(I,q,te)=>{if(!A)return;const le=A.date,Ue=[A.instructor,A.student,A.pilot].filter(Boolean).join(", "),Ie={eventId:A.id,cancellationCode:q,cancelledBy:`${Fe}`,cancelledAt:new Date().toISOString(),manualCodeEntry:te,eventDate:A.date,eventType:A.type==="ftd"?"ftd":"flight",resourceType:A.resourceId||"Unknown",eventName:A.flightNumber||A.syllabusItem||"N/A",personnelAffected:Ue||"N/A",notes:A.notes||""},he=[...xi,Ie];Ta(he),localStorage.setItem("cancellationRecords",JSON.stringify(he));const qe={...A,isCancelled:!0,cancellationCode:q,cancellationManualEntry:te,cancelledBy:`${Fe}`,cancelledAt:new Date().toISOString()},dt=le===ze&&(f==="NextDayBuild"||f==="Priorities"||f==="ProgramData");dt?Mt(wn=>wn.map(Ut=>Ut.id===A.id?qe:Ut)):Bt(wn=>{const In=(wn[le]||[]).map(An=>An.id===A.id?qe:An);return{...wn,[le]:In}}),vs(wn=>wn.filter(Ut=>Ut.id!==A.id));const at=x;y(""),setTimeout(()=>y(at),100);const Nt=dt?"Next Day Build":"Program Schedule",Be=A.type||"event",Wt=A.student||A.pilot||A.instructor||"Unknown",tn=`Cancelled ${Be} event for ${Wt} (Code: ${q==="OTHER"&&te?te:q})`,Dn=`Event: ${A.syllabusItem||A.flightNumber||Be}, Time: ${A.startTime}, Duration: ${A.duration}hrs, Marked as cancelled`;Pn(Nt,"Cancel",tn,Dn),_(null)},Zc=()=>{if(!A)return;const I=A.date;vs(qe=>qe.filter(dt=>dt.id!==A.id));const q=I===ze&&(f==="NextDayBuild"||f==="Priorities"||f==="ProgramData");q?Mt(qe=>qe.filter(dt=>dt.id!==A.id)):Bt(qe=>{const dt=(qe[I]||[]).filter(at=>at.id!==A.id);return{...qe,[I]:dt}}),q||(console.log("ðŸ“‹ Triggering PT-051 sync after event deletion..."),setTimeout(()=>{console.log("â° Executing delayed PT-051 sync after deletion..."),Bt(qe=>(dn(dt=>(pl(qe,dt),dt)),qe))},500));const te=q?"Next Day Build":"Program Schedule",le=A.type||"event",Ue=A.student||A.pilot||A.instructor||"Unknown",Ie=`Deleted ${le} event for ${Ue}`,he=`Event: ${A.syllabusItem||A.flightNumber||le}, Time: ${A.startTime}, Duration: ${A.duration}hrs`;Pn(te,"Delete",Ie,he),_(null)},yo=I=>{console.log("Visual Adjust Start - Event:",I),se(!0),J(I),console.log("Visual Adjust Mode set to true")},ui=I=>{se(!1),J(null),_(null)},_a=()=>{console.log("ðŸ“‹ Starting sync of priority events with SCT and remedial requests...");let I=0;const q=[...Ti];console.log("ðŸ” SCT Sync - buildDfpDate:",ze);const te=xn.filter(he=>he.priority==="High"&&he.name.trim()!==""&&he.currency.trim()!==""),le=Es.filter(he=>he.priority==="High"&&he.name.trim()!==""&&he.currency.trim()!=="");console.log("ðŸ” Found HIGH priority SCT flights:",te.length,"| FTDs:",le.length),te.forEach(he=>{const qe=q.findIndex(at=>at.id===`sct-flight-${he.id}`),dt=Kt.find(at=>at.id===`sct-flight-${he.id}`);if(qe>-1){const at=be.find(Wt=>Wt.code===he.event),Nt=(at==null?void 0:at.duration)||1.5;let Be=8;if(he.requestedTime){const[Wt,Rt]=he.requestedTime.split(":").map(Number);Be=Wt+Rt/60}q[qe]={...q[qe],student:he.flightType==="Dual"?he.crewMember||"TBA":"",pilot:he.name,flightNumber:he.event,duration:Nt,startTime:Be,flightType:he.flightType,soloOrDual:he.flightType,currency:he.currency},console.log("ðŸ”„ Updated HIGH priority SCT flight:",he.event,"for",he.name,"at",he.requestedTime||"08:00")}else if(!dt){const at=be.find(Rt=>Rt.code===he.event);xe.find(Rt=>Rt.fullName===he.name);const Nt=(at==null?void 0:at.duration)||1.5;let Be=8;if(he.requestedTime){const[Rt,tn]=he.requestedTime.split(":").map(Number);Be=Rt+tn/60}const Wt={id:`sct-flight-${he.id}`,date:ze,type:"flight",instructor:"",student:he.flightType==="Dual"?he.crewMember||"TBA":"",pilot:he.name,flightNumber:he.event,duration:Nt,startTime:Be,resourceId:"",color:"bg-red-500/50",flightType:he.flightType,soloOrDual:he.flightType,locationType:"Local",origin:X,destination:X,isTimeFixed:!0,isSct:!0,eventCategory:"sct",currency:he.currency};q.push(Wt),I++,console.log("âœ… Added HIGH priority SCT flight:",he.event,"for",he.name,"at",he.requestedTime||"08:00"),console.log("  - Event date:",Wt.date,"| isTimeFixed:",Wt.isTimeFixed,"| startTime:",Wt.startTime)}}),le.forEach(he=>{const qe=q.findIndex(at=>at.id===`sct-ftd-${he.id}`),dt=Kt.find(at=>at.id===`sct-ftd-${he.id}`);if(qe>-1){const at=be.find(Wt=>Wt.code===he.event),Nt=(at==null?void 0:at.duration)||1.5;let Be=8;if(he.requestedTime){const[Wt,Rt]=he.requestedTime.split(":").map(Number);Be=Wt+Rt/60}q[qe]={...q[qe],student:he.flightType==="Dual"?he.crewMember||"TBA":"",pilot:he.name,flightNumber:he.event,duration:Nt,startTime:Be,flightType:"Dual",soloOrDual:"Dual",currency:he.currency},console.log("ðŸ”„ Updated HIGH priority SCT FTD:",he.event,"for",he.name,"at",he.requestedTime||"08:00")}else if(!dt){const at=be.find(Rt=>Rt.code===he.event);xe.find(Rt=>Rt.fullName===he.name);const Nt=(at==null?void 0:at.duration)||1.5;let Be=8;if(he.requestedTime){const[Rt,tn]=he.requestedTime.split(":").map(Number);Be=Rt+tn/60}const Wt={id:`sct-ftd-${he.id}`,date:ze,type:"ftd",instructor:"",student:he.flightType==="Dual"?he.crewMember||"TBA":"",pilot:he.name,flightNumber:he.event,duration:Nt,startTime:Be,resourceId:"",color:"bg-red-500/50",flightType:"Dual",soloOrDual:"Dual",locationType:"Local",origin:X,destination:X,isTimeFixed:!0,isSct:!0,eventCategory:"sct",currency:he.currency};console.log("âœ… Added HIGH priority SCT FTD:",he.event,"for",he.name,"at",he.requestedTime||"08:00"),console.log("  - Event date:",Wt.date,"| isTimeFixed:",Wt.isTimeFixed,"| startTime:",Wt.startTime),q.push(Wt),I++}}),console.log(`ðŸ” Checking ${ci.length} remedial requests for Force Schedule...`);const Ue=ci.filter(he=>he.forceSchedule);return console.log(`ðŸ“Œ Found ${Ue.length} Force Scheduled remedial events`),ci.forEach(he=>{if(he.forceSchedule){console.log(`ðŸ”Ž Processing Force Schedule remedial: traineeId=${he.traineeId}, eventCode=${he.eventCode}`);const qe=q.find(dt=>dt.flightNumber===he.eventCode&&dt.isRemedial);if(qe)console.log(`âš ï¸ Event already exists in priority list: ${he.eventCode}`);else if(!qe){const dt=xe.find(Be=>Be.idNumber===he.traineeId);let at=null;if(dt){const Be=ot.get(dt.fullName);Be&&(at=Be.find(Wt=>Wt.id===he.eventCode||Wt.code===he.eventCode),at&&console.log(`âœ… Found remedial event in Individual LMP: ${he.eventCode}`))}at||(at=be.find(Be=>Be.id===he.eventCode||Be.code===he.eventCode),at&&console.log(`âœ… Found event in master syllabus: ${he.eventCode}`));const Nt=(at==null?void 0:at.duration)||1.5;if(at||console.error(`âŒ Event not found in Individual LMP or master syllabus: ${he.eventCode}`),dt||console.error(`âŒ Trainee not found for ID: ${he.traineeId}`),dt&&at){const Be=at.resourcesHuman&&at.resourcesHuman.length>0?at.resourcesHuman[0]:"";console.log(`ðŸ“‹ Allocated instructor for ${at.code}: ${Be||"None"}`);const Wt={id:`remedial-${he.traineeId}-${he.eventCode}`,date:ze,type:at.type==="FTD"?"ftd":at.type==="Ground School"?"ground":(at.type==="Flight","flight"),instructor:Be,student:dt.fullName,flightNumber:at.code,duration:Nt,startTime:8,resourceId:"",color:"bg-orange-500/50",flightType:at.sortieType==="Solo"?"Solo":"Dual",locationType:"Local",origin:X,destination:X,isTimeFixed:!0,isRemedial:!0};q.push(Wt),I++,console.log("âœ… Added Force Schedule remedial:",at.code,"for",dt.fullName)}}}}),I>0||JSON.stringify(q)!==JSON.stringify(Ti)?(vs(q),I>0?console.log(`\\ud83d\\udcca Priority Events Sync Complete: Added ${I} auto-generated events`):console.log("\\ud83d\\udd04 Priority Events Sync Complete: Updated existing events")):console.log("\\u2705 No changes to priority events"),q},pl=(I,q)=>{const te=I||Et,le=q||xt;console.log("ðŸ”„ Starting PT-051 sync with Active DFP..."),console.log("Published schedules keys:",Object.keys(te));const Ue=[];Object.values(te).forEach(Be=>{Ue.push(...Be)}),console.log("Total events on Active DFP:",Ue.length),console.log("Current PT-051 count:",le.size),console.log("Sample events:",Ue.slice(0,3).map(Be=>({id:Be.id,flightNumber:Be.flightNumber,date:Be.date,student:Be.student,pilot:Be.pilot,instructor:Be.instructor})));const Ie=new Map(le);let he=0,qe=0;Ue.forEach(Be=>{var In,An,Sn,Ln;const Wt=(In=Be==null?void 0:Be.flightNumber)==null?void 0:In.includes("Duty Sup"),Rt=(An=Be==null?void 0:Be.flightNumber)==null?void 0:An.toUpperCase().includes("STBY"),tn=((Sn=Be==null?void 0:Be.resourceId)==null?void 0:Sn.startsWith("STBY"))||((Ln=Be==null?void 0:Be.resourceId)==null?void 0:Ln.startsWith("BNF-STBY")),Dn=(Be==null?void 0:Be.type)==="deployment",wn=(Be==null?void 0:Be.type)==="flight"||(Be==null?void 0:Be.type)==="ftd"||(Be==null?void 0:Be.type)==="ground"||(Be==null?void 0:Be.type)==="cpt";if(Wt||Rt||tn||Dn||!wn){console.log("â­ï¸ Skipping event:",{flightNumber:Be==null?void 0:Be.flightNumber,type:Be==null?void 0:Be.type,resourceId:Be==null?void 0:Be.resourceId,date:Be==null?void 0:Be.date,reason:Wt?"DUTY SUP":Rt||tn?"STBY allocation":Dn?"Deployment":"Invalid event type"});return}const Ut=[];Be.student&&Ut.push(Be.student),Be.pilot&&Be.flightType==="Solo"&&Ut.push(Be.pilot),Be.attendees&&Array.isArray(Be.attendees)&&Ut.push(...Be.attendees),Ut.length>0&&console.log(`ðŸ“‹ Processing ${Be.type} event for PT-051:`,{flightNumber:Be.flightNumber,type:Be.type,date:Be.date,trainees:Ut}),Ut.forEach(bn=>{const gn=`${Be.id}-${bn}`;if(!Array.from(Ie.values()).find(bs=>bs.eventId===Be.id&&bs.traineeFullName===bn)){const bs={id:`pt051-${gn}`,traineeFullName:bn,eventId:Be.id,flightNumber:Be.flightNumber,date:Be.date,instructorName:Be.instructor||"",overallGrade:null,overallResult:null,dcoResult:null,overallComments:"",isCompleted:!1,scores:o_.map(Ss=>({element:Ss,grade:null,comment:""}))};Ie.set(bs.id,bs),he++,console.log("âœ… Created PT-051 for",bn,"on",Be.flightNumber,Be.date)}})});let dt=0;Ie.forEach((Be,Wt)=>{const Rt=Ue.find(tn=>tn.id===Be.eventId);if(Rt){let tn=!1;const Dn={};Be.instructorName!==(Rt.instructor||"")&&(Dn.instructorName=Rt.instructor||"",tn=!0,console.log("ðŸ“ Instructor changed:",Be.instructorName,"â†’",Rt.instructor)),Be.flightNumber!==Rt.flightNumber&&(Dn.flightNumber=Rt.flightNumber,tn=!0,console.log("ðŸ“ Flight number changed:",Be.flightNumber,"â†’",Rt.flightNumber)),Be.date!==Rt.date&&(Dn.date=Rt.date,tn=!0,console.log("ðŸ“ Date changed:",Be.date,"â†’",Rt.date)),tn&&(Ie.set(Wt,{...Be,...Dn}),dt++,console.log("âœï¸ Updated PT-051 for",Be.traineeFullName,"on",Be.flightNumber))}});const at=new Set(Ue.map(Be=>Be.id)),Nt=[];Ie.forEach((Be,Wt)=>{at.has(Be.eventId)||(Nt.push(Wt),console.log("ðŸ—‘ï¸ Deleting PT-051 for",Be.traineeFullName,"on",Be.flightNumber,Be.date,"(event no longer on Active DFP)"))}),Nt.forEach(Be=>{Ie.delete(Be),qe++}),he>0||qe>0||dt>0?(dn(Ie),console.log(`ðŸ“Š PT-051 Sync Complete: Created ${he}, Updated ${dt}, Deleted ${qe}`)):console.log("âœ… PT-051s already in sync with Active DFP")},xl=(I,q)=>{vs(te=>te.map(le=>le.id===I?{...le,...q}:le))},Jo=I=>{const q=K.find(te=>te.name===I);q&&(gt(q),xs("Instructors"))},za=I=>{const q=xe.find(te=>te.fullName===I);q&&(gt(q),xs("CourseRoster"))},Ia=()=>{console.log("ðŸš€ [NEO-Build] startBuildProcess called"),console.log("ðŸš€ [NEO-Build] DEBUG ===== PRE-BUILD ANALYSIS START ====="),console.log("ðŸš€ [NEO-Build] Pre-Build Step 1: Syncing SCT and Remedial requests...");const I=_a();console.log(`Pre-Build Step 2: Checking Active DFP for ${ze}...`);const q=Et[ze]||[];console.log(`DEBUG Active DFP has ${q.length} events for ${ze}`);let te=[...I],le=0;q.length>0?(console.log("DEBUG Existing events details:"),q.forEach((qe,dt)=>{console.log(`  ${dt+1}. ${qe.flightNumber} - ${qe.student||qe.pilot||"N/A"} with ${qe.instructor} at ${qe.startTime.toFixed(2)} (ID: ${qe.id}, isTimeFixed: ${qe.isTimeFixed})`)}),console.log("AUTOMATICALLY adding ALL these events to Highest Priority to preserve them..."),q.forEach(qe=>{if(te.some(at=>at.id===qe.id))console.log(`  DEBUG SKIP: ${qe.flightNumber} already in highest priority (ID: ${qe.id})`);else{const at={...qe,isTimeFixed:!0};te.push(at),le++,console.log(`  DEBUG LOCKED: ${qe.flightNumber} - ${qe.student||qe.pilot||"N/A"} with ${qe.instructor} at ${qe.startTime.toFixed(2)} (ID: ${qe.id})`)}}),le>0?(vs(te),console.log(`DEBUG Pre-Build Complete: ${le} events LOCKED as highest priority (MUST be included in build)`),console.log(`DEBUG Total Highest Priority Events: ${te.length}`)):console.log("DEBUG Pre-Build Complete: All existing events already locked")):console.log("DEBUG Pre-Build Analysis: No existing events found in Active DFP for this date"),console.log("DEBUG ===== PRE-BUILD ANALYSIS END =====");const Ue=te;console.log(`DEBUG Final preserved events count: ${Ue.length}`);const Ie=xe.filter(qe=>!qe.isPaused&&!Li(qe,Ce,Nn,ze,"flight"));let he=0;Ie.forEach(qe=>{const{next:dt}=tf(qe,ot,nt,be,Et,ze);dt&&dt.code.startsWith("BNF")&&dt.type==="Flight"&&he++}),Vr(he),Ba(!0),setTimeout(()=>{Ba(!1),yl(Ue)},3e3)},Po=()=>{console.log("ðŸš€ [NEO-Build] handleBuildDfp called"),console.log("ðŸš€ [NEO-Build] buildDfpDate:",ze);const I=d();if(console.log("ðŸš€ [NEO-Build] todayStr:",I),console.log("ðŸš€ [NEO-Build] Date comparison:",ze,"<=",I,"=",ze<=I),ze<=I){console.log("ðŸš€ [NEO-Build] Build date is today or in the past, showing warning"),Fs(!0);return}console.log("ðŸš€ [NEO-Build] Starting build process"),Ia()},pa=()=>{Fs(!1),Ia()},yl=I=>{console.log("ðŸš€ [NEO-Build] runBuildAlgorithm called"),console.log("ðŸš€ [NEO-Build] buildDfpDate:",ze),console.log("ðŸš€ [NEO-Build] preservedEvents:",(I==null?void 0:I.length)||0),console.log("ðŸš€ [NEO-Build] highestPriorityEvents:",Ti.length),rr(!0),Mt([]);const q=I||Ti;console.log(`ðŸš€ [NEO-Build] DEBUG runBuildAlgorithm called with ${q.length} highest priority events`);const te={instructors:K,trainees:xe,syllabus:be,scores:nt,coursePriorities:Ht,coursePercentages:we,availableAircraftCount:je,ftdCount:Ye,cptCount:St,courseColors:kt,school:X,dayStart:Ce,dayEnd:B,ftdStart:rt,ftdEnd:et,allowNightFlying:pn,commenceNightFlying:ts,ceaseNightFlying:Nn,buildDate:ze,highestPriorityEvents:q,programWithPrimaries:ra,traineeLMPs:ot,flightTurnaround:Qn,ftdTurnaround:cs,cptTurnaround:Ms,preferredDutyPeriod:ss,maxCrewDutyPeriod:Jn,eventLimits:Pt,sctFtds:Es,sctFlights:xn,remedialRequests:ci,sctEvents:Ir,getEventDayNightClassification:ic};setTimeout(()=>{try{console.log("ðŸš€ [NEO-Build] Starting DFP build process for",ze),console.log("ðŸš€ [NEO-Build] Config:",{instructors:te.instructors.length,trainees:te.trainees.length,syllabus:te.syllabus.length,highestPriorityEvents:te.highestPriorityEvents.length,buildDate:te.buildDate});const le=h_(te,js,Et);console.log("ðŸš€ [NEO-Build] DFP build completed, generated",le.length,"events"),console.log("ðŸš€ [NEO-Build] Generated events sample:",le.slice(0,3)),Mt(le),console.log("ðŸš€ [NEO-Build] setNextDayBuildEvents called with",le.length,"events");const Ue=f_(le,we,Ht,je,ze,xe,ot,nt,be,Et);jn(Ue),localStorage.setItem("lastBuildAnalysis",JSON.stringify({...Ue,timeDistribution:{eventsByHour:Array.from(Ue.timeDistribution.eventsByHour.entries()),clusteringScore:Ue.timeDistribution.clusteringScore,uniformityScore:Ue.timeDistribution.uniformityScore}})),console.log("Build analysis:",Ue);const Ie=[],he=[...K,...xe];le.forEach(qe=>{Ls(qe).forEach(dt=>{const at=he.find(Nt=>Nt.name===dt||"fullName"in Nt&&Nt.fullName===dt);at&&Li(at,qe.startTime,qe.startTime+qe.duration,ze,qe.type)&&(Ie.push(`${dt} in event ${qe.flightNumber} at ${qe.startTime.toFixed(2)} conflicts with a static unavailability period.`),Pn("Next Day Build","Add",`NEO-Build completed for ${ze}`,`Generated ${le.length} events, Flight: ${le.filter(Nt=>Nt.type==="flight").length}, FTD: ${le.filter(Nt=>Nt.type==="ftd").length}, Ground: ${le.filter(Nt=>Nt.type==="ground").length}`))})}),Ie.length>0&&Js(Ie)}catch(le){console.error("ðŸš€ [NEO-Build] DFP Build Failed:",le),console.error("ðŸš€ [NEO-Build] Error stack:",le instanceof Error?le.stack:"No stack trace"),js({message:"Error during build!",percentage:100})}finally{setTimeout(()=>{console.log("ðŸš€ [NEO-Build] Build process complete, navigating to NextDayBuild"),rr(!1),xs("NextDayBuild")},1e3)}},500)},Xo=()=>{Kt.length>0?Un(!0):u("No DFP has been built to publish. Please run 'Build DFP' first.","Publish Error","warning")},Ro=()=>{Un(!1);const I=Kt.map(q=>({...q,date:ze}));Bt(q=>({...q,[ze]:I})),console.log("ðŸ“‹ Triggering PT-051 sync after publish..."),setTimeout(()=>{console.log("â° Executing delayed PT-051 sync after publish..."),Bt(q=>(dn(te=>(pl(q,te),te)),q))},500),fo(q=>({...q,[ze]:JSON.parse(JSON.stringify(I))})),Pn("Next Day Build","Edit",`Published schedule for ${ze}`,`Total events: ${I.length}, Flight: ${I.filter(q=>q.type==="flight").length}, FTD: ${I.filter(q=>q.type==="ftd").length}, Ground: ${I.filter(q=>q.type==="ground").length}`),y(ze),Mt([]),h("Program Schedule"),$s("DFP Successfully Published!")},Ko=I=>{!I||I.length===0||(Bt(q=>{const te=q[x]||[],le=new Map(I.map(Ie=>[Ie.eventId,Ie])),Ue=te.map(Ie=>{if(le.has(Ie.id)){const he=le.get(Ie.id);return{...Ie,startTime:he.newStartTime??Ie.startTime,resourceId:he.newResourceId??Ie.resourceId}}return Ie});return{...q,[x]:Ue}}),I.forEach(q=>{const te=currentScheduleForDate.find(le=>le.id===q.eventId);if(te){const le=te.startTime,Ue=te.resourceId,Ie=te.type||"event",he=te.student||te.pilot||te.instructor||"Unknown";jo(`schedule-move-${q.eventId}`,{page:"Program Schedule",action:"Edit",description:`Moved ${Ie} event for ${he}`,originalValues:{startTime:le,resourceId:Ue},newValues:{startTime:q.newStartTime,resourceId:q.newResourceId}},Pn)}}))},Va=I=>{!I||I.length===0||(Mt(q=>{const te=new Map(I.map(le=>[le.eventId,le]));return q.map(le=>{if(te.has(le.id)){const Ue=te.get(le.id);return{...le,startTime:Ue.newStartTime??le.startTime,resourceId:Ue.newResourceId??le.resourceId}}return le})}),I.forEach(q=>{const te=Kt.find(le=>le.id===q.eventId);if(te){const le=te.startTime,Ue=te.resourceId,Ie=te.type||"event",he=te.student||te.pilot||te.instructor||"Unknown";jo(`ndb-move-${q.eventId}`,{page:"Next Day Build",action:"Edit",description:`Moved ${Ie} event for ${he}`,originalValues:{startTime:le,resourceId:Ue},newValues:{startTime:q.newStartTime,resourceId:q.newResourceId}},Pn)}}))},ri=C.useMemo(()=>be.map(I=>I.id),[be]),Bl=C.useMemo(()=>{console.log("addTileSyllabusOptions filtering syllabusDetails:",be);const I=be.filter(te=>te.type==="Flight"||te.type==="FTD"||te.type==="Ground School"&&te.code.includes("CPT"));console.log("Filtered items:",I);const q=I.map(te=>te.id);return q.includes("SCT FORM")||q.push("SCT FORM"),q},[be]),bd=(I,q,te,le,Ue)=>{const Ie=new Date().toISOString(),he=Ue;let qe=!1,dt=null;const at=Nt=>Nt.map(Be=>{if(Be.id===I){const Wt={...Be,authNotes:q};return te==="autho"?(Wt.authoSignedBy=he,Wt.authoSignedAt=Ie):te==="captain"&&(Wt.captainSignedBy=he,Wt.captainSignedAt=Ie,Wt.isVerbalAuth=le),!!(Wt.authoSignedBy&&Wt.captainSignedBy)&&(qe=!0),dt=Wt,Wt}return Be});E(Nt=>at(Nt)),Bt(Nt=>Object.fromEntries(Object.entries(Nt).map(([Be,Wt])=>[Be,at(Wt)]))),dt&&hr(dt),te==="captain"&&!qe&&(Ha(!1),hr(null)),qe&&$s("Flight Authorised!")},vd=C.useCallback(I=>{const q=new Map(I.map(te=>[te.idNumber,te]));ue(te=>{const le=new Set(te.map(he=>he.idNumber)),Ue=te.map(he=>q.get(he.idNumber)||he),Ie=I.filter(he=>!le.has(he.idNumber));return[...Ue,...Ie]})},[]),fu=C.useCallback(I=>{ue(I),$s("Instructors successfully replaced!")},[]),Nd=C.useCallback(I=>{const q=new Map(I.map(te=>[te.idNumber,te]));pe(te=>{const le=new Set(te.map(he=>he.idNumber)),Ue=te.map(he=>q.get(he.idNumber)||he),Ie=I.filter(he=>!le.has(he.idNumber));return[...Ue,...Ie]})},[]),Rr=C.useCallback(I=>{pe(I),$s("Trainees successfully replaced!")},[]),bl=C.useCallback(I=>{const q=new Map(I.map(te=>[te.code.trim().replace(/\s/g,"").toLowerCase(),te]));Ze(te=>{const le=te.map(he=>{const qe=he.code.trim().replace(/\s/g,"").toLowerCase();return q.get(qe)||he}),Ue=new Set(te.map(he=>he.code.trim().replace(/\s/g,"").toLowerCase())),Ie=I.filter(he=>!Ue.has(he.code.trim().replace(/\s/g,"").toLowerCase()));return[...le,...Ie]})},[]),Ol=I=>{Ze(q=>q.map(te=>te.id===I.id?I:te))},$l=(I,q)=>{st(te=>te.map(le=>le.name===I?{...le,gradDate:q}:le))},pc=(I,q)=>{st(te=>te.map(le=>le.name===I?{...le,startDate:q}:le))},b=I=>{Te(I),I||fe(new Set)},S=C.useMemo(()=>{const I={};return xe.forEach(q=>{I[q.course]||(I[q.course]=[]),I[q.course].push(q)}),I},[xe]),L=I=>{const q=be.find(le=>le.code===I.flightNumber);if(!q)return;const te={id:_r(),type:"ground",flightNumber:I.flightNumber,startTime:I.startTime,duration:q.duration,instructor:I.instructor,attendees:I.attendees,resourceId:I.resourceId,color:"bg-teal-400/50",flightType:"Dual",locationType:"Local",origin:X,destination:X,authNotes:I.location};Mt(le=>[...le,te]),En(!1),$s("Ground event added to the build.")},G=C.useCallback((I,q)=>{var he;const te=[],le=Ra(I,be),Ue=I.flightNumber,Ie=xe.filter(qe=>qe.fullName!==I.student&&!qe.isPaused);for(const qe of Ie){if(((he=tf(qe,ot,nt,be,Et,ze).next)==null?void 0:he.id)!==Ue||Li(qe,le.start,le.end,I.date,I.type)||q.some(wn=>{if(wn.id===I.id||!Ls(wn).includes(qe.fullName))return!1;const Ut=Ra(wn,be);return le.start<Ut.end&&le.end>Ut.start}))continue;const Nt=l_(qe.lastFlightDate,I.date),Be=q.filter(wn=>Ls(wn).includes(qe.fullName)),Wt=Be.filter(wn=>wn.type==="flight").length,Rt=Be.filter(wn=>wn.type==="ftd").length,tn=Be.filter(wn=>wn.type==="cpt"||wn.type==="ground"&&wn.flightNumber.includes("CPT")).length,Dn=Be.filter(wn=>wn.type==="ground"&&!(wn.type==="cpt"||wn.flightNumber.includes("CPT"))).length;te.push({type:"trainee",trainee:{name:qe.fullName,rank:qe.rank,course:qe.course,daysSinceLastFlight:Nt,flightsToday:Wt,ftdsToday:Rt,cptsToday:tn,groundToday:Dn}})}return te.sort((qe,dt)=>dt.trainee.daysSinceLastFlight-qe.trainee.daysSinceLastFlight)},[xe,be,ot,nt]),ie=C.useCallback((I,q,te)=>{const le=[];console.log("ðŸ” generateInstructorRemediesAtTime called for:",I.flightNumber,"at time:",te),console.log("ðŸ” Total instructors to check:",K.length);let Ue=0,Ie=0,he=0;const qe={...I,startTime:te},dt=Ra(qe,be);for(const at of K){const Nt=at.role==="QFI",Be=at.role==="SIM IP";if(!(I.type==="flight"&&Nt||I.type==="ftd"&&(Nt||Be)||I.type==="ground")){Ue++;continue}if(Li(at,dt.start,dt.end,I.date,I.type)){Ie++;continue}if(q.some(Sn=>{if(Sn.id===I.id||!Ls(Sn).includes(at.name))return!1;const Ln=Ra(Sn,be);return dt.start<Ln.end&&dt.end>Ln.start})){he++;continue}const tn=q.filter(Sn=>Sn.id!==I.id&&Ls(Sn).includes(at.name)),Dn=tn.filter(Sn=>Sn.type==="flight").length,wn=tn.filter(Sn=>Sn.type==="ftd").length,Ut=tn.filter(Sn=>Sn.type==="cpt"||Sn.type==="ground"&&Sn.flightNumber.includes("CPT")).length,In=tn.filter(Sn=>Sn.type==="ground"&&!(Sn.type==="cpt"||Sn.flightNumber.includes("CPT"))).length,An=_m(at.name,q.filter(Sn=>Sn.id!==I.id),qe,be);le.push({type:"instructor",instructor:{name:at.name,rank:at.rank,dutyHours:An,flightsToday:Dn,ftdsToday:wn,cptsToday:Ut,groundToday:In}})}return console.log("ðŸ” Instructor remedy generation complete:"),console.log("ðŸ” - Qualification failures:",Ue),console.log("ðŸ” - Unavailability failures:",Ie),console.log("ðŸ” - Overlap failures:",he),console.log("ðŸ” - Total suggestions:",le.length),le.sort((at,Nt)=>{const Be=at.instructor.flightsToday+at.instructor.ftdsToday+at.instructor.cptsToday+at.instructor.groundToday,Wt=Nt.instructor.flightsToday+Nt.instructor.ftdsToday+Nt.instructor.cptsToday+Nt.instructor.groundToday;return Be!==Wt?Be-Wt:at.instructor.dutyHours-Nt.instructor.dutyHours})},[K,be]),oe=C.useCallback((I,q,te)=>{const le=[];console.log("ðŸ” generatePilotRemediesAtTime called for:",I.flightNumber,"at time:",te);const Ue=K.filter(at=>at.role==="QFI");console.log("ðŸ” Total qualified pilots to check:",Ue.length);let Ie=0,he=0;const qe={...I,startTime:te},dt=Ra(qe,be);for(const at of Ue){if(Li(at,dt.start,dt.end,I.date,I.type)){Ie++;continue}if(q.some(Ut=>{if(Ut.id===I.id||!Ls(Ut).includes(at.name))return!1;const In=Ra(Ut,be);return dt.start<In.end&&dt.end>In.start})){he++;continue}const Be=q.filter(Ut=>Ut.id!==I.id&&Ls(Ut).includes(at.name)),Wt=Be.filter(Ut=>Ut.type==="flight").length,Rt=Be.filter(Ut=>Ut.type==="ftd").length,tn=Be.filter(Ut=>Ut.type==="cpt"||Ut.type==="ground"&&Ut.flightNumber.includes("CPT")).length,Dn=Be.filter(Ut=>Ut.type==="ground"&&!(Ut.type==="cpt"||Ut.flightNumber.includes("CPT"))).length,wn=_m(at.name,q.filter(Ut=>Ut.id!==I.id),qe,be);le.push({type:"instructor",instructor:{name:at.name,rank:at.rank,dutyHours:wn,flightsToday:Wt,ftdsToday:Rt,cptsToday:tn,groundToday:Dn}})}return console.log("ðŸ” Pilot remedy generation complete:"),console.log("ðŸ” - Unavailability failures:",Ie),console.log("ðŸ” - Overlap failures:",he),console.log("ðŸ” - Total suggestions:",le.length),le.sort((at,Nt)=>{const Be=at.instructor.flightsToday+at.instructor.ftdsToday+at.instructor.cptsToday+at.instructor.groundToday,Wt=Nt.instructor.flightsToday+Nt.instructor.ftdsToday+Nt.instructor.cptsToday+Nt.instructor.groundToday;return Be!==Wt?Be-Wt:at.instructor.dutyHours-Nt.instructor.dutyHours})},[K,be]),de=(I,q,te,le)=>{const{flightTurnaround:Ue,ftdTurnaround:Ie,syllabusDetails:he,instructorsData:qe,traineesData:dt,getPersonnel:at,getEventBookingWindow:Nt,isPersonStaticallyUnavailable:Be,maxCrewDutyPeriod:Wt}=te,Rt=q.filter(Ln=>Ln.resourceId===I.resourceId&&Ln.id!==I.id).sort((Ln,bn)=>Ln.startTime-bn.startTime),tn=Rt.filter(Ln=>Ln.startTime<I.startTime).pop(),Dn=Rt.find(Ln=>Ln.startTime>I.startTime);let wn="middle";tn||(wn="first"),Dn||(wn="last");let Ut=0;I.type==="flight"?Ut=Ue:I.type==="ftd"&&(Ut=Ie);const In=Ln=>{const bn={...I,startTime:Ln},gn=Nt(bn,he);if(gn.start<le.start||gn.end>le.end)return!1;const Gn=new Date().getHours()+new Date().getMinutes()/60;if(Ln<I.startTime&&gn.start<Gn)return!1;if(tn){let Ss=Ut;const dr=at(tn),ii=at(I);if(dr.some(Zr=>ii.includes(Zr))){const Zr=he.find(Vs=>Vs.id===tn.flightNumber),gr=he.find(Vs=>Vs.id===I.flightNumber),bo=((Zr==null?void 0:Zr.postFlightTime)||0)+((gr==null?void 0:gr.preFlightTime)||0);Ss=Math.max(Ut,bo)}if(Ln<tn.startTime+tn.duration+Ss)return!1}if(Dn){let Ss=Ut;const dr=at(Dn),ii=at(I);if(dr.some(Zr=>ii.includes(Zr))){const Zr=he.find(Vs=>Vs.id===I.flightNumber),gr=he.find(Vs=>Vs.id===Dn.flightNumber),bo=((Zr==null?void 0:Zr.postFlightTime)||0)+((gr==null?void 0:gr.preFlightTime)||0);Ss=Math.max(Ut,bo)}if(Ln+I.duration+Ss>Dn.startTime)return!1}const bs=at(I);for(const Ss of bs){const dr=[...qe,...dt].find(gr=>("fullName"in gr?gr.fullName:gr.name)===Ss);if(!dr)continue;if(Be(dr,gn.start,gn.end,I.date,I.type)||q.some(gr=>{if(gr.id===I.id||!at(gr).includes(Ss))return!1;const bo=Nt(gr,he);return gn.start<bo.end&&gn.end>bo.start}))return!1;const Lr=q.filter(gr=>gr.id!==I.id&&at(gr).includes(Ss));if(_m(Ss,Lr,bn,he)>Wt)return!1}return!0},An=5/60,Sn=Math.floor((le.end-le.start)/An);for(let Ln=1;Ln<=Sn;Ln++){const bn=I.startTime+Ln*An,gn=I.startTime-Ln*An;if(wn==="first"||wn==="last"&&!Dn){if(In(bn))return{type:"timeshift",newStartTime:bn,instructor:{name:I.instructor||""}}}else{if(In(bn))return{type:"timeshift",newStartTime:bn,instructor:{name:I.instructor||""}};if(In(gn))return{type:"timeshift",newStartTime:gn,instructor:{name:I.instructor||""}}}}return null},ve=I=>{var Nt;const q=["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f),te=q?Kt.map(Be=>({...Be,date:ze})):qs,Ue=(q?po:Kr).has(I.id);let Ie=[];if(U&&Ue?(Ie=Gt(I,te),Ie.length>0&&(Ie.unshift("âš ï¸ VALIDATE MODE CONFLICTS DETECTED:"),Ie.push(""),Ie.push("This event is marked RED because Validate mode found the following rule violations:"))):Ie=Gt(I,te),Ie.length===0){yi(U&&!Ue?"NEO analysis: This event has no conflicts and passes all validation rules.":"NEO found no hard errors for this event.");return}U&&Ue?(console.log(`NEO: Analyzing validate-mode conflict for event ${I.flightNumber} (${I.id})`),console.log("Validation errors found:",Ie),Wr({event:I,errors:Ie})):Wr({event:I,errors:Ie});const he=Ie.every(Be=>Be.toLowerCase().includes("turnaround"))&&Ie.length>0,qe=Ie.some(Be=>I.instructor&&Be.includes(I.instructor.split(",")[0]));if(he||!qe){const Wt=de(I,te,{flightTurnaround:Qn,ftdTurnaround:cs,syllabusDetails:be,instructorsData:K,traineesData:xe,getPersonnel:Ls,getEventBookingWindow:Ra,isPersonStaticallyUnavailable:Li,maxCrewDutyPeriod:Jn},{start:Ce,end:B});if(Wt){re(Wt),Qe(!0),Tr([]);return}else if(he){yi("No resolution found for the turnaround violation. Changing crew will not fix this resource conflict."),Wr(null),Tr([]);return}}const dt=Ie.filter(Be=>I.student&&Be.includes(I.student.split(",")[0]));if(!qe&&dt.length>0){const Be=G(I,te);if(Be.length>0){Tr(Be);return}}if((Nt=I.flightNumber)==null?void 0:Nt.startsWith("SCT")){console.log("ðŸ”§ SCT event detected, generating pilot remedies");const Be=oe(I,te,I.startTime);Be.length>0?Tr(Be):(yi("No resolution found."),Tr([]))}else{const Be=ie(I,te,I.startTime);Be.length>0?Tr(Be):(yi("No resolution found."),Tr([]))}},Se=I=>{if(console.log("ðŸ”§ handleApplyNeoRemedy called with remedy:",I),console.log("ðŸ”§ neoProblemTileForFlyout:",Bs),!Bs){console.log("âŒ No problem tile found, returning early");return}console.log("ðŸ”§ Remedy type:",I.type),console.log("ðŸ”§ Instructor duty hours:",I.type!=="trainee"?I.instructor.dutyHours:"N/A"),console.log("ðŸ”§ Preferred duty period:",ss),I.type!=="trainee"&&I.instructor.dutyHours>ss?(console.log("âš ï¸ Duty warning triggered"),io(I),ao(!0)):(console.log("âœ… Executing remedy directly"),jt(I,Bs.event))},Pe=()=>{di&&Bs&&jt(di,Bs.event),ao(!1),io(null)},it=()=>{Jt(!1),Tr(fn)},_t=()=>{Jt(!1),Tr(Xn)},Me=()=>{Qe(!1),re(null),Wr(null)},ut=()=>{if(Qe(!1),re(null),Bs){console.log("ðŸ”§ DEBUG: Generating instructor remedies for event:",Bs.event.flightNumber);const q=["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f)?Kt.map(le=>({...le,date:ze})):qs;console.log("ðŸ”§ DEBUG: Total events in context:",q.length);const te=ie(Bs.event,q,Bs.event.startTime);console.log("ðŸ”§ DEBUG: Generated remedies:",te.length),console.log("ðŸ”§ DEBUG: Remedies:",te),Tr(te)}},wt=()=>{k&&Bs&&(jt(k,Bs.event),setShowTimeOnlyConfirmation(!1),re(null),Wr(null),Tr([]))},Gt=(I,q)=>{const te=[],le=go(I,q,I.date);if(le.hasConflict){const qe=q.find(dt=>dt.id===le.conflictingEventId);switch(le.conflictType){case"turnaround":if(qe){let dt=0;if(I.type==="flight"?dt=Qn:I.type==="ftd"?dt=cs:(I.type==="cpt"||I.type==="ground"&&I.flightNumber.includes("CPT"))&&(dt=Ms),I.startTime>qe.startTime){const at=I.startTime-(qe.startTime+qe.duration);te.push(`âŒ Turnaround violation - Only ${at.toFixed(2)}hrs between ${I.flightNumber} and previous event ${qe.flightNumber} (minimum required: ${dt}hrs)`)}else{const at=qe.startTime-(I.startTime+I.duration);te.push(`âŒ Turnaround violation - Only ${at.toFixed(2)}hrs between ${I.flightNumber} and next event ${qe.flightNumber} (minimum required: ${dt}hrs)`)}}break;case"resource":qe&&te.push(`âŒ Resource conflict - Aircraft ${I.resourceId} is double-booked with ${qe.flightNumber} at ${qe.startTime.toFixed(2)}hrs`);break;case"personnel":qe&&le.conflictedPersonnel&&te.push(`âŒ ${le.conflictedPersonnel.split(",")[0]} is double-booked - Scheduled for both ${I.flightNumber} and ${qe.flightNumber} at overlapping times`);break;case"day-night":if(qe&&le.conflictedPersonnel){const dt=ic(I,be,Ir),at=ic(qe,be,Ir);te.push(`âŒ Day/Night separation violation - ${le.conflictedPersonnel.split(",")[0]} cannot be scheduled for both ${dt} event (${I.flightNumber}) and ${at} event (${qe.flightNumber})`)}break}}I.flightType==="Dual"&&(!I.instructor||I.instructor.trim()===""||I.instructor==="TBD")&&te.push("âŒ No instructor assigned - Dual flights require an instructor.");const Ue=Ra(I,be),Ie=Ls(I),he=[...K,...xe];return Ie.forEach(qe=>{const dt=he.find(at=>("fullName"in at?at.fullName:at.name)===qe);if(dt&&Li(dt,Ue.start,Ue.end,I.date,I.type)){const at=dt.unavailability.find(Be=>Be.allDay?I.date>=Be.startDate&&I.date<Be.endDate:I.date>=Be.startDate&&I.date<=Be.endDate),Nt=(at==null?void 0:at.reason)||"Unavailable";te.push(`âŒ ${(qe||"").split(",")[0]} is unavailable - ${Nt}`)}}),[...new Set(te)]},jt=(I,q)=>{var dt;console.log("ðŸŸ£ ========== NEO REMEDY START =========="),console.log("ðŸŸ£ NEO: executeNeoRemedy called"),console.log("ðŸŸ£ NEO: Remedy type:",I.type),console.log("ðŸŸ£ NEO: Problem tile ID:",q.id),console.log("ðŸŸ£ NEO: Problem tile instructor:",q.instructor),console.log("ðŸŸ£ NEO: Problem tile student:",q.student),console.log("ðŸŸ£ NEO: Problem tile pilot:",q.pilot);const te=["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f),le=te?ze:x;console.log("ðŸŸ£ NEO: isNextDayContext:",te),console.log("ðŸŸ£ NEO: targetDate:",le),console.log("ðŸŸ£ NEO: activeView:",f);const Ue=te?Kt.map(at=>({...at,date:ze})):Et[le]||[];console.log("ðŸŸ£ NEO: currentEvents count:",Ue.length);const Ie=Ue.find(at=>at.id===q.id);if(!Ie){console.error("ðŸŸ£ âŒ NEO: Event not found:",q.id),console.log("ðŸŸ£ NEO: Available event IDs:",Ue.map(at=>at.id));return}console.log("ðŸŸ£ NEO: Found event to update:",{id:Ie.id,instructor:Ie.instructor,student:Ie.student,pilot:Ie.pilot,date:Ie.date,resourceId:Ie.resourceId});const he={...Ie},qe=(dt=Ie.flightNumber)==null?void 0:dt.startsWith("SCT");if(!qe){const at=he.student||he.pilot;if(at&&he.flightNumber){const Nt=Ai(he.flightNumber,at);he.flightType=Nt,Nt==="Solo"&&at&&(he.pilot=at,he.crew="",console.log(`âœˆï¸ [NEO Solo Logic] Applied: ${at} as PIC, crew cleared for ${he.flightNumber}`))}}I.type==="instructor"?qe?(console.log("ðŸŸ£ NEO: Applying pilot change for SCT event:",Ie.pilot,"â†’",I.instructor.name),he.pilot=I.instructor.name,he.instructor=""):(console.log("ðŸŸ£ NEO: Applying instructor change:",Ie.instructor,"â†’",I.instructor.name),he.instructor=I.instructor.name):I.type==="trainee"?(console.log("ðŸŸ£ NEO: Applying trainee change:",Ie.student,"â†’",I.trainee.name),he.student=I.trainee.name):I.type==="timeshift"&&(console.log("ðŸŸ£ NEO: Applying time shift:",Ie.startTime,"â†’",I.newStartTime),he.startTime=I.newStartTime,I.instructor.name&&(qe?(he.pilot=I.instructor.name,he.instructor=""):he.instructor=I.instructor.name)),console.log("ðŸŸ£ NEO: Updated event created:",{id:he.id,instructor:he.instructor,student:he.student,pilot:he.pilot,date:he.date,resourceId:he.resourceId}),console.log("ðŸŸ£ NEO: Calling handleSaveEvents..."),ga([he],!1),console.log("ðŸŸ£ NEO: handleSaveEvents returned, waiting for useEffect to recalculate conflicts"),console.log("ðŸŸ£ ========== NEO REMEDY END ==========")};C.useEffect(()=>{if(console.log("ðŸŸ  ========== NEO USEEFFECT TRIGGERED =========="),console.log("ðŸŸ  neoProblemTileForFlyout:",Bs?"OPEN":"CLOSED"),!Bs){console.log("ðŸŸ  NEO flyout is closed, skipping useEffect"),console.log("ðŸŸ  ========== NEO USEEFFECT END (CLOSED) ==========");return}console.log("ðŸŸ  NEO flyout is open, processing..."),console.log("ðŸŸ  Problem tile ID:",Bs.event.id),console.log("ðŸŸ  Problem tile instructor:",Bs.event.instructor);const I=["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f),q=I?Kt.map(Ue=>({...Ue,date:ze})):qs;console.log("ðŸŸ  isNextDayContext:",I),console.log("ðŸŸ  currentEvents count:",q.length);const te=q.find(Ue=>Ue.id===Bs.event.id);if(!te){console.log("ðŸŸ  âŒ Event not found in current state, closing flyout"),Wr(null),Tr([]),console.log("ðŸŸ  ========== NEO USEEFFECT END (NOT FOUND) ==========");return}console.log("ðŸŸ  Found updated problem tile:",{id:te.id,instructor:te.instructor,student:te.student,pilot:te.pilot}),console.log("ðŸŸ  Running findHardErrors on updated tile...");const le=Gt(te,q);if(console.log("ðŸŸ  Errors found:",le.length),le.length>0&&console.log("ðŸŸ  Error details:",le),le.length===0)console.log("ðŸŸ  âœ… All conflicts resolved! Closing flyout and showing success message"),$s(`All conflicts for ${te.flightNumber} resolved.`),Wr(null),Tr([]),io(null),ao(!1),re(null),Qe(!1);else{console.log("ðŸŸ  âš ï¸ Conflicts still exist, generating new remedies...");const Ue=le.filter(qe=>qe.toLowerCase().includes("instructor")||te.instructor&&qe.includes(te.instructor.split(",")[0])),Ie=le.filter(qe=>te.student&&qe.includes(te.student.split(",")[0]));console.log("ðŸŸ  Instructor errors:",Ue.length),console.log("ðŸŸ  Trainee errors:",Ie.length);let he=[];Ue.length===0&&Ie.length>0?(console.log("ðŸŸ  Generating trainee remedies..."),he=G(te,q)):(console.log("ðŸŸ  Generating instructor remedies..."),he=ie(te,q,te.startTime)),console.log("ðŸŸ  Generated",he.length,"new remedies"),Wr({event:te,errors:le}),Tr(he)}console.log("ðŸŸ  ========== NEO USEEFFECT END ==========")},[Et,Kt,Bs==null?void 0:Bs.event.id,qs,f,ze]);const zt=()=>{Wr(null),Tr([])},Qt=I=>{const q=I.filter(le=>le.type==="composite"),te=I.filter(le=>le.type==="primitive");Io(q),Da(te),$s("Currency rules saved!")},mn=I=>{Io(q=>q.filter(te=>te.id!==I)),Da(q=>q.filter(te=>te.id!==I)),$s("Currency deleted.")},ln=C.useMemo(()=>[...Ei.map(I=>I.name),...la.map(I=>I.name)].sort(),[Ei,la]),Yn=C.useCallback(()=>{const I=Cn==="nextDayBuild",q=(I?Kt.map(Ie=>({...Ie,date:ze})):qs).filter(Ie=>!Ie.resourceId.startsWith("STBY")&&!Ie.resourceId.startsWith("BNF-STBY")),te=I?ze:x,le=K.map(Ie=>(q.filter(he=>Ls(he).includes(Ie.name)),{instructor:Ie,availableWindows:[]})),Ue=xe.map(Ie=>{const he=q.filter(Rt=>Ls(Rt).includes(Ie.fullName)),qe=he.some(Rt=>Rt.type==="ftd"&&Rt.date===te),dt=he.some(Rt=>Rt.type==="flight"&&Rt.date===te),at=he.filter(Rt=>Rt.type==="ground"&&Rt.date===te).length,Nt=tf(Ie,ot,nt,be,Et,ze).next;let Be=(Nt==null?void 0:Nt.type)==="Flight";return Ie.isPaused&&(Be=!1,console.log(`Oracle: ${Ie.fullName} excluded - trainee is PAUSED`)),(Ie.course.includes("NTSC")||Ie.fullName.includes("NTSC"))&&(Be=!1,console.log(`Oracle: ${Ie.fullName} excluded - trainee is NTSC`)),Nt&&Nt.isRemedial&&(Be=!1,console.log(`Oracle: ${Ie.fullName} excluded - next event ${Nt.code} is REMEDIAL`)),dt&&(Be=!1,console.log(`Oracle: ${Ie.fullName} ineligible - already has flight scheduled for ${te}`)),qe&&dt&&(Be=!1,console.log(`Oracle: ${Ie.fullName} ineligible - has both FTD and flight scheduled for ${te}`)),at>=2&&(Be=!1,console.log(`Oracle: ${Ie.fullName} ineligible - already has ${at} ground events for ${te}`)),Nt||(Be=!1,console.log(`Oracle: ${Ie.fullName} ineligible - no next syllabus event found`)),{trainee:Ie,availableWindows:[],nextSyllabusEvent:Nt,isEligible:Be}});Ue.filter(Ie=>Ie.isEligible).length,mt({instructors:le,trainees:Ue})},[K,xe,qs,x,Kt,ze,Cn,ot,nt,be]),On=C.useCallback(()=>{const I=["NextDayBuild","NextDayInstructorSchedule","NextDayTraineeSchedule","Priorities","ProgramData"].includes(f);Vn(I?"nextDayBuild":"program"),Qr&&(mt(null),Yt(null)),Fi(q=>!q)},[Qr,f]);C.useEffect(()=>{Qr&&Yn()},[Qr,Cn,Yn]);const ys=C.useCallback((I,q)=>{Yt({id:"oracle-preview",date:Cn==="nextDayBuild"?ze:x,startTime:I,duration:1.2,resourceId:q,type:"flight",flightNumber:"Next Event",instructor:"Checking...",student:"Checking...",color:"bg-sky-500/50",flightType:"Dual",locationType:"Local",origin:X,destination:X})},[x,ze,Cn,X]),qn=C.useCallback((I,q)=>{if(!nn||!ke)return;const te=(Cn==="nextDayBuild"?Kt.map(Nt=>({...Nt,date:ze})):qs).filter(Nt=>!Nt.resourceId.startsWith("STBY")&&!Nt.resourceId.startsWith("BNF-STBY")),le=Cn==="nextDayBuild"?ze:x,qe={start:I-1,end:I+1.2+.5},dt=ke.instructors.some(Nt=>{const Wt=te.filter(Rt=>Ls(Rt).includes(Nt.instructor.name)).some(Rt=>{const tn=Ra(Rt,be);return qe.start<tn.end&&qe.end>tn.start});return!Li(Nt.instructor,qe.start,qe.end,le,"flight")&&!Wt}),at=ke.trainees.some(Nt=>{if(!Nt.isEligible)return!1;const Wt=te.filter(Rt=>Ls(Rt).includes(Nt.trainee.fullName)).some(Rt=>{const tn=Ra(Rt,be);return qe.start<tn.end&&qe.end>tn.start});return!Li(Nt.trainee,qe.start,qe.end,le,"flight")&&!Wt});Yt({...nn,startTime:I,resourceId:q,instructor:dt?"Instructor âœ“":"NO INSTRUCTOR âœ•",student:at?"Trainee âœ“":"NO TRAINEE âœ•"})},[nn,ke,qs,x,Kt,ze,Cn,be]),Rs=C.useCallback(()=>{if(!nn||!ke)return;const I=(Cn==="nextDayBuild"?Kt.map(Nt=>({...Nt,date:ze})):qs).filter(Nt=>!Nt.resourceId.startsWith("STBY")&&!Nt.resourceId.startsWith("BNF-STBY")),q=Cn==="nextDayBuild"?ze:x,{startTime:te,duration:le}=nn,he={start:te-1,end:te+le+.5},qe=ke.instructors.filter(Nt=>{const Wt=I.filter(Rt=>Ls(Rt).includes(Nt.instructor.name)).some(Rt=>{const tn=Ra(Rt,be);return he.start<tn.end&&he.end>tn.start});return!Li(Nt.instructor,he.start,he.end,q,"flight")&&!Wt}).map(Nt=>Nt.instructor.name),dt=ke.trainees.filter(Nt=>{var Ut;if(!Nt.isEligible)return!1;const Be=I.filter(In=>Ls(In).includes(Nt.trainee.fullName));if(Be.some(In=>In.type==="flight"&&In.date===q))return console.log(`Oracle: Excluding ${Nt.trainee.fullName} - already has a flight scheduled for ${q}`),!1;if(Nt.nextSyllabusEvent&&Be.some(An=>An.flightNumber===Nt.nextSyllabusEvent.id&&An.date===q))return console.log(`Oracle: Excluding ${Nt.trainee.fullName} - already scheduled for event ${Nt.nextSyllabusEvent.id} on ${q}`),!1;const Rt=Be.some(In=>{const An=Ra(In,be);return he.start<An.end&&he.end>An.start}),tn=Nt.nextSyllabusEvent?ic({flightNumber:Nt.nextSyllabusEvent.id},be,Ir):"Unknown";if(Nt.nextSyllabusEvent&&tn!=="Day/Night"){const In=he.start>=ts&&he.start<Nn;if(tn==="Night"&&!In)return console.log(`Oracle: Excluding ${Nt.trainee.fullName} - Next event is Night but proposed time is Day (${he.start.toFixed(2)})`),!1;if(tn==="Day"&&In)return console.log(`Oracle: Excluding ${Nt.trainee.fullName} - Next event is Day but proposed time is Night (${he.start.toFixed(2)})`),!1}const Dn=Xr(Nt.trainee.fullName,he.start,he.end-he.start,"flight",q,(Ut=Nt.nextSyllabusEvent)==null?void 0:Ut.id),wn=Li(Nt.trainee,he.start,he.end,q,"flight");return Dn.isAllowed?!wn&&!Rt:(console.log(`Oracle: Excluding ${Nt.trainee.fullName} - ${Dn.reason}`),!1)});en({availableInstructors:qe,availableTraineesAnalysis:dt});const at={id:_r(),date:q,type:"flight",flightNumber:"",duration:nn.duration,startTime:nn.startTime,resourceId:nn.resourceId,color:"bg-sky-400/50",flightType:"Dual",locationType:"Local",origin:X,destination:X};_(at),H(!0),Yt(null)},[nn,ke,x,X,qs,Kt,ze,Cn,be]),mr=()=>{const I=K.find(q=>q.name===_e);I&&(gt(I),xs("Instructors"))},Ns=I=>{$a(I),xs("Currency")},$n=()=>{const I=K.find(q=>q.name===_e);I&&Ns(I)},Tn=()=>{const I=K.find(q=>q.name===_e);I&&(Fr(I),Pi(!0))},Ar=()=>{xs(m)},us=()=>{switch(f){case"Program Schedule":return e.jsx(rw,{date:x,onDateChange:Ul,events:da,resources:ho,instructors:K.map(q=>q.name),traineesData:xe,timezoneOffset:s,airframeCount:24,standbyCount:4,ftdCount:Ye,cptCount:St,onUpdateEvent:Ko,onSelectEvent:ws,onReorderResources:()=>{},zoomLevel:1,showValidation:U,showPrePost:$,syllabusDetails:be,personnelData:bi,seatConfigs:Pr,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelConflicts:[],personnelConflictIds:Kr,unavailabilityConflicts:ua,onCptConflict:Is,isMultiSelectMode:Q,selectedEventIds:Y,setSelectedEventIds:fe,detectConflictsForEvent:go,baselineEvents:Ml[x],isOracleMode:Qr,oraclePreviewEvent:nn,onOracleMouseDown:ys,onOracleMouseMove:qn,onOracleMouseUp:Rs,showDepartureDensityOverlay:o,showAircraftAvailability:gs,plannedAvailability:je,dayFlyingStart:`${Math.floor(Ce).toString().padStart(2,"0")}:${Math.round(Ce%1*60).toString().padStart(2,"0")}`,dayFlyingEnd:`${Math.floor(B).toString().padStart(2,"0")}:${Math.round(B%1*60).toString().padStart(2,"0")}`,onAvailabilityChange:q=>{console.log("Availability updated:",q)},isVisualAdjustMode:Oe,visualAdjustEvent:F,onVisualAdjustTimeChange:(q,te)=>{if(F){const le=te-q,Ue={...F,startTime:q,duration:le};J(Ue),Bt(Ie=>{const he={...Ie},qe=x;return he[qe]&&(he[qe]=he[qe].map(dt=>dt.id===F.id?{...dt,startTime:q,duration:le}:dt)),he})}}});case"TraineeSchedule":return e.jsx(dw,{date:x,onDateChange:Ul,events:Fl,trainees:[...xe].sort((q,te)=>q.course!==te.course?q.course.localeCompare(te.course):q.name.localeCompare(te.name)).map(q=>q.fullName),traineesData:xe,onSelectEvent:ws,onUpdateEvent:Ko,zoomLevel:1,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelData:bi,seatConfigs:Pr,syllabusDetails:be,conflictingEventIds:Kr,showValidation:U,unavailabilityConflicts:ua,onSelectTrainee:za,courseColors:kt});case"InstructorSchedule":console.log("ðŸ” STAFF SCHEDULE DEBUG - Case triggered"),console.log("ðŸ” date:",x),console.log("ðŸ” handleDateChange:",typeof Ul),console.log("ðŸ” eventSegmentsForDate count:",da==null?void 0:da.length),console.log("ðŸ” instructorsData count:",K==null?void 0:K.length),console.log("ðŸ” traineesData count:",xe==null?void 0:xe.length),console.log("ðŸ” handleOpenModal:",typeof ws),console.log("ðŸ” handleScheduleUpdate:",typeof Ko),console.log("ðŸ” zoomLevel:",1),console.log("ðŸ” daylightTimes:",{firstLight:"06:30",lastLight:"18:30"}),console.log("ðŸ” personnelData size:",bi==null?void 0:bi.size),console.log("ðŸ” seatConfigs size: N/A (removed direct access)"),console.log("ðŸ” syllabusDetails count:",be==null?void 0:be.length),console.log("ðŸ” personnelAndResourceConflictIds size:",Kr==null?void 0:Kr.size),console.log("ðŸ” showValidation:",U),console.log("ðŸ” unavailabilityConflicts size:",ua==null?void 0:ua.size),console.log("ðŸ” handleSelectInstructorFromSchedule:",typeof Jo),(da==null?void 0:da.length)>0&&console.log("ðŸ” Sample event:",da[0]),(K==null?void 0:K.length)>0&&console.log("ðŸ” Sample instructor:",K[0]);try{return e.jsx(ow,{date:x,onDateChange:Ul,events:da,instructors:K.map(q=>({name:q.name,rank:q.rank,unit:q.unit})),instructorsData:K,traineesData:xe,onSelectEvent:ws,onUpdateEvent:Ko,zoomLevel:1,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelData:bi,seatConfigs:Pr,syllabusDetails:be,conflictingEventIds:Kr,showValidation:U,unavailabilityConflicts:ua,onSelectInstructor:Jo})}catch(q){throw console.error("ðŸ”´ STAFF SCHEDULE ERROR - Failed to render InstructorScheduleView:",q),console.error("ðŸ”´ Error stack:",q.stack),q}case"NextDayInstructorSchedule":return e.jsx(qD,{events:hl.map(q=>({...q,date:ze})),instructors:K.map(q=>({name:q.name,rank:q.rank,unit:q.unit})),traineesData:xe,onSelectEvent:q=>ws({...q,date:ze},{}),onUpdateEvent:Va,zoomLevel:1,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelData:bi,seatConfigs:Pr,syllabusDetails:be,conflictingEventIds:po,showValidation:U,onSelectInstructor:Jo,buildDfpDate:ze,onDateChange:Lo});case"NextDayTraineeSchedule":return e.jsx(zD,{events:hl.map(q=>({...q,date:ze})),trainees:xe.map(q=>q.fullName),traineesData:xe,onSelectEvent:q=>ws({...q,date:ze},{}),onUpdateEvent:Va,zoomLevel:1,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelData:bi,seatConfigs:Pr,syllabusDetails:be,conflictingEventIds:po,showValidation:U,onSelectTrainee:za,buildDfpDate:ze,onDateChange:Lo,courseColors:kt});case"CourseRoster":return e.jsx(Nw,{events:T,traineesData:xe,courseColors:kt,archivedCourses:ht,personnelData:bi,onNavigateToHateSheet:q=>{Aa(q),xs("HateSheet")},onRestoreCourse:()=>{},onUpdateTrainee:q=>{if(!xe.find(le=>le.idNumber===q.idNumber)){const le=q.lmpType||"BPC+IPC",Ue=be.filter(Ie=>le==="BPC+IPC"?!Ie.lmpType||Ie.lmpType==="Master LMP":Ie.courses.includes(le));Ue.length>0&&Vt(Ie=>{const he=new Map(Ie);return he.set(q.fullName,[...Ue]),console.log(`[Individual LMP] Initialized ${q.fullName}'s Individual LMP with ${le} (${Ue.length} events)`),he})}pe(le=>le.map(Ue=>Ue.idNumber===q.idNumber?q:Ue))},onAddTrainee:mc,school:X,scores:nt,syllabusDetails:be,onNavigateToSyllabus:Yo,onNavigateToCurrency:Ns,onViewIndividualLMP:hc,onAddRemedialPackage:gl,locations:jr,units:Wo,selectedPersonForProfile:rn,onProfileOpened:()=>gt(null),traineeLMPs:ot,onViewLogbook:qi,onDeleteTrainee:q=>{pe(te=>te.filter(le=>le.idNumber!==q.idNumber)),Vt(te=>{const le=new Map(te);return le.delete(q.fullName),le}),Pn({page:"Trainee Roster",action:"delete",description:"Deleted trainee from roster",changes:`Removed: ${q.rank} ${q.name} (${q.course}) - ID: ${q.idNumber}`})}});case"HateSheet":if(Ks){const q=Array.from(xt.values()).filter(le=>le.traineeFullName===Ks.fullName),te=[...qs,...Ti];return e.jsx(Cw,{trainee:Ks,lmpScores:nt.get(Ks.fullName)||[],assessments:q,pt051Events:q,userProfile:Fe,refreshEvents:()=>{loadEventsForDate(selectedDate,selectedCourse)},onSelectLmpScore:le=>{_o(le),xs("ScoreDetail")},onSelectPt051:le=>{console.log("onSelectPt051 called with assessment:",le),Pn("Performance History","View",`Viewed PT-051 for ${le.traineeFullName} - Event: ${le.flightNumber} (${le.date})`);const Ue=te.find(Ie=>Ie.id===le.eventId);if(Ue)console.log("Found event in schedules:",Ue),Nr(Ue),xs("PT051");else{const Ie=Kt.find(he=>he.id===le.eventId);if(Ie)console.log("Found event in build:",Ie),Nr({...Ie,date:ze}),xs("PT051");else{console.log("Event not found, creating mock event for assessment");let he="flight";const qe=le.flightNumber||"";qe.includes("CPT")||qe.includes("Cpt")?he="cpt":(qe.includes("MB")||qe.includes("GS")||qe.includes("Ground")||qe.includes("GROUND"))&&(he="ground");const dt={id:le.eventId,flightNumber:le.flightNumber,date:le.date,startTime:"08:00",endTime:"09:00",instructor:le.instructorName||"Unknown",student:le.traineeFullName,syllabus:le.flightNumber,aircraft:"",type:he,status:"Scheduled",notes:"",crew:[]};console.log("Created mock event:",dt),Nr(dt),xs("PT051")}}},onBackToRoster:()=>{gt(Ks),xs("CourseRoster")},onInsertPt051:(le,Ue)=>{const Ie={id:_r(),traineeFullName:Ks.fullName,eventId:`inserted-pt051-${Date.now()}`,flightNumber:"PT-051 Assessment"},he={id:Ie.eventId,flightNumber:Ie.flightNumber,date:Ue,startTime:9,duration:2,type:"flight",status:"Scheduled",instructor:"",crew:[],location:"",syllabusId:"",syllabusCode:"",remarks:"",isCompleted:!1,buildId:"",isOracleGenerated:!1,priority:0,student:Ks.fullName,syllabus:Ie.flightNumber,aircraft:"",notes:""};Pn("Performance History","Insert",`Inserted PT-051 for ${Ks.fullName} at position ${le} on ${Ue}`),Nr(he),xs("PT051")}})}return null;case"ScoreDetail":return Ks&&oa?e.jsx(Tw,{trainee:Ks,scoreData:oa,onBack:()=>xs("HateSheet")}):null;case"NextDayBuild":return e.jsx(zw,{events:mo,resources:ho,instructors:K.map(q=>q.name),traineesData:xe,airframeCount:24,standbyCount:4,ftdCount:Ye,cptCount:St,onUpdateEvent:Va,onSelectEvent:q=>ws({...q,date:ze},{}),onReorderResources:()=>{},zoomLevel:1,showValidation:U,showPrePost:$,syllabusDetails:be,personnelData:bi,seatConfigs:Pr,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelConflicts:[],personnelConflictIds:po,onCptConflict:Is,date:ze,onDateChange:qt,isMultiSelectMode:Q,selectedEventIds:Y,setSelectedEventIds:fe,isOracleMode:Qr,oraclePreviewEvent:nn,onOracleMouseDown:ys,onOracleMouseMove:qn,onOracleMouseUp:Rs,isVisualAdjustMode:Oe,visualAdjustEvent:F,onVisualAdjustTimeChange:(q,te)=>{if(F){const le=te-q,Ue={...F,startTime:q,duration:le};J(Ue),Mt(Ie=>Ie.map(he=>he.id===F.id?{...he,startTime:q,duration:le}:he))}}});case"Priorities":return e.jsx(Ww,{coursePriorities:Ht,onUpdatePriorities:We,coursePercentages:we,onUpdatePercentages:Re,availableAircraftCount:je,onUpdateAircraftCount:$e,availableFtdCount:Ye,onUpdateFtdCount:Dt,availableCptCount:St,onUpdateCptCount:hn,flyingStartTime:Ce,onUpdateFlyingStartTime:At,flyingEndTime:B,onUpdateFlyingEndTime:Ae,ftdStartTime:rt,onUpdateFtdStartTime:yt,ftdEndTime:et,onUpdateFtdEndTime:$t,allowNightFlying:pn,onUpdateAllowNightFlying:kn,commenceNightFlying:ts,onUpdateCommenceNightFlying:un,ceaseNightFlying:Nn,onUpdateCeaseNightFlying:os,instructorsData:K,traineesData:xe,buildDfpDate:ze,highestPriorityEvents:Ti,onSelectEvent:q=>ws(q,{isPriority:!0}),onUpdatePriorityEvent:xl,programWithPrimaries:ra,onUpdateProgramWithPrimaries:no,sctFlights:xn,sctFtds:Es,onAddSctRequest:q=>{const te={id:_r(),name:"",event:"SCT GF",currency:"",currencyExpire:"",priority:"Medium",dateRequested:d()};q==="flight"?ls(le=>[...le,te]):Zs(le=>[...le,te])},onRemoveSctRequest:(q,te)=>{te==="flight"?ls(le=>le.filter(Ue=>Ue.id!==q)):Zs(le=>le.filter(Ue=>Ue.id!==q))},onUpdateSctRequest:(q,te,le,Ue)=>{const Ie=he=>he.map(qe=>qe.id===q?{...qe,[te]:le}:qe);Ue==="flight"?ls(Ie):Zs(Ie),setTimeout(()=>{const qe=(Ue==="flight"?xn:Es).find(at=>at.id===q),dt=qe?{...qe,[te]:le}:null;console.log("ðŸ”„ SCT Request Update:",{id:q,field:te,value:le,type:Ue,requestPriority:dt==null?void 0:dt.priority,shouldSync:(dt==null?void 0:dt.priority)==="High"}),dt&&dt.priority==="High"&&(console.log("âœ… Triggering sync for HIGH priority SCT request"),_a())},100)},syllabusDetails:be,scores:nt,traineeLMPs:ot,remedialRequests:ci,onToggleRemedialRequest:(q,te)=>{ko(le=>{const Ue=le.find(he=>he.traineeId===q&&he.eventCode===te);let Ie;if(Ue){const he=!Ue.forceSchedule;console.log(`ðŸ”„ Toggling Force Schedule for trainee ${q}, event ${te}: ${Ue.forceSchedule} â†’ ${he}`),Ie=le.map(qe=>qe.traineeId===q&&qe.eventCode===te?{...qe,forceSchedule:he}:qe)}else console.log(`âœ… Creating new Force Schedule request for trainee ${q}, event ${te}`),Ie=[...le,{traineeId:q,eventCode:te,forceSchedule:!0}];return console.log("ðŸ“‹ Updated remedialRequests:",Ie.filter(he=>he.forceSchedule)),setTimeout(()=>{console.log("ðŸ”„ Manual sync triggered from setTimeout"),_a()},100),Ie})},currencyNames:ln});case"CourseProgress":return e.jsx(OA,{courses:on,traineesData:xe,courseColors:kt,scores:nt,traineeLMPs:ot,onUpdateGradDate:$l,onUpdateStartDate:pc});case"TrainingRecords":return e.jsx(_D,{courses:on,courseColors:kt,archivedCourses:ht,onAddCourse:ha,onDeleteCourse:ma,onNavigateToCourseRoster:Qi,onNavigateToArchivedCourses:yd,traineesData:xe,instructorsData:K,archivedTraineesData:ce,archivedInstructorsData:ye,events:T,scores:nt,publishedSchedules:Et,syllabusDetails:be,pt051Assessments:xt,onSavePT051Assessment:si});case"ArchivedCourses":return e.jsx(ID,{archivedCourses:ht,onUnarchiveCourse:Kc,onDeleteCourse:gc,onNavigateBack:()=>xs("TrainingRecords")});case"ProgramData":return e.jsx(Yw,{date:ze,events:Kt.map(q=>({...q,date:ze})),instructorsData:K,traineesData:xe,activeCourses:Ht,onNavigateAndSelectPerson:q=>{const te=[...K,...xe].find(le=>le.name===q||"fullName"in le&&le.fullName===q);te&&("role"in te?Jo(q):za(q))},scores:nt,syllabusDetails:be,traineeLMPs:ot,courseColors:kt});case"BuildAnalysis":return e.jsx(Qw,{buildDate:ze,analysis:Mn});case"MyDashboard":const I=[];return Object.values(Et).forEach(q=>{I.push(...q)}),e.jsx(Bw,{userName:Fe!=null&&Fe.name?Fe.name.split(", ").reverse().join(" "):"Joe Bloggs",userRank:(Fe==null?void 0:Fe.rank)||"FLTLT",events:qs.filter(q=>q.instructor===_e),onSelectEvent:ws,onNavigate:xs,onSelectMyProfile:mr,onSelectMyCurrency:$n,onSelectMySct:Tn,sctRequests:[...xn,...Es],pt051Assessments:xt,onSelectPt051:q=>{console.log("ðŸ” Dashboard PT-051 clicked:",q),console.log("Looking for event ID:",q.eventId),console.log("Total events available:",I.length);const te=I.find(Ue=>Ue.id===q.eventId);console.log("Found event:",te);const le=xe.find(Ue=>Ue.fullName===q.traineeFullName);if(console.log("Found trainee:",le),te&&le)console.log("âœ… Setting event and trainee, navigating to PT051"),Nr(te),Aa(le),setTimeout(()=>{console.log("ðŸš€ Navigating to PT051 view"),xs("PT051")},0);else{console.error("âŒ Could not find event or trainee for PT-051:",{assessment:q,eventFound:!!te,traineeFound:!!le,searchingForEventId:q.eventId,availableEventIds:I.map(Ie=>Ie.id).slice(0,10),availableTrainees:xe.map(Ie=>Ie.fullName).slice(0,10),eventsForSameFlightNumber:I.filter(Ie=>Ie.flightNumber===q.flightNumber).map(Ie=>({id:Ie.id,date:Ie.date,instructor:Ie.instructor}))}),console.log("ðŸ”„ Attempting fallback search..."),console.log("Searching for:",{flightNumber:q.flightNumber,date:q.date,instructor:q.instructorName});const Ue=I.find(Ie=>Ie.flightNumber===q.flightNumber&&Ie.date===q.date&&Ie.instructor===q.instructorName);if(console.log("Fallback result:",Ue),Ue&&le)console.log("âœ… Found event using fallback (flight number + date + instructor):",Ue),Nr(Ue),Aa(le),setTimeout(()=>{console.log("ðŸš€ Navigating to PT051 view (fallback)"),xs("PT051")},0);else{console.error("âŒ Primary fallback failed",{fallbackEventFound:!!Ue,traineeFound:!!le,matchingFlightNumbers:I.filter(he=>he.flightNumber===q.flightNumber).length,matchingDates:I.filter(he=>he.date===q.date).length,matchingInstructors:I.filter(he=>he.instructor===q.instructorName).length}),console.log("ðŸ”„ Attempting secondary fallback (flight number + instructor only)...");const Ie=I.find(he=>he.flightNumber===q.flightNumber&&he.instructor===q.instructorName);if(Ie&&le)console.log("âœ… Found event using secondary fallback:",Ie),console.warn("âš ï¸ Note: Event date may differ from PT-051 date"),Nr(Ie),Aa(le),setTimeout(()=>{console.log("ðŸš€ Navigating to PT051 view (secondary fallback)"),xs("PT051")},0);else{console.error("âŒ All fallback attempts failed - cannot open PT-051"),console.log("ðŸ”§ Creating mock event as last resort...");let he="flight";const qe=q.flightNumber||"";qe.includes("CPT")||qe.includes("Cpt")?he="cpt":(qe.includes("MB")||qe.includes("GS")||qe.includes("Ground")||qe.includes("GROUND"))&&(he="ground");const dt={id:q.eventId,flightNumber:q.flightNumber,date:q.date,startTime:"08:00",endTime:"09:00",instructor:q.instructorName||"Unknown",student:q.traineeFullName,syllabus:q.flightNumber,aircraft:"",type:he,status:"Scheduled",notes:"",crew:[]};le&&(console.log("âœ… Created mock event:",dt),Nr(dt),Aa(le),setTimeout(()=>{console.log("ðŸš€ Navigating to PT051 view (mock event)"),xs("PT051")},0))}}}}});case"SupervisorDashboard":return e.jsx(Hw,{instructorsData:K,traineesData:xe,date:x,events:qs,onNavigate:xs,onOpenAuth:q=>{const te=T.find(le=>le.id===q.id)||q;hr(te),Ha(!0)}});case"Instructors":return e.jsx(hS,{onClose:()=>xs("Program Schedule"),events:T,traineesData:xe,instructorsData:K,archivedInstructorsData:ye,school:X,personnelData:bi,onUpdateInstructor:q=>{ue(te=>te.some(Ue=>Ue.idNumber===q.idNumber)?te.map(Ue=>Ue.idNumber===q.idNumber?q:Ue):[...te,q])},onNavigateToCurrency:Ns,onBulkUpdateInstructors:vd,onArchiveInstructor:q=>{const te=K.find(le=>le.idNumber===q);te&&(ue(le=>le.filter(Ue=>Ue.idNumber!==q)),Le(le=>[...le,te]))},onRestoreInstructor:q=>{const te=ye.find(le=>le.idNumber===q);te&&(Le(le=>le.filter(Ue=>Ue.idNumber!==q)),ue(le=>[...le,te]))},locations:jr,units:Wo,selectedPersonForProfile:rn,onProfileOpened:()=>gt(null),onViewLogbook:qi,onRequestSct:q=>{Fr(q),Pi(!0)}});case"Trainees":return e.jsx(mS,{onClose:()=>xs("Program Schedule"),events:T,traineesData:xe,instructorsData:K,archivedTraineesData:ce,school:X,personnelData:bi,onUpdateTrainee:q=>{pe(te=>te.some(Ue=>Ue.idNumber===q.idNumber)?te.map(Ue=>Ue.idNumber===q.idNumber?q:Ue):[...te,q])},onNavigateToCurrency:Ns,onBulkUpdateTrainees:Nd,onArchiveTrainee:q=>{const te=xe.find(le=>le.idNumber===q);te&&(He(le=>[...le,te]),pe(le=>le.filter(Ue=>Ue.idNumber!==q)))},selectedPersonForProfile:rn,onProfileOpened:()=>gt(null),onViewLogbook:qi,onRequestSct:q=>{Ri(q),Pi(!0)}});case"Syllabus":return e.jsx(xS,{syllabusDetails:be,onBack:()=>{xs(Bi),or(null)},initialSelectedId:ji||void 0,onUpdateItem:Ol});case"TraineeLMP":if($r){const q=nt.get($r.fullName)||[];let te=ot.get($r.fullName);if(!te&&$r.lmpType){console.log(`[DEBUG] TraineeLMP view - Initializing missing LMP for ${$r.fullName}`);const le=be.filter(Ue=>Ue.courses.includes($r.lmpType));le.length>0?(Vt(Ue=>{const Ie=new Map(Ue);return Ie.set($r.fullName,[...le]),console.log(`[Individual LMP] Emergency initialized ${$r.fullName}'s Individual LMP with ${$r.lmpType} (${le.length} events)`),Ie}),te=le):console.warn(`[Individual LMP] No Master LMP found for LMP type: ${$r.lmpType}`)}if(te)return e.jsx(MA,{trainee:$r,traineeLmp:te,scores:q,onBack:()=>{gt($r),xs("CourseRoster")}})}return e.jsx("div",{children:"Error: Could not load trainee LMP."});case"Currency":return $i?e.jsx(bS,{person:$i,masterCurrencies:Ei,currencyRequirements:la,allEvents:T,syllabusDetails:be,onClose:Ar,onUpdateCurrencyStatus:(q,te)=>{"role"in $i?ue(Ue=>Ue.map(Ie=>Ie.idNumber===q?{...Ie,currencyStatus:te}:Ie)):pe(Ue=>Ue.map(Ie=>Ie.idNumber===q?{...Ie,currencyStatus:te}:Ie))},registerDirtyCheck:xo}):null;case"Settings":return e.jsx(jA,{locations:jr,onUpdateLocations:Ga,units:Wo,onUpdateUnits:Yc,unitLocations:pd,onUpdateUnitLocations:xd,instructorsData:K,traineesData:xe,syllabusDetails:be,onBulkUpdateInstructors:vd,onReplaceInstructors:fu,onBulkUpdateTrainees:Nd,onReplaceTrainees:Rr,onUpdateSyllabus:bl,onShowSuccess:$s,eventLimits:Pt,onUpdateEventLimits:yn,phraseBank:Tt,onUpdatePhraseBank:lt,onNavigate:xs,masterCurrencies:Ei,currencyRequirements:la,sctEvents:Ir,onUpdateSctEvents:Vo,preferredDutyPeriod:ss,onUpdatePreferredDutyPeriod:Hn,maxCrewDutyPeriod:Jn,onUpdateMaxCrewDutyPeriod:zn,flightTurnaround:Qn,onUpdateFlightTurnaround:as,ftdTurnaround:cs,onUpdateFtdTurnaround:rs,cptTurnaround:Ms,onUpdateCptTurnaround:hs,currentUserPermission:Ke,maxDispatchPerHour:Fn,onUpdateMaxDispatchPerHour:Rn,timezoneOffset:s,onUpdateTimezoneOffset:i,formationCallsigns:Jc,onUpdateFormationCallsigns:Xc,courseColors:kt,setCourseColors:Ge,onUpdateTraineeLMPs:Vt,cancellationRecords:xi,cancellationCodes:so,dayFlyingStart:`${Math.floor(Ce).toString().padStart(2,"0")}:${Math.round(Ce%1*60).toString().padStart(2,"0")}`,dayFlyingEnd:`${Math.floor(B).toString().padStart(2,"0")}:${Math.round(B%1*60).toString().padStart(2,"0")}`,totalAircraft:24});case"CurrencyBuilder":return e.jsx(U5,{onBack:()=>xs("Settings"),masterCurrencies:Ei,currencyRequirements:la,onSave:Qt,onDelete:mn});case"PT051":if(console.log("eventForPt051:",vr),console.log("selectedTraineeForHateSheet:",Ks),vr&&Ks){const q=`pt051-${vr.id}-${Ks.fullName}`;console.log("Looking for assessment with key:",q),console.log("Available assessment keys:",Array.from(xt.keys()));let te=xt.get(q);return console.log("Direct lookup result:",te),te||(console.log("Direct lookup failed, trying fallback search..."),te=Array.from(xt.values()).find(le=>le.eventId===vr.id&&le.traineeFullName===Ks.fullName),console.log("Fallback search result:",te)),e.jsx(tA,{trainee:Ks,event:vr,initialAssessment:te,onBack:()=>{xs("HateSheet")},onEventUpdate:le=>{console.log("Updating eventForPt051 with:",le),Nr(le),E(Ue=>Ue.some(he=>he.id===le.id)?Ue.map(he=>he.id===le.id?le:he):Ue)},onDeleteAssessment:le=>{console.log("ðŸ—‘ï¸ App.tsx: onDeleteAssessment called with ID:",le);const Ue=`pt051-${vr.id}-${Ks.fullName}`;console.log("ðŸ—‘ï¸ App.tsx: Deleting assessment with key:",Ue),dn(Ie=>{const he=new Map(Ie),qe=he.delete(Ue);return console.log("ðŸ—‘ï¸ App.tsx: Assessment deleted from map:",qe),he}),console.log("ðŸ“‹ App.tsx: Logging to audit..."),Pn("Performance History","Delete",`Deleted PT-051 for ${Ks.fullName} - Event: ${vr.flightNumber} (${vr.date})`),console.log("âœ… App.tsx: Audit logged successfully"),$s("PT-051 Assessment Deleted!")},onSave:(le,Ue)=>{const Ie={...le,isCompleted:Ue?le.isCompleted:!0},he=`pt051-${vr.id}-${Ks.fullName}`;if(dn(qe=>new Map(qe).set(he,Ie)),!Ue){$s("PT-051 Assessment Saved!");const qe=[le.overallGrade?`Overall Grade: ${le.overallGrade}`:null,le.overallResult?`Overall Result: ${le.overallResult}`:null,le.dcoResult?`DCO Result: ${le.dcoResult}`:null,le.overallComments?`Comments: ${le.overallComments.substring(0,50)}...`:null].filter(Boolean).join(", ");Pn("Performance History","Edit",`Modified PT-051 for ${le.traineeFullName} - Event: ${le.flightNumber} (${le.date})`,qe)}},instructors:K,pt051Assessments:xt,events:T,lmpScores:nt.get(Ks.fullName)||[],syllabusDetails:be,registerDirtyCheck:xo,phraseBank:Tt,currentUserPin:(Fe==null?void 0:Fe.pin)||"1111"})}return console.error("âŒ PT051 View Error - Missing context:",{eventForPt051:vr,selectedTraineeForHateSheet:Ks,view}),e.jsxs("div",{className:"p-8 bg-gray-900 text-white",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-500 mb-4",children:"Error: PT-051 View Context Missing"}),e.jsxs("p",{className:"mb-2",children:["Trainee: ",Ks?"âœ… Set":"âŒ Not Set"]}),e.jsxs("p",{className:"mb-2",children:["Event: ",vr?"âœ… Set":"âŒ Not Set"]}),e.jsx("button",{onClick:()=>xs("MyDashboard"),className:"mt-4 px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700",children:"Back to Dashboard"})]});case"PostFlight":return ka?e.jsx(kA,{event:ka,onReturn:()=>{Jr(null),xs("Program Schedule")},onSave:q=>{console.log("Post flight data saved:",q),Jr(null),xs("Program Schedule"),$s("Post-flight data saved!")},school:X,traineesData:xe,instructorsData:K}):null;case"Logbook":return Ps?e.jsx(D5,{person:Ps,events:T,onBack:()=>{"role"in Ps?(gt(Ps),xs("Instructors")):(gt(Ps),xs("CourseRoster"))}}):null;case"AUTH":return e.jsx(EA,{});default:return e.jsx("div",{children:"View not found"})}};return e.jsxs("div",{id:"app-content",className:"flex h-screen bg-gray-900 text-white",children:[e.jsx(J5,{activeView:f,onNavigate:xs,courseColors:kt,onAddCourse:I=>Ge(q=>({...q,[I.number]:I.color})),onArchiveCourse:I=>{const q=kt[I];if(q){const te={...kt};delete te[I],Ge(te),vt(le=>({...le,[I]:q}))}},onNextDayBuildClick:()=>{xs("NextDayBuild")},onBuildDfpClick:Po,isSupervisor:!0,onPublish:Xo,currentUserName:_e,currentUserRank:(Fe==null?void 0:Fe.rank)||"FLTLT",instructorsList:K.map(I=>({name:I.name,rank:I.rank,unit:I.unit,pin:I.pin||"1111"})),onUserChange:tt}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[f!=="PostFlight"&&e.jsx(X5,{onAddTile:()=>{Ji(!0),ws(null,{type:"flight"})},onAddGroundEvent:()=>En(!0),showValidation:U,setShowValidation:D,locations:["ESL","PEA"],activeLocation:X,onLocationChange:I=>Mo(I),isMagnifierEnabled:P,setIsMagnifierEnabled:ae,isMultiSelectMode:Q,setIsMultiSelectMode:b,isOracleMode:Qr,onToggleOracleMode:On,showDepartureDensityOverlay:o,onToggleDepartureDensityOverlay:()=>l(!o),showAircraftAvailability:gs,onToggleAircraftAvailability:f==="Program Schedule"?()=>Os(!gs):void 0}),us()]}),P&&e.jsx(sS,{isEnabled:P}),A&&e.jsx(Iw,{event:Oe&&F?F:A,onClose:()=>{_(null),en(null),Ji(!1)},onSave:I=>ga(I,sa),onDeleteRequest:Zc,isEditingDefault:R,instructors:K.map(I=>I.name),trainees:xe.map(I=>I.fullName),syllabus:(console.log("addTileSyllabusOptions length:",Bl.length),console.log("syllabusForModal length:",ri.length),Oi?Bl:ri),syllabusDetails:be,highlightedField:O,school:X,traineesData:xe,instructorsData:K,courseColors:kt,eventsForDate:qs,onNavigateToHateSheet:I=>{Aa(I),xs("HateSheet")},onNavigateToSyllabus:I=>{Yo(I)},onOpenPt051:I=>{Nr(A),Aa(I),Pn("Flight Detail","View",`Viewed PT-051 for ${I.fullName} - Event: ${A.flightNumber} (${A.date})`),xs("PT051")},onOpenAuth:I=>{const q=T.find(te=>te.id===I.id)||I;hr(q),Ha(!0)},onOpenPostFlight:I=>{Jr(I),xs("PostFlight"),_(null)},onScoresCreated:I=>{console.log("App.tsx: onScoresCreated called with:",I);const q=new Map(nt);I.forEach(te=>{console.log("Adding score for trainee:",te.traineeName);const le=q.get(te.traineeName)||[];le.push(te),q.set(te.traineeName,le)}),console.log("Updated scores map:",q),Ct(q),console.log("Scores state updated successfully")},isConflict:ua.has(A.id)||(["NextDayBuild","Priorities","ProgramData"].includes(f)?po:Kr).has(A.id),onNeoClick:ve,traineeLMPs:ot,oracleContextForModal:an,sctRequests:[...xn,...Es],sctEvents:Ir,publishedSchedules:Et,nextDayBuildEvents:Kt,activeView:f,isAddingTile:Oi,formationCallsigns:Jc,currentLocation:X==="ESL"?"East Sale":"Pearce",onVisualAdjustStart:yo,onVisualAdjustEnd:ui,onSavePT051Assessment:si,cancellationCodes:so,onCancelEvent:Fo},`${A.id}-${A.instructor||"no-instructor"}`),ne&&e.jsx(Lw,{conflict:ne,onResolve:()=>{},onCancel:()=>V(null)}),Bs&&!De&&!pt&&e.jsx(FD,{problemTile:Bs,remedies:Ea,onApplyRemedy:Se,onCancel:zt}),pt&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[80] flex items-center justify-center animate-fade-in",onClick:()=>Jt(!1),children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-sky-500/50",onClick:I=>I.stopPropagation(),children:[e.jsx("div",{className:"p-4 border-b border-gray-700 bg-sky-900/20",children:e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Resolution Options"})}),e.jsxs("div",{className:"p-6 space-y-4 text-center",children:[e.jsxs("p",{className:"text-gray-300",children:["NEO has found multiple ways to resolve the conflict for ",e.jsx("span",{className:"font-bold text-white",children:Bs==null?void 0:Bs.event.flightNumber}),". Please choose an option:"]}),e.jsxs("div",{className:"flex justify-center space-x-4 pt-4",children:[e.jsxs("button",{onClick:it,className:"px-6 py-3 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors font-semibold shadow-lg w-1/2",children:[e.jsx("span",{className:"text-lg",children:"Time Shift"}),e.jsx("span",{className:"block text-xs text-sky-200",children:"Keep crew, change time"})]}),e.jsxs("button",{onClick:_t,className:"px-6 py-3 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors font-semibold shadow-lg w-1/2",children:[e.jsx("span",{className:"text-lg",children:"Change Crew"}),e.jsx("span",{className:"block text-xs text-amber-200",children:"Keep time, change instructor"})]})]})]})]})}),De&&k&&Bs&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[80] flex items-center justify-center animate-fade-in",onClick:Me,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-sky-500/50",onClick:I=>I.stopPropagation(),children:[e.jsx("div",{className:"p-4 border-b border-gray-700 bg-sky-900/20",children:e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Confirm Time Change"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Current Start Time:"}),e.jsx("span",{className:"text-white font-mono font-bold",children:jh(Bs.event.startTime)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Conflict Cause:"}),e.jsx("span",{className:"text-amber-400 text-sm font-medium text-right",children:Bs.errors.some(I=>I.toLowerCase().includes("previous"))?"Prior event turnaround":Bs.errors.some(I=>I.toLowerCase().includes("next"))?"Next event turnaround":"Scheduling conflict"})]})]}),e.jsxs("div",{className:"text-center pt-2",children:[e.jsx("p",{className:"text-gray-300 mb-2 text-sm",children:"Proposed New Start Time"}),e.jsx("div",{className:"text-4xl font-bold text-green-400 font-mono tracking-wider",children:jh(k.newStartTime)})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:Me,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:"Cancel"}),e.jsx("button",{onClick:ut,className:"px-4 py-2 bg-transparent border border-gray-500 text-gray-300 hover:bg-gray-700 hover:text-white rounded-md transition-colors text-sm font-semibold",children:"Change Crew Instead"}),e.jsx("button",{onClick:wt,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold",children:"Accept Time Change"})]})]})}),Ui&&di&&e.jsx(OD,{onConfirm:Pe,onCancel:()=>ao(!1),instructorName:di.type!=="trainee"?di.instructor.name:"",dutyHours:di.type!=="trainee"?di.instructor.dutyHours:0}),Do&&e.jsx(BD,{message:Do,onClose:()=>yi(null)}),ro&&e.jsx(LD,{traineeCount:Ao}),_n&&e.jsx(eS,{progress:Cs}),Cr&&e.jsx(tS,{onConfirm:pa,onCancel:()=>Fs(!1),date:ze}),Ds.length>0&&e.jsx(nS,{notifications:Ds,onDismiss:()=>Js([])}),vn&&e.jsx(yS,{date:ze,onConfirm:Ro,onCancel:()=>Un(!1)}),ps&&e.jsx(AA,{locality:X}),ar&&e.jsx(rS,{message:ar,onClose:()=>$s(null)}),co&&$i&&e.jsx(vS,{onClose:()=>qa(!1),allCurrencies:[...Ei,...la],visibleCurrencies:new Set([...Ei,...la].filter(I=>I.isVisible).map(I=>I.name)),onVisibilityChange:I=>{Io(q=>q.map(te=>({...te,isVisible:I.has(te.name)}))),Da(q=>q.map(te=>({...te,isVisible:I.has(te.name)})))},personName:$i.name}),uo&&e.jsx(Pv,{onSaveAndExit:()=>Zi("save"),onExitWithoutSaving:()=>Zi("discard"),onCancel:fa}),_s&&e.jsx(Fw,{onClose:()=>En(!1),onSave:L,groundSyllabus:be.filter(I=>I.type==="Ground School"),activeCourses:kt,allTraineesByCourse:S,instructors:K.map(I=>I.name),traineesData:xe}),oo&&zo&&e.jsx(sA,{event:zo,onClose:()=>Ha(!1),onAuthorise:bd,onClearAuth:I=>{E(q=>q.map(te=>{if(te.id===I){const{authoSignedBy:le,authoSignedAt:Ue,captainSignedBy:Ie,captainSignedAt:he,isVerbalAuth:qe,...dt}=te;return{...dt,authNotes:""}}return te})),Bt(q=>Object.fromEntries(Object.entries(q).map(([te,le])=>[te,le.map(Ue=>{if(Ue.id===I){const{authoSignedBy:Ie,authoSignedAt:he,captainSignedBy:qe,captainSignedAt:dt,isVerbalAuth:at,...Nt}=Ue;return{...Nt,authNotes:""}}return Ue})]))),hr(null),Ha(!1)},instructorsList:K,currentUserName:_e,currentUserRank:(Fe==null?void 0:Fe.rank)||"",currentUserUnit:Fe==null?void 0:Fe.unit}),ei&&aa&&e.jsx(FA,{trainee:aa,instructors:K,scores:nt.get(aa.fullName)||[],traineeLmp:ot.get(aa.fullName)||[],onClose:()=>Yr(!1),onSave:Rl}),li&&e.jsx(UD,{isOpen:li,onClose:()=>Mi(!1),date:x,instructors:K,trainees:xe,events:qs}),ir&&Oa&&e.jsx($D,{instructor:Oa,onClose:()=>Pi(!1),onSave:I=>{I.event.includes("FTD")?Zs(q=>[...q,I]):ls(q=>[...q,I]),Pi(!1),$s(`SCT request submitted for ${Oa.name}`)},currencyNames:["Instrument","Night","Multi-Engine","Formation"],sctEvents:Ir}),ge&&e.jsx(Av,{type:ge.type,title:ge.title,message:ge.message,variant:ge.variant,onConfirm:ge.onConfirm,onCancel:ge.onCancel,confirmText:ge.confirmText,cancelText:ge.cancelText})]})};console.log("Starting app initialization...");console.log("React imported");console.log("ReactDOM imported");console.log("App imported");const wg=document.getElementById("root");console.log("Root element:",wg);if(!wg)throw new Error("Could not find root element to mount to");const g_=Nv.createRoot(wg);class p_ extends Ua.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,s){console.error("Error caught by boundary:",t,s)}render(){var t;return this.state.hasError?e.jsxs("div",{style:{padding:"20px",color:"white",backgroundColor:"#1f2937"},children:[e.jsx("h1",{children:"Something went wrong."}),e.jsx("pre",{style:{color:"#ef4444",whiteSpace:"pre-wrap"},children:(t=this.state.error)==null?void 0:t.toString()}),e.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"10px",padding:"10px",cursor:"pointer"},children:"Reload Page"})]}):this.props.children}}g_.render(e.jsx(Ua.StrictMode,{children:e.jsx(p_,{children:e.jsx(m_,{})})}));export{br as _,y_ as c,ng as g};
public/flight-school-app/assets/index-BCojCDFQ.js: */var vy;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(vy||(vy={}));var Ny;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Ny||(Ny={}));var wy;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(wy||(wy={}));var $c;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})($c||($c={}));var Sy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Sy||(Sy={}));var Cy;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Cy||(Cy={}));var Ty;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Ty||(Ty={}));var jy;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(jy||(jy={}));var Ey;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Ey||(Ey={}));var Ay;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(Ay||(Ay={}));var ky;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(ky||(ky={}));var Dy;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Dy||(Dy={}));var _y;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(_y||(_y={}));var Iy;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(Iy||(Iy={}));var Ly;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Ly||(Ly={}));var My;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(My||(My={}));var Fy;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Fy||(Fy={}));var Py;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(Py||(Py={}));var Ry;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Ry||(Ry={}));var sf;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(sf||(sf={}));var Uy;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Uy||(Uy={}));var By;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(By||(By={}));var Oy;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Oy||(Oy={}));var Mm;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Mm||(Mm={}));var $y;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})($y||($y={}));var Hy;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Hy||(Hy={}));var qy;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(qy||(qy={}));var Gy;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(Gy||(Gy={}));var zy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(zy||(zy={}));var Vy;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Vy||(Vy={}));var Wy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(Wy||(Wy={}));var Yy;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Yy||(Yy={}));var Jy;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(Jy||(Jy={}));var Xy;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(Xy||(Xy={}));var Ky;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Ky||(Ky={}));var Zy;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Zy||(Zy={}));var Qy;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Qy||(Qy={}));var e1;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(e1||(e1={}));var t1;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(t1||(t1={}));var n1;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(n1||(n1={}));var s1;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(s1||(s1={}));var r1;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(r1||(r1={}));var i1;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(i1||(i1={}));var a1;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(a1||(a1={}));var o1;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(o1||(o1={}));var l1;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(l1||(l1={}));var c1;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(c1||(c1={}));var d1;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(d1||(d1={}));var u1;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(u1||(u1={}));var f1;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(f1||(f1={}));var h1;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(h1||(h1={}));var m1;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(m1||(m1={}));var g1;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(g1||(g1={}));var p1;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(p1||(p1={}));var Zd;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Zd||(Zd={}));class Fm{constructor(t){const s={};for(const i of t.headers.entries())s[i[0]]=i[1];this.headers=s,this.responseInternal=t}json(){return this.responseInternal.json()}}class Wu{get text(){var t,s,i,o,l,d,u,f;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",m=!1;const v=[];for(const x of(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)!==null&&f!==void 0?f:[]){for(const[y,T]of Object.entries(x))y!=="text"&&y!=="thought"&&y!=="thoughtSignature"&&(T!==null||T!==void 0)&&v.push(y);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;m=!0,h+=x.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),m?h:void 0}get data(){var t,s,i,o,l,d,u,f;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const m=[];for(const v of(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)!==null&&f!==void 0?f:[]){for(const[x,y]of Object.entries(v))x!=="inlineData"&&(y!==null||y!==void 0)&&m.push(x);v.inlineData&&typeof v.inlineData.data=="string"&&(h+=atob(v.inlineData.data))}return m.length>0&&console.warn(`there are non-data parts ${m} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var t,s,i,o,l,d,u,f;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(m=>m.functionCall).map(m=>m.functionCall).filter(m=>m!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var t,s,i,o,l,d,u,f,h;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const m=(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(h=m==null?void 0:m[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var t,s,i,o,l,d,u,f,h;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const m=(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(h=m==null?void 0:m[0])===null||h===void 0?void 0:h.output}}class x1{}class y1{}class OS{}class $S{}class HS{}class qS{}class b1{}class v1{}class N1{}class GS{}class yh{_fromAPIResponse({apiResponse:t,_isVertexAI:s}){const i=new yh;let o;const l=t;return s?o=AS(l):o=ES(l),Object.assign(i,o),i}}class w1{}class S1{}class C1{}class zS{}class VS{}class WS{}class dg{_fromAPIResponse({apiResponse:t,_isVertexAI:s}){const i=new dg,l=FS(t);return Object.assign(i,l),i}}class YS{}class JS{}class XS{}class T1{}class KS{get text(){var t,s,i;let o="",l=!1;const d=[];for(const u of(i=(s=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&i!==void 0?i:[]){for(const[f,h]of Object.entries(u))f!=="text"&&f!=="thought"&&h!==null&&d.push(f);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;l=!0,o+=u.text}}return d.length>0&&console.warn(`there are non-text parts ${d} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?o:void 0}get data(){var t,s,i;let o="";const l=[];for(const d of(i=(s=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&i!==void 0?i:[]){for(const[u,f]of Object.entries(d))u!=="inlineData"&&f!==null&&l.push(u);d.inlineData&&typeof d.inlineData.data=="string"&&(o+=atob(d.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class ZS{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class ug{_fromAPIResponse({apiResponse:t,_isVertexAI:s}){const i=new ug,l=Rv(t);return Object.assign(i,l),i}}/**
public/flight-school-app/assets/index-BCojCDFQ.js:This is a hard rule that cannot be violated. The event will not be saved.`,"Day/Night Separation Violation","error"),console.log("SAVE BLOCKED - Day/Night separation violation:",Sn.reason);return}}}const te=I[0],le=!te.resourceId,Ue=!!an,Ie=!le&&["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f);if(q&&!Ie){const Ut={...te,isTimeFixed:te.isTimeFixed??!0};vs(In=>{const An=In.findIndex(Sn=>Sn.id===Ut.id);if(An>-1){const Sn=[...In];return Sn[An]=Ut,Sn}return[...In,Ut]})}else{let Ut=!1;if(Ue)Ut=Cn==="nextDayBuild";else{const In=["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f);Ut=te.date===Ve&&In,te.eventCategory==="sct"&&console.log("ðŸ” SCT Save Decision:",{activeView:f,isNextDayView:In,mainEventDate:te.date,buildDfpDate:Ve,datesMatch:te.date===Ve,saveToNextDayBuild:Ut})}if(Ut){if(le){const Ln=[];I.forEach(bn=>{if(!bn.resourceId||bn.type==="deployment"){const Gn=[...Kt.map(bs=>({...bs,date:Ve})),...Ln];bn.resourceId=cr(bn,Gn),Ln.push(bn)}})}const In=new Set(I.map(Ln=>Ln.id)),An=Kt.filter(Ln=>!In.has(Ln.id)),Sn=I.map(({date:Ln,...bn})=>bn);I.forEach(Ln=>{Ln.eventCategory==="sct"&&console.log("ðŸ”„ Updating SCT event in nextDayBuildEvents:",{id:Ln.id,student:Ln.student,pilot:Ln.pilot,flightType:Ln.flightType})}),Mt([...An,...Sn])}else{if(le){const In=[];I.forEach(An=>{if(!An.resourceId||An.type==="deployment"){const Ln=[...Et[te.date]||[],...In],bn=cr(An,Ln);console.log(`Assigning resourceId to ${An.type} event:`,bn),An.resourceId=bn,In.push(An)}})}Bt(In=>{console.log("ðŸŸ¢ setPublishedSchedules: START"),console.log("ðŸŸ¢ Previous publishedSchedules keys:",Object.keys(In));const An={...In},Sn=new Map;return I.forEach(Ln=>{const bn=Ln.date;Sn.has(bn)||Sn.set(bn,[]),Sn.get(bn).push(Ln)}),console.log("ðŸŸ¢ Events grouped by date:",Array.from(Sn.entries()).map(([Ln,bn])=>({date:Ln,count:bn.length,eventIds:bn.map(gn=>gn.id),instructors:bn.map(gn=>gn.instructor)}))),Sn.forEach((Ln,bn)=>{const gn=An[bn]||[];console.log(`ðŸŸ¢ Processing date ${bn}:`,{currentEventsCount:gn.length,eventsToSaveCount:Ln.length});const Gn=new Set(Ln.map(dr=>dr.id)),bs=gn.filter(dr=>!Gn.has(dr.id));console.log(`ðŸŸ¢ Filtered out ${gn.length-bs.length} existing events`),An[bn]=[...bs,...Ln],console.log(`ðŸŸ¢ Saved ${Ln.length} events to date ${bn}`),console.log(`ðŸŸ¢ New total for ${bn}:`,An[bn].length);const Ss=An[bn].find(dr=>dr.id===Ln[0].id);console.log("ðŸŸ¢ Saved event details:",{id:Ss==null?void 0:Ss.id,instructor:Ss==null?void 0:Ss.instructor,student:Ss==null?void 0:Ss.student,pilot:Ss==null?void 0:Ss.pilot})}),console.log("ðŸŸ¢ setPublishedSchedules: COMPLETE"),console.log("ðŸŸ¢ New publishedSchedules keys:",Object.keys(An)),An}),console.log("ðŸ“‹ Triggering PT-051 sync after Active DFP change..."),setTimeout(()=>{console.log("â° Executing delayed PT-051 sync..."),Bt(In=>(dn(An=>(pl(In,An),An)),In))},500)}}I.forEach(Ut=>{if(Ut.eventCategory==="lmp_currency"&&Ut.flightNumber){const In=Ut.flightType==="Dual"?Ut.student:Ut.pilot;In?Er(In,Ut.flightNumber):Ut.groupTraineeIds&&Ut.groupTraineeIds.length>0&&Ut.groupTraineeIds.forEach(An=>{const Sn=ye.find(Ln=>Ln.idNumber===An);Sn&&Er(Sn.fullName,Ut.flightNumber)})}});const qe=te.date===Ve&&["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f);I.forEach(Ut=>{var Ln;const In=qe?"Next Day Build":"Program Schedule",An=Ut.type||"event",Sn=Ut.student||Ut.pilot||Ut.instructor||"Unknown";if(le){const bn=`Added ${An} event for ${Sn}`,gn=`Event: ${Ut.syllabusItem||Ut.flightNumber||An}, Time: ${Ut.startTime}, Duration: ${Ut.duration}hrs, Resource: ${Ut.resourceId}`;Pn(In,"Add",bn,gn)}else{const bn=((Ln=Et[Ut.date])==null?void 0:Ln.find(gn=>gn.id===Ut.id))||Kt.find(gn=>gn.id===Ut.id);if(bn){const gn=[];if(Ut.instructor!==bn.instructor&&gn.push(`Instructor: ${bn.instructor||"None"} â†’ ${Ut.instructor||"None"}`),Ut.pilot!==bn.pilot&&gn.push(`Pilot: ${bn.pilot||"None"} â†’ ${Ut.pilot||"None"}`),Ut.student!==bn.student&&gn.push(`Student: ${bn.student||"None"} â†’ ${Ut.student||"None"}`),Ut.syllabusItem!==bn.syllabusItem&&gn.push(`LMP Event: ${bn.syllabusItem||"None"} â†’ ${Ut.syllabusItem||"None"}`),Ut.flightNumber!==bn.flightNumber&&gn.push(`Flight Number: ${bn.flightNumber||"None"} â†’ ${Ut.flightNumber||"None"}`),Ut.area!==bn.area&&gn.push(`Area: ${bn.area||"None"} â†’ ${Ut.area||"None"}`),Ut.startTime!==bn.startTime&&gn.push(`Start time: ${t(bn.startTime)} â†’ ${t(Ut.startTime)}`),Ut.duration!==bn.duration&&gn.push(`Duration: ${bn.duration}hrs â†’ ${Ut.duration}hrs`),Ut.resourceId!==bn.resourceId&&gn.push(`Resource: ${bn.resourceId} â†’ ${Ut.resourceId}`),Ut.type!==bn.type&&gn.push(`Type: ${bn.type} â†’ ${Ut.type}`),gn.length>0){const Gn=`Modified ${An} event for ${Sn}`;Pn(In,"Edit",Gn,gn.join(", "))}}else{const gn=`Modified ${An} event for ${Sn}`,Gn=`Event: ${Ut.syllabusItem||Ut.flightNumber||An}, Time: ${Ut.startTime}, Duration: ${Ut.duration}hrs, Resource: ${Ut.resourceId}`;Pn(In,"Edit",gn,Gn)}}}),console.log("ðŸ”µ Setting selectedEvent to null (closing modal)"),_(null),en(null),Ue&&(Fi(!1),mt(null),Yt(null)),console.log("ðŸ”µ ========== handleSaveEvents END ==========")},Fo=(I,q,te)=>{if(!A)return;const le=A.date,Ue=[A.instructor,A.student,A.pilot].filter(Boolean).join(", "),Ie={eventId:A.id,cancellationCode:q,cancelledBy:`${Fe}`,cancelledAt:new Date().toISOString(),manualCodeEntry:te,eventDate:A.date,eventType:A.type==="ftd"?"ftd":"flight",resourceType:A.resourceId||"Unknown",eventName:A.flightNumber||A.syllabusItem||"N/A",personnelAffected:Ue||"N/A",notes:A.notes||""},he=[...xi,Ie];Ta(he),localStorage.setItem("cancellationRecords",JSON.stringify(he));const qe={...A,isCancelled:!0,cancellationCode:q,cancellationManualEntry:te,cancelledBy:`${Fe}`,cancelledAt:new Date().toISOString()},dt=le===Ve&&(f==="NextDayBuild"||f==="Priorities"||f==="ProgramData");dt?Mt(wn=>wn.map(Ut=>Ut.id===A.id?qe:Ut)):Bt(wn=>{const In=(wn[le]||[]).map(An=>An.id===A.id?qe:An);return{...wn,[le]:In}}),vs(wn=>wn.filter(Ut=>Ut.id!==A.id));const at=x;y(""),setTimeout(()=>y(at),100);const Nt=dt?"Next Day Build":"Program Schedule",Be=A.type||"event",Wt=A.student||A.pilot||A.instructor||"Unknown",tn=`Cancelled ${Be} event for ${Wt} (Code: ${q==="OTHER"&&te?te:q})`,Dn=`Event: ${A.syllabusItem||A.flightNumber||Be}, Time: ${A.startTime}, Duration: ${A.duration}hrs, Marked as cancelled`;Pn(Nt,"Cancel",tn,Dn),_(null)},Zc=()=>{if(!A)return;const I=A.date;vs(qe=>qe.filter(dt=>dt.id!==A.id));const q=I===Ve&&(f==="NextDayBuild"||f==="Priorities"||f==="ProgramData");q?Mt(qe=>qe.filter(dt=>dt.id!==A.id)):Bt(qe=>{const dt=(qe[I]||[]).filter(at=>at.id!==A.id);return{...qe,[I]:dt}}),q||(console.log("ðŸ“‹ Triggering PT-051 sync after event deletion..."),setTimeout(()=>{console.log("â° Executing delayed PT-051 sync after deletion..."),Bt(qe=>(dn(dt=>(pl(qe,dt),dt)),qe))},500));const te=q?"Next Day Build":"Program Schedule",le=A.type||"event",Ue=A.student||A.pilot||A.instructor||"Unknown",Ie=`Deleted ${le} event for ${Ue}`,he=`Event: ${A.syllabusItem||A.flightNumber||le}, Time: ${A.startTime}, Duration: ${A.duration}hrs`;Pn(te,"Delete",Ie,he),_(null)},yo=I=>{console.log("Visual Adjust Start - Event:",I),se(!0),J(I),console.log("Visual Adjust Mode set to true")},ui=I=>{se(!1),J(null),_(null)},_a=()=>{console.log("ðŸ“‹ Starting sync of priority events with SCT and remedial requests...");let I=0;const q=[...Ti];console.log("ðŸ” SCT Sync - buildDfpDate:",Ve);const te=xn.filter(he=>he.priority==="High"&&he.name.trim()!==""&&he.currency.trim()!==""),le=Es.filter(he=>he.priority==="High"&&he.name.trim()!==""&&he.currency.trim()!=="");console.log("ðŸ” Found HIGH priority SCT flights:",te.length,"| FTDs:",le.length),te.forEach(he=>{const qe=q.findIndex(at=>at.id===`sct-flight-${he.id}`),dt=Kt.find(at=>at.id===`sct-flight-${he.id}`);if(qe>-1){const at=be.find(Wt=>Wt.code===he.event),Nt=(at==null?void 0:at.duration)||1.5;let Be=8;if(he.requestedTime){const[Wt,Rt]=he.requestedTime.split(":").map(Number);Be=Wt+Rt/60}q[qe]={...q[qe],student:he.flightType==="Dual"?he.crewMember||"TBA":"",pilot:he.name,flightNumber:he.event,duration:Nt,startTime:Be,flightType:he.flightType,soloOrDual:he.flightType,currency:he.currency},console.log("ðŸ”„ Updated HIGH priority SCT flight:",he.event,"for",he.name,"at",he.requestedTime||"08:00")}else if(!dt){const at=be.find(Rt=>Rt.code===he.event);ye.find(Rt=>Rt.fullName===he.name);const Nt=(at==null?void 0:at.duration)||1.5;let Be=8;if(he.requestedTime){const[Rt,tn]=he.requestedTime.split(":").map(Number);Be=Rt+tn/60}const Wt={id:`sct-flight-${he.id}`,date:Ve,type:"flight",instructor:"",student:he.flightType==="Dual"?he.crewMember||"TBA":"",pilot:he.name,flightNumber:he.event,duration:Nt,startTime:Be,resourceId:"",color:"bg-red-500/50",flightType:he.flightType,soloOrDual:he.flightType,locationType:"Local",origin:X,destination:X,isTimeFixed:!0,isSct:!0,eventCategory:"sct",currency:he.currency};q.push(Wt),I++,console.log("âœ… Added HIGH priority SCT flight:",he.event,"for",he.name,"at",he.requestedTime||"08:00"),console.log("  - Event date:",Wt.date,"| isTimeFixed:",Wt.isTimeFixed,"| startTime:",Wt.startTime)}}),le.forEach(he=>{const qe=q.findIndex(at=>at.id===`sct-ftd-${he.id}`),dt=Kt.find(at=>at.id===`sct-ftd-${he.id}`);if(qe>-1){const at=be.find(Wt=>Wt.code===he.event),Nt=(at==null?void 0:at.duration)||1.5;let Be=8;if(he.requestedTime){const[Wt,Rt]=he.requestedTime.split(":").map(Number);Be=Wt+Rt/60}q[qe]={...q[qe],student:he.flightType==="Dual"?he.crewMember||"TBA":"",pilot:he.name,flightNumber:he.event,duration:Nt,startTime:Be,flightType:"Dual",soloOrDual:"Dual",currency:he.currency},console.log("ðŸ”„ Updated HIGH priority SCT FTD:",he.event,"for",he.name,"at",he.requestedTime||"08:00")}else if(!dt){const at=be.find(Rt=>Rt.code===he.event);ye.find(Rt=>Rt.fullName===he.name);const Nt=(at==null?void 0:at.duration)||1.5;let Be=8;if(he.requestedTime){const[Rt,tn]=he.requestedTime.split(":").map(Number);Be=Rt+tn/60}const Wt={id:`sct-ftd-${he.id}`,date:Ve,type:"ftd",instructor:"",student:he.flightType==="Dual"?he.crewMember||"TBA":"",pilot:he.name,flightNumber:he.event,duration:Nt,startTime:Be,resourceId:"",color:"bg-red-500/50",flightType:"Dual",soloOrDual:"Dual",locationType:"Local",origin:X,destination:X,isTimeFixed:!0,isSct:!0,eventCategory:"sct",currency:he.currency};console.log("âœ… Added HIGH priority SCT FTD:",he.event,"for",he.name,"at",he.requestedTime||"08:00"),console.log("  - Event date:",Wt.date,"| isTimeFixed:",Wt.isTimeFixed,"| startTime:",Wt.startTime),q.push(Wt),I++}}),console.log(`ðŸ” Checking ${ci.length} remedial requests for Force Schedule...`);const Ue=ci.filter(he=>he.forceSchedule);return console.log(`ðŸ“Œ Found ${Ue.length} Force Scheduled remedial events`),ci.forEach(he=>{if(he.forceSchedule){console.log(`ðŸ”Ž Processing Force Schedule remedial: traineeId=${he.traineeId}, eventCode=${he.eventCode}`);const qe=q.find(dt=>dt.flightNumber===he.eventCode&&dt.isRemedial);if(qe)console.log(`âš ï¸ Event already exists in priority list: ${he.eventCode}`);else if(!qe){const dt=ye.find(Be=>Be.idNumber===he.traineeId);let at=null;if(dt){const Be=ot.get(dt.fullName);Be&&(at=Be.find(Wt=>Wt.id===he.eventCode||Wt.code===he.eventCode),at&&console.log(`âœ… Found remedial event in Individual LMP: ${he.eventCode}`))}at||(at=be.find(Be=>Be.id===he.eventCode||Be.code===he.eventCode),at&&console.log(`âœ… Found event in master syllabus: ${he.eventCode}`));const Nt=(at==null?void 0:at.duration)||1.5;if(at||console.error(`âŒ Event not found in Individual LMP or master syllabus: ${he.eventCode}`),dt||console.error(`âŒ Trainee not found for ID: ${he.traineeId}`),dt&&at){const Be=at.resourcesHuman&&at.resourcesHuman.length>0?at.resourcesHuman[0]:"";console.log(`ðŸ“‹ Allocated instructor for ${at.code}: ${Be||"None"}`);const Wt={id:`remedial-${he.traineeId}-${he.eventCode}`,date:Ve,type:at.type==="FTD"?"ftd":at.type==="Ground School"?"ground":(at.type==="Flight","flight"),instructor:Be,student:dt.fullName,flightNumber:at.code,duration:Nt,startTime:8,resourceId:"",color:"bg-orange-500/50",flightType:at.sortieType==="Solo"?"Solo":"Dual",locationType:"Local",origin:X,destination:X,isTimeFixed:!0,isRemedial:!0};q.push(Wt),I++,console.log("âœ… Added Force Schedule remedial:",at.code,"for",dt.fullName)}}}}),I>0||JSON.stringify(q)!==JSON.stringify(Ti)?(vs(q),I>0?console.log(`\\ud83d\\udcca Priority Events Sync Complete: Added ${I} auto-generated events`):console.log("\\ud83d\\udd04 Priority Events Sync Complete: Updated existing events")):console.log("\\u2705 No changes to priority events"),q},pl=(I,q)=>{const te=I||Et,le=q||xt;console.log("ðŸ”„ Starting PT-051 sync with Active DFP..."),console.log("Published schedules keys:",Object.keys(te));const Ue=[];Object.values(te).forEach(Be=>{Ue.push(...Be)}),console.log("Total events on Active DFP:",Ue.length),console.log("Current PT-051 count:",le.size),console.log("Sample events:",Ue.slice(0,3).map(Be=>({id:Be.id,flightNumber:Be.flightNumber,date:Be.date,student:Be.student,pilot:Be.pilot,instructor:Be.instructor})));const Ie=new Map(le);let he=0,qe=0;Ue.forEach(Be=>{var In,An,Sn,Ln;const Wt=(In=Be==null?void 0:Be.flightNumber)==null?void 0:In.includes("Duty Sup"),Rt=(An=Be==null?void 0:Be.flightNumber)==null?void 0:An.toUpperCase().includes("STBY"),tn=((Sn=Be==null?void 0:Be.resourceId)==null?void 0:Sn.startsWith("STBY"))||((Ln=Be==null?void 0:Be.resourceId)==null?void 0:Ln.startsWith("BNF-STBY")),Dn=(Be==null?void 0:Be.type)==="deployment",wn=(Be==null?void 0:Be.type)==="flight"||(Be==null?void 0:Be.type)==="ftd"||(Be==null?void 0:Be.type)==="ground"||(Be==null?void 0:Be.type)==="cpt";if(Wt||Rt||tn||Dn||!wn){console.log("â­ï¸ Skipping event:",{flightNumber:Be==null?void 0:Be.flightNumber,type:Be==null?void 0:Be.type,resourceId:Be==null?void 0:Be.resourceId,date:Be==null?void 0:Be.date,reason:Wt?"DUTY SUP":Rt||tn?"STBY allocation":Dn?"Deployment":"Invalid event type"});return}const Ut=[];Be.student&&Ut.push(Be.student),Be.pilot&&Be.flightType==="Solo"&&Ut.push(Be.pilot),Be.attendees&&Array.isArray(Be.attendees)&&Ut.push(...Be.attendees),Ut.length>0&&console.log(`ðŸ“‹ Processing ${Be.type} event for PT-051:`,{flightNumber:Be.flightNumber,type:Be.type,date:Be.date,trainees:Ut}),Ut.forEach(bn=>{const gn=`${Be.id}-${bn}`;if(!Array.from(Ie.values()).find(bs=>bs.eventId===Be.id&&bs.traineeFullName===bn)){const bs={id:`pt051-${gn}`,traineeFullName:bn,eventId:Be.id,flightNumber:Be.flightNumber,date:Be.date,instructorName:Be.instructor||"",overallGrade:null,overallResult:null,dcoResult:null,overallComments:"",isCompleted:!1,scores:o_.map(Ss=>({element:Ss,grade:null,comment:""}))};Ie.set(bs.id,bs),he++,console.log("âœ… Created PT-051 for",bn,"on",Be.flightNumber,Be.date)}})});let dt=0;Ie.forEach((Be,Wt)=>{const Rt=Ue.find(tn=>tn.id===Be.eventId);if(Rt){let tn=!1;const Dn={};Be.instructorName!==(Rt.instructor||"")&&(Dn.instructorName=Rt.instructor||"",tn=!0,console.log("ðŸ“ Instructor changed:",Be.instructorName,"â†’",Rt.instructor)),Be.flightNumber!==Rt.flightNumber&&(Dn.flightNumber=Rt.flightNumber,tn=!0,console.log("ðŸ“ Flight number changed:",Be.flightNumber,"â†’",Rt.flightNumber)),Be.date!==Rt.date&&(Dn.date=Rt.date,tn=!0,console.log("ðŸ“ Date changed:",Be.date,"â†’",Rt.date)),tn&&(Ie.set(Wt,{...Be,...Dn}),dt++,console.log("âœï¸ Updated PT-051 for",Be.traineeFullName,"on",Be.flightNumber))}});const at=new Set(Ue.map(Be=>Be.id)),Nt=[];Ie.forEach((Be,Wt)=>{at.has(Be.eventId)||(Nt.push(Wt),console.log("ðŸ—‘ï¸ Deleting PT-051 for",Be.traineeFullName,"on",Be.flightNumber,Be.date,"(event no longer on Active DFP)"))}),Nt.forEach(Be=>{Ie.delete(Be),qe++}),he>0||qe>0||dt>0?(dn(Ie),console.log(`ðŸ“Š PT-051 Sync Complete: Created ${he}, Updated ${dt}, Deleted ${qe}`)):console.log("âœ… PT-051s already in sync with Active DFP")},xl=(I,q)=>{vs(te=>te.map(le=>le.id===I?{...le,...q}:le))},Jo=I=>{const q=K.find(te=>te.name===I);q&&(gt(q),xs("Instructors"))},za=I=>{const q=ye.find(te=>te.fullName===I);q&&(gt(q),xs("CourseRoster"))},Ia=()=>{console.log("ðŸš€ [NEO-Build] startBuildProcess called"),console.log("ðŸš€ [NEO-Build] DEBUG ===== PRE-BUILD ANALYSIS START ====="),console.log("ðŸš€ [NEO-Build] Pre-Build Step 1: Syncing SCT and Remedial requests...");const I=_a();console.log(`Pre-Build Step 2: Checking Active DFP for ${Ve}...`);const q=Et[Ve]||[];console.log(`DEBUG Active DFP has ${q.length} events for ${Ve}`);let te=[...I],le=0;q.length>0?(console.log("DEBUG Existing events details:"),q.forEach((qe,dt)=>{console.log(`  ${dt+1}. ${qe.flightNumber} - ${qe.student||qe.pilot||"N/A"} with ${qe.instructor} at ${qe.startTime.toFixed(2)} (ID: ${qe.id}, isTimeFixed: ${qe.isTimeFixed})`)}),console.log("AUTOMATICALLY adding ALL these events to Highest Priority to preserve them..."),q.forEach(qe=>{if(te.some(at=>at.id===qe.id))console.log(`  DEBUG SKIP: ${qe.flightNumber} already in highest priority (ID: ${qe.id})`);else{const at={...qe,isTimeFixed:!0};te.push(at),le++,console.log(`  DEBUG LOCKED: ${qe.flightNumber} - ${qe.student||qe.pilot||"N/A"} with ${qe.instructor} at ${qe.startTime.toFixed(2)} (ID: ${qe.id})`)}}),le>0?(vs(te),console.log(`DEBUG Pre-Build Complete: ${le} events LOCKED as highest priority (MUST be included in build)`),console.log(`DEBUG Total Highest Priority Events: ${te.length}`)):console.log("DEBUG Pre-Build Complete: All existing events already locked")):console.log("DEBUG Pre-Build Analysis: No existing events found in Active DFP for this date"),console.log("DEBUG ===== PRE-BUILD ANALYSIS END =====");const Ue=te;console.log(`DEBUG Final preserved events count: ${Ue.length}`);const Ie=ye.filter(qe=>!qe.isPaused&&!Li(qe,Ce,Nn,Ve,"flight"));let he=0;Ie.forEach(qe=>{const{next:dt}=tf(qe,ot,nt,be,Et,Ve);dt&&dt.code.startsWith("BNF")&&dt.type==="Flight"&&he++}),Vr(he),Ba(!0),setTimeout(()=>{Ba(!1),yl(Ue)},3e3)},Po=()=>{console.log("ðŸš€ [NEO-Build] handleBuildDfp called"),console.log("ðŸš€ [NEO-Build] buildDfpDate:",Ve);const I=d();if(console.log("ðŸš€ [NEO-Build] todayStr:",I),console.log("ðŸš€ [NEO-Build] Date comparison:",Ve,"<=",I,"=",Ve<=I),Ve<=I){console.log("ðŸš€ [NEO-Build] Build date is today or in the past, showing warning"),Fs(!0);return}console.log("ðŸš€ [NEO-Build] Starting build process"),Ia()},pa=()=>{Fs(!1),Ia()},yl=I=>{console.log("ðŸš€ [NEO-Build] runBuildAlgorithm called"),console.log("ðŸš€ [NEO-Build] buildDfpDate:",Ve),console.log("ðŸš€ [NEO-Build] preservedEvents:",(I==null?void 0:I.length)||0),console.log("ðŸš€ [NEO-Build] highestPriorityEvents:",Ti.length),rr(!0),Mt([]);const q=I||Ti;console.log(`ðŸš€ [NEO-Build] DEBUG runBuildAlgorithm called with ${q.length} highest priority events`);const te={instructors:K,trainees:ye,syllabus:be,scores:nt,coursePriorities:Ht,coursePercentages:we,availableAircraftCount:je,ftdCount:Ye,cptCount:St,courseColors:kt,school:X,dayStart:Ce,dayEnd:B,ftdStart:rt,ftdEnd:et,allowNightFlying:pn,commenceNightFlying:ts,ceaseNightFlying:Nn,buildDate:Ve,highestPriorityEvents:q,programWithPrimaries:ra,traineeLMPs:ot,flightTurnaround:Qn,ftdTurnaround:cs,cptTurnaround:Ms,preferredDutyPeriod:ss,maxCrewDutyPeriod:Jn,eventLimits:Pt,sctFtds:Es,sctFlights:xn,remedialRequests:ci,sctEvents:Ir,getEventDayNightClassification:ic};setTimeout(()=>{try{console.log("ðŸš€ [NEO-Build] Starting DFP build process for",Ve),console.log("ðŸš€ [NEO-Build] Config:",{instructors:te.instructors.length,trainees:te.trainees.length,syllabus:te.syllabus.length,highestPriorityEvents:te.highestPriorityEvents.length,buildDate:te.buildDate});const le=h_(te,js,Et);console.log("ðŸš€ [NEO-Build] DFP build completed, generated",le.length,"events"),console.log("ðŸš€ [NEO-Build] Generated events sample:",le.slice(0,3)),Mt(le),console.log("ðŸš€ [NEO-Build] setNextDayBuildEvents called with",le.length,"events");const Ue=f_(le,we,Ht,je,Ve,ye,ot,nt,be,Et);jn(Ue),localStorage.setItem("lastBuildAnalysis",JSON.stringify({...Ue,timeDistribution:{eventsByHour:Array.from(Ue.timeDistribution.eventsByHour.entries()),clusteringScore:Ue.timeDistribution.clusteringScore,uniformityScore:Ue.timeDistribution.uniformityScore}})),console.log("Build analysis:",Ue);const Ie=[],he=[...K,...ye];le.forEach(qe=>{Ls(qe).forEach(dt=>{const at=he.find(Nt=>Nt.name===dt||"fullName"in Nt&&Nt.fullName===dt);at&&Li(at,qe.startTime,qe.startTime+qe.duration,Ve,qe.type)&&(Ie.push(`${dt} in event ${qe.flightNumber} at ${qe.startTime.toFixed(2)} conflicts with a static unavailability period.`),Pn("Next Day Build","Add",`NEO-Build completed for ${Ve}`,`Generated ${le.length} events, Flight: ${le.filter(Nt=>Nt.type==="flight").length}, FTD: ${le.filter(Nt=>Nt.type==="ftd").length}, Ground: ${le.filter(Nt=>Nt.type==="ground").length}`))})}),Ie.length>0&&Js(Ie)}catch(le){console.error("ðŸš€ [NEO-Build] DFP Build Failed:",le),console.error("ðŸš€ [NEO-Build] Error stack:",le instanceof Error?le.stack:"No stack trace"),js({message:"Error during build!",percentage:100})}finally{setTimeout(()=>{console.log("ðŸš€ [NEO-Build] Build process complete, navigating to NextDayBuild"),rr(!1),xs("NextDayBuild")},1e3)}},500)},Xo=()=>{Kt.length>0?Un(!0):u("No DFP has been built to publish. Please run 'Build DFP' first.","Publish Error","warning")},Ro=()=>{Un(!1);const I=Kt.map(q=>({...q,date:Ve}));Bt(q=>({...q,[Ve]:I})),console.log("ðŸ“‹ Triggering PT-051 sync after publish..."),setTimeout(()=>{console.log("â° Executing delayed PT-051 sync after publish..."),Bt(q=>(dn(te=>(pl(q,te),te)),q))},500),fo(q=>({...q,[Ve]:JSON.parse(JSON.stringify(I))})),Pn("Next Day Build","Edit",`Published schedule for ${Ve}`,`Total events: ${I.length}, Flight: ${I.filter(q=>q.type==="flight").length}, FTD: ${I.filter(q=>q.type==="ftd").length}, Ground: ${I.filter(q=>q.type==="ground").length}`),y(Ve),Mt([]),h("Program Schedule"),$s("DFP Successfully Published!")},Ko=I=>{!I||I.length===0||(Bt(q=>{const te=q[x]||[],le=new Map(I.map(Ie=>[Ie.eventId,Ie])),Ue=te.map(Ie=>{if(le.has(Ie.id)){const he=le.get(Ie.id);return{...Ie,startTime:he.newStartTime??Ie.startTime,resourceId:he.newResourceId??Ie.resourceId}}return Ie});return{...q,[x]:Ue}}),I.forEach(q=>{const te=currentScheduleForDate.find(le=>le.id===q.eventId);if(te){const le=te.startTime,Ue=te.resourceId,Ie=te.type||"event",he=te.student||te.pilot||te.instructor||"Unknown";jo(`schedule-move-${q.eventId}`,{page:"Program Schedule",action:"Edit",description:`Moved ${Ie} event for ${he}`,originalValues:{startTime:le,resourceId:Ue},newValues:{startTime:q.newStartTime,resourceId:q.newResourceId}},Pn)}}))},Va=I=>{!I||I.length===0||(Mt(q=>{const te=new Map(I.map(le=>[le.eventId,le]));return q.map(le=>{if(te.has(le.id)){const Ue=te.get(le.id);return{...le,startTime:Ue.newStartTime??le.startTime,resourceId:Ue.newResourceId??le.resourceId}}return le})}),I.forEach(q=>{const te=Kt.find(le=>le.id===q.eventId);if(te){const le=te.startTime,Ue=te.resourceId,Ie=te.type||"event",he=te.student||te.pilot||te.instructor||"Unknown";jo(`ndb-move-${q.eventId}`,{page:"Next Day Build",action:"Edit",description:`Moved ${Ie} event for ${he}`,originalValues:{startTime:le,resourceId:Ue},newValues:{startTime:q.newStartTime,resourceId:q.newResourceId}},Pn)}}))},ri=C.useMemo(()=>be.map(I=>I.id),[be]),Bl=C.useMemo(()=>{console.log("addTileSyllabusOptions filtering syllabusDetails:",be);const I=be.filter(te=>te.type==="Flight"||te.type==="FTD"||te.type==="Ground School"&&te.code.includes("CPT"));console.log("Filtered items:",I);const q=I.map(te=>te.id);return q.includes("SCT FORM")||q.push("SCT FORM"),q},[be]),bd=(I,q,te,le,Ue)=>{const Ie=new Date().toISOString(),he=Ue;let qe=!1,dt=null;const at=Nt=>Nt.map(Be=>{if(Be.id===I){const Wt={...Be,authNotes:q};return te==="autho"?(Wt.authoSignedBy=he,Wt.authoSignedAt=Ie):te==="captain"&&(Wt.captainSignedBy=he,Wt.captainSignedAt=Ie,Wt.isVerbalAuth=le),!!(Wt.authoSignedBy&&Wt.captainSignedBy)&&(qe=!0),dt=Wt,Wt}return Be});E(Nt=>at(Nt)),Bt(Nt=>Object.fromEntries(Object.entries(Nt).map(([Be,Wt])=>[Be,at(Wt)]))),dt&&hr(dt),te==="captain"&&!qe&&(Ha(!1),hr(null)),qe&&$s("Flight Authorised!")},vd=C.useCallback(I=>{const q=new Map(I.map(te=>[te.idNumber,te]));ue(te=>{const le=new Set(te.map(he=>he.idNumber)),Ue=te.map(he=>q.get(he.idNumber)||he),Ie=I.filter(he=>!le.has(he.idNumber));return[...Ue,...Ie]})},[]),fu=C.useCallback(I=>{ue(I),$s("Instructors successfully replaced!")},[]),Nd=C.useCallback(I=>{const q=new Map(I.map(te=>[te.idNumber,te]));pe(te=>{const le=new Set(te.map(he=>he.idNumber)),Ue=te.map(he=>q.get(he.idNumber)||he),Ie=I.filter(he=>!le.has(he.idNumber));return[...Ue,...Ie]})},[]),Rr=C.useCallback(I=>{pe(I),$s("Trainees successfully replaced!")},[]),bl=C.useCallback(I=>{const q=new Map(I.map(te=>[te.code.trim().replace(/\s/g,"").toLowerCase(),te]));Ze(te=>{const le=te.map(he=>{const qe=he.code.trim().replace(/\s/g,"").toLowerCase();return q.get(qe)||he}),Ue=new Set(te.map(he=>he.code.trim().replace(/\s/g,"").toLowerCase())),Ie=I.filter(he=>!Ue.has(he.code.trim().replace(/\s/g,"").toLowerCase()));return[...le,...Ie]})},[]),Ol=I=>{Ze(q=>q.map(te=>te.id===I.id?I:te))},$l=(I,q)=>{st(te=>te.map(le=>le.name===I?{...le,gradDate:q}:le))},pc=(I,q)=>{st(te=>te.map(le=>le.name===I?{...le,startDate:q}:le))},b=I=>{Te(I),I||fe(new Set)},S=C.useMemo(()=>{const I={};return ye.forEach(q=>{I[q.course]||(I[q.course]=[]),I[q.course].push(q)}),I},[ye]),L=I=>{const q=be.find(le=>le.code===I.flightNumber);if(!q)return;const te={id:_r(),type:"ground",flightNumber:I.flightNumber,startTime:I.startTime,duration:q.duration,instructor:I.instructor,attendees:I.attendees,resourceId:I.resourceId,color:"bg-teal-400/50",flightType:"Dual",locationType:"Local",origin:X,destination:X,authNotes:I.location};Mt(le=>[...le,te]),En(!1),$s("Ground event added to the build.")},G=C.useCallback((I,q)=>{var he;const te=[],le=Ra(I,be),Ue=I.flightNumber,Ie=ye.filter(qe=>qe.fullName!==I.student&&!qe.isPaused);for(const qe of Ie){if(((he=tf(qe,ot,nt,be,Et,Ve).next)==null?void 0:he.id)!==Ue||Li(qe,le.start,le.end,I.date,I.type)||q.some(wn=>{if(wn.id===I.id||!Ls(wn).includes(qe.fullName))return!1;const Ut=Ra(wn,be);return le.start<Ut.end&&le.end>Ut.start}))continue;const Nt=l_(qe.lastFlightDate,I.date),Be=q.filter(wn=>Ls(wn).includes(qe.fullName)),Wt=Be.filter(wn=>wn.type==="flight").length,Rt=Be.filter(wn=>wn.type==="ftd").length,tn=Be.filter(wn=>wn.type==="cpt"||wn.type==="ground"&&wn.flightNumber.includes("CPT")).length,Dn=Be.filter(wn=>wn.type==="ground"&&!(wn.type==="cpt"||wn.flightNumber.includes("CPT"))).length;te.push({type:"trainee",trainee:{name:qe.fullName,rank:qe.rank,course:qe.course,daysSinceLastFlight:Nt,flightsToday:Wt,ftdsToday:Rt,cptsToday:tn,groundToday:Dn}})}return te.sort((qe,dt)=>dt.trainee.daysSinceLastFlight-qe.trainee.daysSinceLastFlight)},[ye,be,ot,nt]),ie=C.useCallback((I,q,te)=>{const le=[];console.log("ðŸ” generateInstructorRemediesAtTime called for:",I.flightNumber,"at time:",te),console.log("ðŸ” Total instructors to check:",K.length);let Ue=0,Ie=0,he=0;const qe={...I,startTime:te},dt=Ra(qe,be);for(const at of K){const Nt=at.role==="QFI",Be=at.role==="SIM IP";if(!(I.type==="flight"&&Nt||I.type==="ftd"&&(Nt||Be)||I.type==="ground")){Ue++;continue}if(Li(at,dt.start,dt.end,I.date,I.type)){Ie++;continue}if(q.some(Sn=>{if(Sn.id===I.id||!Ls(Sn).includes(at.name))return!1;const Ln=Ra(Sn,be);return dt.start<Ln.end&&dt.end>Ln.start})){he++;continue}const tn=q.filter(Sn=>Sn.id!==I.id&&Ls(Sn).includes(at.name)),Dn=tn.filter(Sn=>Sn.type==="flight").length,wn=tn.filter(Sn=>Sn.type==="ftd").length,Ut=tn.filter(Sn=>Sn.type==="cpt"||Sn.type==="ground"&&Sn.flightNumber.includes("CPT")).length,In=tn.filter(Sn=>Sn.type==="ground"&&!(Sn.type==="cpt"||Sn.flightNumber.includes("CPT"))).length,An=_m(at.name,q.filter(Sn=>Sn.id!==I.id),qe,be);le.push({type:"instructor",instructor:{name:at.name,rank:at.rank,dutyHours:An,flightsToday:Dn,ftdsToday:wn,cptsToday:Ut,groundToday:In}})}return console.log("ðŸ” Instructor remedy generation complete:"),console.log("ðŸ” - Qualification failures:",Ue),console.log("ðŸ” - Unavailability failures:",Ie),console.log("ðŸ” - Overlap failures:",he),console.log("ðŸ” - Total suggestions:",le.length),le.sort((at,Nt)=>{const Be=at.instructor.flightsToday+at.instructor.ftdsToday+at.instructor.cptsToday+at.instructor.groundToday,Wt=Nt.instructor.flightsToday+Nt.instructor.ftdsToday+Nt.instructor.cptsToday+Nt.instructor.groundToday;return Be!==Wt?Be-Wt:at.instructor.dutyHours-Nt.instructor.dutyHours})},[K,be]),oe=C.useCallback((I,q,te)=>{const le=[];console.log("ðŸ” generatePilotRemediesAtTime called for:",I.flightNumber,"at time:",te);const Ue=K.filter(at=>at.role==="QFI");console.log("ðŸ” Total qualified pilots to check:",Ue.length);let Ie=0,he=0;const qe={...I,startTime:te},dt=Ra(qe,be);for(const at of Ue){if(Li(at,dt.start,dt.end,I.date,I.type)){Ie++;continue}if(q.some(Ut=>{if(Ut.id===I.id||!Ls(Ut).includes(at.name))return!1;const In=Ra(Ut,be);return dt.start<In.end&&dt.end>In.start})){he++;continue}const Be=q.filter(Ut=>Ut.id!==I.id&&Ls(Ut).includes(at.name)),Wt=Be.filter(Ut=>Ut.type==="flight").length,Rt=Be.filter(Ut=>Ut.type==="ftd").length,tn=Be.filter(Ut=>Ut.type==="cpt"||Ut.type==="ground"&&Ut.flightNumber.includes("CPT")).length,Dn=Be.filter(Ut=>Ut.type==="ground"&&!(Ut.type==="cpt"||Ut.flightNumber.includes("CPT"))).length,wn=_m(at.name,q.filter(Ut=>Ut.id!==I.id),qe,be);le.push({type:"instructor",instructor:{name:at.name,rank:at.rank,dutyHours:wn,flightsToday:Wt,ftdsToday:Rt,cptsToday:tn,groundToday:Dn}})}return console.log("ðŸ” Pilot remedy generation complete:"),console.log("ðŸ” - Unavailability failures:",Ie),console.log("ðŸ” - Overlap failures:",he),console.log("ðŸ” - Total suggestions:",le.length),le.sort((at,Nt)=>{const Be=at.instructor.flightsToday+at.instructor.ftdsToday+at.instructor.cptsToday+at.instructor.groundToday,Wt=Nt.instructor.flightsToday+Nt.instructor.ftdsToday+Nt.instructor.cptsToday+Nt.instructor.groundToday;return Be!==Wt?Be-Wt:at.instructor.dutyHours-Nt.instructor.dutyHours})},[K,be]),de=(I,q,te,le)=>{const{flightTurnaround:Ue,ftdTurnaround:Ie,syllabusDetails:he,instructorsData:qe,traineesData:dt,getPersonnel:at,getEventBookingWindow:Nt,isPersonStaticallyUnavailable:Be,maxCrewDutyPeriod:Wt}=te,Rt=q.filter(Ln=>Ln.resourceId===I.resourceId&&Ln.id!==I.id).sort((Ln,bn)=>Ln.startTime-bn.startTime),tn=Rt.filter(Ln=>Ln.startTime<I.startTime).pop(),Dn=Rt.find(Ln=>Ln.startTime>I.startTime);let wn="middle";tn||(wn="first"),Dn||(wn="last");let Ut=0;I.type==="flight"?Ut=Ue:I.type==="ftd"&&(Ut=Ie);const In=Ln=>{const bn={...I,startTime:Ln},gn=Nt(bn,he);if(gn.start<le.start||gn.end>le.end)return!1;const Gn=new Date().getHours()+new Date().getMinutes()/60;if(Ln<I.startTime&&gn.start<Gn)return!1;if(tn){let Ss=Ut;const dr=at(tn),ii=at(I);if(dr.some(Zr=>ii.includes(Zr))){const Zr=he.find(Vs=>Vs.id===tn.flightNumber),gr=he.find(Vs=>Vs.id===I.flightNumber),bo=((Zr==null?void 0:Zr.postFlightTime)||0)+((gr==null?void 0:gr.preFlightTime)||0);Ss=Math.max(Ut,bo)}if(Ln<tn.startTime+tn.duration+Ss)return!1}if(Dn){let Ss=Ut;const dr=at(Dn),ii=at(I);if(dr.some(Zr=>ii.includes(Zr))){const Zr=he.find(Vs=>Vs.id===I.flightNumber),gr=he.find(Vs=>Vs.id===Dn.flightNumber),bo=((Zr==null?void 0:Zr.postFlightTime)||0)+((gr==null?void 0:gr.preFlightTime)||0);Ss=Math.max(Ut,bo)}if(Ln+I.duration+Ss>Dn.startTime)return!1}const bs=at(I);for(const Ss of bs){const dr=[...qe,...dt].find(gr=>("fullName"in gr?gr.fullName:gr.name)===Ss);if(!dr)continue;if(Be(dr,gn.start,gn.end,I.date,I.type)||q.some(gr=>{if(gr.id===I.id||!at(gr).includes(Ss))return!1;const bo=Nt(gr,he);return gn.start<bo.end&&gn.end>bo.start}))return!1;const Lr=q.filter(gr=>gr.id!==I.id&&at(gr).includes(Ss));if(_m(Ss,Lr,bn,he)>Wt)return!1}return!0},An=5/60,Sn=Math.floor((le.end-le.start)/An);for(let Ln=1;Ln<=Sn;Ln++){const bn=I.startTime+Ln*An,gn=I.startTime-Ln*An;if(wn==="first"||wn==="last"&&!Dn){if(In(bn))return{type:"timeshift",newStartTime:bn,instructor:{name:I.instructor||""}}}else{if(In(bn))return{type:"timeshift",newStartTime:bn,instructor:{name:I.instructor||""}};if(In(gn))return{type:"timeshift",newStartTime:gn,instructor:{name:I.instructor||""}}}}return null},ve=I=>{var Nt;const q=["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f),te=q?Kt.map(Be=>({...Be,date:Ve})):qs,Ue=(q?po:Kr).has(I.id);let Ie=[];if(U&&Ue?(Ie=Gt(I,te),Ie.length>0&&(Ie.unshift("âš ï¸ VALIDATE MODE CONFLICTS DETECTED:"),Ie.push(""),Ie.push("This event is marked RED because Validate mode found the following rule violations:"))):Ie=Gt(I,te),Ie.length===0){yi(U&&!Ue?"NEO analysis: This event has no conflicts and passes all validation rules.":"NEO found no hard errors for this event.");return}U&&Ue?(console.log(`NEO: Analyzing validate-mode conflict for event ${I.flightNumber} (${I.id})`),console.log("Validation errors found:",Ie),Wr({event:I,errors:Ie})):Wr({event:I,errors:Ie});const he=Ie.every(Be=>Be.toLowerCase().includes("turnaround"))&&Ie.length>0,qe=Ie.some(Be=>I.instructor&&Be.includes(I.instructor.split(",")[0]));if(he||!qe){const Wt=de(I,te,{flightTurnaround:Qn,ftdTurnaround:cs,syllabusDetails:be,instructorsData:K,traineesData:ye,getPersonnel:Ls,getEventBookingWindow:Ra,isPersonStaticallyUnavailable:Li,maxCrewDutyPeriod:Jn},{start:Ce,end:B});if(Wt){re(Wt),Qe(!0),Tr([]);return}else if(he){yi("No resolution found for the turnaround violation. Changing crew will not fix this resource conflict."),Wr(null),Tr([]);return}}const dt=Ie.filter(Be=>I.student&&Be.includes(I.student.split(",")[0]));if(!qe&&dt.length>0){const Be=G(I,te);if(Be.length>0){Tr(Be);return}}if((Nt=I.flightNumber)==null?void 0:Nt.startsWith("SCT")){console.log("ðŸ”§ SCT event detected, generating pilot remedies");const Be=oe(I,te,I.startTime);Be.length>0?Tr(Be):(yi("No resolution found."),Tr([]))}else{const Be=ie(I,te,I.startTime);Be.length>0?Tr(Be):(yi("No resolution found."),Tr([]))}},Se=I=>{if(console.log("ðŸ”§ handleApplyNeoRemedy called with remedy:",I),console.log("ðŸ”§ neoProblemTileForFlyout:",Bs),!Bs){console.log("âŒ No problem tile found, returning early");return}console.log("ðŸ”§ Remedy type:",I.type),console.log("ðŸ”§ Instructor duty hours:",I.type!=="trainee"?I.instructor.dutyHours:"N/A"),console.log("ðŸ”§ Preferred duty period:",ss),I.type!=="trainee"&&I.instructor.dutyHours>ss?(console.log("âš ï¸ Duty warning triggered"),io(I),ao(!0)):(console.log("âœ… Executing remedy directly"),jt(I,Bs.event))},Pe=()=>{di&&Bs&&jt(di,Bs.event),ao(!1),io(null)},it=()=>{Jt(!1),Tr(fn)},_t=()=>{Jt(!1),Tr(Xn)},Me=()=>{Qe(!1),re(null),Wr(null)},ut=()=>{if(Qe(!1),re(null),Bs){console.log("ðŸ”§ DEBUG: Generating instructor remedies for event:",Bs.event.flightNumber);const q=["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f)?Kt.map(le=>({...le,date:Ve})):qs;console.log("ðŸ”§ DEBUG: Total events in context:",q.length);const te=ie(Bs.event,q,Bs.event.startTime);console.log("ðŸ”§ DEBUG: Generated remedies:",te.length),console.log("ðŸ”§ DEBUG: Remedies:",te),Tr(te)}},wt=()=>{k&&Bs&&(jt(k,Bs.event),setShowTimeOnlyConfirmation(!1),re(null),Wr(null),Tr([]))},Gt=(I,q)=>{const te=[],le=go(I,q,I.date);if(le.hasConflict){const qe=q.find(dt=>dt.id===le.conflictingEventId);switch(le.conflictType){case"turnaround":if(qe){let dt=0;if(I.type==="flight"?dt=Qn:I.type==="ftd"?dt=cs:(I.type==="cpt"||I.type==="ground"&&I.flightNumber.includes("CPT"))&&(dt=Ms),I.startTime>qe.startTime){const at=I.startTime-(qe.startTime+qe.duration);te.push(`âŒ Turnaround violation - Only ${at.toFixed(2)}hrs between ${I.flightNumber} and previous event ${qe.flightNumber} (minimum required: ${dt}hrs)`)}else{const at=qe.startTime-(I.startTime+I.duration);te.push(`âŒ Turnaround violation - Only ${at.toFixed(2)}hrs between ${I.flightNumber} and next event ${qe.flightNumber} (minimum required: ${dt}hrs)`)}}break;case"resource":qe&&te.push(`âŒ Resource conflict - Aircraft ${I.resourceId} is double-booked with ${qe.flightNumber} at ${qe.startTime.toFixed(2)}hrs`);break;case"personnel":qe&&le.conflictedPersonnel&&te.push(`âŒ ${le.conflictedPersonnel.split(",")[0]} is double-booked - Scheduled for both ${I.flightNumber} and ${qe.flightNumber} at overlapping times`);break;case"day-night":if(qe&&le.conflictedPersonnel){const dt=ic(I,be,Ir),at=ic(qe,be,Ir);te.push(`âŒ Day/Night separation violation - ${le.conflictedPersonnel.split(",")[0]} cannot be scheduled for both ${dt} event (${I.flightNumber}) and ${at} event (${qe.flightNumber})`)}break}}I.flightType==="Dual"&&(!I.instructor||I.instructor.trim()===""||I.instructor==="TBD")&&te.push("âŒ No instructor assigned - Dual flights require an instructor.");const Ue=Ra(I,be),Ie=Ls(I),he=[...K,...ye];return Ie.forEach(qe=>{const dt=he.find(at=>("fullName"in at?at.fullName:at.name)===qe);if(dt&&Li(dt,Ue.start,Ue.end,I.date,I.type)){const at=dt.unavailability.find(Be=>Be.allDay?I.date>=Be.startDate&&I.date<Be.endDate:I.date>=Be.startDate&&I.date<=Be.endDate),Nt=(at==null?void 0:at.reason)||"Unavailable";te.push(`âŒ ${(qe||"").split(",")[0]} is unavailable - ${Nt}`)}}),[...new Set(te)]},jt=(I,q)=>{var dt;console.log("ðŸŸ£ ========== NEO REMEDY START =========="),console.log("ðŸŸ£ NEO: executeNeoRemedy called"),console.log("ðŸŸ£ NEO: Remedy type:",I.type),console.log("ðŸŸ£ NEO: Problem tile ID:",q.id),console.log("ðŸŸ£ NEO: Problem tile instructor:",q.instructor),console.log("ðŸŸ£ NEO: Problem tile student:",q.student),console.log("ðŸŸ£ NEO: Problem tile pilot:",q.pilot);const te=["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f),le=te?Ve:x;console.log("ðŸŸ£ NEO: isNextDayContext:",te),console.log("ðŸŸ£ NEO: targetDate:",le),console.log("ðŸŸ£ NEO: activeView:",f);const Ue=te?Kt.map(at=>({...at,date:Ve})):Et[le]||[];console.log("ðŸŸ£ NEO: currentEvents count:",Ue.length);const Ie=Ue.find(at=>at.id===q.id);if(!Ie){console.error("ðŸŸ£ âŒ NEO: Event not found:",q.id),console.log("ðŸŸ£ NEO: Available event IDs:",Ue.map(at=>at.id));return}console.log("ðŸŸ£ NEO: Found event to update:",{id:Ie.id,instructor:Ie.instructor,student:Ie.student,pilot:Ie.pilot,date:Ie.date,resourceId:Ie.resourceId});const he={...Ie},qe=(dt=Ie.flightNumber)==null?void 0:dt.startsWith("SCT");if(!qe){const at=he.student||he.pilot;if(at&&he.flightNumber){const Nt=Ai(he.flightNumber,at);he.flightType=Nt,Nt==="Solo"&&at&&(he.pilot=at,he.crew="",console.log(`âœˆï¸ [NEO Solo Logic] Applied: ${at} as PIC, crew cleared for ${he.flightNumber}`))}}I.type==="instructor"?qe?(console.log("ðŸŸ£ NEO: Applying pilot change for SCT event:",Ie.pilot,"â†’",I.instructor.name),he.pilot=I.instructor.name,he.instructor=""):(console.log("ðŸŸ£ NEO: Applying instructor change:",Ie.instructor,"â†’",I.instructor.name),he.instructor=I.instructor.name):I.type==="trainee"?(console.log("ðŸŸ£ NEO: Applying trainee change:",Ie.student,"â†’",I.trainee.name),he.student=I.trainee.name):I.type==="timeshift"&&(console.log("ðŸŸ£ NEO: Applying time shift:",Ie.startTime,"â†’",I.newStartTime),he.startTime=I.newStartTime,I.instructor.name&&(qe?(he.pilot=I.instructor.name,he.instructor=""):he.instructor=I.instructor.name)),console.log("ðŸŸ£ NEO: Updated event created:",{id:he.id,instructor:he.instructor,student:he.student,pilot:he.pilot,date:he.date,resourceId:he.resourceId}),console.log("ðŸŸ£ NEO: Calling handleSaveEvents..."),ga([he],!1),console.log("ðŸŸ£ NEO: handleSaveEvents returned, waiting for useEffect to recalculate conflicts"),console.log("ðŸŸ£ ========== NEO REMEDY END ==========")};C.useEffect(()=>{if(console.log("ðŸŸ  ========== NEO USEEFFECT TRIGGERED =========="),console.log("ðŸŸ  neoProblemTileForFlyout:",Bs?"OPEN":"CLOSED"),!Bs){console.log("ðŸŸ  NEO flyout is closed, skipping useEffect"),console.log("ðŸŸ  ========== NEO USEEFFECT END (CLOSED) ==========");return}console.log("ðŸŸ  NEO flyout is open, processing..."),console.log("ðŸŸ  Problem tile ID:",Bs.event.id),console.log("ðŸŸ  Problem tile instructor:",Bs.event.instructor);const I=["NextDayBuild","Priorities","ProgramData","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(f),q=I?Kt.map(Ue=>({...Ue,date:Ve})):qs;console.log("ðŸŸ  isNextDayContext:",I),console.log("ðŸŸ  currentEvents count:",q.length);const te=q.find(Ue=>Ue.id===Bs.event.id);if(!te){console.log("ðŸŸ  âŒ Event not found in current state, closing flyout"),Wr(null),Tr([]),console.log("ðŸŸ  ========== NEO USEEFFECT END (NOT FOUND) ==========");return}console.log("ðŸŸ  Found updated problem tile:",{id:te.id,instructor:te.instructor,student:te.student,pilot:te.pilot}),console.log("ðŸŸ  Running findHardErrors on updated tile...");const le=Gt(te,q);if(console.log("ðŸŸ  Errors found:",le.length),le.length>0&&console.log("ðŸŸ  Error details:",le),le.length===0)console.log("ðŸŸ  âœ… All conflicts resolved! Closing flyout and showing success message"),$s(`All conflicts for ${te.flightNumber} resolved.`),Wr(null),Tr([]),io(null),ao(!1),re(null),Qe(!1);else{console.log("ðŸŸ  âš ï¸ Conflicts still exist, generating new remedies...");const Ue=le.filter(qe=>qe.toLowerCase().includes("instructor")||te.instructor&&qe.includes(te.instructor.split(",")[0])),Ie=le.filter(qe=>te.student&&qe.includes(te.student.split(",")[0]));console.log("ðŸŸ  Instructor errors:",Ue.length),console.log("ðŸŸ  Trainee errors:",Ie.length);let he=[];Ue.length===0&&Ie.length>0?(console.log("ðŸŸ  Generating trainee remedies..."),he=G(te,q)):(console.log("ðŸŸ  Generating instructor remedies..."),he=ie(te,q,te.startTime)),console.log("ðŸŸ  Generated",he.length,"new remedies"),Wr({event:te,errors:le}),Tr(he)}console.log("ðŸŸ  ========== NEO USEEFFECT END ==========")},[Et,Kt,Bs==null?void 0:Bs.event.id,qs,f,Ve]);const zt=()=>{Wr(null),Tr([])},Qt=I=>{const q=I.filter(le=>le.type==="composite"),te=I.filter(le=>le.type==="primitive");Io(q),Da(te),$s("Currency rules saved!")},mn=I=>{Io(q=>q.filter(te=>te.id!==I)),Da(q=>q.filter(te=>te.id!==I)),$s("Currency deleted.")},ln=C.useMemo(()=>[...Ei.map(I=>I.name),...la.map(I=>I.name)].sort(),[Ei,la]),Yn=C.useCallback(()=>{const I=Cn==="nextDayBuild",q=(I?Kt.map(Ie=>({...Ie,date:Ve})):qs).filter(Ie=>!Ie.resourceId.startsWith("STBY")&&!Ie.resourceId.startsWith("BNF-STBY")),te=I?Ve:x,le=K.map(Ie=>(q.filter(he=>Ls(he).includes(Ie.name)),{instructor:Ie,availableWindows:[]})),Ue=ye.map(Ie=>{const he=q.filter(Rt=>Ls(Rt).includes(Ie.fullName)),qe=he.some(Rt=>Rt.type==="ftd"&&Rt.date===te),dt=he.some(Rt=>Rt.type==="flight"&&Rt.date===te),at=he.filter(Rt=>Rt.type==="ground"&&Rt.date===te).length,Nt=tf(Ie,ot,nt,be,Et,Ve).next;let Be=(Nt==null?void 0:Nt.type)==="Flight";return Ie.isPaused&&(Be=!1,console.log(`Oracle: ${Ie.fullName} excluded - trainee is PAUSED`)),(Ie.course.includes("NTSC")||Ie.fullName.includes("NTSC"))&&(Be=!1,console.log(`Oracle: ${Ie.fullName} excluded - trainee is NTSC`)),Nt&&Nt.isRemedial&&(Be=!1,console.log(`Oracle: ${Ie.fullName} excluded - next event ${Nt.code} is REMEDIAL`)),dt&&(Be=!1,console.log(`Oracle: ${Ie.fullName} ineligible - already has flight scheduled for ${te}`)),qe&&dt&&(Be=!1,console.log(`Oracle: ${Ie.fullName} ineligible - has both FTD and flight scheduled for ${te}`)),at>=2&&(Be=!1,console.log(`Oracle: ${Ie.fullName} ineligible - already has ${at} ground events for ${te}`)),Nt||(Be=!1,console.log(`Oracle: ${Ie.fullName} ineligible - no next syllabus event found`)),{trainee:Ie,availableWindows:[],nextSyllabusEvent:Nt,isEligible:Be}});Ue.filter(Ie=>Ie.isEligible).length,mt({instructors:le,trainees:Ue})},[K,ye,qs,x,Kt,Ve,Cn,ot,nt,be]),On=C.useCallback(()=>{const I=["NextDayBuild","NextDayInstructorSchedule","NextDayTraineeSchedule","Priorities","ProgramData"].includes(f);Vn(I?"nextDayBuild":"program"),Qr&&(mt(null),Yt(null)),Fi(q=>!q)},[Qr,f]);C.useEffect(()=>{Qr&&Yn()},[Qr,Cn,Yn]);const ys=C.useCallback((I,q)=>{Yt({id:"oracle-preview",date:Cn==="nextDayBuild"?Ve:x,startTime:I,duration:1.2,resourceId:q,type:"flight",flightNumber:"Next Event",instructor:"Checking...",student:"Checking...",color:"bg-sky-500/50",flightType:"Dual",locationType:"Local",origin:X,destination:X})},[x,Ve,Cn,X]),qn=C.useCallback((I,q)=>{if(!nn||!ke)return;const te=(Cn==="nextDayBuild"?Kt.map(Nt=>({...Nt,date:Ve})):qs).filter(Nt=>!Nt.resourceId.startsWith("STBY")&&!Nt.resourceId.startsWith("BNF-STBY")),le=Cn==="nextDayBuild"?Ve:x,qe={start:I-1,end:I+1.2+.5},dt=ke.instructors.some(Nt=>{const Wt=te.filter(Rt=>Ls(Rt).includes(Nt.instructor.name)).some(Rt=>{const tn=Ra(Rt,be);return qe.start<tn.end&&qe.end>tn.start});return!Li(Nt.instructor,qe.start,qe.end,le,"flight")&&!Wt}),at=ke.trainees.some(Nt=>{if(!Nt.isEligible)return!1;const Wt=te.filter(Rt=>Ls(Rt).includes(Nt.trainee.fullName)).some(Rt=>{const tn=Ra(Rt,be);return qe.start<tn.end&&qe.end>tn.start});return!Li(Nt.trainee,qe.start,qe.end,le,"flight")&&!Wt});Yt({...nn,startTime:I,resourceId:q,instructor:dt?"Instructor âœ“":"NO INSTRUCTOR âœ•",student:at?"Trainee âœ“":"NO TRAINEE âœ•"})},[nn,ke,qs,x,Kt,Ve,Cn,be]),Rs=C.useCallback(()=>{if(!nn||!ke)return;const I=(Cn==="nextDayBuild"?Kt.map(Nt=>({...Nt,date:Ve})):qs).filter(Nt=>!Nt.resourceId.startsWith("STBY")&&!Nt.resourceId.startsWith("BNF-STBY")),q=Cn==="nextDayBuild"?Ve:x,{startTime:te,duration:le}=nn,he={start:te-1,end:te+le+.5},qe=ke.instructors.filter(Nt=>{const Wt=I.filter(Rt=>Ls(Rt).includes(Nt.instructor.name)).some(Rt=>{const tn=Ra(Rt,be);return he.start<tn.end&&he.end>tn.start});return!Li(Nt.instructor,he.start,he.end,q,"flight")&&!Wt}).map(Nt=>Nt.instructor.name),dt=ke.trainees.filter(Nt=>{var Ut;if(!Nt.isEligible)return!1;const Be=I.filter(In=>Ls(In).includes(Nt.trainee.fullName));if(Be.some(In=>In.type==="flight"&&In.date===q))return console.log(`Oracle: Excluding ${Nt.trainee.fullName} - already has a flight scheduled for ${q}`),!1;if(Nt.nextSyllabusEvent&&Be.some(An=>An.flightNumber===Nt.nextSyllabusEvent.id&&An.date===q))return console.log(`Oracle: Excluding ${Nt.trainee.fullName} - already scheduled for event ${Nt.nextSyllabusEvent.id} on ${q}`),!1;const Rt=Be.some(In=>{const An=Ra(In,be);return he.start<An.end&&he.end>An.start}),tn=Nt.nextSyllabusEvent?ic({flightNumber:Nt.nextSyllabusEvent.id},be,Ir):"Unknown";if(Nt.nextSyllabusEvent&&tn!=="Day/Night"){const In=he.start>=ts&&he.start<Nn;if(tn==="Night"&&!In)return console.log(`Oracle: Excluding ${Nt.trainee.fullName} - Next event is Night but proposed time is Day (${he.start.toFixed(2)})`),!1;if(tn==="Day"&&In)return console.log(`Oracle: Excluding ${Nt.trainee.fullName} - Next event is Day but proposed time is Night (${he.start.toFixed(2)})`),!1}const Dn=Xr(Nt.trainee.fullName,he.start,he.end-he.start,"flight",q,(Ut=Nt.nextSyllabusEvent)==null?void 0:Ut.id),wn=Li(Nt.trainee,he.start,he.end,q,"flight");return Dn.isAllowed?!wn&&!Rt:(console.log(`Oracle: Excluding ${Nt.trainee.fullName} - ${Dn.reason}`),!1)});en({availableInstructors:qe,availableTraineesAnalysis:dt});const at={id:_r(),date:q,type:"flight",flightNumber:"",duration:nn.duration,startTime:nn.startTime,resourceId:nn.resourceId,color:"bg-sky-400/50",flightType:"Dual",locationType:"Local",origin:X,destination:X};_(at),H(!0),Yt(null)},[nn,ke,x,X,qs,Kt,Ve,Cn,be]),mr=()=>{const I=K.find(q=>q.name===_e);I&&(gt(I),xs("Instructors"))},Ns=I=>{$a(I),xs("Currency")},$n=()=>{const I=K.find(q=>q.name===_e);I&&Ns(I)},Tn=()=>{const I=K.find(q=>q.name===_e);I&&(Fr(I),Pi(!0))},Ar=()=>{xs(m)},us=()=>{switch(f){case"Program Schedule":return e.jsx(rw,{date:x,onDateChange:Ul,events:da,resources:ho,instructors:K.map(q=>q.name),traineesData:ye,timezoneOffset:s,airframeCount:24,standbyCount:4,ftdCount:Ye,cptCount:St,onUpdateEvent:Ko,onSelectEvent:ws,onReorderResources:()=>{},zoomLevel:1,showValidation:U,showPrePost:$,syllabusDetails:be,personnelData:bi,seatConfigs:Pr,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelConflicts:[],personnelConflictIds:Kr,unavailabilityConflicts:ua,onCptConflict:Is,isMultiSelectMode:Q,selectedEventIds:Y,setSelectedEventIds:fe,detectConflictsForEvent:go,baselineEvents:Ml[x],isOracleMode:Qr,oraclePreviewEvent:nn,onOracleMouseDown:ys,onOracleMouseMove:qn,onOracleMouseUp:Rs,showDepartureDensityOverlay:o,showAircraftAvailability:gs,plannedAvailability:je,dayFlyingStart:`${Math.floor(Ce).toString().padStart(2,"0")}:${Math.round(Ce%1*60).toString().padStart(2,"0")}`,dayFlyingEnd:`${Math.floor(B).toString().padStart(2,"0")}:${Math.round(B%1*60).toString().padStart(2,"0")}`,onAvailabilityChange:q=>{console.log("Availability updated:",q)},isVisualAdjustMode:Oe,visualAdjustEvent:F,onVisualAdjustTimeChange:(q,te)=>{if(F){const le=te-q,Ue={...F,startTime:q,duration:le};J(Ue),Bt(Ie=>{const he={...Ie},qe=x;return he[qe]&&(he[qe]=he[qe].map(dt=>dt.id===F.id?{...dt,startTime:q,duration:le}:dt)),he})}}});case"TraineeSchedule":return e.jsx(dw,{date:x,onDateChange:Ul,events:Fl,trainees:[...ye].sort((q,te)=>q.course!==te.course?q.course.localeCompare(te.course):q.name.localeCompare(te.name)).map(q=>q.fullName),traineesData:ye,onSelectEvent:ws,onUpdateEvent:Ko,zoomLevel:1,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelData:bi,seatConfigs:Pr,syllabusDetails:be,conflictingEventIds:Kr,showValidation:U,unavailabilityConflicts:ua,onSelectTrainee:za,courseColors:kt});case"InstructorSchedule":console.log("ðŸ” STAFF SCHEDULE DEBUG - Case triggered"),console.log("ðŸ” date:",x),console.log("ðŸ” handleDateChange:",typeof Ul),console.log("ðŸ” eventSegmentsForDate count:",da==null?void 0:da.length),console.log("ðŸ” instructorsData count:",K==null?void 0:K.length),console.log("ðŸ” traineesData count:",ye==null?void 0:ye.length),console.log("ðŸ” handleOpenModal:",typeof ws),console.log("ðŸ” handleScheduleUpdate:",typeof Ko),console.log("ðŸ” zoomLevel:",1),console.log("ðŸ” daylightTimes:",{firstLight:"06:30",lastLight:"18:30"}),console.log("ðŸ” personnelData size:",bi==null?void 0:bi.size),console.log("ðŸ” seatConfigs size: N/A (removed direct access)"),console.log("ðŸ” syllabusDetails count:",be==null?void 0:be.length),console.log("ðŸ” personnelAndResourceConflictIds size:",Kr==null?void 0:Kr.size),console.log("ðŸ” showValidation:",U),console.log("ðŸ” unavailabilityConflicts size:",ua==null?void 0:ua.size),console.log("ðŸ” handleSelectInstructorFromSchedule:",typeof Jo),(da==null?void 0:da.length)>0&&console.log("ðŸ” Sample event:",da[0]),(K==null?void 0:K.length)>0&&console.log("ðŸ” Sample instructor:",K[0]);try{return e.jsx(ow,{date:x,onDateChange:Ul,events:da,instructors:K.map(q=>({name:q.name,rank:q.rank,unit:q.unit})),instructorsData:K,traineesData:ye,onSelectEvent:ws,onUpdateEvent:Ko,zoomLevel:1,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelData:bi,seatConfigs:Pr,syllabusDetails:be,conflictingEventIds:Kr,showValidation:U,unavailabilityConflicts:ua,onSelectInstructor:Jo})}catch(q){throw console.error("ðŸ”´ STAFF SCHEDULE ERROR - Failed to render InstructorScheduleView:",q),console.error("ðŸ”´ Error stack:",q.stack),q}case"NextDayInstructorSchedule":return e.jsx(qD,{events:hl.map(q=>({...q,date:Ve})),instructors:K.map(q=>({name:q.name,rank:q.rank,unit:q.unit})),traineesData:ye,onSelectEvent:q=>ws({...q,date:Ve},{}),onUpdateEvent:Va,zoomLevel:1,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelData:bi,seatConfigs:Pr,syllabusDetails:be,conflictingEventIds:po,showValidation:U,onSelectInstructor:Jo,buildDfpDate:Ve,onDateChange:Lo});case"NextDayTraineeSchedule":return e.jsx(zD,{events:hl.map(q=>({...q,date:Ve})),trainees:ye.map(q=>q.fullName),traineesData:ye,onSelectEvent:q=>ws({...q,date:Ve},{}),onUpdateEvent:Va,zoomLevel:1,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelData:bi,seatConfigs:Pr,syllabusDetails:be,conflictingEventIds:po,showValidation:U,onSelectTrainee:za,buildDfpDate:Ve,onDateChange:Lo,courseColors:kt});case"CourseRoster":return e.jsx(Nw,{events:T,traineesData:ye,courseColors:kt,archivedCourses:ht,personnelData:bi,onNavigateToHateSheet:q=>{Aa(q),xs("HateSheet")},onRestoreCourse:()=>{},onUpdateTrainee:q=>{if(!ye.find(le=>le.idNumber===q.idNumber)){const le=q.lmpType||"BPC+IPC",Ue=be.filter(Ie=>le==="BPC+IPC"?!Ie.lmpType||Ie.lmpType==="Master LMP":Ie.courses.includes(le));Ue.length>0&&Vt(Ie=>{const he=new Map(Ie);return he.set(q.fullName,[...Ue]),console.log(`[Individual LMP] Initialized ${q.fullName}'s Individual LMP with ${le} (${Ue.length} events)`),he})}pe(le=>le.map(Ue=>Ue.idNumber===q.idNumber?q:Ue))},onAddTrainee:mc,school:X,scores:nt,syllabusDetails:be,onNavigateToSyllabus:Yo,onNavigateToCurrency:Ns,onViewIndividualLMP:hc,onAddRemedialPackage:gl,locations:jr,units:Wo,selectedPersonForProfile:rn,onProfileOpened:()=>gt(null),traineeLMPs:ot,onViewLogbook:qi,onDeleteTrainee:q=>{pe(te=>te.filter(le=>le.idNumber!==q.idNumber)),Vt(te=>{const le=new Map(te);return le.delete(q.fullName),le}),Pn({page:"Trainee Roster",action:"delete",description:"Deleted trainee from roster",changes:`Removed: ${q.rank} ${q.name} (${q.course}) - ID: ${q.idNumber}`})}});case"HateSheet":if(Ks){const q=Array.from(xt.values()).filter(le=>le.traineeFullName===Ks.fullName),te=[...qs,...Ti];return e.jsx(Cw,{trainee:Ks,lmpScores:nt.get(Ks.fullName)||[],assessments:q,pt051Events:q,userProfile:Fe,refreshEvents:()=>{loadEventsForDate(selectedDate,selectedCourse)},onSelectLmpScore:le=>{_o(le),xs("ScoreDetail")},onSelectPt051:le=>{console.log("onSelectPt051 called with assessment:",le),Pn("Performance History","View",`Viewed PT-051 for ${le.traineeFullName} - Event: ${le.flightNumber} (${le.date})`);const Ue=te.find(Ie=>Ie.id===le.eventId);if(Ue)console.log("Found event in schedules:",Ue),Nr(Ue),xs("PT051");else{const Ie=Kt.find(he=>he.id===le.eventId);if(Ie)console.log("Found event in build:",Ie),Nr({...Ie,date:Ve}),xs("PT051");else{console.log("Event not found, creating mock event for assessment");let he="flight";const qe=le.flightNumber||"";qe.includes("CPT")||qe.includes("Cpt")?he="cpt":(qe.includes("MB")||qe.includes("GS")||qe.includes("Ground")||qe.includes("GROUND"))&&(he="ground");const dt={id:le.eventId,flightNumber:le.flightNumber,date:le.date,startTime:"08:00",endTime:"09:00",instructor:le.instructorName||"Unknown",student:le.traineeFullName,syllabus:le.flightNumber,aircraft:"",type:he,status:"Scheduled",notes:"",crew:[]};console.log("Created mock event:",dt),Nr(dt),xs("PT051")}}},onBackToRoster:()=>{gt(Ks),xs("CourseRoster")},onInsertPt051:(le,Ue)=>{const Ie={id:_r(),traineeFullName:Ks.fullName,eventId:`inserted-pt051-${Date.now()}`,flightNumber:"PT-051 Assessment"},he={id:Ie.eventId,flightNumber:Ie.flightNumber,date:Ue,startTime:9,duration:2,type:"flight",status:"Scheduled",instructor:"",crew:[],location:"",syllabusId:"",syllabusCode:"",remarks:"",isCompleted:!1,buildId:"",isOracleGenerated:!1,priority:0,student:Ks.fullName,syllabus:Ie.flightNumber,aircraft:"",notes:""};Pn("Performance History","Insert",`Inserted PT-051 for ${Ks.fullName} at position ${le} on ${Ue}`),Nr(he),xs("PT051")}})}return null;case"ScoreDetail":return Ks&&oa?e.jsx(Tw,{trainee:Ks,scoreData:oa,onBack:()=>xs("HateSheet")}):null;case"NextDayBuild":return e.jsx(zw,{events:mo,resources:ho,instructors:K.map(q=>q.name),traineesData:ye,airframeCount:24,standbyCount:4,ftdCount:Ye,cptCount:St,onUpdateEvent:Va,onSelectEvent:q=>ws({...q,date:Ve},{}),onReorderResources:()=>{},zoomLevel:1,showValidation:U,showPrePost:$,syllabusDetails:be,personnelData:bi,seatConfigs:Pr,daylightTimes:{firstLight:"06:30",lastLight:"18:30"},personnelConflicts:[],personnelConflictIds:po,onCptConflict:Is,date:Ve,onDateChange:qt,isMultiSelectMode:Q,selectedEventIds:Y,setSelectedEventIds:fe,isOracleMode:Qr,oraclePreviewEvent:nn,onOracleMouseDown:ys,onOracleMouseMove:qn,onOracleMouseUp:Rs,isVisualAdjustMode:Oe,visualAdjustEvent:F,onVisualAdjustTimeChange:(q,te)=>{if(F){const le=te-q,Ue={...F,startTime:q,duration:le};J(Ue),Mt(Ie=>Ie.map(he=>he.id===F.id?{...he,startTime:q,duration:le}:he))}}});case"Priorities":return e.jsx(Ww,{coursePriorities:Ht,onUpdatePriorities:ze,coursePercentages:we,onUpdatePercentages:Re,availableAircraftCount:je,onUpdateAircraftCount:$e,availableFtdCount:Ye,onUpdateFtdCount:Dt,availableCptCount:St,onUpdateCptCount:hn,flyingStartTime:Ce,onUpdateFlyingStartTime:At,flyingEndTime:B,onUpdateFlyingEndTime:Ae,ftdStartTime:rt,onUpdateFtdStartTime:yt,ftdEndTime:et,onUpdateFtdEndTime:$t,allowNightFlying:pn,onUpdateAllowNightFlying:kn,commenceNightFlying:ts,onUpdateCommenceNightFlying:un,ceaseNightFlying:Nn,onUpdateCeaseNightFlying:os,instructorsData:K,traineesData:ye,buildDfpDate:Ve,highestPriorityEvents:Ti,onSelectEvent:q=>ws(q,{isPriority:!0}),onUpdatePriorityEvent:xl,programWithPrimaries:ra,onUpdateProgramWithPrimaries:no,sctFlights:xn,sctFtds:Es,onAddSctRequest:q=>{const te={id:_r(),name:"",event:"SCT GF",currency:"",currencyExpire:"",priority:"Medium",dateRequested:d()};q==="flight"?ls(le=>[...le,te]):Zs(le=>[...le,te])},onRemoveSctRequest:(q,te)=>{te==="flight"?ls(le=>le.filter(Ue=>Ue.id!==q)):Zs(le=>le.filter(Ue=>Ue.id!==q))},onUpdateSctRequest:(q,te,le,Ue)=>{const Ie=he=>he.map(qe=>qe.id===q?{...qe,[te]:le}:qe);Ue==="flight"?ls(Ie):Zs(Ie),setTimeout(()=>{const qe=(Ue==="flight"?xn:Es).find(at=>at.id===q),dt=qe?{...qe,[te]:le}:null;console.log("ðŸ”„ SCT Request Update:",{id:q,field:te,value:le,type:Ue,requestPriority:dt==null?void 0:dt.priority,shouldSync:(dt==null?void 0:dt.priority)==="High"}),dt&&dt.priority==="High"&&(console.log("âœ… Triggering sync for HIGH priority SCT request"),_a())},100)},syllabusDetails:be,scores:nt,traineeLMPs:ot,remedialRequests:ci,onToggleRemedialRequest:(q,te)=>{ko(le=>{const Ue=le.find(he=>he.traineeId===q&&he.eventCode===te);let Ie;if(Ue){const he=!Ue.forceSchedule;console.log(`ðŸ”„ Toggling Force Schedule for trainee ${q}, event ${te}: ${Ue.forceSchedule} â†’ ${he}`),Ie=le.map(qe=>qe.traineeId===q&&qe.eventCode===te?{...qe,forceSchedule:he}:qe)}else console.log(`âœ… Creating new Force Schedule request for trainee ${q}, event ${te}`),Ie=[...le,{traineeId:q,eventCode:te,forceSchedule:!0}];return console.log("ðŸ“‹ Updated remedialRequests:",Ie.filter(he=>he.forceSchedule)),setTimeout(()=>{console.log("ðŸ”„ Manual sync triggered from setTimeout"),_a()},100),Ie})},currencyNames:ln});case"CourseProgress":return e.jsx(OA,{courses:on,traineesData:ye,courseColors:kt,scores:nt,traineeLMPs:ot,onUpdateGradDate:$l,onUpdateStartDate:pc});case"TrainingRecords":return e.jsx(_D,{courses:on,courseColors:kt,archivedCourses:ht,onAddCourse:ha,onDeleteCourse:ma,onNavigateToCourseRoster:Qi,onNavigateToArchivedCourses:yd,traineesData:ye,instructorsData:K,archivedTraineesData:ce,archivedInstructorsData:xe,events:T,scores:nt,publishedSchedules:Et,syllabusDetails:be,pt051Assessments:xt,onSavePT051Assessment:si});case"ArchivedCourses":return e.jsx(ID,{archivedCourses:ht,onUnarchiveCourse:Kc,onDeleteCourse:gc,onNavigateBack:()=>xs("TrainingRecords")});case"ProgramData":return e.jsx(Yw,{date:Ve,events:Kt.map(q=>({...q,date:Ve})),instructorsData:K,traineesData:ye,activeCourses:Ht,onNavigateAndSelectPerson:q=>{const te=[...K,...ye].find(le=>le.name===q||"fullName"in le&&le.fullName===q);te&&("role"in te?Jo(q):za(q))},scores:nt,syllabusDetails:be,traineeLMPs:ot,courseColors:kt});case"BuildAnalysis":return e.jsx(Qw,{buildDate:Ve,analysis:Mn});case"MyDashboard":const I=[];return Object.values(Et).forEach(q=>{I.push(...q)}),e.jsx(Bw,{userName:Fe!=null&&Fe.name?Fe.name.split(", ").reverse().join(" "):"Joe Bloggs",userRank:(Fe==null?void 0:Fe.rank)||"FLTLT",events:qs.filter(q=>q.instructor===_e),onSelectEvent:ws,onNavigate:xs,onSelectMyProfile:mr,onSelectMyCurrency:$n,onSelectMySct:Tn,sctRequests:[...xn,...Es],pt051Assessments:xt,onSelectPt051:q=>{console.log("ðŸ” Dashboard PT-051 clicked:",q),console.log("Looking for event ID:",q.eventId),console.log("Total events available:",I.length);const te=I.find(Ue=>Ue.id===q.eventId);console.log("Found event:",te);const le=ye.find(Ue=>Ue.fullName===q.traineeFullName);if(console.log("Found trainee:",le),te&&le)console.log("âœ… Setting event and trainee, navigating to PT051"),Nr(te),Aa(le),setTimeout(()=>{console.log("ðŸš€ Navigating to PT051 view"),xs("PT051")},0);else{console.error("âŒ Could not find event or trainee for PT-051:",{assessment:q,eventFound:!!te,traineeFound:!!le,searchingForEventId:q.eventId,availableEventIds:I.map(Ie=>Ie.id).slice(0,10),availableTrainees:ye.map(Ie=>Ie.fullName).slice(0,10),eventsForSameFlightNumber:I.filter(Ie=>Ie.flightNumber===q.flightNumber).map(Ie=>({id:Ie.id,date:Ie.date,instructor:Ie.instructor}))}),console.log("ðŸ”„ Attempting fallback search..."),console.log("Searching for:",{flightNumber:q.flightNumber,date:q.date,instructor:q.instructorName});const Ue=I.find(Ie=>Ie.flightNumber===q.flightNumber&&Ie.date===q.date&&Ie.instructor===q.instructorName);if(console.log("Fallback result:",Ue),Ue&&le)console.log("âœ… Found event using fallback (flight number + date + instructor):",Ue),Nr(Ue),Aa(le),setTimeout(()=>{console.log("ðŸš€ Navigating to PT051 view (fallback)"),xs("PT051")},0);else{console.error("âŒ Primary fallback failed",{fallbackEventFound:!!Ue,traineeFound:!!le,matchingFlightNumbers:I.filter(he=>he.flightNumber===q.flightNumber).length,matchingDates:I.filter(he=>he.date===q.date).length,matchingInstructors:I.filter(he=>he.instructor===q.instructorName).length}),console.log("ðŸ”„ Attempting secondary fallback (flight number + instructor only)...");const Ie=I.find(he=>he.flightNumber===q.flightNumber&&he.instructor===q.instructorName);if(Ie&&le)console.log("âœ… Found event using secondary fallback:",Ie),console.warn("âš ï¸ Note: Event date may differ from PT-051 date"),Nr(Ie),Aa(le),setTimeout(()=>{console.log("ðŸš€ Navigating to PT051 view (secondary fallback)"),xs("PT051")},0);else{console.error("âŒ All fallback attempts failed - cannot open PT-051"),console.log("ðŸ”§ Creating mock event as last resort...");let he="flight";const qe=q.flightNumber||"";qe.includes("CPT")||qe.includes("Cpt")?he="cpt":(qe.includes("MB")||qe.includes("GS")||qe.includes("Ground")||qe.includes("GROUND"))&&(he="ground");const dt={id:q.eventId,flightNumber:q.flightNumber,date:q.date,startTime:"08:00",endTime:"09:00",instructor:q.instructorName||"Unknown",student:q.traineeFullName,syllabus:q.flightNumber,aircraft:"",type:he,status:"Scheduled",notes:"",crew:[]};le&&(console.log("âœ… Created mock event:",dt),Nr(dt),Aa(le),setTimeout(()=>{console.log("ðŸš€ Navigating to PT051 view (mock event)"),xs("PT051")},0))}}}}});case"SupervisorDashboard":return e.jsx(Hw,{instructorsData:K,traineesData:ye,date:x,events:qs,onNavigate:xs,onOpenAuth:q=>{const te=T.find(le=>le.id===q.id)||q;hr(te),Ha(!0)}});case"Instructors":return e.jsx(hS,{onClose:()=>xs("Program Schedule"),events:T,traineesData:ye,instructorsData:K,archivedInstructorsData:xe,school:X,personnelData:bi,onUpdateInstructor:q=>{ue(te=>te.some(Ue=>Ue.idNumber===q.idNumber)?te.map(Ue=>Ue.idNumber===q.idNumber?q:Ue):[...te,q])},onNavigateToCurrency:Ns,onBulkUpdateInstructors:vd,onArchiveInstructor:q=>{const te=K.find(le=>le.idNumber===q);te&&(ue(le=>le.filter(Ue=>Ue.idNumber!==q)),Le(le=>[...le,te]))},onRestoreInstructor:q=>{const te=xe.find(le=>le.idNumber===q);te&&(Le(le=>le.filter(Ue=>Ue.idNumber!==q)),ue(le=>[...le,te]))},locations:jr,units:Wo,selectedPersonForProfile:rn,onProfileOpened:()=>gt(null),onViewLogbook:qi,onRequestSct:q=>{Fr(q),Pi(!0)}});case"Trainees":return e.jsx(mS,{onClose:()=>xs("Program Schedule"),events:T,traineesData:ye,instructorsData:K,archivedTraineesData:ce,school:X,personnelData:bi,onUpdateTrainee:q=>{pe(te=>te.some(Ue=>Ue.idNumber===q.idNumber)?te.map(Ue=>Ue.idNumber===q.idNumber?q:Ue):[...te,q])},onNavigateToCurrency:Ns,onBulkUpdateTrainees:Nd,onArchiveTrainee:q=>{const te=ye.find(le=>le.idNumber===q);te&&(He(le=>[...le,te]),pe(le=>le.filter(Ue=>Ue.idNumber!==q)))},selectedPersonForProfile:rn,onProfileOpened:()=>gt(null),onViewLogbook:qi,onRequestSct:q=>{Ri(q),Pi(!0)}});case"Syllabus":return e.jsx(xS,{syllabusDetails:be,onBack:()=>{xs(Bi),or(null)},initialSelectedId:ji||void 0,onUpdateItem:Ol});case"TraineeLMP":if($r){const q=nt.get($r.fullName)||[];let te=ot.get($r.fullName);if(!te&&$r.lmpType){console.log(`[DEBUG] TraineeLMP view - Initializing missing LMP for ${$r.fullName}`);const le=be.filter(Ue=>Ue.courses.includes($r.lmpType));le.length>0?(Vt(Ue=>{const Ie=new Map(Ue);return Ie.set($r.fullName,[...le]),console.log(`[Individual LMP] Emergency initialized ${$r.fullName}'s Individual LMP with ${$r.lmpType} (${le.length} events)`),Ie}),te=le):console.warn(`[Individual LMP] No Master LMP found for LMP type: ${$r.lmpType}`)}if(te)return e.jsx(MA,{trainee:$r,traineeLmp:te,scores:q,onBack:()=>{gt($r),xs("CourseRoster")}})}return e.jsx("div",{children:"Error: Could not load trainee LMP."});case"Currency":return $i?e.jsx(bS,{person:$i,masterCurrencies:Ei,currencyRequirements:la,allEvents:T,syllabusDetails:be,onClose:Ar,onUpdateCurrencyStatus:(q,te)=>{"role"in $i?ue(Ue=>Ue.map(Ie=>Ie.idNumber===q?{...Ie,currencyStatus:te}:Ie)):pe(Ue=>Ue.map(Ie=>Ie.idNumber===q?{...Ie,currencyStatus:te}:Ie))},registerDirtyCheck:xo}):null;case"Settings":return e.jsx(jA,{locations:jr,onUpdateLocations:Ga,units:Wo,onUpdateUnits:Yc,unitLocations:pd,onUpdateUnitLocations:xd,instructorsData:K,traineesData:ye,syllabusDetails:be,onBulkUpdateInstructors:vd,onReplaceInstructors:fu,onBulkUpdateTrainees:Nd,onReplaceTrainees:Rr,onUpdateSyllabus:bl,onShowSuccess:$s,eventLimits:Pt,onUpdateEventLimits:yn,phraseBank:Tt,onUpdatePhraseBank:lt,onNavigate:xs,masterCurrencies:Ei,currencyRequirements:la,sctEvents:Ir,onUpdateSctEvents:Vo,preferredDutyPeriod:ss,onUpdatePreferredDutyPeriod:Hn,maxCrewDutyPeriod:Jn,onUpdateMaxCrewDutyPeriod:zn,flightTurnaround:Qn,onUpdateFlightTurnaround:as,ftdTurnaround:cs,onUpdateFtdTurnaround:rs,cptTurnaround:Ms,onUpdateCptTurnaround:hs,currentUserPermission:Ke,maxDispatchPerHour:Fn,onUpdateMaxDispatchPerHour:Rn,timezoneOffset:s,onUpdateTimezoneOffset:i,formationCallsigns:Jc,onUpdateFormationCallsigns:Xc,courseColors:kt,setCourseColors:Ge,onUpdateTraineeLMPs:Vt,cancellationRecords:xi,cancellationCodes:so,dayFlyingStart:`${Math.floor(Ce).toString().padStart(2,"0")}:${Math.round(Ce%1*60).toString().padStart(2,"0")}`,dayFlyingEnd:`${Math.floor(B).toString().padStart(2,"0")}:${Math.round(B%1*60).toString().padStart(2,"0")}`,totalAircraft:24});case"CurrencyBuilder":return e.jsx(U5,{onBack:()=>xs("Settings"),masterCurrencies:Ei,currencyRequirements:la,onSave:Qt,onDelete:mn});case"PT051":if(console.log("eventForPt051:",vr),console.log("selectedTraineeForHateSheet:",Ks),vr&&Ks){const q=`pt051-${vr.id}-${Ks.fullName}`;console.log("Looking for assessment with key:",q),console.log("Available assessment keys:",Array.from(xt.keys()));let te=xt.get(q);return console.log("Direct lookup result:",te),te||(console.log("Direct lookup failed, trying fallback search..."),te=Array.from(xt.values()).find(le=>le.eventId===vr.id&&le.traineeFullName===Ks.fullName),console.log("Fallback search result:",te)),e.jsx(tA,{trainee:Ks,event:vr,initialAssessment:te,onBack:()=>{xs("HateSheet")},onEventUpdate:le=>{console.log("Updating eventForPt051 with:",le),Nr(le),E(Ue=>Ue.some(he=>he.id===le.id)?Ue.map(he=>he.id===le.id?le:he):Ue)},onDeleteAssessment:le=>{console.log("ðŸ—‘ï¸ App.tsx: onDeleteAssessment called with ID:",le);const Ue=`pt051-${vr.id}-${Ks.fullName}`;console.log("ðŸ—‘ï¸ App.tsx: Deleting assessment with key:",Ue),dn(Ie=>{const he=new Map(Ie),qe=he.delete(Ue);return console.log("ðŸ—‘ï¸ App.tsx: Assessment deleted from map:",qe),he}),console.log("ðŸ“‹ App.tsx: Logging to audit..."),Pn("Performance History","Delete",`Deleted PT-051 for ${Ks.fullName} - Event: ${vr.flightNumber} (${vr.date})`),console.log("âœ… App.tsx: Audit logged successfully"),$s("PT-051 Assessment Deleted!")},onSave:(le,Ue)=>{const Ie={...le,isCompleted:Ue?le.isCompleted:!0},he=`pt051-${vr.id}-${Ks.fullName}`;if(dn(qe=>new Map(qe).set(he,Ie)),!Ue){$s("PT-051 Assessment Saved!");const qe=[le.overallGrade?`Overall Grade: ${le.overallGrade}`:null,le.overallResult?`Overall Result: ${le.overallResult}`:null,le.dcoResult?`DCO Result: ${le.dcoResult}`:null,le.overallComments?`Comments: ${le.overallComments.substring(0,50)}...`:null].filter(Boolean).join(", ");Pn("Performance History","Edit",`Modified PT-051 for ${le.traineeFullName} - Event: ${le.flightNumber} (${le.date})`,qe)}},instructors:K,pt051Assessments:xt,events:T,lmpScores:nt.get(Ks.fullName)||[],syllabusDetails:be,registerDirtyCheck:xo,phraseBank:Tt,currentUserPin:(Fe==null?void 0:Fe.pin)||"1111"})}return console.error("âŒ PT051 View Error - Missing context:",{eventForPt051:vr,selectedTraineeForHateSheet:Ks,view}),e.jsxs("div",{className:"p-8 bg-gray-900 text-white",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-500 mb-4",children:"Error: PT-051 View Context Missing"}),e.jsxs("p",{className:"mb-2",children:["Trainee: ",Ks?"âœ… Set":"âŒ Not Set"]}),e.jsxs("p",{className:"mb-2",children:["Event: ",vr?"âœ… Set":"âŒ Not Set"]}),e.jsx("button",{onClick:()=>xs("MyDashboard"),className:"mt-4 px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700",children:"Back to Dashboard"})]});case"PostFlight":return ka?e.jsx(kA,{event:ka,onReturn:()=>{Jr(null),xs("Program Schedule")},onSave:q=>{console.log("Post flight data saved:",q),Jr(null),xs("Program Schedule"),$s("Post-flight data saved!")},school:X,traineesData:ye,instructorsData:K}):null;case"Logbook":return Ps?e.jsx(D5,{person:Ps,events:T,onBack:()=>{"role"in Ps?(gt(Ps),xs("Instructors")):(gt(Ps),xs("CourseRoster"))}}):null;case"AUTH":return e.jsx(EA,{});default:return e.jsx("div",{children:"View not found"})}};return e.jsxs("div",{id:"app-content",className:"flex h-screen bg-gray-900 text-white",children:[e.jsx(J5,{activeView:f,onNavigate:xs,courseColors:kt,onAddCourse:I=>Ge(q=>({...q,[I.number]:I.color})),onArchiveCourse:I=>{const q=kt[I];if(q){const te={...kt};delete te[I],Ge(te),vt(le=>({...le,[I]:q}))}},onNextDayBuildClick:()=>{xs("NextDayBuild")},onBuildDfpClick:Po,isSupervisor:!0,onPublish:Xo,currentUserName:_e,currentUserRank:(Fe==null?void 0:Fe.rank)||"FLTLT",instructorsList:K.map(I=>({name:I.name,rank:I.rank,unit:I.unit,pin:I.pin||"1111"})),onUserChange:tt}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[f!=="PostFlight"&&e.jsx(X5,{onAddTile:()=>{Ji(!0),ws(null,{type:"flight"})},onAddGroundEvent:()=>En(!0),showValidation:U,setShowValidation:D,locations:["ESL","PEA"],activeLocation:X,onLocationChange:I=>Mo(I),isMagnifierEnabled:P,setIsMagnifierEnabled:ae,isMultiSelectMode:Q,setIsMultiSelectMode:b,isOracleMode:Qr,onToggleOracleMode:On,showDepartureDensityOverlay:o,onToggleDepartureDensityOverlay:()=>l(!o),showAircraftAvailability:gs,onToggleAircraftAvailability:f==="Program Schedule"?()=>Os(!gs):void 0}),us()]}),P&&e.jsx(sS,{isEnabled:P}),A&&e.jsx(Iw,{event:Oe&&F?F:A,onClose:()=>{_(null),en(null),Ji(!1)},onSave:I=>ga(I,sa),onDeleteRequest:Zc,isEditingDefault:R,instructors:K.map(I=>I.name),trainees:ye.map(I=>I.fullName),syllabus:(console.log("addTileSyllabusOptions length:",Bl.length),console.log("syllabusForModal length:",ri.length),Oi?Bl:ri),syllabusDetails:be,highlightedField:O,school:X,traineesData:ye,instructorsData:K,courseColors:kt,eventsForDate:qs,onNavigateToHateSheet:I=>{Aa(I),xs("HateSheet")},onNavigateToSyllabus:I=>{Yo(I)},onOpenPt051:I=>{Nr(A),Aa(I),Pn("Flight Detail","View",`Viewed PT-051 for ${I.fullName} - Event: ${A.flightNumber} (${A.date})`),xs("PT051")},onOpenAuth:I=>{const q=T.find(te=>te.id===I.id)||I;hr(q),Ha(!0)},onOpenPostFlight:I=>{Jr(I),xs("PostFlight"),_(null)},onScoresCreated:I=>{console.log("App.tsx: onScoresCreated called with:",I);const q=new Map(nt);I.forEach(te=>{console.log("Adding score for trainee:",te.traineeName);const le=q.get(te.traineeName)||[];le.push(te),q.set(te.traineeName,le)}),console.log("Updated scores map:",q),Ct(q),console.log("Scores state updated successfully")},isConflict:ua.has(A.id)||(["NextDayBuild","Priorities","ProgramData"].includes(f)?po:Kr).has(A.id),onNeoClick:ve,traineeLMPs:ot,oracleContextForModal:an,sctRequests:[...xn,...Es],sctEvents:Ir,publishedSchedules:Et,nextDayBuildEvents:Kt,activeView:f,isAddingTile:Oi,formationCallsigns:Jc,currentLocation:X==="ESL"?"East Sale":"Pearce",onVisualAdjustStart:yo,onVisualAdjustEnd:ui,onSavePT051Assessment:si,cancellationCodes:so,onCancelEvent:Fo},`${A.id}-${A.instructor||"no-instructor"}`),ne&&e.jsx(Lw,{conflict:ne,onResolve:()=>{},onCancel:()=>V(null)}),Bs&&!De&&!pt&&e.jsx(FD,{problemTile:Bs,remedies:Ea,onApplyRemedy:Se,onCancel:zt}),pt&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[80] flex items-center justify-center animate-fade-in",onClick:()=>Jt(!1),children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-sky-500/50",onClick:I=>I.stopPropagation(),children:[e.jsx("div",{className:"p-4 border-b border-gray-700 bg-sky-900/20",children:e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Resolution Options"})}),e.jsxs("div",{className:"p-6 space-y-4 text-center",children:[e.jsxs("p",{className:"text-gray-300",children:["NEO has found multiple ways to resolve the conflict for ",e.jsx("span",{className:"font-bold text-white",children:Bs==null?void 0:Bs.event.flightNumber}),". Please choose an option:"]}),e.jsxs("div",{className:"flex justify-center space-x-4 pt-4",children:[e.jsxs("button",{onClick:it,className:"px-6 py-3 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors font-semibold shadow-lg w-1/2",children:[e.jsx("span",{className:"text-lg",children:"Time Shift"}),e.jsx("span",{className:"block text-xs text-sky-200",children:"Keep crew, change time"})]}),e.jsxs("button",{onClick:_t,className:"px-6 py-3 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors font-semibold shadow-lg w-1/2",children:[e.jsx("span",{className:"text-lg",children:"Change Crew"}),e.jsx("span",{className:"block text-xs text-amber-200",children:"Keep time, change instructor"})]})]})]})]})}),De&&k&&Bs&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[80] flex items-center justify-center animate-fade-in",onClick:Me,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-sky-500/50",onClick:I=>I.stopPropagation(),children:[e.jsx("div",{className:"p-4 border-b border-gray-700 bg-sky-900/20",children:e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Confirm Time Change"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Current Start Time:"}),e.jsx("span",{className:"text-white font-mono font-bold",children:jh(Bs.event.startTime)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Conflict Cause:"}),e.jsx("span",{className:"text-amber-400 text-sm font-medium text-right",children:Bs.errors.some(I=>I.toLowerCase().includes("previous"))?"Prior event turnaround":Bs.errors.some(I=>I.toLowerCase().includes("next"))?"Next event turnaround":"Scheduling conflict"})]})]}),e.jsxs("div",{className:"text-center pt-2",children:[e.jsx("p",{className:"text-gray-300 mb-2 text-sm",children:"Proposed New Start Time"}),e.jsx("div",{className:"text-4xl font-bold text-green-400 font-mono tracking-wider",children:jh(k.newStartTime)})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:Me,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:"Cancel"}),e.jsx("button",{onClick:ut,className:"px-4 py-2 bg-transparent border border-gray-500 text-gray-300 hover:bg-gray-700 hover:text-white rounded-md transition-colors text-sm font-semibold",children:"Change Crew Instead"}),e.jsx("button",{onClick:wt,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold",children:"Accept Time Change"})]})]})}),Ui&&di&&e.jsx(OD,{onConfirm:Pe,onCancel:()=>ao(!1),instructorName:di.type!=="trainee"?di.instructor.name:"",dutyHours:di.type!=="trainee"?di.instructor.dutyHours:0}),Do&&e.jsx(BD,{message:Do,onClose:()=>yi(null)}),ro&&e.jsx(LD,{traineeCount:Ao}),_n&&e.jsx(eS,{progress:Cs}),Cr&&e.jsx(tS,{onConfirm:pa,onCancel:()=>Fs(!1),date:Ve}),Ds.length>0&&e.jsx(nS,{notifications:Ds,onDismiss:()=>Js([])}),vn&&e.jsx(yS,{date:Ve,onConfirm:Ro,onCancel:()=>Un(!1)}),ps&&e.jsx(AA,{locality:X}),ar&&e.jsx(rS,{message:ar,onClose:()=>$s(null)}),co&&$i&&e.jsx(vS,{onClose:()=>qa(!1),allCurrencies:[...Ei,...la],visibleCurrencies:new Set([...Ei,...la].filter(I=>I.isVisible).map(I=>I.name)),onVisibilityChange:I=>{Io(q=>q.map(te=>({...te,isVisible:I.has(te.name)}))),Da(q=>q.map(te=>({...te,isVisible:I.has(te.name)})))},personName:$i.name}),uo&&e.jsx(Pv,{onSaveAndExit:()=>Zi("save"),onExitWithoutSaving:()=>Zi("discard"),onCancel:fa}),_s&&e.jsx(Fw,{onClose:()=>En(!1),onSave:L,groundSyllabus:be.filter(I=>I.type==="Ground School"),activeCourses:kt,allTraineesByCourse:S,instructors:K.map(I=>I.name),traineesData:ye}),oo&&zo&&e.jsx(sA,{event:zo,onClose:()=>Ha(!1),onAuthorise:bd,onClearAuth:I=>{E(q=>q.map(te=>{if(te.id===I){const{authoSignedBy:le,authoSignedAt:Ue,captainSignedBy:Ie,captainSignedAt:he,isVerbalAuth:qe,...dt}=te;return{...dt,authNotes:""}}return te})),Bt(q=>Object.fromEntries(Object.entries(q).map(([te,le])=>[te,le.map(Ue=>{if(Ue.id===I){const{authoSignedBy:Ie,authoSignedAt:he,captainSignedBy:qe,captainSignedAt:dt,isVerbalAuth:at,...Nt}=Ue;return{...Nt,authNotes:""}}return Ue})]))),hr(null),Ha(!1)},instructorsList:K,currentUserName:_e,currentUserRank:(Fe==null?void 0:Fe.rank)||"",currentUserUnit:Fe==null?void 0:Fe.unit}),ei&&aa&&e.jsx(FA,{trainee:aa,instructors:K,scores:nt.get(aa.fullName)||[],traineeLmp:ot.get(aa.fullName)||[],onClose:()=>Yr(!1),onSave:Rl}),li&&e.jsx(UD,{isOpen:li,onClose:()=>Mi(!1),date:x,instructors:K,trainees:ye,events:qs}),ir&&Oa&&e.jsx($D,{instructor:Oa,onClose:()=>Pi(!1),onSave:I=>{I.event.includes("FTD")?Zs(q=>[...q,I]):ls(q=>[...q,I]),Pi(!1),$s(`SCT request submitted for ${Oa.name}`)},currencyNames:["Instrument","Night","Multi-Engine","Formation"],sctEvents:Ir}),ge&&e.jsx(Av,{type:ge.type,title:ge.title,message:ge.message,variant:ge.variant,onConfirm:ge.onConfirm,onCancel:ge.onCancel,confirmText:ge.confirmText,cancelText:ge.cancelText})]})};console.log("Starting app initialization...");console.log("React imported");console.log("ReactDOM imported");console.log("App imported");const wg=document.getElementById("root");console.log("Root element:",wg);if(!wg)throw new Error("Could not find root element to mount to");const g_=Nv.createRoot(wg);class p_ extends Ua.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,s){console.error("Error caught by boundary:",t,s)}render(){var t;return this.state.hasError?e.jsxs("div",{style:{padding:"20px",color:"white",backgroundColor:"#1f2937"},children:[e.jsx("h1",{children:"Something went wrong."}),e.jsx("pre",{style:{color:"#ef4444",whiteSpace:"pre-wrap"},children:(t=this.state.error)==null?void 0:t.toString()}),e.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"10px",padding:"10px",cursor:"pointer"},children:"Reload Page"})]}):this.props.children}}g_.render(e.jsx(Ua.StrictMode,{children:e.jsx(p_,{children:e.jsx(m_,{})})}));export{br as _,y_ as c,ng as g};
public/flight-school-app/assets/index-BiUszwTI.js: */var vy;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(vy||(vy={}));var Ny;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Ny||(Ny={}));var wy;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(wy||(wy={}));var $c;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})($c||($c={}));var Sy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Sy||(Sy={}));var Cy;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Cy||(Cy={}));var Ty;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Ty||(Ty={}));var jy;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(jy||(jy={}));var Ey;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Ey||(Ey={}));var Ay;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(Ay||(Ay={}));var ky;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(ky||(ky={}));var Dy;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Dy||(Dy={}));var _y;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(_y||(_y={}));var Iy;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(Iy||(Iy={}));var Ly;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Ly||(Ly={}));var My;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(My||(My={}));var Fy;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Fy||(Fy={}));var Py;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(Py||(Py={}));var Ry;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Ry||(Ry={}));var sf;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(sf||(sf={}));var Uy;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Uy||(Uy={}));var By;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(By||(By={}));var Oy;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Oy||(Oy={}));var Mm;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Mm||(Mm={}));var $y;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})($y||($y={}));var Hy;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Hy||(Hy={}));var qy;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(qy||(qy={}));var Gy;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(Gy||(Gy={}));var zy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(zy||(zy={}));var Vy;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Vy||(Vy={}));var Wy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(Wy||(Wy={}));var Yy;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Yy||(Yy={}));var Jy;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(Jy||(Jy={}));var Xy;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(Xy||(Xy={}));var Ky;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Ky||(Ky={}));var Zy;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Zy||(Zy={}));var Qy;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Qy||(Qy={}));var e1;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(e1||(e1={}));var t1;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(t1||(t1={}));var n1;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(n1||(n1={}));var s1;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(s1||(s1={}));var r1;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(r1||(r1={}));var i1;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(i1||(i1={}));var a1;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(a1||(a1={}));var o1;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(o1||(o1={}));var l1;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(l1||(l1={}));var c1;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(c1||(c1={}));var d1;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(d1||(d1={}));var u1;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(u1||(u1={}));var f1;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(f1||(f1={}));var h1;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(h1||(h1={}));var m1;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(m1||(m1={}));var g1;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(g1||(g1={}));var p1;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(p1||(p1={}));var Zd;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Zd||(Zd={}));class Fm{constructor(t){const s={};for(const i of t.headers.entries())s[i[0]]=i[1];this.headers=s,this.responseInternal=t}json(){return this.responseInternal.json()}}class Wu{get text(){var t,s,i,o,l,d,u,f;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",m=!1;const v=[];for(const x of(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)!==null&&f!==void 0?f:[]){for(const[y,T]of Object.entries(x))y!=="text"&&y!=="thought"&&y!=="thoughtSignature"&&(T!==null||T!==void 0)&&v.push(y);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;m=!0,h+=x.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),m?h:void 0}get data(){var t,s,i,o,l,d,u,f;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const m=[];for(const v of(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)!==null&&f!==void 0?f:[]){for(const[x,y]of Object.entries(v))x!=="inlineData"&&(y!==null||y!==void 0)&&m.push(x);v.inlineData&&typeof v.inlineData.data=="string"&&(h+=atob(v.inlineData.data))}return m.length>0&&console.warn(`there are non-data parts ${m} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var t,s,i,o,l,d,u,f;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(m=>m.functionCall).map(m=>m.functionCall).filter(m=>m!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var t,s,i,o,l,d,u,f,h;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const m=(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(h=m==null?void 0:m[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var t,s,i,o,l,d,u,f,h;if(((o=(i=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const m=(f=(u=(d=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(h=m==null?void 0:m[0])===null||h===void 0?void 0:h.output}}class x1{}class y1{}class OS{}class $S{}class HS{}class qS{}class b1{}class v1{}class N1{}class GS{}class yh{_fromAPIResponse({apiResponse:t,_isVertexAI:s}){const i=new yh;let o;const l=t;return s?o=AS(l):o=ES(l),Object.assign(i,o),i}}class w1{}class S1{}class C1{}class zS{}class VS{}class WS{}class dg{_fromAPIResponse({apiResponse:t,_isVertexAI:s}){const i=new dg,l=FS(t);return Object.assign(i,l),i}}class YS{}class JS{}class XS{}class T1{}class KS{get text(){var t,s,i;let o="",l=!1;const d=[];for(const u of(i=(s=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&i!==void 0?i:[]){for(const[f,h]of Object.entries(u))f!=="text"&&f!=="thought"&&h!==null&&d.push(f);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;l=!0,o+=u.text}}return d.length>0&&console.warn(`there are non-text parts ${d} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?o:void 0}get data(){var t,s,i;let o="";const l=[];for(const d of(i=(s=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&i!==void 0?i:[]){for(const[u,f]of Object.entries(d))u!=="inlineData"&&f!==null&&l.push(u);d.inlineData&&typeof d.inlineData.data=="string"&&(o+=atob(d.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class ZS{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class ug{_fromAPIResponse({apiResponse:t,_isVertexAI:s}){const i=new ug,l=Rv(t);return Object.assign(i,l),i}}/**
