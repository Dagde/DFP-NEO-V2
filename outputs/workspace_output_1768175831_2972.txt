
export async function initializeData() {
  console.log('ğŸ”§ initializeData() v2.2 - Starting data initialization');
  
    // Read data source settings from localStorage
    let dataSourceSettings = { staff: false, trainee: false, course: false };
    try {
      const settingsStr = localStorage.getItem('dataSourceSettings');
      if (settingsStr) {
        dataSourceSettings = JSON.parse(settingsStr);
      }
      console.log('ğŸ›ï¸ Data source settings:', dataSourceSettings);
    } catch (e) {
      console.log('âš ï¸ Could not read dataSourceSettings, using defaults');
    }
    
  let instructors: any[] = [];
  let trainees: any[] = [];
  let aircraft: any[] = [];
  let scores: Record<string, any[]> = {};
  let events: any[] = [];

  try {
    console.log('ğŸŒ Initializing data from API...');
    
    // Fetch instructors
    console.log('ğŸ‘¨â€ğŸ« Fetching instructors from API...');
    instructors = await fetchInstructors();
         // Always merge with mock data for staff
         instructors = mergeInstructorData(instructors, ESL_DATA.instructors);
      
    
    // Fetch trainees
    console.log('ğŸ‘¨â€ğŸ“ Fetching trainees from API...');
    trainees = await fetchTrainees();
    console.log('âœ… Trainees loaded:', trainees.length);
      
      // Merge with mock data if trainee toggle is ON
        trainees = mergeTraineeData(trainees, ESL_DATA.trainees);
      
    
         // Always merge with mock data for trainees
         trainees = mergeTraineeData(trainees, ESL_DATA.trainees);

    // Fetch aircraft
    console.log('âœˆï¸ Fetching aircraft from API...');
    aircraft = await fetchAircraft();
    console.log('âœ… Aircraft loaded:', aircraft.length);
    
    // Fetch scores
    console.log('ğŸ“Š Fetching scores from API...');
    scores = await fetchScores();
    console.log('âœ… Scores loaded:', Object.keys(scores).length, 'trainees with scores');
    
    // Fetch schedule
    console.log('ğŸ“… Fetching schedule from API...');
