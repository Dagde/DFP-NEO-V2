                        <td className="py-2 px-2 text-gray-300 font-semibold">{event.flightNumber}</td>
                        <td className="py-2 px-2 text-gray-300">{event.soloOrDual || event.flightType || 'N/A'}</td>
                        <td className="py-2 px-2 text-gray-300">{event.currency || 'N/A'}</td>
                        <td className="py-2 px-2 text-gray-300 bg-yellow-100 text-gray-800 font-semibold">High</td>
                    </tr>
                    );
                })}
            </tbody>
        </table>
      </div>
  );
  
     return (
       <>
           <div className="section-course-priority grid grid-cols-1 lg:grid-cols-2 gap-6">

            <div className="bg-gray-800 rounded-lg shadow-lg border border-gray-700 h-fit">
                <div className="p-4 flex justify-between items-center">
                    <h2 className="text-lg font-semibold text-gray-200">Course Priority</h2>
                    <span className="text-xs text-gray-500">Last updated: {courseTimestamp}</span>
                </div>
                <div className="p-4 border-t border-gray-700">
                    <ul className="space-y-2">
                        {coursePriorities.map((course, index) => (
                            <li
                                key={course}
                                draggable
                                onDragStart={() => handleCourseDragStart(index)}
                                onDragEnter={() => handleCourseDragEnter(index)}
                                onDragEnd={handleCourseDragEnd}
                                onDragOver={(e) => e.preventDefault()}
                                className="p-3 bg-gray-700/50 rounded-md text-white flex items-center justify-between cursor-grab active:cursor-grabbing"
                            >
                                <div className="flex items-center space-x-3">
                                    <span className="font-mono text-gray-500">{index + 1}</span>
                                    <span className="font-semibold">{course}</span>
                                </div>
                                <div className="flex items-center space-x-2">
                                    <span className={`font-mono w-12 text-center ${totalPercentage !== 100 && 'text-red-400'}`}>{coursePercentages.get(course) ?? 0}%</span>
                                    <div className="flex flex-col">
                                        <ArrowButton direction="up" onClick={() => handlePercentageChange(course, 'increase')} disabled={(coursePercentages.get(course) ?? 0) >= 100} />
                                        <ArrowButton direction="down" onClick={() => handlePercentageChange(course, 'decrease')} disabled={(coursePercentages.get(course) ?? 0) <= 5} />
                                    </div>
                                </div>
                            </li>
                        ))}
                    </ul>
                     <div className={`mt-3 p-2 rounded text-center text-sm font-semibold ${totalPercentage === 100 ? 'bg-green-500/20 text-green-300' : 'bg-amber-500/20 text-amber-300'}`}>
                        Total: {totalPercentage}%
                    </div>
                    <div className="mt-2 p-2 bg-blue-500/10 border border-blue-500/30 rounded text-xs text-blue-300">
                        <p className="font-semibold mb-1">ℹ️ Weighted Priority System:</p>
                        <ul className="list-disc list-inside space-y-1 text-blue-200">
                            <li>Percentages are auto-normalized to 100%</li>
                            <li>Minimum percentage per course: 5%</li>
                            <li>Higher % = more events (biased allocation)</li>
                            <li>All courses still get events (no starvation)</li>
                        </ul>
                    </div>
                </div>
            </div>
           </div>

           <div className="section-build-factors">

            <div className="space-y-6">
                <div className="bg-gray-800 rounded-lg shadow-lg border border-gray-700 h-fit">
                    <div className="p-4 flex justify-between items-center">
                        <h2 className="text-lg font-semibold text-gray-200">Build Factors</h2>
                    </div>
                     <div className="p-4 border-t border-gray-700 space-y-4">
                        <div>
                            <label htmlFor="aircraft-count" className="block text-sm font-medium text-gray-400">Available Aircraft</label>
                            <input id="aircraft-count" type="number" value={availableAircraftCount} onChange={(e) => { logAudit("Priorities", "Edit", "Updated available aircraft count", `${availableAircraftCount} → ${parseInt(e.target.value)}`); onUpdateAircraftCount(parseInt(e.target.value)); }} className="w-full mt-1 bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"/>
                        </div>
                        <div>
                            <label htmlFor="ftd-count" className="block text-sm font-medium text-gray-400">FTD Available</label>
                            <input id="ftd-count" type="number" value={availableFtdCount} onChange={(e) => { logAudit("Priorities", "Edit", "Updated available FTD count", `${availableFtdCount} → ${parseInt(e.target.value)}`); onUpdateFtdCount(parseInt(e.target.value)); }} className="w-full mt-1 bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"/>
                        </div>
                        <div>
                            <label htmlFor="cpt-count" className="block text-sm font-medium text-gray-400">CPT Available</label>
                            <input id="cpt-count" type="number" value={availableCptCount} onChange={(e) => { logAudit("Priorities", "Edit", "Updated available CPT count", `${availableCptCount} → ${parseInt(e.target.value)}`); onUpdateCptCount(parseInt(e.target.value)); }} className="w-full mt-1 bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"/>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-400">Day Flying Window</label>
                            <div className="flex items-center space-x-2 mt-1">
                                <select value={flyingStartTime} onChange={(e) => { logAudit("Priorities", "Edit", "Updated flying start time", `${flyingStartTime} → ${parseFloat(e.target.value)}`); onUpdateFlyingStartTime(parseFloat(e.target.value)); }} className="w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500 text-center">
                                    {timeOptions.map(opt => <option key={opt.value} value={opt.value}>{opt.label}</option>)}
                                </select>
                                <span className="text-gray-400">to</span>
                                <select value={flyingEndTime} onChange={(e) => { logAudit("Priorities", "Edit", "Updated flying end time", `${flyingEndTime} → ${parseFloat(e.target.value)}`); onUpdateFlyingEndTime(parseFloat(e.target.value)); }} className="w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500 text-center">
                                    {timeOptions.map(opt => <option key={opt.value} value={opt.value}>{opt.label}</option>)}
                                </select>
                            </div>
                        </div>
                           <div>
                               <label className="block text-sm font-medium text-gray-400">FTD Operating Window</label>
                               <div className="flex items-center space-x-2 mt-1">
                                   <select value={ftdStartTime} onChange={(e) => { logAudit("Priorities", "Edit", "Updated FTD start time", `${ftdStartTime} → ${parseFloat(e.target.value)}`); onUpdateFtdStartTime(parseFloat(e.target.value)); }} className="w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500 text-center">
                                       {timeOptions.map(opt => <option key={opt.value} value={opt.value}>{opt.label}</option>)}
