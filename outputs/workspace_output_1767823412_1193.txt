public/flight-school-app/assets/index-DfaaHY89.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),J=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(J);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{J&&K(!0)},[J]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${J?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const J=n.eventCategory==="sct";J&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const ee=J||n.flightType==="Solo"?n.pilot:n.instructor,K=J?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(J&&n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(J&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(console.log("🔍 SOLO CHECK:",{pilot:n.pilot,student:n.student,flightType:n.flightType,areEqual:n.pilot===n.student}),n.pilot&&n.student&&n.pilot===n.student)return console.log("🎯 FALLBACK SOLO DETECTION: Pilot and student are the same:",n.pilot),e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-DfaaHY89.js: */const WE="gl-node/";class YE{constructor(t){var s;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(s=t.vertexai)!==null&&s!==void 0?s:!1,this.apiKey=t.apiKey;const i=CS(t.httpOptions,t.vertexai,void 0,void 0);i&&(t.httpOptions?t.httpOptions.baseUrl=i:t.httpOptions={baseUrl:i}),this.apiVersion=t.apiVersion;const o=new VE(this.apiKey);this.apiClient=new cj({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:WE+"web",uploader:new qE,downloader:new ME}),this.models=new Aj(this.apiClient),this.live=new wj(this.apiClient,o,new GE),this.batches=new QC(this.apiClient),this.chats=new MT(this.models,this.apiClient),this.caches=new _T(this.apiClient),this.files=new GT(this.apiClient),this.operations=new kj(this.apiClient),this.authTokens=new zj(this.apiClient),this.tunings=new LE(this.apiClient),this.fileSearchStores=new mE(this.apiClient)}}const d2=[{category:"Core Dimensions",elements:["Airmanship","Preparation","Technique"]},{category:"Procedural Framework",elements:["Pre-Post Flight","Walk Around","Strap-in","Ground Checks","Airborne Checks"]},{category:"Takeoff",elements:["Stationary"]},{category:"Departure",elements:["Visual"]},{category:"Core Handling Skills",elements:["Effects of Control","Trimming","Straight and Level"]},{category:"Turns",elements:["Level medium Turn","Level Steep turn"]},{category:"Recovery",elements:["Visual - Initial & Pitch"]},{category:"Landing",elements:["Landing","Crosswind"]},{category:"Domestics",elements:["Radio Comms","Situational Awareness","Lookout","Knowledge"]}],JE=d2.flatMap(n=>n.elements),z1=["DEMO",0,1,2,3,4,5],XE=["No Grade",0,1,2,3,4,5],Hm=["QFI","Weather","Profile","Overall","NEST"],KE=n=>{const t={QFI:"",Weather:"",Profile:"",Overall:"",NEST:""};if(!n)return t;const s={...t};return Hm.forEach((i,o)=>{const l=Hm[o+1],d=`${i}:`,u=n.indexOf(d);if(u!==-1){let f=u+d.length,h=-1;if(l){const v=`${l}:`;h=n.indexOf(v,f)}let m="";h!==-1?m=n.substring(f,h):m=n.substring(f),s[i]=m.trim()}}),s};function ZE(n){let t="";const s=n.byteLength;for(let i=0;i<s;i++)t+=String.fromCharCode(n[i]);return btoa(t)}const QE=({element:n,onClose:t,onInsert:s,phraseBank:i})=>{const[o,l]=C.useState(new Set);let d=i==null?void 0:i[n];const u=["Airmanship","Preparation","Technique"].includes(n);!d&&!u&&(d=i==null?void 0:i["Generic Flying Elements"]);const f=v=>{const x=new Set(o);x.has(v)?x.delete(v):x.add(v),l(x)},h=()=>{const v=Array.from(o).join(" ");s(v)},m=v=>{switch(v){case"5":return"5 - Excellent";case"4":return"4 - High Satisfactory";case"3":return"3 - Satisfactory";case"2":return"2 - Low Satisfactory";case"1":return"1 - Marginal";case"0":return"0 - Unsatisfactory";default:return v}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[80] flex items-center justify-center animate-fade-in",onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700 flex flex-col max-h-[80vh]",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-bold text-white",children:["Select Phrases: ",e.jsx("span",{className:"text-sky-400",children:n})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 overflow-y-auto flex-1 space-y-4",children:d?Object.entries(d).sort((v,x)=>Number(x[0])-Number(v[0])).map(([v,x])=>{const y=x;return y.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2 border-b border-gray-700 pb-1",children:m(v)}),e.jsx("div",{className:"space-y-2",children:y.map((T,E)=>e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer p-2 rounded hover:bg-gray-700/50",children:[e.jsx("input",{type:"checkbox",checked:o.has(T),onChange:()=>f(T),className:"mt-1 h-4 w-4 accent-sky-500 bg-gray-600 border-gray-500 rounded"}),e.jsx("span",{className:"text-sm text-gray-200",children:T})]},E))})]},v)}):e.jsxs("div",{className:"text-center py-8 text-gray-500 italic",children:[e.jsx("p",{children:"No phrase list available for this element."}),e.jsx("p",{className:"text-xs mt-2",children:"Configure in Settings → Scoring Matrix."})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-900/50 flex justify-end space-x-3",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm font-semibold",children:"Cancel"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 text-sm font-semibold",children:"Insert Selected"})]})]})})},eA=new YE({apiKey:""}),tA=({trainee:n,event:t,onBack:s,onSave:i,onDeleteAssessment:o,onEventUpdate:l,initialAssessment:d,instructors:u,pt051Assessments:f,events:h,lmpScores:m,syllabusDetails:v,registerDirtyCheck:x,phraseBank:y,currentUserPin:T})=>{const[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState("Saved"),W=C.useRef(!0),[ne,V]=C.useState(null),U=C.useRef(null),D=C.useRef(null),$=C.useRef(null),M=C.useRef(null),P=C.useRef(null),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(null),fe=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500",ge=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500";C.useMemo(()=>t.instructor&&u.find(we=>we.name===t.instructor)||null,[t.instructor,u]);const[Ne,Oe]=C.useState(()=>d&&(d.startTime!==void 0||d.duration!==void 0)?{...t,startTime:d.startTime||t.startTime,duration:d.duration||t.duration}:t),[se,F]=C.useState(()=>d||{id:_r(),traineeFullName:n.fullName,eventId:t.id,flightNumber:t.flightNumber,date:t.date,instructorName:t.instructor||"",scores:JE.map(we=>({element:we,grade:null,comment:""})),overallGrade:null,overallResult:null,groundSchoolAssessment:{isAssessment:!1,result:void 0}}),X=we=>{const Re={...Ne,...we};Oe(Re),l&&l(Re)},[J,ee]=C.useState(()=>{const we=KE(d==null?void 0:d.overallComments);return!we.QFI&&t.instructor&&(we.QFI=t.instructor),we}),[K,ue]=C.useState((d==null?void 0:d.overallGrade)||null),[xe,Le]=C.useState((d==null?void 0:d.overallResult)||null),[ye,pe]=C.useState((d==null?void 0:d.groundSchoolAssessment)||{isAssessment:!1,result:void 0}),[ce,He]=C.useState((d==null?void 0:d.dcoResult)||""),_e=C.useMemo(()=>{const we=[],Re=ot=>{const Vt=v.find(yn=>yn.id===ot||yn.code===ot);if(Vt)return Vt.type==="Flight"||Vt.type==="FTD";const Pt=ot.toUpperCase();return!!((Pt.includes("FTD")||Pt.startsWith("BGF")||Pt.startsWith("BIF")||Pt.startsWith("BNF")||Pt.startsWith("BNAV")||Pt.startsWith("SCT"))&&!Pt.includes("MB")&&!Pt.includes("TUT")&&!Pt.includes("CPT"))};m.forEach(ot=>{Re(ot.event)&&we.push({name:ot.event,score:ot.score,date:ot.date,timestamp:new Date(ot.date).getTime()})}),f.forEach(ot=>{ot.traineeFullName===n.fullName&&ot.eventId!==t.id&&ot.overallGrade!==null&&ot.overallGrade!=="No Grade"&&Re(ot.flightNumber)&&we.push({name:ot.flightNumber,score:ot.overallGrade,date:ot.date,timestamp:new Date(ot.date).getTime()})}),we.sort((ot,Vt)=>Vt.timestamp-ot.timestamp);const be=new Date(t.date).getTime(),Ze=we.filter(ot=>ot.timestamp<be);return Ze.length>0?Ze[0]:null},[m,f,n.fullName,v,t.date,t.id]);C.useEffect(()=>{K===1&&_e&&Number(_e.score)===1?(A(!0),Le("F")):A(!1)},[K,_e]),C.useEffect(()=>{K==="No Grade"||K===null?Le(null):K===0?Le("F"):K>=1&&K<=5&&Le("P")},[K]);const Z=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,grade:Re}:Ze)}))},Fe=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,comment:Re}:Ze)}))},Xe=(we,Re)=>{ee(be=>({...be,[we]:Re})),we==="QFI"&&F(be=>({...be,instructorName:Re}))},ft=C.useMemo(()=>u.filter(we=>we.unit===n.unit),[u,n.unit]),tt=we=>{F(Re=>({...Re,instructorName:we})),ee(Re=>({...Re,QFI:we}))},We=we=>{if(we==null)return"";let Re=we;Re>=24&&(Re-=24);const be=Math.floor(Re),Ze=Math.round((Re-be)*60);return`${be.toString().padStart(2,"0")}${Ze.toString().padStart(2,"0")}`},Ke=(we,Re)=>{let be=we.currentTarget.value;be=be.replace(/\D/g,""),be.length>4&&(be=be.substring(0,4)),we.currentTarget.value=be},nt=we=>{const Re=t==null?void 0:t.target;if(!Re)return;let be=Re.value;if(be.length>0){const Ze=be.padStart(4,"0"),ot=parseInt(Ze);if(!isNaN(ot)&&ot>=0&&ot<=2359&&ot%100<60){const Vt=Math.floor(ot/100),Pt=ot%100,yn=Vt+Pt/60;if(Re.value=Ze,we==="startTime"){const Tt={...Ne,startTime:yn};Oe(Tt),X(Tt)}else{const Tt=Ne.startTime||0,lt=yn-Tt;if(lt>0){const Et={...Ne,duration:lt};Oe(Et),X(Et)}}}else if(Re.value="",we==="startTime"){const Vt={...Ne,startTime:null};Oe(Vt),X(Vt)}}},Ct=(we,Re)=>{if(we.key==="Enter"&&(we.preventDefault(),nt(Re),Re==="startTime")){const be=document.querySelector('input[placeholder="hhmm"]:last-of-type');be==null||be.focus()}},xt=()=>{U.current&&(U.current.then(we=>we.close()),U.current=null),P.current&&(P.current.disconnect(),P.current=null),M.current&&(M.current.disconnect(),M.current=null),$.current&&($.current.getTracks().forEach(we=>we.stop()),$.current=null),D.current&&D.current.state!=="closed"&&(D.current.close(),D.current=null),V(null)},dn=async(we,Re)=>{if(ne===we){xt();return}ne&&xt(),V(we);try{const be=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3});D.current=be;const Ze=await navigator.mediaDevices.getUserMedia({audio:!0});$.current=Ze;const ot=be.createMediaStreamSource(Ze);P.current=ot;const Vt=be.createScriptProcessor(4096,1,1);M.current=Vt;const Pt=eA.live.connect({model:"gemini-2.5-flash-native-audio-preview-09-2025",config:{responseModalities:[sf.AUDIO],inputAudioTranscription:{}},callbacks:{onopen:()=>console.log("Gemini Live Connected"),onmessage:yn=>{var Tt;if((Tt=yn.serverContent)!=null&&Tt.inputTranscription){const lt=yn.serverContent.inputTranscription.text;if(lt&&Re==="section"){const Et=we;ee(Bt=>({...Bt,[Et]:(Bt[Et]||"")+lt}))}}},onclose:()=>{ne===we&&xt()},onerror:()=>xt()}});U.current=Pt,Vt.onaudioprocess=yn=>{const Tt=yn.inputBuffer.getChannelData(0),lt=on(Tt);U.current&&U.current.then(Et=>{Et&&Et.sendRealtimeInput({media:lt})})},ot.connect(Vt),Vt.connect(be.destination)}catch(be){console.error("Failed to start voice input:",be),xt()}};function on(we){const Re=we.length,be=new Int16Array(Re);for(let Ze=0;Ze<Re;Ze++)be[Ze]=we[Ze]*32768;return{data:ZE(new Uint8Array(be.buffer)),mimeType:"audio/pcm;rate=16000"}}C.useEffect(()=>()=>{xt()},[]);const st=we=>{Y(we),Q(!0)},kt=we=>{Te&&F(Re=>({...Re,scores:Re.scores.map(be=>be.element===Te?{...be,comment:(be.comment?be.comment+" ":"")+we}:be)})),Q(!1),Y(null)};C.useEffect(()=>{const we=Hm.map(Re=>`${Re}:
public/flight-school-app/assets/index-DfaaHY89.js:`)}return""+s},t})();const DD=({traineesData:n,instructorsData:t,archivedTraineesData:s,archivedInstructorsData:i,events:o,courses:l,archivedCourses:d,scores:u,publishedSchedules:f,syllabusDetails:h,pt051Assessments:m,onSavePT051Assessment:v})=>{const[x,y]=C.useState("all"),[T,E]=C.useState("all-time"),[A,_]=C.useState(""),[R,H]=C.useState(""),[O,W]=C.useState(""),[ne,V]=C.useState("pdf"),[U,D]=C.useState(!1),[$,M]=C.useState([]),[P,ae]=C.useState([]),[Q,Te]=C.useState([]),[Y,fe]=C.useState([]),[ge,Ne]=C.useState("all"),[Oe,se]=C.useState("all"),[F,X]=C.useState(""),[J,ee]=C.useState(""),[K,ue]=C.useState(""),[xe,Le]=C.useState(!1),[ye,pe]=C.useState(""),[ce,He]=C.useState(!1),[_e,Z]=C.useState(!1),[Fe,Xe]=C.useState(!1),[ft,tt]=C.useState(0),[We,Ke]=C.useState(""),[nt,Ct]=C.useState([]),[xt,dn]=C.useState(!1),[on,st]=C.useState([]),[kt,Ge]=C.useState(!1),[ht,vt]=C.useState(0),[Ht,ze]=C.useState(""),we=B=>{if(!B)return"";const Ae=new Date(B),rt=String(Ae.getDate()).padStart(2,"0"),yt=Ae.toLocaleString("en-GB",{month:"short"}),et=String(Ae.getFullYear()).slice(-2);return`${rt} ${yt} ${et}`},Re=C.useMemo(()=>{const B=Object.values(f).flat();return console.log("📊 Export View - All events from published schedules:",B.length),console.log("📊 Export View - Published schedule dates:",Object.keys(f)),B},[f]),be=C.useMemo(()=>{const B=[...n,...s];return console.log("📊 Export View - All trainees:",B.length),console.log("📊 Export View - ADF303 trainees:",B.filter(Ae=>Ae.course==="ADF303").length),B},[n,s]),Ze=C.useMemo(()=>[...t,...i],[t,i]),ot=C.useMemo(()=>{const B=l.map(rt=>rt.name),Ae=Object.keys(d);return[...new Set([...B,...Ae])]},[l,d]),Vt=C.useMemo(()=>ot.filter(B=>B.toLowerCase().includes(F.toLowerCase())),[ot,F]),Pt=C.useMemo(()=>be.filter(B=>`${B.rank} ${B.name} ${B.course}`.toLowerCase().includes(J.toLowerCase())),[be,J]),yn=C.useMemo(()=>Ze.filter(B=>`${B.rank} ${B.name}`.toLowerCase().includes(K.toLowerCase())),[Ze,K]),Tt=C.useMemo(()=>{let B=[...Re];if(console.log("🔍 FILTER DEBUG - Starting with events:",B.length),console.log("🔍 FILTER DEBUG - timePeriod:",T),console.log("🔍 FILTER DEBUG - singleDate:",A),console.log("🔍 FILTER DEBUG - startDate:",R),console.log("🔍 FILTER DEBUG - endDate:",O),T==="single-date"&&A?(B=B.filter(Ae=>Ae.date===A),console.log("🔍 FILTER DEBUG - After single-date filter:",B.length)):T==="date-range"&&R&&O&&(B=B.filter(Ae=>Ae.date>=R&&Ae.date<=O),console.log("🔍 FILTER DEBUG - After date-range filter:",B.length)),Y.length>0){console.log("🔍 FILTER DEBUG - selectedEventTypes:",Y),console.log("🔍 FILTER DEBUG - Sample event types from data (first 5):",B.slice(0,5).map(rt=>rt.type)),console.log("🔍 FILTER DEBUG - Unique event types in data:",[...new Set(B.map(rt=>rt.type))]);const Ae=Y.map(rt=>rt.toLowerCase());B=B.filter(rt=>{const yt=rt.type.toLowerCase();return Ae.includes(yt)}),console.log("🔍 FILTER DEBUG - After event type filter:",B.length)}if(console.log("🔍 FILTER DEBUG - statusFilter:",ge),console.log("🔍 FILTER DEBUG - Before status filter:",B.length),ge==="dco"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="DCO"}):ge==="dnco"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="DNCO"}):ge==="pass"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="Pass"}):ge==="fail"&&(B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="Fail"})),console.log("🔍 FILTER DEBUG - After all status filters:",B.length),console.log("🔍 FILTER DEBUG - remedialFilter:",Oe),Oe==="yes"?(B=B.filter(Ae=>Ae.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=yes filter:",B.length)):Oe==="no"&&(B=B.filter(Ae=>!Ae.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=no filter:",B.length)),$.length>0&&(console.log("📊 Trainee filter - Selected trainees:",$),console.log("📊 Trainee filter - Events before filter:",B.length),B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;return rt?$.some(et=>!!(rt===et||rt.startsWith(et+" –")||rt.startsWith(et+" -"))):!1}),console.log("📊 Trainee filter - Events after filter:",B.length)),P.length>0&&(B=B.filter(Ae=>Ae.instructor&&P.includes(Ae.instructor))),Q.length>0){const Ae=be.filter(yt=>Q.includes(yt.course)),rt=Ae.map(yt=>yt.name);console.log("📊 Course filter - Selected courses:",Q),console.log("📊 Course filter - Trainees in selected courses:",Ae.length),console.log("📊 Course filter - Trainee names (first 5):",rt.slice(0,5)),console.log("📊 Course filter - Events before filter:",B.length),console.log("📊 Course filter - Sample event student names (first 5):",B.slice(0,5).map(yt=>yt.student||yt.pilot)),B=B.filter(yt=>{const et=yt.student||yt.pilot;if(!et)return!1;const $t=rt.some(pn=>!!(et===pn||et.startsWith(pn+" –")||et.startsWith(pn+" -")));return $t||console.log("📊 No match for student:",et),$t}),console.log("📊 Course filter - Events after filter:",B.length)}return B},[Re,T,A,R,O,Y,ge,Oe,$,P,Q,n]),lt=C.useMemo(()=>{if(Q.length===0)return[];const B=be.filter(et=>Q.includes(et.course));let Ae=Re;T==="single-date"&&A?Ae=Ae.filter(et=>et.date===A):T==="date-range"&&R&&O&&(Ae=Ae.filter(et=>et.date>=R&&et.date<=O));const rt=Ae.filter(et=>Q.some($t=>{const pn=et.student||et.pilot;return pn?B.find(ts=>pn===ts.name||pn.startsWith(ts.name+" –")||pn.startsWith(ts.name+" -")):!1}));return[...new Set(rt.map(et=>{const $t=et.student||et.pilot;if(!$t)return null;const pn=B.find(kn=>$t===kn.name||$t.startsWith(kn.name+" –")||$t.startsWith(kn.name+" -"));return pn==null?void 0:pn.name}).filter(Boolean))]},[Re,Q,T,A,R,O,be]),Et=C.useMemo(()=>(console.log("📊 filteredData calculation - recordType:",x),console.log("📊 filteredData calculation - filteredEvents:",Tt.length),console.log("📊 filteredData calculation - allTrainees:",be.length),console.log("📊 filteredData calculation - allInstructors:",Ze.length),x==="events"?{events:Tt,trainees:[],staff:[]}:x==="trainees"?(console.log("📊 Returning all trainees:",be.length),{events:Tt,trainees:be,staff:[]}):x==="staff"?(console.log("📊 Returning all staff:",Ze.length),{events:Tt,trainees:[],staff:Ze}):(console.log("📊 Returning all trainees and staff"),{events:Tt,trainees:be,staff:Ze})),[x,Tt,be,Ze]),Bt=C.useMemo(()=>{let B=0;return(x==="all"||x==="trainees")&&(B+=Et.trainees.length),(x==="all"||x==="staff")&&(B+=Et.staff.length),(x==="all"||x==="events")&&(B+=Et.events.length),B},[x,Et]),Kt=C.useMemo(()=>{const Ae=Bt*(ne==="pdf"?5e3:ne==="excel"?2e3:500);return Ae<1024?`${Ae} B`:Ae<1024*1024?`${(Ae/1024).toFixed(1)} KB`:`${(Ae/(1024*1024)).toFixed(1)} MB`},[Bt,ne]),Mt=Bt>1e3,Ve=()=>T==="all-time"?"All time":T==="single-date"&&A?we(A):T==="date-range"&&R&&O?`${we(R)} to ${we(O)}`:"Not specified",qt=()=>x==="all"?"All records (Trainees, Staff, Events)":x==="trainees"?"Trainee records":x==="staff"?"Staff records":"Event records",Mn=async()=>{console.log("🚀 Starting export...",{recordType:x,timePeriod:T,outputFormat:ne,recordCount:Bt,data:Et});const rt=`training_records_${new Date().toISOString().split("T")[0]}.${ne==="excel"?"xlsx":ne}`;try{console.log("📄 Export format:",ne),Xe(!0),tt(0),Ke("Preparing export..."),ne==="csv"?(console.log("📊 Exporting CSV..."),console.log("📊 Record count:",Bt),Ke("Generating CSV file..."),jn(rt),console.log("✅ CSV export completed")):ne==="excel"?(console.log("📊 Exporting Excel..."),console.log("📊 Record count:",Bt),Ke("Generating Excel file..."),je(rt),console.log("✅ Excel export completed")):ne==="pdf"&&(console.log("📄 Exporting PDF..."),console.log("📄 Record count:",Bt),console.log("📄 Events to export:",Et.events.length),Ke(`Generating PDF (${Et.events.length} records)...`),await $e(rt),console.log("✅ PDF export completed")),Xe(!1),console.log("✅ Showing success message"),He(!0),setTimeout(()=>He(!1),5e3)}catch(yt){console.error("❌ Export error:",yt),console.error("Error stack:",yt instanceof Error?yt.stack:"No stack trace"),Xe(!1),Z(!0),setTimeout(()=>Z(!1),5e3)}},jn=B=>{let Ae="";(x==="all"||x==="events")&&(Ae+=`EVENTS
public/flight-school-app/assets/index-BjUJyT2V.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct";X&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=X?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return console.log("🎯 FALLBACK SOLO DETECTION: Pilot and student are the same:",n.pilot),e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-BjUJyT2V.js: */const WE="gl-node/";class YE{constructor(t){var s;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(s=t.vertexai)!==null&&s!==void 0?s:!1,this.apiKey=t.apiKey;const i=CS(t.httpOptions,t.vertexai,void 0,void 0);i&&(t.httpOptions?t.httpOptions.baseUrl=i:t.httpOptions={baseUrl:i}),this.apiVersion=t.apiVersion;const o=new VE(this.apiKey);this.apiClient=new cj({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:WE+"web",uploader:new qE,downloader:new ME}),this.models=new Aj(this.apiClient),this.live=new wj(this.apiClient,o,new GE),this.batches=new QC(this.apiClient),this.chats=new MT(this.models,this.apiClient),this.caches=new _T(this.apiClient),this.files=new GT(this.apiClient),this.operations=new kj(this.apiClient),this.authTokens=new zj(this.apiClient),this.tunings=new LE(this.apiClient),this.fileSearchStores=new mE(this.apiClient)}}const d2=[{category:"Core Dimensions",elements:["Airmanship","Preparation","Technique"]},{category:"Procedural Framework",elements:["Pre-Post Flight","Walk Around","Strap-in","Ground Checks","Airborne Checks"]},{category:"Takeoff",elements:["Stationary"]},{category:"Departure",elements:["Visual"]},{category:"Core Handling Skills",elements:["Effects of Control","Trimming","Straight and Level"]},{category:"Turns",elements:["Level medium Turn","Level Steep turn"]},{category:"Recovery",elements:["Visual - Initial & Pitch"]},{category:"Landing",elements:["Landing","Crosswind"]},{category:"Domestics",elements:["Radio Comms","Situational Awareness","Lookout","Knowledge"]}],JE=d2.flatMap(n=>n.elements),z1=["DEMO",0,1,2,3,4,5],XE=["No Grade",0,1,2,3,4,5],Hm=["QFI","Weather","Profile","Overall","NEST"],KE=n=>{const t={QFI:"",Weather:"",Profile:"",Overall:"",NEST:""};if(!n)return t;const s={...t};return Hm.forEach((i,o)=>{const l=Hm[o+1],d=`${i}:`,u=n.indexOf(d);if(u!==-1){let f=u+d.length,h=-1;if(l){const v=`${l}:`;h=n.indexOf(v,f)}let m="";h!==-1?m=n.substring(f,h):m=n.substring(f),s[i]=m.trim()}}),s};function ZE(n){let t="";const s=n.byteLength;for(let i=0;i<s;i++)t+=String.fromCharCode(n[i]);return btoa(t)}const QE=({element:n,onClose:t,onInsert:s,phraseBank:i})=>{const[o,l]=C.useState(new Set);let d=i==null?void 0:i[n];const u=["Airmanship","Preparation","Technique"].includes(n);!d&&!u&&(d=i==null?void 0:i["Generic Flying Elements"]);const f=v=>{const x=new Set(o);x.has(v)?x.delete(v):x.add(v),l(x)},h=()=>{const v=Array.from(o).join(" ");s(v)},m=v=>{switch(v){case"5":return"5 - Excellent";case"4":return"4 - High Satisfactory";case"3":return"3 - Satisfactory";case"2":return"2 - Low Satisfactory";case"1":return"1 - Marginal";case"0":return"0 - Unsatisfactory";default:return v}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[80] flex items-center justify-center animate-fade-in",onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700 flex flex-col max-h-[80vh]",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-bold text-white",children:["Select Phrases: ",e.jsx("span",{className:"text-sky-400",children:n})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 overflow-y-auto flex-1 space-y-4",children:d?Object.entries(d).sort((v,x)=>Number(x[0])-Number(v[0])).map(([v,x])=>{const y=x;return y.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2 border-b border-gray-700 pb-1",children:m(v)}),e.jsx("div",{className:"space-y-2",children:y.map((T,E)=>e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer p-2 rounded hover:bg-gray-700/50",children:[e.jsx("input",{type:"checkbox",checked:o.has(T),onChange:()=>f(T),className:"mt-1 h-4 w-4 accent-sky-500 bg-gray-600 border-gray-500 rounded"}),e.jsx("span",{className:"text-sm text-gray-200",children:T})]},E))})]},v)}):e.jsxs("div",{className:"text-center py-8 text-gray-500 italic",children:[e.jsx("p",{children:"No phrase list available for this element."}),e.jsx("p",{className:"text-xs mt-2",children:"Configure in Settings → Scoring Matrix."})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-900/50 flex justify-end space-x-3",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm font-semibold",children:"Cancel"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 text-sm font-semibold",children:"Insert Selected"})]})]})})},eA=new YE({apiKey:""}),tA=({trainee:n,event:t,onBack:s,onSave:i,onDeleteAssessment:o,onEventUpdate:l,initialAssessment:d,instructors:u,pt051Assessments:f,events:h,lmpScores:m,syllabusDetails:v,registerDirtyCheck:x,phraseBank:y,currentUserPin:T})=>{const[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState("Saved"),W=C.useRef(!0),[ne,V]=C.useState(null),U=C.useRef(null),D=C.useRef(null),$=C.useRef(null),M=C.useRef(null),P=C.useRef(null),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(null),fe=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500",ge=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500";C.useMemo(()=>t.instructor&&u.find(we=>we.name===t.instructor)||null,[t.instructor,u]);const[Ne,Oe]=C.useState(()=>d&&(d.startTime!==void 0||d.duration!==void 0)?{...t,startTime:d.startTime||t.startTime,duration:d.duration||t.duration}:t),[se,F]=C.useState(()=>d||{id:_r(),traineeFullName:n.fullName,eventId:t.id,flightNumber:t.flightNumber,date:t.date,instructorName:t.instructor||"",scores:JE.map(we=>({element:we,grade:null,comment:""})),overallGrade:null,overallResult:null,groundSchoolAssessment:{isAssessment:!1,result:void 0}}),J=we=>{const Re={...Ne,...we};Oe(Re),l&&l(Re)},[X,ee]=C.useState(()=>{const we=KE(d==null?void 0:d.overallComments);return!we.QFI&&t.instructor&&(we.QFI=t.instructor),we}),[K,ue]=C.useState((d==null?void 0:d.overallGrade)||null),[xe,Le]=C.useState((d==null?void 0:d.overallResult)||null),[ye,pe]=C.useState((d==null?void 0:d.groundSchoolAssessment)||{isAssessment:!1,result:void 0}),[ce,He]=C.useState((d==null?void 0:d.dcoResult)||""),_e=C.useMemo(()=>{const we=[],Re=ot=>{const Vt=v.find(yn=>yn.id===ot||yn.code===ot);if(Vt)return Vt.type==="Flight"||Vt.type==="FTD";const Pt=ot.toUpperCase();return!!((Pt.includes("FTD")||Pt.startsWith("BGF")||Pt.startsWith("BIF")||Pt.startsWith("BNF")||Pt.startsWith("BNAV")||Pt.startsWith("SCT"))&&!Pt.includes("MB")&&!Pt.includes("TUT")&&!Pt.includes("CPT"))};m.forEach(ot=>{Re(ot.event)&&we.push({name:ot.event,score:ot.score,date:ot.date,timestamp:new Date(ot.date).getTime()})}),f.forEach(ot=>{ot.traineeFullName===n.fullName&&ot.eventId!==t.id&&ot.overallGrade!==null&&ot.overallGrade!=="No Grade"&&Re(ot.flightNumber)&&we.push({name:ot.flightNumber,score:ot.overallGrade,date:ot.date,timestamp:new Date(ot.date).getTime()})}),we.sort((ot,Vt)=>Vt.timestamp-ot.timestamp);const be=new Date(t.date).getTime(),Ze=we.filter(ot=>ot.timestamp<be);return Ze.length>0?Ze[0]:null},[m,f,n.fullName,v,t.date,t.id]);C.useEffect(()=>{K===1&&_e&&Number(_e.score)===1?(A(!0),Le("F")):A(!1)},[K,_e]),C.useEffect(()=>{K==="No Grade"||K===null?Le(null):K===0?Le("F"):K>=1&&K<=5&&Le("P")},[K]);const Z=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,grade:Re}:Ze)}))},Fe=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,comment:Re}:Ze)}))},Xe=(we,Re)=>{ee(be=>({...be,[we]:Re})),we==="QFI"&&F(be=>({...be,instructorName:Re}))},ft=C.useMemo(()=>u.filter(we=>we.unit===n.unit),[u,n.unit]),tt=we=>{F(Re=>({...Re,instructorName:we})),ee(Re=>({...Re,QFI:we}))},We=we=>{if(we==null)return"";let Re=we;Re>=24&&(Re-=24);const be=Math.floor(Re),Ze=Math.round((Re-be)*60);return`${be.toString().padStart(2,"0")}${Ze.toString().padStart(2,"0")}`},Ke=(we,Re)=>{let be=we.currentTarget.value;be=be.replace(/\D/g,""),be.length>4&&(be=be.substring(0,4)),we.currentTarget.value=be},nt=we=>{const Re=t==null?void 0:t.target;if(!Re)return;let be=Re.value;if(be.length>0){const Ze=be.padStart(4,"0"),ot=parseInt(Ze);if(!isNaN(ot)&&ot>=0&&ot<=2359&&ot%100<60){const Vt=Math.floor(ot/100),Pt=ot%100,yn=Vt+Pt/60;if(Re.value=Ze,we==="startTime"){const Tt={...Ne,startTime:yn};Oe(Tt),J(Tt)}else{const Tt=Ne.startTime||0,lt=yn-Tt;if(lt>0){const Et={...Ne,duration:lt};Oe(Et),J(Et)}}}else if(Re.value="",we==="startTime"){const Vt={...Ne,startTime:null};Oe(Vt),J(Vt)}}},Ct=(we,Re)=>{if(we.key==="Enter"&&(we.preventDefault(),nt(Re),Re==="startTime")){const be=document.querySelector('input[placeholder="hhmm"]:last-of-type');be==null||be.focus()}},xt=()=>{U.current&&(U.current.then(we=>we.close()),U.current=null),P.current&&(P.current.disconnect(),P.current=null),M.current&&(M.current.disconnect(),M.current=null),$.current&&($.current.getTracks().forEach(we=>we.stop()),$.current=null),D.current&&D.current.state!=="closed"&&(D.current.close(),D.current=null),V(null)},dn=async(we,Re)=>{if(ne===we){xt();return}ne&&xt(),V(we);try{const be=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3});D.current=be;const Ze=await navigator.mediaDevices.getUserMedia({audio:!0});$.current=Ze;const ot=be.createMediaStreamSource(Ze);P.current=ot;const Vt=be.createScriptProcessor(4096,1,1);M.current=Vt;const Pt=eA.live.connect({model:"gemini-2.5-flash-native-audio-preview-09-2025",config:{responseModalities:[sf.AUDIO],inputAudioTranscription:{}},callbacks:{onopen:()=>console.log("Gemini Live Connected"),onmessage:yn=>{var Tt;if((Tt=yn.serverContent)!=null&&Tt.inputTranscription){const lt=yn.serverContent.inputTranscription.text;if(lt&&Re==="section"){const Et=we;ee(Bt=>({...Bt,[Et]:(Bt[Et]||"")+lt}))}}},onclose:()=>{ne===we&&xt()},onerror:()=>xt()}});U.current=Pt,Vt.onaudioprocess=yn=>{const Tt=yn.inputBuffer.getChannelData(0),lt=on(Tt);U.current&&U.current.then(Et=>{Et&&Et.sendRealtimeInput({media:lt})})},ot.connect(Vt),Vt.connect(be.destination)}catch(be){console.error("Failed to start voice input:",be),xt()}};function on(we){const Re=we.length,be=new Int16Array(Re);for(let Ze=0;Ze<Re;Ze++)be[Ze]=we[Ze]*32768;return{data:ZE(new Uint8Array(be.buffer)),mimeType:"audio/pcm;rate=16000"}}C.useEffect(()=>()=>{xt()},[]);const st=we=>{Y(we),Q(!0)},kt=we=>{Te&&F(Re=>({...Re,scores:Re.scores.map(be=>be.element===Te?{...be,comment:(be.comment?be.comment+" ":"")+we}:be)})),Q(!1),Y(null)};C.useEffect(()=>{const we=Hm.map(Re=>`${Re}:
public/flight-school-app/assets/index-BjUJyT2V.js:`)}return""+s},t})();const DD=({traineesData:n,instructorsData:t,archivedTraineesData:s,archivedInstructorsData:i,events:o,courses:l,archivedCourses:d,scores:u,publishedSchedules:f,syllabusDetails:h,pt051Assessments:m,onSavePT051Assessment:v})=>{const[x,y]=C.useState("all"),[T,E]=C.useState("all-time"),[A,_]=C.useState(""),[R,H]=C.useState(""),[O,W]=C.useState(""),[ne,V]=C.useState("pdf"),[U,D]=C.useState(!1),[$,M]=C.useState([]),[P,ae]=C.useState([]),[Q,Te]=C.useState([]),[Y,fe]=C.useState([]),[ge,Ne]=C.useState("all"),[Oe,se]=C.useState("all"),[F,J]=C.useState(""),[X,ee]=C.useState(""),[K,ue]=C.useState(""),[xe,Le]=C.useState(!1),[ye,pe]=C.useState(""),[ce,He]=C.useState(!1),[_e,Z]=C.useState(!1),[Fe,Xe]=C.useState(!1),[ft,tt]=C.useState(0),[We,Ke]=C.useState(""),[nt,Ct]=C.useState([]),[xt,dn]=C.useState(!1),[on,st]=C.useState([]),[kt,Ge]=C.useState(!1),[ht,vt]=C.useState(0),[Ht,ze]=C.useState(""),we=B=>{if(!B)return"";const Ae=new Date(B),rt=String(Ae.getDate()).padStart(2,"0"),yt=Ae.toLocaleString("en-GB",{month:"short"}),et=String(Ae.getFullYear()).slice(-2);return`${rt} ${yt} ${et}`},Re=C.useMemo(()=>{const B=Object.values(f).flat();return console.log("📊 Export View - All events from published schedules:",B.length),console.log("📊 Export View - Published schedule dates:",Object.keys(f)),B},[f]),be=C.useMemo(()=>{const B=[...n,...s];return console.log("📊 Export View - All trainees:",B.length),console.log("📊 Export View - ADF303 trainees:",B.filter(Ae=>Ae.course==="ADF303").length),B},[n,s]),Ze=C.useMemo(()=>[...t,...i],[t,i]),ot=C.useMemo(()=>{const B=l.map(rt=>rt.name),Ae=Object.keys(d);return[...new Set([...B,...Ae])]},[l,d]),Vt=C.useMemo(()=>ot.filter(B=>B.toLowerCase().includes(F.toLowerCase())),[ot,F]),Pt=C.useMemo(()=>be.filter(B=>`${B.rank} ${B.name} ${B.course}`.toLowerCase().includes(X.toLowerCase())),[be,X]),yn=C.useMemo(()=>Ze.filter(B=>`${B.rank} ${B.name}`.toLowerCase().includes(K.toLowerCase())),[Ze,K]),Tt=C.useMemo(()=>{let B=[...Re];if(console.log("🔍 FILTER DEBUG - Starting with events:",B.length),console.log("🔍 FILTER DEBUG - timePeriod:",T),console.log("🔍 FILTER DEBUG - singleDate:",A),console.log("🔍 FILTER DEBUG - startDate:",R),console.log("🔍 FILTER DEBUG - endDate:",O),T==="single-date"&&A?(B=B.filter(Ae=>Ae.date===A),console.log("🔍 FILTER DEBUG - After single-date filter:",B.length)):T==="date-range"&&R&&O&&(B=B.filter(Ae=>Ae.date>=R&&Ae.date<=O),console.log("🔍 FILTER DEBUG - After date-range filter:",B.length)),Y.length>0){console.log("🔍 FILTER DEBUG - selectedEventTypes:",Y),console.log("🔍 FILTER DEBUG - Sample event types from data (first 5):",B.slice(0,5).map(rt=>rt.type)),console.log("🔍 FILTER DEBUG - Unique event types in data:",[...new Set(B.map(rt=>rt.type))]);const Ae=Y.map(rt=>rt.toLowerCase());B=B.filter(rt=>{const yt=rt.type.toLowerCase();return Ae.includes(yt)}),console.log("🔍 FILTER DEBUG - After event type filter:",B.length)}if(console.log("🔍 FILTER DEBUG - statusFilter:",ge),console.log("🔍 FILTER DEBUG - Before status filter:",B.length),ge==="dco"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="DCO"}):ge==="dnco"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="DNCO"}):ge==="pass"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="Pass"}):ge==="fail"&&(B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="Fail"})),console.log("🔍 FILTER DEBUG - After all status filters:",B.length),console.log("🔍 FILTER DEBUG - remedialFilter:",Oe),Oe==="yes"?(B=B.filter(Ae=>Ae.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=yes filter:",B.length)):Oe==="no"&&(B=B.filter(Ae=>!Ae.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=no filter:",B.length)),$.length>0&&(console.log("📊 Trainee filter - Selected trainees:",$),console.log("📊 Trainee filter - Events before filter:",B.length),B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;return rt?$.some(et=>!!(rt===et||rt.startsWith(et+" –")||rt.startsWith(et+" -"))):!1}),console.log("📊 Trainee filter - Events after filter:",B.length)),P.length>0&&(B=B.filter(Ae=>Ae.instructor&&P.includes(Ae.instructor))),Q.length>0){const Ae=be.filter(yt=>Q.includes(yt.course)),rt=Ae.map(yt=>yt.name);console.log("📊 Course filter - Selected courses:",Q),console.log("📊 Course filter - Trainees in selected courses:",Ae.length),console.log("📊 Course filter - Trainee names (first 5):",rt.slice(0,5)),console.log("📊 Course filter - Events before filter:",B.length),console.log("📊 Course filter - Sample event student names (first 5):",B.slice(0,5).map(yt=>yt.student||yt.pilot)),B=B.filter(yt=>{const et=yt.student||yt.pilot;if(!et)return!1;const $t=rt.some(pn=>!!(et===pn||et.startsWith(pn+" –")||et.startsWith(pn+" -")));return $t||console.log("📊 No match for student:",et),$t}),console.log("📊 Course filter - Events after filter:",B.length)}return B},[Re,T,A,R,O,Y,ge,Oe,$,P,Q,n]),lt=C.useMemo(()=>{if(Q.length===0)return[];const B=be.filter(et=>Q.includes(et.course));let Ae=Re;T==="single-date"&&A?Ae=Ae.filter(et=>et.date===A):T==="date-range"&&R&&O&&(Ae=Ae.filter(et=>et.date>=R&&et.date<=O));const rt=Ae.filter(et=>Q.some($t=>{const pn=et.student||et.pilot;return pn?B.find(ts=>pn===ts.name||pn.startsWith(ts.name+" –")||pn.startsWith(ts.name+" -")):!1}));return[...new Set(rt.map(et=>{const $t=et.student||et.pilot;if(!$t)return null;const pn=B.find(kn=>$t===kn.name||$t.startsWith(kn.name+" –")||$t.startsWith(kn.name+" -"));return pn==null?void 0:pn.name}).filter(Boolean))]},[Re,Q,T,A,R,O,be]),Et=C.useMemo(()=>(console.log("📊 filteredData calculation - recordType:",x),console.log("📊 filteredData calculation - filteredEvents:",Tt.length),console.log("📊 filteredData calculation - allTrainees:",be.length),console.log("📊 filteredData calculation - allInstructors:",Ze.length),x==="events"?{events:Tt,trainees:[],staff:[]}:x==="trainees"?(console.log("📊 Returning all trainees:",be.length),{events:Tt,trainees:be,staff:[]}):x==="staff"?(console.log("📊 Returning all staff:",Ze.length),{events:Tt,trainees:[],staff:Ze}):(console.log("📊 Returning all trainees and staff"),{events:Tt,trainees:be,staff:Ze})),[x,Tt,be,Ze]),Bt=C.useMemo(()=>{let B=0;return(x==="all"||x==="trainees")&&(B+=Et.trainees.length),(x==="all"||x==="staff")&&(B+=Et.staff.length),(x==="all"||x==="events")&&(B+=Et.events.length),B},[x,Et]),Kt=C.useMemo(()=>{const Ae=Bt*(ne==="pdf"?5e3:ne==="excel"?2e3:500);return Ae<1024?`${Ae} B`:Ae<1024*1024?`${(Ae/1024).toFixed(1)} KB`:`${(Ae/(1024*1024)).toFixed(1)} MB`},[Bt,ne]),Mt=Bt>1e3,Ve=()=>T==="all-time"?"All time":T==="single-date"&&A?we(A):T==="date-range"&&R&&O?`${we(R)} to ${we(O)}`:"Not specified",qt=()=>x==="all"?"All records (Trainees, Staff, Events)":x==="trainees"?"Trainee records":x==="staff"?"Staff records":"Event records",Mn=async()=>{console.log("🚀 Starting export...",{recordType:x,timePeriod:T,outputFormat:ne,recordCount:Bt,data:Et});const rt=`training_records_${new Date().toISOString().split("T")[0]}.${ne==="excel"?"xlsx":ne}`;try{console.log("📄 Export format:",ne),Xe(!0),tt(0),Ke("Preparing export..."),ne==="csv"?(console.log("📊 Exporting CSV..."),console.log("📊 Record count:",Bt),Ke("Generating CSV file..."),jn(rt),console.log("✅ CSV export completed")):ne==="excel"?(console.log("📊 Exporting Excel..."),console.log("📊 Record count:",Bt),Ke("Generating Excel file..."),je(rt),console.log("✅ Excel export completed")):ne==="pdf"&&(console.log("📄 Exporting PDF..."),console.log("📄 Record count:",Bt),console.log("📄 Events to export:",Et.events.length),Ke(`Generating PDF (${Et.events.length} records)...`),await $e(rt),console.log("✅ PDF export completed")),Xe(!1),console.log("✅ Showing success message"),He(!0),setTimeout(()=>He(!1),5e3)}catch(yt){console.error("❌ Export error:",yt),console.error("Error stack:",yt instanceof Error?yt.stack:"No stack trace"),Xe(!1),Z(!0),setTimeout(()=>Z(!1),5e3)}},jn=B=>{let Ae="";(x==="all"||x==="events")&&(Ae+=`EVENTS
public/flight-school-app/assets/index-C-Gm8wkn.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct";X&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=X?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(n.eventCategory==="twr_di"&&console.log("🔍 TWR DI EVENT:",{id:n.id,flightNumber:n.flightNumber,flightType:n.flightType,pilot:n.pilot,instructor:n.instructor,student:n.student}),n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return console.log("🎯 FALLBACK SOLO DETECTION: Pilot and student are the same:",n.pilot),e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-C-Gm8wkn.js: */const WE="gl-node/";class YE{constructor(t){var s;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(s=t.vertexai)!==null&&s!==void 0?s:!1,this.apiKey=t.apiKey;const i=CS(t.httpOptions,t.vertexai,void 0,void 0);i&&(t.httpOptions?t.httpOptions.baseUrl=i:t.httpOptions={baseUrl:i}),this.apiVersion=t.apiVersion;const o=new VE(this.apiKey);this.apiClient=new cj({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:WE+"web",uploader:new qE,downloader:new ME}),this.models=new Aj(this.apiClient),this.live=new wj(this.apiClient,o,new GE),this.batches=new QC(this.apiClient),this.chats=new MT(this.models,this.apiClient),this.caches=new _T(this.apiClient),this.files=new GT(this.apiClient),this.operations=new kj(this.apiClient),this.authTokens=new zj(this.apiClient),this.tunings=new LE(this.apiClient),this.fileSearchStores=new mE(this.apiClient)}}const d2=[{category:"Core Dimensions",elements:["Airmanship","Preparation","Technique"]},{category:"Procedural Framework",elements:["Pre-Post Flight","Walk Around","Strap-in","Ground Checks","Airborne Checks"]},{category:"Takeoff",elements:["Stationary"]},{category:"Departure",elements:["Visual"]},{category:"Core Handling Skills",elements:["Effects of Control","Trimming","Straight and Level"]},{category:"Turns",elements:["Level medium Turn","Level Steep turn"]},{category:"Recovery",elements:["Visual - Initial & Pitch"]},{category:"Landing",elements:["Landing","Crosswind"]},{category:"Domestics",elements:["Radio Comms","Situational Awareness","Lookout","Knowledge"]}],JE=d2.flatMap(n=>n.elements),z1=["DEMO",0,1,2,3,4,5],XE=["No Grade",0,1,2,3,4,5],Hm=["QFI","Weather","Profile","Overall","NEST"],KE=n=>{const t={QFI:"",Weather:"",Profile:"",Overall:"",NEST:""};if(!n)return t;const s={...t};return Hm.forEach((i,o)=>{const l=Hm[o+1],d=`${i}:`,u=n.indexOf(d);if(u!==-1){let f=u+d.length,h=-1;if(l){const v=`${l}:`;h=n.indexOf(v,f)}let m="";h!==-1?m=n.substring(f,h):m=n.substring(f),s[i]=m.trim()}}),s};function ZE(n){let t="";const s=n.byteLength;for(let i=0;i<s;i++)t+=String.fromCharCode(n[i]);return btoa(t)}const QE=({element:n,onClose:t,onInsert:s,phraseBank:i})=>{const[o,l]=C.useState(new Set);let d=i==null?void 0:i[n];const u=["Airmanship","Preparation","Technique"].includes(n);!d&&!u&&(d=i==null?void 0:i["Generic Flying Elements"]);const f=v=>{const x=new Set(o);x.has(v)?x.delete(v):x.add(v),l(x)},h=()=>{const v=Array.from(o).join(" ");s(v)},m=v=>{switch(v){case"5":return"5 - Excellent";case"4":return"4 - High Satisfactory";case"3":return"3 - Satisfactory";case"2":return"2 - Low Satisfactory";case"1":return"1 - Marginal";case"0":return"0 - Unsatisfactory";default:return v}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[80] flex items-center justify-center animate-fade-in",onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700 flex flex-col max-h-[80vh]",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-bold text-white",children:["Select Phrases: ",e.jsx("span",{className:"text-sky-400",children:n})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 overflow-y-auto flex-1 space-y-4",children:d?Object.entries(d).sort((v,x)=>Number(x[0])-Number(v[0])).map(([v,x])=>{const y=x;return y.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2 border-b border-gray-700 pb-1",children:m(v)}),e.jsx("div",{className:"space-y-2",children:y.map((T,E)=>e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer p-2 rounded hover:bg-gray-700/50",children:[e.jsx("input",{type:"checkbox",checked:o.has(T),onChange:()=>f(T),className:"mt-1 h-4 w-4 accent-sky-500 bg-gray-600 border-gray-500 rounded"}),e.jsx("span",{className:"text-sm text-gray-200",children:T})]},E))})]},v)}):e.jsxs("div",{className:"text-center py-8 text-gray-500 italic",children:[e.jsx("p",{children:"No phrase list available for this element."}),e.jsx("p",{className:"text-xs mt-2",children:"Configure in Settings → Scoring Matrix."})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-900/50 flex justify-end space-x-3",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm font-semibold",children:"Cancel"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 text-sm font-semibold",children:"Insert Selected"})]})]})})},eA=new YE({apiKey:""}),tA=({trainee:n,event:t,onBack:s,onSave:i,onDeleteAssessment:o,onEventUpdate:l,initialAssessment:d,instructors:u,pt051Assessments:f,events:h,lmpScores:m,syllabusDetails:v,registerDirtyCheck:x,phraseBank:y,currentUserPin:T})=>{const[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState("Saved"),W=C.useRef(!0),[ne,V]=C.useState(null),U=C.useRef(null),D=C.useRef(null),$=C.useRef(null),M=C.useRef(null),P=C.useRef(null),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(null),fe=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500",ge=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500";C.useMemo(()=>t.instructor&&u.find(we=>we.name===t.instructor)||null,[t.instructor,u]);const[Ne,Oe]=C.useState(()=>d&&(d.startTime!==void 0||d.duration!==void 0)?{...t,startTime:d.startTime||t.startTime,duration:d.duration||t.duration}:t),[se,F]=C.useState(()=>d||{id:_r(),traineeFullName:n.fullName,eventId:t.id,flightNumber:t.flightNumber,date:t.date,instructorName:t.instructor||"",scores:JE.map(we=>({element:we,grade:null,comment:""})),overallGrade:null,overallResult:null,groundSchoolAssessment:{isAssessment:!1,result:void 0}}),J=we=>{const Re={...Ne,...we};Oe(Re),l&&l(Re)},[X,ee]=C.useState(()=>{const we=KE(d==null?void 0:d.overallComments);return!we.QFI&&t.instructor&&(we.QFI=t.instructor),we}),[K,ue]=C.useState((d==null?void 0:d.overallGrade)||null),[xe,Le]=C.useState((d==null?void 0:d.overallResult)||null),[ye,pe]=C.useState((d==null?void 0:d.groundSchoolAssessment)||{isAssessment:!1,result:void 0}),[ce,He]=C.useState((d==null?void 0:d.dcoResult)||""),_e=C.useMemo(()=>{const we=[],Re=ot=>{const Vt=v.find(yn=>yn.id===ot||yn.code===ot);if(Vt)return Vt.type==="Flight"||Vt.type==="FTD";const Pt=ot.toUpperCase();return!!((Pt.includes("FTD")||Pt.startsWith("BGF")||Pt.startsWith("BIF")||Pt.startsWith("BNF")||Pt.startsWith("BNAV")||Pt.startsWith("SCT"))&&!Pt.includes("MB")&&!Pt.includes("TUT")&&!Pt.includes("CPT"))};m.forEach(ot=>{Re(ot.event)&&we.push({name:ot.event,score:ot.score,date:ot.date,timestamp:new Date(ot.date).getTime()})}),f.forEach(ot=>{ot.traineeFullName===n.fullName&&ot.eventId!==t.id&&ot.overallGrade!==null&&ot.overallGrade!=="No Grade"&&Re(ot.flightNumber)&&we.push({name:ot.flightNumber,score:ot.overallGrade,date:ot.date,timestamp:new Date(ot.date).getTime()})}),we.sort((ot,Vt)=>Vt.timestamp-ot.timestamp);const be=new Date(t.date).getTime(),Ze=we.filter(ot=>ot.timestamp<be);return Ze.length>0?Ze[0]:null},[m,f,n.fullName,v,t.date,t.id]);C.useEffect(()=>{K===1&&_e&&Number(_e.score)===1?(A(!0),Le("F")):A(!1)},[K,_e]),C.useEffect(()=>{K==="No Grade"||K===null?Le(null):K===0?Le("F"):K>=1&&K<=5&&Le("P")},[K]);const Z=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,grade:Re}:Ze)}))},Fe=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,comment:Re}:Ze)}))},Xe=(we,Re)=>{ee(be=>({...be,[we]:Re})),we==="QFI"&&F(be=>({...be,instructorName:Re}))},ft=C.useMemo(()=>u.filter(we=>we.unit===n.unit),[u,n.unit]),tt=we=>{F(Re=>({...Re,instructorName:we})),ee(Re=>({...Re,QFI:we}))},We=we=>{if(we==null)return"";let Re=we;Re>=24&&(Re-=24);const be=Math.floor(Re),Ze=Math.round((Re-be)*60);return`${be.toString().padStart(2,"0")}${Ze.toString().padStart(2,"0")}`},Ke=(we,Re)=>{let be=we.currentTarget.value;be=be.replace(/\D/g,""),be.length>4&&(be=be.substring(0,4)),we.currentTarget.value=be},nt=we=>{const Re=t==null?void 0:t.target;if(!Re)return;let be=Re.value;if(be.length>0){const Ze=be.padStart(4,"0"),ot=parseInt(Ze);if(!isNaN(ot)&&ot>=0&&ot<=2359&&ot%100<60){const Vt=Math.floor(ot/100),Pt=ot%100,yn=Vt+Pt/60;if(Re.value=Ze,we==="startTime"){const Tt={...Ne,startTime:yn};Oe(Tt),J(Tt)}else{const Tt=Ne.startTime||0,lt=yn-Tt;if(lt>0){const Et={...Ne,duration:lt};Oe(Et),J(Et)}}}else if(Re.value="",we==="startTime"){const Vt={...Ne,startTime:null};Oe(Vt),J(Vt)}}},Ct=(we,Re)=>{if(we.key==="Enter"&&(we.preventDefault(),nt(Re),Re==="startTime")){const be=document.querySelector('input[placeholder="hhmm"]:last-of-type');be==null||be.focus()}},xt=()=>{U.current&&(U.current.then(we=>we.close()),U.current=null),P.current&&(P.current.disconnect(),P.current=null),M.current&&(M.current.disconnect(),M.current=null),$.current&&($.current.getTracks().forEach(we=>we.stop()),$.current=null),D.current&&D.current.state!=="closed"&&(D.current.close(),D.current=null),V(null)},dn=async(we,Re)=>{if(ne===we){xt();return}ne&&xt(),V(we);try{const be=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3});D.current=be;const Ze=await navigator.mediaDevices.getUserMedia({audio:!0});$.current=Ze;const ot=be.createMediaStreamSource(Ze);P.current=ot;const Vt=be.createScriptProcessor(4096,1,1);M.current=Vt;const Pt=eA.live.connect({model:"gemini-2.5-flash-native-audio-preview-09-2025",config:{responseModalities:[sf.AUDIO],inputAudioTranscription:{}},callbacks:{onopen:()=>console.log("Gemini Live Connected"),onmessage:yn=>{var Tt;if((Tt=yn.serverContent)!=null&&Tt.inputTranscription){const lt=yn.serverContent.inputTranscription.text;if(lt&&Re==="section"){const Et=we;ee(Bt=>({...Bt,[Et]:(Bt[Et]||"")+lt}))}}},onclose:()=>{ne===we&&xt()},onerror:()=>xt()}});U.current=Pt,Vt.onaudioprocess=yn=>{const Tt=yn.inputBuffer.getChannelData(0),lt=on(Tt);U.current&&U.current.then(Et=>{Et&&Et.sendRealtimeInput({media:lt})})},ot.connect(Vt),Vt.connect(be.destination)}catch(be){console.error("Failed to start voice input:",be),xt()}};function on(we){const Re=we.length,be=new Int16Array(Re);for(let Ze=0;Ze<Re;Ze++)be[Ze]=we[Ze]*32768;return{data:ZE(new Uint8Array(be.buffer)),mimeType:"audio/pcm;rate=16000"}}C.useEffect(()=>()=>{xt()},[]);const st=we=>{Y(we),Q(!0)},kt=we=>{Te&&F(Re=>({...Re,scores:Re.scores.map(be=>be.element===Te?{...be,comment:(be.comment?be.comment+" ":"")+we}:be)})),Q(!1),Y(null)};C.useEffect(()=>{const we=Hm.map(Re=>`${Re}:
public/flight-school-app/assets/index-C-Gm8wkn.js:`)}return""+s},t})();const DD=({traineesData:n,instructorsData:t,archivedTraineesData:s,archivedInstructorsData:i,events:o,courses:l,archivedCourses:d,scores:u,publishedSchedules:f,syllabusDetails:h,pt051Assessments:m,onSavePT051Assessment:v})=>{const[x,y]=C.useState("all"),[T,E]=C.useState("all-time"),[A,_]=C.useState(""),[R,H]=C.useState(""),[O,W]=C.useState(""),[ne,V]=C.useState("pdf"),[U,D]=C.useState(!1),[$,M]=C.useState([]),[P,ae]=C.useState([]),[Q,Te]=C.useState([]),[Y,fe]=C.useState([]),[ge,Ne]=C.useState("all"),[Oe,se]=C.useState("all"),[F,J]=C.useState(""),[X,ee]=C.useState(""),[K,ue]=C.useState(""),[xe,Le]=C.useState(!1),[ye,pe]=C.useState(""),[ce,He]=C.useState(!1),[_e,Z]=C.useState(!1),[Fe,Xe]=C.useState(!1),[ft,tt]=C.useState(0),[We,Ke]=C.useState(""),[nt,Ct]=C.useState([]),[xt,dn]=C.useState(!1),[on,st]=C.useState([]),[kt,Ge]=C.useState(!1),[ht,vt]=C.useState(0),[Ht,ze]=C.useState(""),we=B=>{if(!B)return"";const Ae=new Date(B),rt=String(Ae.getDate()).padStart(2,"0"),yt=Ae.toLocaleString("en-GB",{month:"short"}),et=String(Ae.getFullYear()).slice(-2);return`${rt} ${yt} ${et}`},Re=C.useMemo(()=>{const B=Object.values(f).flat();return console.log("📊 Export View - All events from published schedules:",B.length),console.log("📊 Export View - Published schedule dates:",Object.keys(f)),B},[f]),be=C.useMemo(()=>{const B=[...n,...s];return console.log("📊 Export View - All trainees:",B.length),console.log("📊 Export View - ADF303 trainees:",B.filter(Ae=>Ae.course==="ADF303").length),B},[n,s]),Ze=C.useMemo(()=>[...t,...i],[t,i]),ot=C.useMemo(()=>{const B=l.map(rt=>rt.name),Ae=Object.keys(d);return[...new Set([...B,...Ae])]},[l,d]),Vt=C.useMemo(()=>ot.filter(B=>B.toLowerCase().includes(F.toLowerCase())),[ot,F]),Pt=C.useMemo(()=>be.filter(B=>`${B.rank} ${B.name} ${B.course}`.toLowerCase().includes(X.toLowerCase())),[be,X]),yn=C.useMemo(()=>Ze.filter(B=>`${B.rank} ${B.name}`.toLowerCase().includes(K.toLowerCase())),[Ze,K]),Tt=C.useMemo(()=>{let B=[...Re];if(console.log("🔍 FILTER DEBUG - Starting with events:",B.length),console.log("🔍 FILTER DEBUG - timePeriod:",T),console.log("🔍 FILTER DEBUG - singleDate:",A),console.log("🔍 FILTER DEBUG - startDate:",R),console.log("🔍 FILTER DEBUG - endDate:",O),T==="single-date"&&A?(B=B.filter(Ae=>Ae.date===A),console.log("🔍 FILTER DEBUG - After single-date filter:",B.length)):T==="date-range"&&R&&O&&(B=B.filter(Ae=>Ae.date>=R&&Ae.date<=O),console.log("🔍 FILTER DEBUG - After date-range filter:",B.length)),Y.length>0){console.log("🔍 FILTER DEBUG - selectedEventTypes:",Y),console.log("🔍 FILTER DEBUG - Sample event types from data (first 5):",B.slice(0,5).map(rt=>rt.type)),console.log("🔍 FILTER DEBUG - Unique event types in data:",[...new Set(B.map(rt=>rt.type))]);const Ae=Y.map(rt=>rt.toLowerCase());B=B.filter(rt=>{const yt=rt.type.toLowerCase();return Ae.includes(yt)}),console.log("🔍 FILTER DEBUG - After event type filter:",B.length)}if(console.log("🔍 FILTER DEBUG - statusFilter:",ge),console.log("🔍 FILTER DEBUG - Before status filter:",B.length),ge==="dco"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="DCO"}):ge==="dnco"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="DNCO"}):ge==="pass"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="Pass"}):ge==="fail"&&(B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="Fail"})),console.log("🔍 FILTER DEBUG - After all status filters:",B.length),console.log("🔍 FILTER DEBUG - remedialFilter:",Oe),Oe==="yes"?(B=B.filter(Ae=>Ae.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=yes filter:",B.length)):Oe==="no"&&(B=B.filter(Ae=>!Ae.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=no filter:",B.length)),$.length>0&&(console.log("📊 Trainee filter - Selected trainees:",$),console.log("📊 Trainee filter - Events before filter:",B.length),B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;return rt?$.some(et=>!!(rt===et||rt.startsWith(et+" –")||rt.startsWith(et+" -"))):!1}),console.log("📊 Trainee filter - Events after filter:",B.length)),P.length>0&&(B=B.filter(Ae=>Ae.instructor&&P.includes(Ae.instructor))),Q.length>0){const Ae=be.filter(yt=>Q.includes(yt.course)),rt=Ae.map(yt=>yt.name);console.log("📊 Course filter - Selected courses:",Q),console.log("📊 Course filter - Trainees in selected courses:",Ae.length),console.log("📊 Course filter - Trainee names (first 5):",rt.slice(0,5)),console.log("📊 Course filter - Events before filter:",B.length),console.log("📊 Course filter - Sample event student names (first 5):",B.slice(0,5).map(yt=>yt.student||yt.pilot)),B=B.filter(yt=>{const et=yt.student||yt.pilot;if(!et)return!1;const $t=rt.some(pn=>!!(et===pn||et.startsWith(pn+" –")||et.startsWith(pn+" -")));return $t||console.log("📊 No match for student:",et),$t}),console.log("📊 Course filter - Events after filter:",B.length)}return B},[Re,T,A,R,O,Y,ge,Oe,$,P,Q,n]),lt=C.useMemo(()=>{if(Q.length===0)return[];const B=be.filter(et=>Q.includes(et.course));let Ae=Re;T==="single-date"&&A?Ae=Ae.filter(et=>et.date===A):T==="date-range"&&R&&O&&(Ae=Ae.filter(et=>et.date>=R&&et.date<=O));const rt=Ae.filter(et=>Q.some($t=>{const pn=et.student||et.pilot;return pn?B.find(ts=>pn===ts.name||pn.startsWith(ts.name+" –")||pn.startsWith(ts.name+" -")):!1}));return[...new Set(rt.map(et=>{const $t=et.student||et.pilot;if(!$t)return null;const pn=B.find(kn=>$t===kn.name||$t.startsWith(kn.name+" –")||$t.startsWith(kn.name+" -"));return pn==null?void 0:pn.name}).filter(Boolean))]},[Re,Q,T,A,R,O,be]),Et=C.useMemo(()=>(console.log("📊 filteredData calculation - recordType:",x),console.log("📊 filteredData calculation - filteredEvents:",Tt.length),console.log("📊 filteredData calculation - allTrainees:",be.length),console.log("📊 filteredData calculation - allInstructors:",Ze.length),x==="events"?{events:Tt,trainees:[],staff:[]}:x==="trainees"?(console.log("📊 Returning all trainees:",be.length),{events:Tt,trainees:be,staff:[]}):x==="staff"?(console.log("📊 Returning all staff:",Ze.length),{events:Tt,trainees:[],staff:Ze}):(console.log("📊 Returning all trainees and staff"),{events:Tt,trainees:be,staff:Ze})),[x,Tt,be,Ze]),Bt=C.useMemo(()=>{let B=0;return(x==="all"||x==="trainees")&&(B+=Et.trainees.length),(x==="all"||x==="staff")&&(B+=Et.staff.length),(x==="all"||x==="events")&&(B+=Et.events.length),B},[x,Et]),Kt=C.useMemo(()=>{const Ae=Bt*(ne==="pdf"?5e3:ne==="excel"?2e3:500);return Ae<1024?`${Ae} B`:Ae<1024*1024?`${(Ae/1024).toFixed(1)} KB`:`${(Ae/(1024*1024)).toFixed(1)} MB`},[Bt,ne]),Mt=Bt>1e3,Ve=()=>T==="all-time"?"All time":T==="single-date"&&A?we(A):T==="date-range"&&R&&O?`${we(R)} to ${we(O)}`:"Not specified",qt=()=>x==="all"?"All records (Trainees, Staff, Events)":x==="trainees"?"Trainee records":x==="staff"?"Staff records":"Event records",Mn=async()=>{console.log("🚀 Starting export...",{recordType:x,timePeriod:T,outputFormat:ne,recordCount:Bt,data:Et});const rt=`training_records_${new Date().toISOString().split("T")[0]}.${ne==="excel"?"xlsx":ne}`;try{console.log("📄 Export format:",ne),Xe(!0),tt(0),Ke("Preparing export..."),ne==="csv"?(console.log("📊 Exporting CSV..."),console.log("📊 Record count:",Bt),Ke("Generating CSV file..."),jn(rt),console.log("✅ CSV export completed")):ne==="excel"?(console.log("📊 Exporting Excel..."),console.log("📊 Record count:",Bt),Ke("Generating Excel file..."),je(rt),console.log("✅ Excel export completed")):ne==="pdf"&&(console.log("📄 Exporting PDF..."),console.log("📄 Record count:",Bt),console.log("📄 Events to export:",Et.events.length),Ke(`Generating PDF (${Et.events.length} records)...`),await $e(rt),console.log("✅ PDF export completed")),Xe(!1),console.log("✅ Showing success message"),He(!0),setTimeout(()=>He(!1),5e3)}catch(yt){console.error("❌ Export error:",yt),console.error("Error stack:",yt instanceof Error?yt.stack:"No stack trace"),Xe(!1),Z(!0),setTimeout(()=>Z(!1),5e3)}},jn=B=>{let Ae="";(x==="all"||x==="events")&&(Ae+=`EVENTS
public/flight-school-app/assets/index-BCojCDFQ.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{try{const Ge=T}catch{}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct",ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=X?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-BCojCDFQ.js: */const WE="gl-node/";class YE{constructor(t){var s;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(s=t.vertexai)!==null&&s!==void 0?s:!1,this.apiKey=t.apiKey;const i=CS(t.httpOptions,t.vertexai,void 0,void 0);i&&(t.httpOptions?t.httpOptions.baseUrl=i:t.httpOptions={baseUrl:i}),this.apiVersion=t.apiVersion;const o=new VE(this.apiKey);this.apiClient=new cj({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:WE+"web",uploader:new qE,downloader:new ME}),this.models=new Aj(this.apiClient),this.live=new wj(this.apiClient,o,new GE),this.batches=new QC(this.apiClient),this.chats=new MT(this.models,this.apiClient),this.caches=new _T(this.apiClient),this.files=new GT(this.apiClient),this.operations=new kj(this.apiClient),this.authTokens=new zj(this.apiClient),this.tunings=new LE(this.apiClient),this.fileSearchStores=new mE(this.apiClient)}}const d2=[{category:"Core Dimensions",elements:["Airmanship","Preparation","Technique"]},{category:"Procedural Framework",elements:["Pre-Post Flight","Walk Around","Strap-in","Ground Checks","Airborne Checks"]},{category:"Takeoff",elements:["Stationary"]},{category:"Departure",elements:["Visual"]},{category:"Core Handling Skills",elements:["Effects of Control","Trimming","Straight and Level"]},{category:"Turns",elements:["Level medium Turn","Level Steep turn"]},{category:"Recovery",elements:["Visual - Initial & Pitch"]},{category:"Landing",elements:["Landing","Crosswind"]},{category:"Domestics",elements:["Radio Comms","Situational Awareness","Lookout","Knowledge"]}],JE=d2.flatMap(n=>n.elements),z1=["DEMO",0,1,2,3,4,5],XE=["No Grade",0,1,2,3,4,5],Hm=["QFI","Weather","Profile","Overall","NEST"],KE=n=>{const t={QFI:"",Weather:"",Profile:"",Overall:"",NEST:""};if(!n)return t;const s={...t};return Hm.forEach((i,o)=>{const l=Hm[o+1],d=`${i}:`,u=n.indexOf(d);if(u!==-1){let f=u+d.length,h=-1;if(l){const v=`${l}:`;h=n.indexOf(v,f)}let m="";h!==-1?m=n.substring(f,h):m=n.substring(f),s[i]=m.trim()}}),s};function ZE(n){let t="";const s=n.byteLength;for(let i=0;i<s;i++)t+=String.fromCharCode(n[i]);return btoa(t)}const QE=({element:n,onClose:t,onInsert:s,phraseBank:i})=>{const[o,l]=C.useState(new Set);let d=i==null?void 0:i[n];const u=["Airmanship","Preparation","Technique"].includes(n);!d&&!u&&(d=i==null?void 0:i["Generic Flying Elements"]);const f=v=>{const x=new Set(o);x.has(v)?x.delete(v):x.add(v),l(x)},h=()=>{const v=Array.from(o).join(" ");s(v)},m=v=>{switch(v){case"5":return"5 - Excellent";case"4":return"4 - High Satisfactory";case"3":return"3 - Satisfactory";case"2":return"2 - Low Satisfactory";case"1":return"1 - Marginal";case"0":return"0 - Unsatisfactory";default:return v}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[80] flex items-center justify-center animate-fade-in",onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700 flex flex-col max-h-[80vh]",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-bold text-white",children:["Select Phrases: ",e.jsx("span",{className:"text-sky-400",children:n})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 overflow-y-auto flex-1 space-y-4",children:d?Object.entries(d).sort((v,x)=>Number(x[0])-Number(v[0])).map(([v,x])=>{const y=x;return y.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2 border-b border-gray-700 pb-1",children:m(v)}),e.jsx("div",{className:"space-y-2",children:y.map((T,E)=>e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer p-2 rounded hover:bg-gray-700/50",children:[e.jsx("input",{type:"checkbox",checked:o.has(T),onChange:()=>f(T),className:"mt-1 h-4 w-4 accent-sky-500 bg-gray-600 border-gray-500 rounded"}),e.jsx("span",{className:"text-sm text-gray-200",children:T})]},E))})]},v)}):e.jsxs("div",{className:"text-center py-8 text-gray-500 italic",children:[e.jsx("p",{children:"No phrase list available for this element."}),e.jsx("p",{className:"text-xs mt-2",children:"Configure in Settings → Scoring Matrix."})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-900/50 flex justify-end space-x-3",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm font-semibold",children:"Cancel"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 text-sm font-semibold",children:"Insert Selected"})]})]})})},eA=new YE({apiKey:""}),tA=({trainee:n,event:t,onBack:s,onSave:i,onDeleteAssessment:o,onEventUpdate:l,initialAssessment:d,instructors:u,pt051Assessments:f,events:h,lmpScores:m,syllabusDetails:v,registerDirtyCheck:x,phraseBank:y,currentUserPin:T})=>{const[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState("Saved"),W=C.useRef(!0),[ne,V]=C.useState(null),U=C.useRef(null),D=C.useRef(null),$=C.useRef(null),M=C.useRef(null),P=C.useRef(null),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(null),fe=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500",ge=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500";C.useMemo(()=>t.instructor&&u.find(we=>we.name===t.instructor)||null,[t.instructor,u]);const[Ne,Oe]=C.useState(()=>d&&(d.startTime!==void 0||d.duration!==void 0)?{...t,startTime:d.startTime||t.startTime,duration:d.duration||t.duration}:t),[se,F]=C.useState(()=>d||{id:_r(),traineeFullName:n.fullName,eventId:t.id,flightNumber:t.flightNumber,date:t.date,instructorName:t.instructor||"",scores:JE.map(we=>({element:we,grade:null,comment:""})),overallGrade:null,overallResult:null,groundSchoolAssessment:{isAssessment:!1,result:void 0}}),J=we=>{const Re={...Ne,...we};Oe(Re),l&&l(Re)},[X,ee]=C.useState(()=>{const we=KE(d==null?void 0:d.overallComments);return!we.QFI&&t.instructor&&(we.QFI=t.instructor),we}),[K,ue]=C.useState((d==null?void 0:d.overallGrade)||null),[xe,Le]=C.useState((d==null?void 0:d.overallResult)||null),[ye,pe]=C.useState((d==null?void 0:d.groundSchoolAssessment)||{isAssessment:!1,result:void 0}),[ce,He]=C.useState((d==null?void 0:d.dcoResult)||""),_e=C.useMemo(()=>{const we=[],Re=ot=>{const Vt=v.find(yn=>yn.id===ot||yn.code===ot);if(Vt)return Vt.type==="Flight"||Vt.type==="FTD";const Pt=ot.toUpperCase();return!!((Pt.includes("FTD")||Pt.startsWith("BGF")||Pt.startsWith("BIF")||Pt.startsWith("BNF")||Pt.startsWith("BNAV")||Pt.startsWith("SCT"))&&!Pt.includes("MB")&&!Pt.includes("TUT")&&!Pt.includes("CPT"))};m.forEach(ot=>{Re(ot.event)&&we.push({name:ot.event,score:ot.score,date:ot.date,timestamp:new Date(ot.date).getTime()})}),f.forEach(ot=>{ot.traineeFullName===n.fullName&&ot.eventId!==t.id&&ot.overallGrade!==null&&ot.overallGrade!=="No Grade"&&Re(ot.flightNumber)&&we.push({name:ot.flightNumber,score:ot.overallGrade,date:ot.date,timestamp:new Date(ot.date).getTime()})}),we.sort((ot,Vt)=>Vt.timestamp-ot.timestamp);const be=new Date(t.date).getTime(),Ze=we.filter(ot=>ot.timestamp<be);return Ze.length>0?Ze[0]:null},[m,f,n.fullName,v,t.date,t.id]);C.useEffect(()=>{K===1&&_e&&Number(_e.score)===1?(A(!0),Le("F")):A(!1)},[K,_e]),C.useEffect(()=>{K==="No Grade"||K===null?Le(null):K===0?Le("F"):K>=1&&K<=5&&Le("P")},[K]);const Z=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,grade:Re}:Ze)}))},Fe=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,comment:Re}:Ze)}))},Xe=(we,Re)=>{ee(be=>({...be,[we]:Re})),we==="QFI"&&F(be=>({...be,instructorName:Re}))},ft=C.useMemo(()=>u.filter(we=>we.unit===n.unit),[u,n.unit]),tt=we=>{F(Re=>({...Re,instructorName:we})),ee(Re=>({...Re,QFI:we}))},We=we=>{if(we==null)return"";let Re=we;Re>=24&&(Re-=24);const be=Math.floor(Re),Ze=Math.round((Re-be)*60);return`${be.toString().padStart(2,"0")}${Ze.toString().padStart(2,"0")}`},Ke=(we,Re)=>{let be=we.currentTarget.value;be=be.replace(/\D/g,""),be.length>4&&(be=be.substring(0,4)),we.currentTarget.value=be},nt=we=>{const Re=t==null?void 0:t.target;if(!Re)return;let be=Re.value;if(be.length>0){const Ze=be.padStart(4,"0"),ot=parseInt(Ze);if(!isNaN(ot)&&ot>=0&&ot<=2359&&ot%100<60){const Vt=Math.floor(ot/100),Pt=ot%100,yn=Vt+Pt/60;if(Re.value=Ze,we==="startTime"){const Tt={...Ne,startTime:yn};Oe(Tt),J(Tt)}else{const Tt=Ne.startTime||0,lt=yn-Tt;if(lt>0){const Et={...Ne,duration:lt};Oe(Et),J(Et)}}}else if(Re.value="",we==="startTime"){const Vt={...Ne,startTime:null};Oe(Vt),J(Vt)}}},Ct=(we,Re)=>{if(we.key==="Enter"&&(we.preventDefault(),nt(Re),Re==="startTime")){const be=document.querySelector('input[placeholder="hhmm"]:last-of-type');be==null||be.focus()}},xt=()=>{U.current&&(U.current.then(we=>we.close()),U.current=null),P.current&&(P.current.disconnect(),P.current=null),M.current&&(M.current.disconnect(),M.current=null),$.current&&($.current.getTracks().forEach(we=>we.stop()),$.current=null),D.current&&D.current.state!=="closed"&&(D.current.close(),D.current=null),V(null)},dn=async(we,Re)=>{if(ne===we){xt();return}ne&&xt(),V(we);try{const be=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3});D.current=be;const Ze=await navigator.mediaDevices.getUserMedia({audio:!0});$.current=Ze;const ot=be.createMediaStreamSource(Ze);P.current=ot;const Vt=be.createScriptProcessor(4096,1,1);M.current=Vt;const Pt=eA.live.connect({model:"gemini-2.5-flash-native-audio-preview-09-2025",config:{responseModalities:[sf.AUDIO],inputAudioTranscription:{}},callbacks:{onopen:()=>console.log("Gemini Live Connected"),onmessage:yn=>{var Tt;if((Tt=yn.serverContent)!=null&&Tt.inputTranscription){const lt=yn.serverContent.inputTranscription.text;if(lt&&Re==="section"){const Et=we;ee(Bt=>({...Bt,[Et]:(Bt[Et]||"")+lt}))}}},onclose:()=>{ne===we&&xt()},onerror:()=>xt()}});U.current=Pt,Vt.onaudioprocess=yn=>{const Tt=yn.inputBuffer.getChannelData(0),lt=on(Tt);U.current&&U.current.then(Et=>{Et&&Et.sendRealtimeInput({media:lt})})},ot.connect(Vt),Vt.connect(be.destination)}catch(be){console.error("Failed to start voice input:",be),xt()}};function on(we){const Re=we.length,be=new Int16Array(Re);for(let Ze=0;Ze<Re;Ze++)be[Ze]=we[Ze]*32768;return{data:ZE(new Uint8Array(be.buffer)),mimeType:"audio/pcm;rate=16000"}}C.useEffect(()=>()=>{xt()},[]);const st=we=>{Y(we),Q(!0)},kt=we=>{Te&&F(Re=>({...Re,scores:Re.scores.map(be=>be.element===Te?{...be,comment:(be.comment?be.comment+" ":"")+we}:be)})),Q(!1),Y(null)};C.useEffect(()=>{const we=Hm.map(Re=>`${Re}:
public/flight-school-app/assets/index-BCojCDFQ.js:`)}return""+s},t})();const DD=({traineesData:n,instructorsData:t,archivedTraineesData:s,archivedInstructorsData:i,events:o,courses:l,archivedCourses:d,scores:u,publishedSchedules:f,syllabusDetails:h,pt051Assessments:m,onSavePT051Assessment:v})=>{const[x,y]=C.useState("all"),[T,E]=C.useState("all-time"),[A,_]=C.useState(""),[R,H]=C.useState(""),[O,W]=C.useState(""),[ne,V]=C.useState("pdf"),[U,D]=C.useState(!1),[$,M]=C.useState([]),[P,ae]=C.useState([]),[Q,Te]=C.useState([]),[Y,fe]=C.useState([]),[ge,Ne]=C.useState("all"),[Oe,se]=C.useState("all"),[F,J]=C.useState(""),[X,ee]=C.useState(""),[K,ue]=C.useState(""),[xe,Le]=C.useState(!1),[ye,pe]=C.useState(""),[ce,He]=C.useState(!1),[_e,Z]=C.useState(!1),[Fe,Xe]=C.useState(!1),[ft,tt]=C.useState(0),[We,Ke]=C.useState(""),[nt,Ct]=C.useState([]),[xt,dn]=C.useState(!1),[on,st]=C.useState([]),[kt,Ge]=C.useState(!1),[ht,vt]=C.useState(0),[Ht,ze]=C.useState(""),we=B=>{if(!B)return"";const Ae=new Date(B),rt=String(Ae.getDate()).padStart(2,"0"),yt=Ae.toLocaleString("en-GB",{month:"short"}),et=String(Ae.getFullYear()).slice(-2);return`${rt} ${yt} ${et}`},Re=C.useMemo(()=>{const B=Object.values(f).flat();return console.log("📊 Export View - All events from published schedules:",B.length),console.log("📊 Export View - Published schedule dates:",Object.keys(f)),B},[f]),be=C.useMemo(()=>{const B=[...n,...s];return console.log("📊 Export View - All trainees:",B.length),console.log("📊 Export View - ADF303 trainees:",B.filter(Ae=>Ae.course==="ADF303").length),B},[n,s]),Ze=C.useMemo(()=>[...t,...i],[t,i]),ot=C.useMemo(()=>{const B=l.map(rt=>rt.name),Ae=Object.keys(d);return[...new Set([...B,...Ae])]},[l,d]),Vt=C.useMemo(()=>ot.filter(B=>B.toLowerCase().includes(F.toLowerCase())),[ot,F]),Pt=C.useMemo(()=>be.filter(B=>`${B.rank} ${B.name} ${B.course}`.toLowerCase().includes(X.toLowerCase())),[be,X]),yn=C.useMemo(()=>Ze.filter(B=>`${B.rank} ${B.name}`.toLowerCase().includes(K.toLowerCase())),[Ze,K]),Tt=C.useMemo(()=>{let B=[...Re];if(console.log("🔍 FILTER DEBUG - Starting with events:",B.length),console.log("🔍 FILTER DEBUG - timePeriod:",T),console.log("🔍 FILTER DEBUG - singleDate:",A),console.log("🔍 FILTER DEBUG - startDate:",R),console.log("🔍 FILTER DEBUG - endDate:",O),T==="single-date"&&A?(B=B.filter(Ae=>Ae.date===A),console.log("🔍 FILTER DEBUG - After single-date filter:",B.length)):T==="date-range"&&R&&O&&(B=B.filter(Ae=>Ae.date>=R&&Ae.date<=O),console.log("🔍 FILTER DEBUG - After date-range filter:",B.length)),Y.length>0){console.log("🔍 FILTER DEBUG - selectedEventTypes:",Y),console.log("🔍 FILTER DEBUG - Sample event types from data (first 5):",B.slice(0,5).map(rt=>rt.type)),console.log("🔍 FILTER DEBUG - Unique event types in data:",[...new Set(B.map(rt=>rt.type))]);const Ae=Y.map(rt=>rt.toLowerCase());B=B.filter(rt=>{const yt=rt.type.toLowerCase();return Ae.includes(yt)}),console.log("🔍 FILTER DEBUG - After event type filter:",B.length)}if(console.log("🔍 FILTER DEBUG - statusFilter:",ge),console.log("🔍 FILTER DEBUG - Before status filter:",B.length),ge==="dco"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="DCO"}):ge==="dnco"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="DNCO"}):ge==="pass"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="Pass"}):ge==="fail"&&(B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="Fail"})),console.log("🔍 FILTER DEBUG - After all status filters:",B.length),console.log("🔍 FILTER DEBUG - remedialFilter:",Oe),Oe==="yes"?(B=B.filter(Ae=>Ae.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=yes filter:",B.length)):Oe==="no"&&(B=B.filter(Ae=>!Ae.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=no filter:",B.length)),$.length>0&&(console.log("📊 Trainee filter - Selected trainees:",$),console.log("📊 Trainee filter - Events before filter:",B.length),B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;return rt?$.some(et=>!!(rt===et||rt.startsWith(et+" –")||rt.startsWith(et+" -"))):!1}),console.log("📊 Trainee filter - Events after filter:",B.length)),P.length>0&&(B=B.filter(Ae=>Ae.instructor&&P.includes(Ae.instructor))),Q.length>0){const Ae=be.filter(yt=>Q.includes(yt.course)),rt=Ae.map(yt=>yt.name);console.log("📊 Course filter - Selected courses:",Q),console.log("📊 Course filter - Trainees in selected courses:",Ae.length),console.log("📊 Course filter - Trainee names (first 5):",rt.slice(0,5)),console.log("📊 Course filter - Events before filter:",B.length),console.log("📊 Course filter - Sample event student names (first 5):",B.slice(0,5).map(yt=>yt.student||yt.pilot)),B=B.filter(yt=>{const et=yt.student||yt.pilot;if(!et)return!1;const $t=rt.some(pn=>!!(et===pn||et.startsWith(pn+" –")||et.startsWith(pn+" -")));return $t||console.log("📊 No match for student:",et),$t}),console.log("📊 Course filter - Events after filter:",B.length)}return B},[Re,T,A,R,O,Y,ge,Oe,$,P,Q,n]),lt=C.useMemo(()=>{if(Q.length===0)return[];const B=be.filter(et=>Q.includes(et.course));let Ae=Re;T==="single-date"&&A?Ae=Ae.filter(et=>et.date===A):T==="date-range"&&R&&O&&(Ae=Ae.filter(et=>et.date>=R&&et.date<=O));const rt=Ae.filter(et=>Q.some($t=>{const pn=et.student||et.pilot;return pn?B.find(ts=>pn===ts.name||pn.startsWith(ts.name+" –")||pn.startsWith(ts.name+" -")):!1}));return[...new Set(rt.map(et=>{const $t=et.student||et.pilot;if(!$t)return null;const pn=B.find(kn=>$t===kn.name||$t.startsWith(kn.name+" –")||$t.startsWith(kn.name+" -"));return pn==null?void 0:pn.name}).filter(Boolean))]},[Re,Q,T,A,R,O,be]),Et=C.useMemo(()=>(console.log("📊 filteredData calculation - recordType:",x),console.log("📊 filteredData calculation - filteredEvents:",Tt.length),console.log("📊 filteredData calculation - allTrainees:",be.length),console.log("📊 filteredData calculation - allInstructors:",Ze.length),x==="events"?{events:Tt,trainees:[],staff:[]}:x==="trainees"?(console.log("📊 Returning all trainees:",be.length),{events:Tt,trainees:be,staff:[]}):x==="staff"?(console.log("📊 Returning all staff:",Ze.length),{events:Tt,trainees:[],staff:Ze}):(console.log("📊 Returning all trainees and staff"),{events:Tt,trainees:be,staff:Ze})),[x,Tt,be,Ze]),Bt=C.useMemo(()=>{let B=0;return(x==="all"||x==="trainees")&&(B+=Et.trainees.length),(x==="all"||x==="staff")&&(B+=Et.staff.length),(x==="all"||x==="events")&&(B+=Et.events.length),B},[x,Et]),Kt=C.useMemo(()=>{const Ae=Bt*(ne==="pdf"?5e3:ne==="excel"?2e3:500);return Ae<1024?`${Ae} B`:Ae<1024*1024?`${(Ae/1024).toFixed(1)} KB`:`${(Ae/(1024*1024)).toFixed(1)} MB`},[Bt,ne]),Mt=Bt>1e3,Ve=()=>T==="all-time"?"All time":T==="single-date"&&A?we(A):T==="date-range"&&R&&O?`${we(R)} to ${we(O)}`:"Not specified",qt=()=>x==="all"?"All records (Trainees, Staff, Events)":x==="trainees"?"Trainee records":x==="staff"?"Staff records":"Event records",Mn=async()=>{console.log("🚀 Starting export...",{recordType:x,timePeriod:T,outputFormat:ne,recordCount:Bt,data:Et});const rt=`training_records_${new Date().toISOString().split("T")[0]}.${ne==="excel"?"xlsx":ne}`;try{console.log("📄 Export format:",ne),Xe(!0),tt(0),Ke("Preparing export..."),ne==="csv"?(console.log("📊 Exporting CSV..."),console.log("📊 Record count:",Bt),Ke("Generating CSV file..."),jn(rt),console.log("✅ CSV export completed")):ne==="excel"?(console.log("📊 Exporting Excel..."),console.log("📊 Record count:",Bt),Ke("Generating Excel file..."),je(rt),console.log("✅ Excel export completed")):ne==="pdf"&&(console.log("📄 Exporting PDF..."),console.log("📄 Record count:",Bt),console.log("📄 Events to export:",Et.events.length),Ke(`Generating PDF (${Et.events.length} records)...`),await $e(rt),console.log("✅ PDF export completed")),Xe(!1),console.log("✅ Showing success message"),He(!0),setTimeout(()=>He(!1),5e3)}catch(yt){console.error("❌ Export error:",yt),console.error("Error stack:",yt instanceof Error?yt.stack:"No stack trace"),Xe(!1),Z(!0),setTimeout(()=>Z(!1),5e3)}},jn=B=>{let Ae="";(x==="all"||x==="events")&&(Ae+=`EVENTS
public/flight-school-app/assets/index-CHdj6ICi.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},ye=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},xe=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),Ve=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},We=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>We("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>We("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),ye.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),Ve.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:Ve.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:xe,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{try{const Ge=T}catch{}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct",ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=n.flightType==="Solo"?"":X?n.student:n.student||"";let ue="font-semibold truncate",ye="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?ye="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(ye="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,We=n.startTime+n.duration,we=Ht>=We&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?ye="font-bold truncate text-red-500":ye+=" text-white/80"}const xe=(()=>{if(W)return K;if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&!n.student&&n.pilot)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof xe=="string"?xe:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,We=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[We==null?void 0:We.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[We==null?void 0:We.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:ye.replace("truncate",""),children:typeof xe=="string"?e.jsxs(e.Fragment,{children:[xe,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):xe})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-CHdj6ICi.js: */const WE="gl-node/";class YE{constructor(t){var s;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(s=t.vertexai)!==null&&s!==void 0?s:!1,this.apiKey=t.apiKey;const i=CS(t.httpOptions,t.vertexai,void 0,void 0);i&&(t.httpOptions?t.httpOptions.baseUrl=i:t.httpOptions={baseUrl:i}),this.apiVersion=t.apiVersion;const o=new VE(this.apiKey);this.apiClient=new cj({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:WE+"web",uploader:new qE,downloader:new ME}),this.models=new Aj(this.apiClient),this.live=new wj(this.apiClient,o,new GE),this.batches=new QC(this.apiClient),this.chats=new MT(this.models,this.apiClient),this.caches=new _T(this.apiClient),this.files=new GT(this.apiClient),this.operations=new kj(this.apiClient),this.authTokens=new zj(this.apiClient),this.tunings=new LE(this.apiClient),this.fileSearchStores=new mE(this.apiClient)}}const d2=[{category:"Core Dimensions",elements:["Airmanship","Preparation","Technique"]},{category:"Procedural Framework",elements:["Pre-Post Flight","Walk Around","Strap-in","Ground Checks","Airborne Checks"]},{category:"Takeoff",elements:["Stationary"]},{category:"Departure",elements:["Visual"]},{category:"Core Handling Skills",elements:["Effects of Control","Trimming","Straight and Level"]},{category:"Turns",elements:["Level medium Turn","Level Steep turn"]},{category:"Recovery",elements:["Visual - Initial & Pitch"]},{category:"Landing",elements:["Landing","Crosswind"]},{category:"Domestics",elements:["Radio Comms","Situational Awareness","Lookout","Knowledge"]}],JE=d2.flatMap(n=>n.elements),z1=["DEMO",0,1,2,3,4,5],XE=["No Grade",0,1,2,3,4,5],Hm=["QFI","Weather","Profile","Overall","NEST"],KE=n=>{const t={QFI:"",Weather:"",Profile:"",Overall:"",NEST:""};if(!n)return t;const s={...t};return Hm.forEach((i,o)=>{const l=Hm[o+1],d=`${i}:`,u=n.indexOf(d);if(u!==-1){let f=u+d.length,h=-1;if(l){const v=`${l}:`;h=n.indexOf(v,f)}let m="";h!==-1?m=n.substring(f,h):m=n.substring(f),s[i]=m.trim()}}),s};function ZE(n){let t="";const s=n.byteLength;for(let i=0;i<s;i++)t+=String.fromCharCode(n[i]);return btoa(t)}const QE=({element:n,onClose:t,onInsert:s,phraseBank:i})=>{const[o,l]=C.useState(new Set);let d=i==null?void 0:i[n];const u=["Airmanship","Preparation","Technique"].includes(n);!d&&!u&&(d=i==null?void 0:i["Generic Flying Elements"]);const f=v=>{const x=new Set(o);x.has(v)?x.delete(v):x.add(v),l(x)},h=()=>{const v=Array.from(o).join(" ");s(v)},m=v=>{switch(v){case"5":return"5 - Excellent";case"4":return"4 - High Satisfactory";case"3":return"3 - Satisfactory";case"2":return"2 - Low Satisfactory";case"1":return"1 - Marginal";case"0":return"0 - Unsatisfactory";default:return v}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[80] flex items-center justify-center animate-fade-in",onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700 flex flex-col max-h-[80vh]",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-bold text-white",children:["Select Phrases: ",e.jsx("span",{className:"text-sky-400",children:n})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 overflow-y-auto flex-1 space-y-4",children:d?Object.entries(d).sort((v,x)=>Number(x[0])-Number(v[0])).map(([v,x])=>{const y=x;return y.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2 border-b border-gray-700 pb-1",children:m(v)}),e.jsx("div",{className:"space-y-2",children:y.map((T,E)=>e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer p-2 rounded hover:bg-gray-700/50",children:[e.jsx("input",{type:"checkbox",checked:o.has(T),onChange:()=>f(T),className:"mt-1 h-4 w-4 accent-sky-500 bg-gray-600 border-gray-500 rounded"}),e.jsx("span",{className:"text-sm text-gray-200",children:T})]},E))})]},v)}):e.jsxs("div",{className:"text-center py-8 text-gray-500 italic",children:[e.jsx("p",{children:"No phrase list available for this element."}),e.jsx("p",{className:"text-xs mt-2",children:"Configure in Settings → Scoring Matrix."})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-900/50 flex justify-end space-x-3",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm font-semibold",children:"Cancel"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 text-sm font-semibold",children:"Insert Selected"})]})]})})},eA=new YE({apiKey:""}),tA=({trainee:n,event:t,onBack:s,onSave:i,onDeleteAssessment:o,onEventUpdate:l,initialAssessment:d,instructors:u,pt051Assessments:f,events:h,lmpScores:m,syllabusDetails:v,registerDirtyCheck:x,phraseBank:y,currentUserPin:T})=>{const[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState("Saved"),W=C.useRef(!0),[ne,V]=C.useState(null),U=C.useRef(null),D=C.useRef(null),$=C.useRef(null),M=C.useRef(null),P=C.useRef(null),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(null),fe=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500",ge=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500";C.useMemo(()=>t.instructor&&u.find(we=>we.name===t.instructor)||null,[t.instructor,u]);const[Ne,Oe]=C.useState(()=>d&&(d.startTime!==void 0||d.duration!==void 0)?{...t,startTime:d.startTime||t.startTime,duration:d.duration||t.duration}:t),[se,F]=C.useState(()=>d||{id:_r(),traineeFullName:n.fullName,eventId:t.id,flightNumber:t.flightNumber,date:t.date,instructorName:t.instructor||"",scores:JE.map(we=>({element:we,grade:null,comment:""})),overallGrade:null,overallResult:null,groundSchoolAssessment:{isAssessment:!1,result:void 0}}),J=we=>{const Re={...Ne,...we};Oe(Re),l&&l(Re)},[X,ee]=C.useState(()=>{const we=KE(d==null?void 0:d.overallComments);return!we.QFI&&t.instructor&&(we.QFI=t.instructor),we}),[K,ue]=C.useState((d==null?void 0:d.overallGrade)||null),[ye,Le]=C.useState((d==null?void 0:d.overallResult)||null),[xe,pe]=C.useState((d==null?void 0:d.groundSchoolAssessment)||{isAssessment:!1,result:void 0}),[ce,He]=C.useState((d==null?void 0:d.dcoResult)||""),_e=C.useMemo(()=>{const we=[],Re=ot=>{const Vt=v.find(yn=>yn.id===ot||yn.code===ot);if(Vt)return Vt.type==="Flight"||Vt.type==="FTD";const Pt=ot.toUpperCase();return!!((Pt.includes("FTD")||Pt.startsWith("BGF")||Pt.startsWith("BIF")||Pt.startsWith("BNF")||Pt.startsWith("BNAV")||Pt.startsWith("SCT"))&&!Pt.includes("MB")&&!Pt.includes("TUT")&&!Pt.includes("CPT"))};m.forEach(ot=>{Re(ot.event)&&we.push({name:ot.event,score:ot.score,date:ot.date,timestamp:new Date(ot.date).getTime()})}),f.forEach(ot=>{ot.traineeFullName===n.fullName&&ot.eventId!==t.id&&ot.overallGrade!==null&&ot.overallGrade!=="No Grade"&&Re(ot.flightNumber)&&we.push({name:ot.flightNumber,score:ot.overallGrade,date:ot.date,timestamp:new Date(ot.date).getTime()})}),we.sort((ot,Vt)=>Vt.timestamp-ot.timestamp);const be=new Date(t.date).getTime(),Ze=we.filter(ot=>ot.timestamp<be);return Ze.length>0?Ze[0]:null},[m,f,n.fullName,v,t.date,t.id]);C.useEffect(()=>{K===1&&_e&&Number(_e.score)===1?(A(!0),Le("F")):A(!1)},[K,_e]),C.useEffect(()=>{K==="No Grade"||K===null?Le(null):K===0?Le("F"):K>=1&&K<=5&&Le("P")},[K]);const Z=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,grade:Re}:Ze)}))},Fe=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,comment:Re}:Ze)}))},Xe=(we,Re)=>{ee(be=>({...be,[we]:Re})),we==="QFI"&&F(be=>({...be,instructorName:Re}))},ft=C.useMemo(()=>u.filter(we=>we.unit===n.unit),[u,n.unit]),tt=we=>{F(Re=>({...Re,instructorName:we})),ee(Re=>({...Re,QFI:we}))},Ve=we=>{if(we==null)return"";let Re=we;Re>=24&&(Re-=24);const be=Math.floor(Re),Ze=Math.round((Re-be)*60);return`${be.toString().padStart(2,"0")}${Ze.toString().padStart(2,"0")}`},Ke=(we,Re)=>{let be=we.currentTarget.value;be=be.replace(/\D/g,""),be.length>4&&(be=be.substring(0,4)),we.currentTarget.value=be},nt=we=>{const Re=t==null?void 0:t.target;if(!Re)return;let be=Re.value;if(be.length>0){const Ze=be.padStart(4,"0"),ot=parseInt(Ze);if(!isNaN(ot)&&ot>=0&&ot<=2359&&ot%100<60){const Vt=Math.floor(ot/100),Pt=ot%100,yn=Vt+Pt/60;if(Re.value=Ze,we==="startTime"){const Tt={...Ne,startTime:yn};Oe(Tt),J(Tt)}else{const Tt=Ne.startTime||0,lt=yn-Tt;if(lt>0){const Et={...Ne,duration:lt};Oe(Et),J(Et)}}}else if(Re.value="",we==="startTime"){const Vt={...Ne,startTime:null};Oe(Vt),J(Vt)}}},Ct=(we,Re)=>{if(we.key==="Enter"&&(we.preventDefault(),nt(Re),Re==="startTime")){const be=document.querySelector('input[placeholder="hhmm"]:last-of-type');be==null||be.focus()}},xt=()=>{U.current&&(U.current.then(we=>we.close()),U.current=null),P.current&&(P.current.disconnect(),P.current=null),M.current&&(M.current.disconnect(),M.current=null),$.current&&($.current.getTracks().forEach(we=>we.stop()),$.current=null),D.current&&D.current.state!=="closed"&&(D.current.close(),D.current=null),V(null)},dn=async(we,Re)=>{if(ne===we){xt();return}ne&&xt(),V(we);try{const be=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3});D.current=be;const Ze=await navigator.mediaDevices.getUserMedia({audio:!0});$.current=Ze;const ot=be.createMediaStreamSource(Ze);P.current=ot;const Vt=be.createScriptProcessor(4096,1,1);M.current=Vt;const Pt=eA.live.connect({model:"gemini-2.5-flash-native-audio-preview-09-2025",config:{responseModalities:[sf.AUDIO],inputAudioTranscription:{}},callbacks:{onopen:()=>console.log("Gemini Live Connected"),onmessage:yn=>{var Tt;if((Tt=yn.serverContent)!=null&&Tt.inputTranscription){const lt=yn.serverContent.inputTranscription.text;if(lt&&Re==="section"){const Et=we;ee(Bt=>({...Bt,[Et]:(Bt[Et]||"")+lt}))}}},onclose:()=>{ne===we&&xt()},onerror:()=>xt()}});U.current=Pt,Vt.onaudioprocess=yn=>{const Tt=yn.inputBuffer.getChannelData(0),lt=on(Tt);U.current&&U.current.then(Et=>{Et&&Et.sendRealtimeInput({media:lt})})},ot.connect(Vt),Vt.connect(be.destination)}catch(be){console.error("Failed to start voice input:",be),xt()}};function on(we){const Re=we.length,be=new Int16Array(Re);for(let Ze=0;Ze<Re;Ze++)be[Ze]=we[Ze]*32768;return{data:ZE(new Uint8Array(be.buffer)),mimeType:"audio/pcm;rate=16000"}}C.useEffect(()=>()=>{xt()},[]);const st=we=>{Y(we),Q(!0)},kt=we=>{Te&&F(Re=>({...Re,scores:Re.scores.map(be=>be.element===Te?{...be,comment:(be.comment?be.comment+" ":"")+we}:be)})),Q(!1),Y(null)};C.useEffect(()=>{const we=Hm.map(Re=>`${Re}:
public/flight-school-app/assets/index-CHdj6ICi.js:`)}return""+s},t})();const DD=({traineesData:n,instructorsData:t,archivedTraineesData:s,archivedInstructorsData:i,events:o,courses:l,archivedCourses:d,scores:u,publishedSchedules:f,syllabusDetails:h,pt051Assessments:m,onSavePT051Assessment:v})=>{const[x,y]=C.useState("all"),[T,E]=C.useState("all-time"),[A,_]=C.useState(""),[R,H]=C.useState(""),[O,W]=C.useState(""),[ne,V]=C.useState("pdf"),[U,D]=C.useState(!1),[$,M]=C.useState([]),[P,ae]=C.useState([]),[Q,Te]=C.useState([]),[Y,fe]=C.useState([]),[ge,Ne]=C.useState("all"),[Oe,se]=C.useState("all"),[F,J]=C.useState(""),[X,ee]=C.useState(""),[K,ue]=C.useState(""),[ye,Le]=C.useState(!1),[xe,pe]=C.useState(""),[ce,He]=C.useState(!1),[_e,Z]=C.useState(!1),[Fe,Xe]=C.useState(!1),[ft,tt]=C.useState(0),[Ve,Ke]=C.useState(""),[nt,Ct]=C.useState([]),[xt,dn]=C.useState(!1),[on,st]=C.useState([]),[kt,Ge]=C.useState(!1),[ht,vt]=C.useState(0),[Ht,We]=C.useState(""),we=B=>{if(!B)return"";const Ae=new Date(B),rt=String(Ae.getDate()).padStart(2,"0"),yt=Ae.toLocaleString("en-GB",{month:"short"}),et=String(Ae.getFullYear()).slice(-2);return`${rt} ${yt} ${et}`},Re=C.useMemo(()=>{const B=Object.values(f).flat();return console.log("📊 Export View - All events from published schedules:",B.length),console.log("📊 Export View - Published schedule dates:",Object.keys(f)),B},[f]),be=C.useMemo(()=>{const B=[...n,...s];return console.log("📊 Export View - All trainees:",B.length),console.log("📊 Export View - ADF303 trainees:",B.filter(Ae=>Ae.course==="ADF303").length),B},[n,s]),Ze=C.useMemo(()=>[...t,...i],[t,i]),ot=C.useMemo(()=>{const B=l.map(rt=>rt.name),Ae=Object.keys(d);return[...new Set([...B,...Ae])]},[l,d]),Vt=C.useMemo(()=>ot.filter(B=>B.toLowerCase().includes(F.toLowerCase())),[ot,F]),Pt=C.useMemo(()=>be.filter(B=>`${B.rank} ${B.name} ${B.course}`.toLowerCase().includes(X.toLowerCase())),[be,X]),yn=C.useMemo(()=>Ze.filter(B=>`${B.rank} ${B.name}`.toLowerCase().includes(K.toLowerCase())),[Ze,K]),Tt=C.useMemo(()=>{let B=[...Re];if(console.log("🔍 FILTER DEBUG - Starting with events:",B.length),console.log("🔍 FILTER DEBUG - timePeriod:",T),console.log("🔍 FILTER DEBUG - singleDate:",A),console.log("🔍 FILTER DEBUG - startDate:",R),console.log("🔍 FILTER DEBUG - endDate:",O),T==="single-date"&&A?(B=B.filter(Ae=>Ae.date===A),console.log("🔍 FILTER DEBUG - After single-date filter:",B.length)):T==="date-range"&&R&&O&&(B=B.filter(Ae=>Ae.date>=R&&Ae.date<=O),console.log("🔍 FILTER DEBUG - After date-range filter:",B.length)),Y.length>0){console.log("🔍 FILTER DEBUG - selectedEventTypes:",Y),console.log("🔍 FILTER DEBUG - Sample event types from data (first 5):",B.slice(0,5).map(rt=>rt.type)),console.log("🔍 FILTER DEBUG - Unique event types in data:",[...new Set(B.map(rt=>rt.type))]);const Ae=Y.map(rt=>rt.toLowerCase());B=B.filter(rt=>{const yt=rt.type.toLowerCase();return Ae.includes(yt)}),console.log("🔍 FILTER DEBUG - After event type filter:",B.length)}if(console.log("🔍 FILTER DEBUG - statusFilter:",ge),console.log("🔍 FILTER DEBUG - Before status filter:",B.length),ge==="dco"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="DCO"}):ge==="dnco"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="DNCO"}):ge==="pass"?B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="Pass"}):ge==="fail"&&(B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;if(!rt)return!1;const yt=u.get(rt);if(!yt)return!1;const et=yt.find($t=>$t.syllabusId===Ae.flightNumber&&$t.date===Ae.date);return(et==null?void 0:et.outcome)==="Fail"})),console.log("🔍 FILTER DEBUG - After all status filters:",B.length),console.log("🔍 FILTER DEBUG - remedialFilter:",Oe),Oe==="yes"?(B=B.filter(Ae=>Ae.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=yes filter:",B.length)):Oe==="no"&&(B=B.filter(Ae=>!Ae.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=no filter:",B.length)),$.length>0&&(console.log("📊 Trainee filter - Selected trainees:",$),console.log("📊 Trainee filter - Events before filter:",B.length),B=B.filter(Ae=>{const rt=Ae.student||Ae.pilot;return rt?$.some(et=>!!(rt===et||rt.startsWith(et+" –")||rt.startsWith(et+" -"))):!1}),console.log("📊 Trainee filter - Events after filter:",B.length)),P.length>0&&(B=B.filter(Ae=>Ae.instructor&&P.includes(Ae.instructor))),Q.length>0){const Ae=be.filter(yt=>Q.includes(yt.course)),rt=Ae.map(yt=>yt.name);console.log("📊 Course filter - Selected courses:",Q),console.log("📊 Course filter - Trainees in selected courses:",Ae.length),console.log("📊 Course filter - Trainee names (first 5):",rt.slice(0,5)),console.log("📊 Course filter - Events before filter:",B.length),console.log("📊 Course filter - Sample event student names (first 5):",B.slice(0,5).map(yt=>yt.student||yt.pilot)),B=B.filter(yt=>{const et=yt.student||yt.pilot;if(!et)return!1;const $t=rt.some(pn=>!!(et===pn||et.startsWith(pn+" –")||et.startsWith(pn+" -")));return $t||console.log("📊 No match for student:",et),$t}),console.log("📊 Course filter - Events after filter:",B.length)}return B},[Re,T,A,R,O,Y,ge,Oe,$,P,Q,n]),lt=C.useMemo(()=>{if(Q.length===0)return[];const B=be.filter(et=>Q.includes(et.course));let Ae=Re;T==="single-date"&&A?Ae=Ae.filter(et=>et.date===A):T==="date-range"&&R&&O&&(Ae=Ae.filter(et=>et.date>=R&&et.date<=O));const rt=Ae.filter(et=>Q.some($t=>{const pn=et.student||et.pilot;return pn?B.find(ts=>pn===ts.name||pn.startsWith(ts.name+" –")||pn.startsWith(ts.name+" -")):!1}));return[...new Set(rt.map(et=>{const $t=et.student||et.pilot;if(!$t)return null;const pn=B.find(kn=>$t===kn.name||$t.startsWith(kn.name+" –")||$t.startsWith(kn.name+" -"));return pn==null?void 0:pn.name}).filter(Boolean))]},[Re,Q,T,A,R,O,be]),Et=C.useMemo(()=>(console.log("📊 filteredData calculation - recordType:",x),console.log("📊 filteredData calculation - filteredEvents:",Tt.length),console.log("📊 filteredData calculation - allTrainees:",be.length),console.log("📊 filteredData calculation - allInstructors:",Ze.length),x==="events"?{events:Tt,trainees:[],staff:[]}:x==="trainees"?(console.log("📊 Returning all trainees:",be.length),{events:Tt,trainees:be,staff:[]}):x==="staff"?(console.log("📊 Returning all staff:",Ze.length),{events:Tt,trainees:[],staff:Ze}):(console.log("📊 Returning all trainees and staff"),{events:Tt,trainees:be,staff:Ze})),[x,Tt,be,Ze]),Bt=C.useMemo(()=>{let B=0;return(x==="all"||x==="trainees")&&(B+=Et.trainees.length),(x==="all"||x==="staff")&&(B+=Et.staff.length),(x==="all"||x==="events")&&(B+=Et.events.length),B},[x,Et]),Kt=C.useMemo(()=>{const Ae=Bt*(ne==="pdf"?5e3:ne==="excel"?2e3:500);return Ae<1024?`${Ae} B`:Ae<1024*1024?`${(Ae/1024).toFixed(1)} KB`:`${(Ae/(1024*1024)).toFixed(1)} MB`},[Bt,ne]),Mt=Bt>1e3,ze=()=>T==="all-time"?"All time":T==="single-date"&&A?we(A):T==="date-range"&&R&&O?`${we(R)} to ${we(O)}`:"Not specified",qt=()=>x==="all"?"All records (Trainees, Staff, Events)":x==="trainees"?"Trainee records":x==="staff"?"Staff records":"Event records",Mn=async()=>{console.log("🚀 Starting export...",{recordType:x,timePeriod:T,outputFormat:ne,recordCount:Bt,data:Et});const rt=`training_records_${new Date().toISOString().split("T")[0]}.${ne==="excel"?"xlsx":ne}`;try{console.log("📄 Export format:",ne),Xe(!0),tt(0),Ke("Preparing export..."),ne==="csv"?(console.log("📊 Exporting CSV..."),console.log("📊 Record count:",Bt),Ke("Generating CSV file..."),jn(rt),console.log("✅ CSV export completed")):ne==="excel"?(console.log("📊 Exporting Excel..."),console.log("📊 Record count:",Bt),Ke("Generating Excel file..."),je(rt),console.log("✅ Excel export completed")):ne==="pdf"&&(console.log("📄 Exporting PDF..."),console.log("📄 Record count:",Bt),console.log("📄 Events to export:",Et.events.length),Ke(`Generating PDF (${Et.events.length} records)...`),await $e(rt),console.log("✅ PDF export completed")),Xe(!1),console.log("✅ Showing success message"),He(!0),setTimeout(()=>He(!1),5e3)}catch(yt){console.error("❌ Export error:",yt),console.error("Error stack:",yt instanceof Error?yt.stack:"No stack trace"),Xe(!1),Z(!0),setTimeout(()=>Z(!1),5e3)}},jn=B=>{let Ae="";(x==="all"||x==="events")&&(Ae+=`EVENTS
public/flight-school-app/assets/index-Cu9GSreP.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[je,Y]=C.useState(!1),he=C.useRef(null),[ge,Ne]=C.useState(!1),[$e,se]=C.useState(!1),F=C.useRef(null),J=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[te,K]=C.useState(J);C.useEffect(()=>{const Re=be=>{he.current&&!he.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{J&&K(!0)},[J]);const fe=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},de=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},Ie=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(Ie).sort((Re,be)=>{const Ze=Z.indexOf(Re),lt=Z.indexOf(be);return Ze!==-1&&lt!==-1?Ze-lt:Ze!==-1?-1:lt!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),yt=()=>Q(!0),dn=()=>{je||Q(!1)},on=()=>{const Re=!je;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||je,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),Nt=()=>{$e||Ne(!1)},Ht=()=>{const Re=!$e;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||$e;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:he,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:yt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:Nt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:fe,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${J?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${te?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${te?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),Ie[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&de(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:de,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{console.log("🔍 FLIGHT TILE ERROR TRACKING - Props received:"),console.log("  - event.id:",n==null?void 0:n.id),console.log("  - event.type:",n==null?void 0:n.type),console.log("  - personnelData size:",y==null?void 0:y.size),console.log("  - seatConfigs type:",typeof T),console.log("  - seatConfigs value:",T),console.log("  - seatConfigs === undefined:",T===void 0),console.log("  - seatConfigs === null:",T===null);try{const Ge=T;console.log("✅ seatConfigs access successful")}catch(Ge){console.error("❌ seatConfigs access failed:",Ge),console.error("❌ Error stack:",Ge.stack)}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},je=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const Nt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(Nt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-Nt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,he=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(he,Ne));const J=n.eventCategory==="sct";J&&console.log("🎯 FlightTile rendering SCT event:",{id:n.id,flightType:n.flightType,pilot:n.pilot,student:n.student,instructor:n.instructor,eventCategory:n.eventCategory,fullEvent:n});const te=J||n.flightType==="Solo"?n.pilot:n.instructor,K=J?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let fe="font-semibold truncate",xe="truncate";if(W)te!=null&&te.includes("✓")?fe="font-bold truncate text-green-400":te!=null&&te.includes("✕")&&(fe="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(te||""),Nt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===te||ht&&!we?fe="font-bold truncate text-red-500":Ge&&(fe+=` ${Ge}`),x===K||Nt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(J&&n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(J&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},de=pe(te),qe=pe(typeof ye=="string"?ye:""),Ie=n.callsign||"",Z=te?y.get(te):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=Ie||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,Nt=Ze=>{if(!Ze)return Ze;const lt=Ze.split(", ");if(lt.length!==2)return Ze;const Wt=lt[0],yn=lt[1].charAt(0);return`${Wt}, ${yn}`},Ht=ht?Nt(te||""):te,ze=ht?Nt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:fe,children:[te==null?void 0:te.split(" – ")[0],de&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:de})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:fe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],de&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:de})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],qe&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:qe})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:fe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],de&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:de})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],qe&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:qe})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,yt=je(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${yt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${fe.replace("truncate","")}`,children:[te==null?void 0:te.split(" – ")[0],de&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:de})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,qe&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:qe})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{console.log("FlightTile onMouseDown called for event:",n.id),Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-Cu9GSreP.js: */const WE="gl-node/";class YE{constructor(t){var s;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(s=t.vertexai)!==null&&s!==void 0?s:!1,this.apiKey=t.apiKey;const i=CS(t.httpOptions,t.vertexai,void 0,void 0);i&&(t.httpOptions?t.httpOptions.baseUrl=i:t.httpOptions={baseUrl:i}),this.apiVersion=t.apiVersion;const o=new VE(this.apiKey);this.apiClient=new cj({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:WE+"web",uploader:new qE,downloader:new ME}),this.models=new Aj(this.apiClient),this.live=new wj(this.apiClient,o,new GE),this.batches=new QC(this.apiClient),this.chats=new MT(this.models,this.apiClient),this.caches=new _T(this.apiClient),this.files=new GT(this.apiClient),this.operations=new kj(this.apiClient),this.authTokens=new zj(this.apiClient),this.tunings=new LE(this.apiClient),this.fileSearchStores=new mE(this.apiClient)}}const d2=[{category:"Core Dimensions",elements:["Airmanship","Preparation","Technique"]},{category:"Procedural Framework",elements:["Pre-Post Flight","Walk Around","Strap-in","Ground Checks","Airborne Checks"]},{category:"Takeoff",elements:["Stationary"]},{category:"Departure",elements:["Visual"]},{category:"Core Handling Skills",elements:["Effects of Control","Trimming","Straight and Level"]},{category:"Turns",elements:["Level medium Turn","Level Steep turn"]},{category:"Recovery",elements:["Visual - Initial & Pitch"]},{category:"Landing",elements:["Landing","Crosswind"]},{category:"Domestics",elements:["Radio Comms","Situational Awareness","Lookout","Knowledge"]}],JE=d2.flatMap(n=>n.elements),z1=["DEMO",0,1,2,3,4,5],XE=["No Grade",0,1,2,3,4,5],Hm=["QFI","Weather","Profile","Overall","NEST"],KE=n=>{const t={QFI:"",Weather:"",Profile:"",Overall:"",NEST:""};if(!n)return t;const s={...t};return Hm.forEach((i,o)=>{const l=Hm[o+1],d=`${i}:`,u=n.indexOf(d);if(u!==-1){let f=u+d.length,h=-1;if(l){const v=`${l}:`;h=n.indexOf(v,f)}let m="";h!==-1?m=n.substring(f,h):m=n.substring(f),s[i]=m.trim()}}),s};function ZE(n){let t="";const s=n.byteLength;for(let i=0;i<s;i++)t+=String.fromCharCode(n[i]);return btoa(t)}const QE=({element:n,onClose:t,onInsert:s,phraseBank:i})=>{const[o,l]=C.useState(new Set);let d=i==null?void 0:i[n];const u=["Airmanship","Preparation","Technique"].includes(n);!d&&!u&&(d=i==null?void 0:i["Generic Flying Elements"]);const f=v=>{const x=new Set(o);x.has(v)?x.delete(v):x.add(v),l(x)},h=()=>{const v=Array.from(o).join(" ");s(v)},m=v=>{switch(v){case"5":return"5 - Excellent";case"4":return"4 - High Satisfactory";case"3":return"3 - Satisfactory";case"2":return"2 - Low Satisfactory";case"1":return"1 - Marginal";case"0":return"0 - Unsatisfactory";default:return v}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[80] flex items-center justify-center animate-fade-in",onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700 flex flex-col max-h-[80vh]",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-bold text-white",children:["Select Phrases: ",e.jsx("span",{className:"text-sky-400",children:n})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 overflow-y-auto flex-1 space-y-4",children:d?Object.entries(d).sort((v,x)=>Number(x[0])-Number(v[0])).map(([v,x])=>{const y=x;return y.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2 border-b border-gray-700 pb-1",children:m(v)}),e.jsx("div",{className:"space-y-2",children:y.map((T,E)=>e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer p-2 rounded hover:bg-gray-700/50",children:[e.jsx("input",{type:"checkbox",checked:o.has(T),onChange:()=>f(T),className:"mt-1 h-4 w-4 accent-sky-500 bg-gray-600 border-gray-500 rounded"}),e.jsx("span",{className:"text-sm text-gray-200",children:T})]},E))})]},v)}):e.jsxs("div",{className:"text-center py-8 text-gray-500 italic",children:[e.jsx("p",{children:"No phrase list available for this element."}),e.jsx("p",{className:"text-xs mt-2",children:"Configure in Settings → Scoring Matrix."})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-900/50 flex justify-end space-x-3",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm font-semibold",children:"Cancel"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 text-sm font-semibold",children:"Insert Selected"})]})]})})},eA=new YE({apiKey:""}),tA=({trainee:n,event:t,onBack:s,onSave:i,onDeleteAssessment:o,onEventUpdate:l,initialAssessment:d,instructors:u,pt051Assessments:f,events:h,lmpScores:m,syllabusDetails:v,registerDirtyCheck:x,phraseBank:y,currentUserPin:T})=>{const[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState("Saved"),W=C.useRef(!0),[ne,V]=C.useState(null),U=C.useRef(null),D=C.useRef(null),$=C.useRef(null),M=C.useRef(null),P=C.useRef(null),[ae,Q]=C.useState(!1),[je,Y]=C.useState(null),he=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500",ge=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500";C.useMemo(()=>t.instructor&&u.find(we=>we.name===t.instructor)||null,[t.instructor,u]);const[Ne,$e]=C.useState(()=>d&&(d.startTime!==void 0||d.duration!==void 0)?{...t,startTime:d.startTime||t.startTime,duration:d.duration||t.duration}:t),[se,F]=C.useState(()=>d||{id:_r(),traineeFullName:n.fullName,eventId:t.id,flightNumber:t.flightNumber,date:t.date,instructorName:t.instructor||"",scores:JE.map(we=>({element:we,grade:null,comment:""})),overallGrade:null,overallResult:null,groundSchoolAssessment:{isAssessment:!1,result:void 0}}),X=we=>{const Re={...Ne,...we};$e(Re),l&&l(Re)},[J,te]=C.useState(()=>{const we=KE(d==null?void 0:d.overallComments);return!we.QFI&&t.instructor&&(we.QFI=t.instructor),we}),[K,fe]=C.useState((d==null?void 0:d.overallGrade)||null),[xe,Le]=C.useState((d==null?void 0:d.overallResult)||null),[ye,pe]=C.useState((d==null?void 0:d.groundSchoolAssessment)||{isAssessment:!1,result:void 0}),[de,qe]=C.useState((d==null?void 0:d.dcoResult)||""),Ie=C.useMemo(()=>{const we=[],Re=lt=>{const Wt=v.find(yn=>yn.id===lt||yn.code===lt);if(Wt)return Wt.type==="Flight"||Wt.type==="FTD";const Rt=lt.toUpperCase();return!!((Rt.includes("FTD")||Rt.startsWith("BGF")||Rt.startsWith("BIF")||Rt.startsWith("BNF")||Rt.startsWith("BNAV")||Rt.startsWith("SCT"))&&!Rt.includes("MB")&&!Rt.includes("TUT")&&!Rt.includes("CPT"))};m.forEach(lt=>{Re(lt.event)&&we.push({name:lt.event,score:lt.score,date:lt.date,timestamp:new Date(lt.date).getTime()})}),f.forEach(lt=>{lt.traineeFullName===n.fullName&&lt.eventId!==t.id&&lt.overallGrade!==null&&lt.overallGrade!=="No Grade"&&Re(lt.flightNumber)&&we.push({name:lt.flightNumber,score:lt.overallGrade,date:lt.date,timestamp:new Date(lt.date).getTime()})}),we.sort((lt,Wt)=>Wt.timestamp-lt.timestamp);const be=new Date(t.date).getTime(),Ze=we.filter(lt=>lt.timestamp<be);return Ze.length>0?Ze[0]:null},[m,f,n.fullName,v,t.date,t.id]);C.useEffect(()=>{K===1&&Ie&&Number(Ie.score)===1?(A(!0),Le("F")):A(!1)},[K,Ie]),C.useEffect(()=>{K==="No Grade"||K===null?Le(null):K===0?Le("F"):K>=1&&K<=5&&Le("P")},[K]);const Z=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,grade:Re}:Ze)}))},Fe=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,comment:Re}:Ze)}))},Xe=(we,Re)=>{te(be=>({...be,[we]:Re})),we==="QFI"&&F(be=>({...be,instructorName:Re}))},ft=C.useMemo(()=>u.filter(we=>we.unit===n.unit),[u,n.unit]),tt=we=>{F(Re=>({...Re,instructorName:we})),te(Re=>({...Re,QFI:we}))},We=we=>{if(we==null)return"";let Re=we;Re>=24&&(Re-=24);const be=Math.floor(Re),Ze=Math.round((Re-be)*60);return`${be.toString().padStart(2,"0")}${Ze.toString().padStart(2,"0")}`},Ke=(we,Re)=>{let be=we.currentTarget.value;be=be.replace(/\D/g,""),be.length>4&&(be=be.substring(0,4)),we.currentTarget.value=be},nt=we=>{const Re=t==null?void 0:t.target;if(!Re)return;let be=Re.value;if(be.length>0){const Ze=be.padStart(4,"0"),lt=parseInt(Ze);if(!isNaN(lt)&&lt>=0&&lt<=2359&&lt%100<60){const Wt=Math.floor(lt/100),Rt=lt%100,yn=Wt+Rt/60;if(Re.value=Ze,we==="startTime"){const Tt={...Ne,startTime:yn};$e(Tt),X(Tt)}else{const Tt=Ne.startTime||0,ct=yn-Tt;if(ct>0){const Et={...Ne,duration:ct};$e(Et),X(Et)}}}else if(Re.value="",we==="startTime"){const Wt={...Ne,startTime:null};$e(Wt),X(Wt)}}},Ct=(we,Re)=>{if(we.key==="Enter"&&(we.preventDefault(),nt(Re),Re==="startTime")){const be=document.querySelector('input[placeholder="hhmm"]:last-of-type');be==null||be.focus()}},yt=()=>{U.current&&(U.current.then(we=>we.close()),U.current=null),P.current&&(P.current.disconnect(),P.current=null),M.current&&(M.current.disconnect(),M.current=null),$.current&&($.current.getTracks().forEach(we=>we.stop()),$.current=null),D.current&&D.current.state!=="closed"&&(D.current.close(),D.current=null),V(null)},dn=async(we,Re)=>{if(ne===we){yt();return}ne&&yt(),V(we);try{const be=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3});D.current=be;const Ze=await navigator.mediaDevices.getUserMedia({audio:!0});$.current=Ze;const lt=be.createMediaStreamSource(Ze);P.current=lt;const Wt=be.createScriptProcessor(4096,1,1);M.current=Wt;const Rt=eA.live.connect({model:"gemini-2.5-flash-native-audio-preview-09-2025",config:{responseModalities:[sf.AUDIO],inputAudioTranscription:{}},callbacks:{onopen:()=>console.log("Gemini Live Connected"),onmessage:yn=>{var Tt;if((Tt=yn.serverContent)!=null&&Tt.inputTranscription){const ct=yn.serverContent.inputTranscription.text;if(ct&&Re==="section"){const Et=we;te(Bt=>({...Bt,[Et]:(Bt[Et]||"")+ct}))}}},onclose:()=>{ne===we&&yt()},onerror:()=>yt()}});U.current=Rt,Wt.onaudioprocess=yn=>{const Tt=yn.inputBuffer.getChannelData(0),ct=on(Tt);U.current&&U.current.then(Et=>{Et&&Et.sendRealtimeInput({media:ct})})},lt.connect(Wt),Wt.connect(be.destination)}catch(be){console.error("Failed to start voice input:",be),yt()}};function on(we){const Re=we.length,be=new Int16Array(Re);for(let Ze=0;Ze<Re;Ze++)be[Ze]=we[Ze]*32768;return{data:ZE(new Uint8Array(be.buffer)),mimeType:"audio/pcm;rate=16000"}}C.useEffect(()=>()=>{yt()},[]);const st=we=>{Y(we),Q(!0)},kt=we=>{je&&F(Re=>({...Re,scores:Re.scores.map(be=>be.element===je?{...be,comment:(be.comment?be.comment+" ":"")+we}:be)})),Q(!1),Y(null)};C.useEffect(()=>{const we=Hm.map(Re=>`${Re}:
public/flight-school-app/assets/index-Cu9GSreP.js:`)}return""+s},t})();const DD=({traineesData:n,instructorsData:t,archivedTraineesData:s,archivedInstructorsData:i,events:o,courses:l,archivedCourses:d,scores:u,publishedSchedules:f,syllabusDetails:h,pt051Assessments:m,onSavePT051Assessment:v})=>{const[x,y]=C.useState("all"),[T,E]=C.useState("all-time"),[A,_]=C.useState(""),[R,H]=C.useState(""),[O,W]=C.useState(""),[ne,V]=C.useState("pdf"),[U,D]=C.useState(!1),[$,M]=C.useState([]),[P,ae]=C.useState([]),[Q,je]=C.useState([]),[Y,he]=C.useState([]),[ge,Ne]=C.useState("all"),[$e,se]=C.useState("all"),[F,X]=C.useState(""),[J,te]=C.useState(""),[K,fe]=C.useState(""),[xe,Le]=C.useState(!1),[ye,pe]=C.useState(""),[de,qe]=C.useState(!1),[Ie,Z]=C.useState(!1),[Fe,Xe]=C.useState(!1),[ft,tt]=C.useState(0),[We,Ke]=C.useState(""),[nt,Ct]=C.useState([]),[yt,dn]=C.useState(!1),[on,st]=C.useState([]),[kt,Ge]=C.useState(!1),[ht,Nt]=C.useState(0),[Ht,ze]=C.useState(""),we=B=>{if(!B)return"";const ke=new Date(B),it=String(ke.getDate()).padStart(2,"0"),bt=ke.toLocaleString("en-GB",{month:"short"}),et=String(ke.getFullYear()).slice(-2);return`${it} ${bt} ${et}`},Re=C.useMemo(()=>{const B=Object.values(f).flat();return console.log("📊 Export View - All events from published schedules:",B.length),console.log("📊 Export View - Published schedule dates:",Object.keys(f)),B},[f]),be=C.useMemo(()=>{const B=[...n,...s];return console.log("📊 Export View - All trainees:",B.length),console.log("📊 Export View - ADF303 trainees:",B.filter(ke=>ke.course==="ADF303").length),B},[n,s]),Ze=C.useMemo(()=>[...t,...i],[t,i]),lt=C.useMemo(()=>{const B=l.map(it=>it.name),ke=Object.keys(d);return[...new Set([...B,...ke])]},[l,d]),Wt=C.useMemo(()=>lt.filter(B=>B.toLowerCase().includes(F.toLowerCase())),[lt,F]),Rt=C.useMemo(()=>be.filter(B=>`${B.rank} ${B.name} ${B.course}`.toLowerCase().includes(J.toLowerCase())),[be,J]),yn=C.useMemo(()=>Ze.filter(B=>`${B.rank} ${B.name}`.toLowerCase().includes(K.toLowerCase())),[Ze,K]),Tt=C.useMemo(()=>{let B=[...Re];if(console.log("🔍 FILTER DEBUG - Starting with events:",B.length),console.log("🔍 FILTER DEBUG - timePeriod:",T),console.log("🔍 FILTER DEBUG - singleDate:",A),console.log("🔍 FILTER DEBUG - startDate:",R),console.log("🔍 FILTER DEBUG - endDate:",O),T==="single-date"&&A?(B=B.filter(ke=>ke.date===A),console.log("🔍 FILTER DEBUG - After single-date filter:",B.length)):T==="date-range"&&R&&O&&(B=B.filter(ke=>ke.date>=R&&ke.date<=O),console.log("🔍 FILTER DEBUG - After date-range filter:",B.length)),Y.length>0){console.log("🔍 FILTER DEBUG - selectedEventTypes:",Y),console.log("🔍 FILTER DEBUG - Sample event types from data (first 5):",B.slice(0,5).map(it=>it.type)),console.log("🔍 FILTER DEBUG - Unique event types in data:",[...new Set(B.map(it=>it.type))]);const ke=Y.map(it=>it.toLowerCase());B=B.filter(it=>{const bt=it.type.toLowerCase();return ke.includes(bt)}),console.log("🔍 FILTER DEBUG - After event type filter:",B.length)}if(console.log("🔍 FILTER DEBUG - statusFilter:",ge),console.log("🔍 FILTER DEBUG - Before status filter:",B.length),ge==="dco"?B=B.filter(ke=>{const it=ke.student||ke.pilot;if(!it)return!1;const bt=u.get(it);if(!bt)return!1;const et=bt.find($t=>$t.syllabusId===ke.flightNumber&&$t.date===ke.date);return(et==null?void 0:et.outcome)==="DCO"}):ge==="dnco"?B=B.filter(ke=>{const it=ke.student||ke.pilot;if(!it)return!1;const bt=u.get(it);if(!bt)return!1;const et=bt.find($t=>$t.syllabusId===ke.flightNumber&&$t.date===ke.date);return(et==null?void 0:et.outcome)==="DNCO"}):ge==="pass"?B=B.filter(ke=>{const it=ke.student||ke.pilot;if(!it)return!1;const bt=u.get(it);if(!bt)return!1;const et=bt.find($t=>$t.syllabusId===ke.flightNumber&&$t.date===ke.date);return(et==null?void 0:et.outcome)==="Pass"}):ge==="fail"&&(B=B.filter(ke=>{const it=ke.student||ke.pilot;if(!it)return!1;const bt=u.get(it);if(!bt)return!1;const et=bt.find($t=>$t.syllabusId===ke.flightNumber&&$t.date===ke.date);return(et==null?void 0:et.outcome)==="Fail"})),console.log("🔍 FILTER DEBUG - After all status filters:",B.length),console.log("🔍 FILTER DEBUG - remedialFilter:",$e),$e==="yes"?(B=B.filter(ke=>ke.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=yes filter:",B.length)):$e==="no"&&(B=B.filter(ke=>!ke.isRemedial),console.log("🔍 FILTER DEBUG - After remedial=no filter:",B.length)),$.length>0&&(console.log("📊 Trainee filter - Selected trainees:",$),console.log("📊 Trainee filter - Events before filter:",B.length),B=B.filter(ke=>{const it=ke.student||ke.pilot;return it?$.some(et=>!!(it===et||it.startsWith(et+" –")||it.startsWith(et+" -"))):!1}),console.log("📊 Trainee filter - Events after filter:",B.length)),P.length>0&&(B=B.filter(ke=>ke.instructor&&P.includes(ke.instructor))),Q.length>0){const ke=be.filter(bt=>Q.includes(bt.course)),it=ke.map(bt=>bt.name);console.log("📊 Course filter - Selected courses:",Q),console.log("📊 Course filter - Trainees in selected courses:",ke.length),console.log("📊 Course filter - Trainee names (first 5):",it.slice(0,5)),console.log("📊 Course filter - Events before filter:",B.length),console.log("📊 Course filter - Sample event student names (first 5):",B.slice(0,5).map(bt=>bt.student||bt.pilot)),B=B.filter(bt=>{const et=bt.student||bt.pilot;if(!et)return!1;const $t=it.some(pn=>!!(et===pn||et.startsWith(pn+" –")||et.startsWith(pn+" -")));return $t||console.log("📊 No match for student:",et),$t}),console.log("📊 Course filter - Events after filter:",B.length)}return B},[Re,T,A,R,O,Y,ge,$e,$,P,Q,n]),ct=C.useMemo(()=>{if(Q.length===0)return[];const B=be.filter(et=>Q.includes(et.course));let ke=Re;T==="single-date"&&A?ke=ke.filter(et=>et.date===A):T==="date-range"&&R&&O&&(ke=ke.filter(et=>et.date>=R&&et.date<=O));const it=ke.filter(et=>Q.some($t=>{const pn=et.student||et.pilot;return pn?B.find(ts=>pn===ts.name||pn.startsWith(ts.name+" –")||pn.startsWith(ts.name+" -")):!1}));return[...new Set(it.map(et=>{const $t=et.student||et.pilot;if(!$t)return null;const pn=B.find(kn=>$t===kn.name||$t.startsWith(kn.name+" –")||$t.startsWith(kn.name+" -"));return pn==null?void 0:pn.name}).filter(Boolean))]},[Re,Q,T,A,R,O,be]),Et=C.useMemo(()=>(console.log("📊 filteredData calculation - recordType:",x),console.log("📊 filteredData calculation - filteredEvents:",Tt.length),console.log("📊 filteredData calculation - allTrainees:",be.length),console.log("📊 filteredData calculation - allInstructors:",Ze.length),x==="events"?{events:Tt,trainees:[],staff:[]}:x==="trainees"?(console.log("📊 Returning all trainees:",be.length),{events:Tt,trainees:be,staff:[]}):x==="staff"?(console.log("📊 Returning all staff:",Ze.length),{events:Tt,trainees:[],staff:Ze}):(console.log("📊 Returning all trainees and staff"),{events:Tt,trainees:be,staff:Ze})),[x,Tt,be,Ze]),Bt=C.useMemo(()=>{let B=0;return(x==="all"||x==="trainees")&&(B+=Et.trainees.length),(x==="all"||x==="staff")&&(B+=Et.staff.length),(x==="all"||x==="events")&&(B+=Et.events.length),B},[x,Et]),Kt=C.useMemo(()=>{const ke=Bt*(ne==="pdf"?5e3:ne==="excel"?2e3:500);return ke<1024?`${ke} B`:ke<1024*1024?`${(ke/1024).toFixed(1)} KB`:`${(ke/(1024*1024)).toFixed(1)} MB`},[Bt,ne]),Mt=Bt>1e3,Ve=()=>T==="all-time"?"All time":T==="single-date"&&A?we(A):T==="date-range"&&R&&O?`${we(R)} to ${we(O)}`:"Not specified",qt=()=>x==="all"?"All records (Trainees, Staff, Events)":x==="trainees"?"Trainee records":x==="staff"?"Staff records":"Event records",Mn=async()=>{console.log("🚀 Starting export...",{recordType:x,timePeriod:T,outputFormat:ne,recordCount:Bt,data:Et});const it=`training_records_${new Date().toISOString().split("T")[0]}.${ne==="excel"?"xlsx":ne}`;try{console.log("📄 Export format:",ne),Xe(!0),tt(0),Ke("Preparing export..."),ne==="csv"?(console.log("📊 Exporting CSV..."),console.log("📊 Record count:",Bt),Ke("Generating CSV file..."),jn(it),console.log("✅ CSV export completed")):ne==="excel"?(console.log("📊 Exporting Excel..."),console.log("📊 Record count:",Bt),Ke("Generating Excel file..."),Ee(it),console.log("✅ Excel export completed")):ne==="pdf"&&(console.log("📄 Exporting PDF..."),console.log("📄 Record count:",Bt),console.log("📄 Events to export:",Et.events.length),Ke(`Generating PDF (${Et.events.length} records)...`),await He(it),console.log("✅ PDF export completed")),Xe(!1),console.log("✅ Showing success message"),qe(!0),setTimeout(()=>qe(!1),5e3)}catch(bt){console.error("❌ Export error:",bt),console.error("Error stack:",bt instanceof Error?bt.stack:"No stack trace"),Xe(!1),Z(!0),setTimeout(()=>Z(!1),5e3)}},jn=B=>{let ke="";(x==="all"||x==="events")&&(ke+=`EVENTS
public/flight-school-app/assets/index-CmDcbMTV.js:    `;x.document.write(y),x.document.close(),x.print()},v=()=>{const x=M5(n),y=new Blob([x],{type:"text/csv"}),T=window.URL.createObjectURL(y),E=document.createElement("a");E.href=T,E.download=`audit-log-${page}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(T)};return _5.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999999] flex items-center justify-center",style:{zIndex:999999},onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col max-h-[90vh] relative",style:{zIndex:999999},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Page: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Export to CSV",children:"Export CSV"}),e.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors",title:"Print Audit Log",children:"Print"}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No audit logs found"}),e.jsx("p",{className:"text-sm mt-2",children:"Activity on this page will be recorded here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("timestamp"),children:e.jsxs("div",{className:"flex items-center",children:["Date/Time",o==="timestamp"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("user"),children:e.jsxs("div",{className:"flex items-center",children:["User",o==="user"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-600",onClick:()=>f("action"),children:e.jsxs("div",{className:"flex items-center",children:["Action",o==="action"&&e.jsx("span",{className:"ml-1",children:d==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Changes"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:h.map(x=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:[e.jsx("div",{children:x.timestamp.toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:x.timestamp.toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-300",children:x.user}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x.action==="View"?"bg-blue-900/50 text-blue-300":x.action==="Edit"?"bg-yellow-900/50 text-yellow-300":x.action==="Add"?"bg-green-900/50 text-green-300":x.action==="Delete"?"bg-red-900/50 text-red-300":x.action==="Archive"?"bg-purple-900/50 text-purple-300":x.action==="Restore"?"bg-cyan-900/50 text-cyan-300":"bg-gray-900/50 text-gray-300"}`,children:x.action})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:x.description}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:x.changes||"-"})]},x.id))})]})})}),e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-900 rounded-b-lg flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Total entries: ",e.jsx("span",{className:"font-medium text-white",children:h.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",new Date().toLocaleString()]})]})]})}),document.body)},Qa=({pageName:n,className:t=""})=>{const[s,i]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(!0),className:`inline-flex items-center px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-200 bg-gray-700/50 hover:bg-gray-600/50 rounded border border-gray-600 hover:border-gray-500 transition-colors ${t}`,title:"View Audit Log",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Audit"]}),s&&e.jsx(F5,{pageName:n,onClose:()=>i(!1)})]})},P5=()=>({id:_r(),name:"New Primitive Currency",description:"",type:"primitive",isVisible:!0,validityDays:365,eventCodes:[],requiredCount:1,expiryRule:"LAST_EVENT_PLUS_PERIOD"}),R5=()=>({id:_r(),name:"New Composite Currency",description:"",type:"composite",isVisible:!0,expiryCalculation:"EARLIEST_CHILD",logicTree:{operator:"AND",children:[]}}),U5=({onBack:n,masterCurrencies:t,currencyRequirements:s,onSave:i,onDelete:o})=>{const[l,d]=C.useState([]),[u,f]=C.useState(null),[h,m]=C.useState(""),[v,x]=C.useState(!1);C.useEffect(()=>{const H=[...t,...s];d(H),u&&!H.some(O=>O.id===u)&&f(null)},[t,s,u]);const y=C.useMemo(()=>l.filter(H=>H.name.toLowerCase().includes(h.toLowerCase())).sort((H,O)=>H.name.localeCompare(O.name)),[l,h]),T=C.useMemo(()=>l.find(H=>H.id===u)||null,[u,l]),E=H=>{d(O=>O.map(W=>W.id===H.id?H:W)),x(!0)},A=H=>{const O=H==="primitive"?P5():R5();d(W=>[...W,O]),f(O.id),x(!0)},_=()=>{if(!u)return;if(l.some(O=>{if(O.type==="composite"){const W=ne=>ne.children.some(V=>typeof V=="string"?V===u:W(V));return W(O.logicTree)}return!1})){alert("This currency cannot be deleted because it is used as a dependency in another composite currency.");return}window.confirm(`Are you sure you want to delete "${T==null?void 0:T.name}"? This action cannot be undone.`)&&(o(u),f(null))},R=()=>{i(l),x(!1)};return e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 overflow-hidden h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Currency Builder"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Define primitive and composite currency rules."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[v&&e.jsxs("button",{onClick:R,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold shadow-md flex items-center space-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6a1 1 0 10-2 0v5.586L7.707 10.293z"}),e.jsx("path",{d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"})]}),e.jsx("span",{children:"Save Changes"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold shadow-md",children:"← Back to Settings"}),e.jsx(Qa,{pageName:"Currency Builder"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search currencies...",value:h,onChange:H=>m(H.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500"}),e.jsxs("div",{className:"flex mt-2 space-x-2",children:[e.jsx("button",{onClick:()=>A("primitive"),className:"flex-1 text-center py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-semibold",children:"+ Primitive"}),e.jsx("button",{onClick:()=>A("composite"),className:"flex-1 text-center py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs font-semibold",children:"+ Composite"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.map(H=>e.jsxs("div",{draggable:!0,onDragStart:O=>{O.dataTransfer.setData("application/currency-id",H.id),O.dataTransfer.effectAllowed="copy"},onClick:()=>f(H.id),className:`p-3 cursor-pointer border-l-4 ${u===H.id?"bg-sky-700 border-sky-400":"border-transparent hover:bg-gray-700/50"}`,children:[e.jsx("p",{className:`font-semibold ${H.type==="composite"?"text-purple-300":"text-green-300"}`,children:H.name}),e.jsx("p",{className:"text-xs text-gray-400",children:H.description||"No description"})]},H.id))})]}),e.jsx("div",{className:"w-2/3 overflow-y-auto p-6",children:T?e.jsxs("div",{className:"space-y-6",children:[T.type==="primitive"?e.jsx(B5,{currency:T,onUpdate:E}):e.jsx(O5,{currency:T,onUpdate:E,allCurrencies:l}),e.jsx($5,{currencyId:T.id,allCurrencies:l}),e.jsx("div",{className:"pt-6 border-t border-gray-700",children:e.jsx("button",{onClick:_,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-semibold",children:"Delete Currency"})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 italic",children:"Select a currency to edit, or add a new one."})})]})]})},B5=({currency:n,onUpdate:t})=>{const s=(i,o)=>{t({...n,[i]:o})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400",children:"Edit Primitive Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:i=>s("name",i)}),e.jsx(ad,{label:"Description",value:n.description,onChange:i=>s("description",i)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:i=>s("isVisible",i)}),e.jsx(ad,{label:"Validity (Days)",type:"number",value:n.validityDays,onChange:i=>s("validityDays",Number(i))}),e.jsx(ad,{label:"Required Count",type:"number",value:n.requiredCount,onChange:i=>s("requiredCount",Number(i))}),e.jsxs(Ev,{label:"Expiry Rule",value:n.expiryRule,onChange:i=>s("expiryRule",i),children:[e.jsx("option",{value:"LAST_EVENT_PLUS_PERIOD",children:"Last Event + Period"}),e.jsx("option",{value:"ROLLING_WINDOW",children:"Rolling Window"})]}),e.jsx(ad,{label:"Event Codes (comma-separated)",value:n.eventCodes.join(", "),onChange:i=>s("eventCodes",i.split(",").map(o=>o.trim()).filter(Boolean))})]})},O5=({currency:n,onUpdate:t,allCurrencies:s})=>{const i=(l,d)=>{t({...n,[l]:d})},o=l=>{i("logicTree",l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-400",children:"Edit Composite Currency"}),e.jsx(ad,{label:"Name",value:n.name,onChange:l=>i("name",l)}),e.jsx(ad,{label:"Description",value:n.description,onChange:l=>i("description",l)}),e.jsx(jv,{label:"Visible in Main List",checked:n.isVisible,onChange:l=>i("isVisible",l)}),e.jsxs(Ev,{label:"Expiry Calculation",value:n.expiryCalculation,onChange:l=>i("expiryCalculation",l),children:[e.jsx("option",{value:"EARLIEST_CHILD",children:"Use Earliest Expiry"}),e.jsx("option",{value:"LATEST_CHILD",children:"Use Latest Expiry"})]}),e.jsx(Tv,{node:n.logicTree,path:[],onUpdate:o,allCurrencies:s})]})},Tv=({node:n,path:t,onUpdate:s,allCurrencies:i})=>{const o=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},l=v=>{v.preventDefault();const x=v.dataTransfer.getData("application/currency-id");if(x&&!n.children.includes(x)){const y=[...n.children,x];s({...n,children:y},t)}},d=(v,x)=>{const y=[...n.children];y[x]=v,s({...n,children:y},t)},u=v=>{const x=n.children.filter((y,T)=>T!==v);s({...n,children:x},t)},f=()=>{const v=[...n.children,"new_condition_placeholder"];s({...n,children:v},t)},h=()=>{const v={operator:"AND",children:[]},x=[...n.children,v];s({...n,children:x},t)},m=v=>{s({...n,operator:v},t)};return e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30 space-y-3",onDragOver:o,onDrop:l,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m("AND"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="AND"?"bg-sky-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ALL of these (AND)"}),e.jsx("button",{onClick:()=>m("OR"),className:`px-3 py-1 text-xs font-bold rounded ${n.operator==="OR"?"bg-purple-600 text-white":"bg-gray-600 text-gray-300"}`,children:"ANY of these (OR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Condition"}),e.jsx("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 rounded",children:"+ Group"})]})]}),e.jsx("div",{className:"space-y-2 pl-4 border-l-2 border-gray-500",children:n.children.length>0?n.children.map((v,x)=>{var y;return e.jsxs("div",{className:"flex items-center group",children:[typeof v=="string"?e.jsx("div",{className:"flex-1 p-2 bg-gray-800 rounded text-sm text-gray-300",children:((y=i.find(T=>T.id===v))==null?void 0:y.name)||"Unlinked Condition"}):e.jsx(Tv,{node:v,path:[...t,"children",x],onUpdate:(T,E)=>d(T,x),allCurrencies:i}),e.jsx("button",{onClick:()=>u(x),className:"ml-2 p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},x)}):e.jsx("div",{className:"text-xs text-gray-500 italic p-4 text-center",children:"Drag currencies here or add conditions/groups."})})]})},$5=({currencyId:n,allCurrencies:t})=>{const s=C.useMemo(()=>{const i=[],o=t.filter(l=>l.type==="composite");for(const l of o){const d=u=>u.children.some(f=>typeof f=="string"?f===n:d(f));d(l.logicTree)&&i.push(l.name)}return i},[n,t]);return s.length===0?null:e.jsxs("div",{className:"p-4 border border-gray-600 rounded-lg bg-gray-700/30",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Used In:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(i=>e.jsx("span",{className:"px-2 py-1 bg-purple-800 text-purple-200 text-xs font-medium rounded-full",children:i},i))})]})},ad=({label:n,value:t,onChange:s,type:i="text"})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("input",{type:i,value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500"})]}),jv=({label:n,checked:t,onChange:s})=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>s(i.target.checked),className:"h-4 w-4 bg-gray-600 border-gray-500 rounded accent-sky-500"}),e.jsx("span",{className:"text-white",children:n})]}),Ev=({label:n,value:t,onChange:s,children:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{value:t,onChange:o=>s(o.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500",children:i})]}),H5=()=>{Pn("Program Schedule","Add","Added new flight event BGF5 for PLTOFF Smith","Event: BGF5, Time: 0800, Duration: 1.2hrs, Instructor: SQNLDR Jones"),Pn("Program Schedule","Edit","Modified flight event BGF3 start time","Changed start time from 0900 to 1000"),Pn("Program Schedule","Delete","Removed ground event for Course 301","Event: Ground School, Time: 1400"),Pn("Next Day Build","View","Viewed Next Day Build schedule for 2024-12-30",null),Pn("Next Day Build","Add","Added SCT event for FLTLT Brown","Event: SCT GF, Time: 0730, Type: Solo"),Pn("Priorities","Edit","Updated course priority order","Moved Course 302 above Course 301"),Pn("Priorities","Edit","Changed flying window times","Start: 0700 → 0730, End: 1700 → 1730"),console.log("✅ Test audit logs seeded successfully")},od=new Map,jo=(n,t,s)=>{const i=od.get(n);if(i){clearTimeout(i.timer);const o=t,l={...o,originalValues:i.originalParams.originalValues||o.originalValues,newValues:o.newValues},d=setTimeout(()=>{let u=t.changes;if(l.originalValues&&l.newValues){const f=[];if(l.originalValues.startTime!==void 0&&l.newValues.startTime!==void 0){const h=m=>{const v=Math.floor(m),x=Math.round((m-v)*60);return`${v.toString().padStart(2,"0")}${x.toString().padStart(2,"0")}`};f.push(`Start time: ${h(l.originalValues.startTime)} → ${h(l.newValues.startTime)}`)}l.originalValues.resourceId!==void 0&&l.newValues.resourceId!==void 0&&f.push(`Resource: ${l.originalValues.resourceId} → ${l.newValues.resourceId}`),u=f.join(", ")}s(l.page,l.action,l.description,u),od.delete(n)},3e3);od.set(n,{timer:d,originalParams:i.originalParams,latestParams:l})}else{const o=setTimeout(()=>{s(t.page,t.action,t.description,t.changes),od.delete(n)},3e3),l=t;od.set(n,{timer:o,originalParams:l,latestParams:l})}},og=()=>{od.forEach(({timer:n})=>{clearTimeout(n)}),od.clear()},q5="modulepreload",G5=function(n,t){return new URL(n,t).href},Jx={},oh=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=d(s.map(m=>{if(m=G5(m,i),m in Jx)return;Jx[m]=!0;const v=m.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(!!i)for(let E=u.length-1;E>=0;E--){const A=u[E];if(A.href===m&&(!v||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":q5,v||(T.as="script"),T.crossOrigin="",T.href=m,h&&T.setAttribute("nonce",h),document.head.appendChild(T),v)return new Promise((E,A)=>{T.addEventListener("load",E),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Av=({type:n,title:t,message:s,onConfirm:i,onCancel:o,confirmText:l="OK",cancelText:d="Cancel",variant:u="info"})=>{const h=(()=>{switch(u){case"error":return{borderColor:"border-red-500/50",headerBg:"bg-red-900/20",titleColor:"text-red-400",iconColor:"text-red-400",confirmBg:"bg-red-600 hover:bg-red-700"};case"warning":return{borderColor:"border-amber-500/50",headerBg:"bg-amber-900/20",titleColor:"text-amber-400",iconColor:"text-amber-400",confirmBg:"bg-amber-600 hover:bg-amber-700"};case"success":return{borderColor:"border-green-500/50",headerBg:"bg-green-900/20",titleColor:"text-green-400",iconColor:"text-green-400",confirmBg:"bg-green-600 hover:bg-green-700"};default:return{borderColor:"border-sky-500/50",headerBg:"bg-sky-900/20",titleColor:"text-sky-400",iconColor:"text-sky-400",confirmBg:"bg-sky-600 hover:bg-sky-700"}}})(),m=()=>{switch(u){case"error":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"success":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},v=()=>{i==null||i()},x=()=>{o==null||o()};return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center animate-fade-in",onClick:x,children:e.jsxs("div",{className:`bg-gray-800 rounded-lg shadow-xl w-full max-w-md border ${h.borderColor}`,onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b border-gray-700 ${h.headerBg} flex items-center space-x-3`,children:[e.jsx("span",{className:h.iconColor,children:m()}),e.jsx("h2",{className:`text-xl font-bold ${h.titleColor}`,children:t})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:s})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-700 flex justify-end space-x-3",children:[n==="confirm"&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:d}),e.jsx("button",{onClick:v,className:`px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold ${h.confirmBg}`,children:l})]})]})})};let Gu=null;const Xx=()=>(Gu||(Gu=document.createElement("div"),Gu.id="dark-modal-root",document.body.appendChild(Gu)),Gu),nf=(n,t="Confirm Action",s="info")=>new Promise(i=>{const o=()=>{const[d,u]=C.useState(!0),f=()=>{u(!1),setTimeout(()=>i(!0),300)},h=()=>{u(!1),setTimeout(()=>i(!1),300)};return d?wv.createPortal(e.jsx(Av,{type:"confirm",title:t,message:n,onConfirm:f,onCancel:h,variant:s}),Xx()):null},l=Ua.createElement(o);oh(async()=>{const{createRoot:d}=await Promise.resolve().then(()=>N5);return{createRoot:d}},void 0,import.meta.url).then(({createRoot:d})=>{d(Xx()).render(l)})}),z5=["bg-sky-400/50","bg-purple-400/50","bg-yellow-400/50","bg-pink-400/50","bg-teal-400/50","bg-indigo-400/50","bg-cyan-400/50","bg-fuchsia-400/50","bg-blue-400/50"],V5=["ADF","FIC","WSO","IFIC","OFI","Pilot Conversion"],W5=["","GS"],Hd=({label:n,value:t,onChange:s,children:i,id:o})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-400",children:n}),e.jsx("select",{id:o,value:t,onChange:s,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i})]}),kv=({onClose:n,onSave:t,existingCourses:s})=>{const[i,o]=C.useState("ADF"),[l,d]=C.useState(""),[u,f]=C.useState(""),[h,m]=C.useState(""),[v,x]=C.useState(""),[y,T]=C.useState(""),[E,A]=C.useState(0),[_,R]=C.useState(0),[H,O]=C.useState(0),W=C.useMemo(()=>{const $=new Set(Object.values(s));return z5.find(M=>!$.has(M))||"bg-gray-400/50"},[s]),ne=C.useMemo(()=>E+_+H,[E,_,H]),V=C.useMemo(()=>{const $=[],M=Object.keys(s).filter(P=>P.startsWith("CSE ")||P.startsWith("ADF")).map(P=>P.replace(/^(CSE|ADF)\s*/i,""));for(let P=290;P<=500;P++)M.includes(String(P))||$.push(P);return $},[s]),U=C.useMemo(()=>Array.from({length:41},($,M)=>M),[]);C.useEffect(()=>{i==="ADF"&&V.length>0?d(String(V[0])):d("")},[i,V]);const D=()=>{let $;if(i==="ADF"){if(!l){alert("Please select an ADF course number.");return}$=`ADF${l}${h}`}else{const M=u.trim();if(!M){alert("Please enter a course number.");return}$=`${i} ${M}${h}`}if(Object.keys(s).includes($)){alert(`Course "${$}" already exists.`);return}if(!v||!y){alert("Please fill in all required date fields.");return}if(new Date(y)<=new Date(v)){alert("Graduation date must be after the start date.");return}t({number:$,color:W,startDate:v,gradDate:y,raafStart:E,navyStart:_,armyStart:H})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700",onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-sky-400",children:"Add New Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Hd,{label:"Course Type",id:"course-type",value:i,onChange:$=>o($.target.value),children:V5.map($=>e.jsx("option",{value:$,children:$},$))}),i==="ADF"?e.jsx(Hd,{label:"Course Number",id:"course-number",value:l,onChange:$=>d($.target.value),children:V.length>0?V.map($=>e.jsx("option",{value:$,children:$},$)):e.jsx("option",{disabled:!0,children:"No courses available"})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-course-number",className:"block text-sm font-medium text-gray-400",children:"Course Number"}),e.jsx("input",{type:"text",id:"manual-course-number",value:u,onChange:$=>f($.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",placeholder:"e.g., 210"})]}),e.jsx(Hd,{label:"Suffix",id:"suffix",value:h,onChange:$=>m($.target.value),children:W5.map($=>e.jsx("option",{value:$,children:$||"None"},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Allocated Colour"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 p-2 bg-gray-700/50 rounded-md h-[38px]",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${W}`}),e.jsx("span",{className:"text-white font-mono text-sm",children:W})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-400",children:"Start Date"}),e.jsx("input",{type:"date",id:"start-date",value:v,onChange:$=>x($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"grad-date",className:"block text-sm font-medium text-gray-400",children:"Graduation Date"}),e.jsx("input",{type:"date",id:"grad-date",value:y,onChange:$=>T($.target.value),style:{colorScheme:"dark"},className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm"})]})]}),e.jsxs("fieldset",{className:"p-4 border border-gray-600 rounded-lg",children:[e.jsx("legend",{className:"px-2 text-sm font-semibold text-gray-300",children:"Initial Student Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsx(Hd,{label:"RAAF",id:"raaf-start",value:E,onChange:$=>A(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Navy",id:"navy-start",value:_,onChange:$=>R(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsx(Hd,{label:"Army",id:"army-start",value:H,onChange:$=>O(parseInt($.target.value)),children:U.map($=>e.jsx("option",{value:$,children:$},$))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center justify-center font-semibold",children:ne})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Total Remaining on Course"}),e.jsx("p",{className:"mt-1 p-2 bg-gray-700/50 rounded-md text-white h-[38px] flex items-center font-semibold",children:ne}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This will be updated from Trainee profiles once they are assigned to this course."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Save Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Y5=({onClose:n,onArchive:t,activeCourses:s})=>{const i=C.useMemo(()=>Object.keys(s),[s]),[o,l]=C.useState(i[0]||""),d=()=>{o&&t(o)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center animate-fade-in",onClick:n,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"Archive a Course"}),e.jsx("button",{onClick:n,className:"text-white hover:text-gray-300","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"Which course would you like to move to the archive?"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"course-to-archive",className:"block text-sm font-medium text-gray-400",children:"Active Courses"}),e.jsx("select",{id:"course-to-archive",value:o,onChange:u=>l(u.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm",children:i.length>0?i.map(u=>e.jsx("option",{value:u,children:u},u)):e.jsx("option",{disabled:!0,children:"No active courses"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Archived courses are removed from the main list but are not deleted from the system."})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end space-x-3",children:[e.jsx("button",{onClick:d,disabled:!o,className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Archive Course"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm",children:"Cancel"})]})]})})},Kx=n=>n.startsWith("Course ")?n.replace("Course ","ADF"):n.replace(/^CSE\s*/i,"ADF").replace(" ",""),J5=({activeView:n,onNavigate:t,courseColors:s,onAddCourse:i,onArchiveCourse:o,onNextDayBuildClick:l,onBuildDfpClick:d,isSupervisor:u,onPublish:f,currentUserName:h,currentUserRank:m,instructorsList:v,onUserChange:x})=>{const[y,T]=C.useState(!1),[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState(""),[W,ne]=C.useState(null),[V,U]=C.useState(!1),[D,$]=C.useState(""),[M,P]=C.useState(""),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(!1),fe=C.useRef(null),[ge,Ne]=C.useState(!1),[Oe,se]=C.useState(!1),F=C.useRef(null),X=["NextDayBuild","Priorities","ProgramData","BuildAnalysis","NextDayInstructorSchedule","NextDayTraineeSchedule"].includes(n),[ee,K]=C.useState(X);C.useEffect(()=>{const Re=be=>{fe.current&&!fe.current.contains(be.target)&&(Y(!1),Q(!1)),F.current&&!F.current.contains(be.target)&&(se(!1),Ne(!1))};return document.addEventListener("mousedown",Re),()=>{document.removeEventListener("mousedown",Re)}},[]),C.useEffect(()=>{X&&K(!0)},[X]);const ue=()=>{K(Re=>!Re)},xe=[{id:"Syllabus",label:"Syllabus"},{id:"CourseProgress",label:"Course Progress"},{id:"TrainingRecords",label:"Training Records"}],Le=Re=>{i(Re),T(!1)},ye=Re=>{o(Re),A(!1)},pe=Re=>{if(Re.name===h){R(!1);return}ne(Re),U(!0),$(""),P("")},ce=()=>{W&&D===W.pin?(x(W.name),U(!1),R(!1),ne(null),$(""),P("")):P("Invalid PIN")},_e=v.filter(Re=>Re.name.toLowerCase().includes(H.toLowerCase())||Re.rank.toLowerCase().includes(H.toLowerCase())||Re.unit&&Re.unit.toLowerCase().includes(H.toLowerCase())).reduce((Re,be)=>{const Ze=be.unit||"Unassigned";return Re[Ze]||(Re[Ze]=[]),Re[Ze].push(be),Re},{}),Z=["1FTS","CFS","2FTS"],Fe=Object.keys(_e).sort((Re,be)=>{const Ze=Z.indexOf(Re),ot=Z.indexOf(be);return Ze!==-1&&ot!==-1?Ze-ot:Ze!==-1?-1:ot!==-1?1:Re.localeCompare(be)}),Xe=Object.entries(s),ft=5,tt=Xe.slice(0,ft),We=Xe.slice(ft,ft*2),nt=["MyDashboard","SupervisorDashboard"].includes(n),Ct=["Instructors","InstructorSchedule"].includes(n),xt=()=>Q(!0),dn=()=>{Te||Q(!1)},on=()=>{const Re=!Te;Y(Re),Re&&Q(!0)},st=Re=>{t(Re),Y(!1),Q(!1)},kt=ae||Te,Ge=["CourseRoster","TraineeSchedule"].includes(n),ht=()=>Ne(!0),vt=()=>{Oe||Ne(!1)},Ht=()=>{const Re=!Oe;se(Re),Re&&Ne(!0)},ze=Re=>{t(Re),se(!1),Ne(!1)},we=ge||Oe;return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-[12.71rem] bg-gray-900 flex-shrink-0 flex flex-col border-r border-gray-700",children:[e.jsx("div",{className:"h-16 flex items-center justify-center flex-shrink-0 px-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex w-full space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>t("MyDashboard"),className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="MyDashboard"?"active":""}`,children:e.jsx("span",{className:"leading-tight",children:"My Dashboard"})}),e.jsx("button",{onClick:()=>u&&t("SupervisorDashboard"),disabled:!u,title:u?"View Supervisor Dashboard":"Access denied: Requires Flying Supervisor role.",className:`w-1/2 flex items-center justify-center text-center px-1 py-1 text-sm font-semibold rounded-md btn-aluminium-brushed ${n==="SupervisorDashboard"?"active":""} ${u?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:"leading-tight",children:"Supervisor Dashboard"})})]})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-1",children:[e.jsx("button",{onClick:()=>t("Program Schedule"),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-green-brushed rounded-md ${n==="Program Schedule"&&!nt?"active":""}`,children:e.jsx("span",{children:"DFP"})}),e.jsxs("div",{ref:fe,onMouseLeave:dn,children:[e.jsxs("button",{onClick:on,onMouseEnter:xt,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ct||kt)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Staff"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${kt?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${kt?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>st("Instructors"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="Instructors"?"active":""}`,children:"Staff Profile"}),e.jsx("button",{onClick:()=>st("InstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="InstructorSchedule"?"active":""}`,children:"Staff Schedule"})]})})]}),e.jsxs("div",{ref:F,onMouseLeave:vt,children:[e.jsxs("button",{onClick:Ht,onMouseEnter:ht,className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center justify-between btn-aluminium-brushed rounded-md ${(Ge||we)&&!nt?"active":""}`,children:[e.jsx("span",{children:"Trainee"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${we?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${we?"max-h-40":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>ze("CourseRoster"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="CourseRoster"?"active":""}`,children:"Trainee Profile"}),e.jsx("button",{onClick:()=>ze("TraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-medium btn-aluminium-brushed rounded-md ${n==="TraineeSchedule"?"active":""}`,children:"Trainee Schedule"})]})})]}),xe.map(Re=>e.jsx("button",{onClick:()=>t(Re.id),className:`w-full text-left px-4 py-1 text-sm font-medium flex items-center space-x-3 btn-aluminium-brushed rounded-md ${n===Re.id&&!nt?"active":""}`,children:e.jsx("span",{className:Re.id==="TrainingRecords"?"text-xs":"",children:Re.label})},Re.id)),e.jsxs("div",{className:"pt-12",children:[e.jsxs("button",{onClick:ue,className:`w-full text-left px-4 py-1 text-sm font-semibold flex items-center justify-between btn-aluminium-brushed rounded-md ${X?"active":""}`,children:[e.jsx("span",{children:"Next Day Build"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transform transition-transform duration-200 ${ee?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("div",{className:`overflow-hidden transition-[max-height] duration-300 ease-in-out ${ee?"max-h-96":"max-h-0"}`,children:e.jsxs("div",{className:"pl-4 pr-2 pt-1 space-y-1 bg-black/10",children:[e.jsx("button",{onClick:()=>t("NextDayBuild"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayBuild"?"active":""}`,children:e.jsx("span",{children:"Program Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayInstructorSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayInstructorSchedule"?"active":""}`,children:e.jsx("span",{children:"Staff Schedule"})}),e.jsx("button",{onClick:()=>t("NextDayTraineeSchedule"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="NextDayTraineeSchedule"?"active":""}`,children:e.jsx("span",{children:"Trainee Schedule"})}),e.jsx("button",{onClick:()=>t("Priorities"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Priorities"?"active":""}`,children:e.jsx("span",{children:"Priorities"})}),e.jsx("button",{onClick:()=>t("ProgramData"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="ProgramData"?"active":""}`,children:e.jsx("span",{children:"Program Data"})}),e.jsx("button",{onClick:()=>t("BuildAnalysis"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="BuildAnalysis"?"active":""}`,children:e.jsx("span",{children:"Build Analysis"})}),e.jsx("button",{onClick:d,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-orange-brushed rounded-md",children:e.jsx("span",{children:"NEO - Build"})}),e.jsx("button",{onClick:f,className:"w-full text-left px-4 py-1 text-sm font-semibold btn-green-brushed rounded-md",children:e.jsx("span",{children:"Publish"})})]})})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700",children:[e.jsx("div",{className:"px-2 py-2 space-y-2",children:e.jsx("div",{children:e.jsx("button",{onClick:()=>t("Settings"),className:`w-full text-left px-4 py-1 text-sm font-semibold btn-aluminium-brushed rounded-md ${n==="Settings"?"active":""}`,children:e.jsx("span",{children:"Settings"})},"Settings")})}),e.jsxs("div",{className:"border-t border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"px-4 pt-4 mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Courses"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Add course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>A(!0),className:"p-1 rounded bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"Archive course",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"px-4 pb-2 flex space-x-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:tt.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))}),We.length>0&&e.jsx("div",{className:"flex-1 min-w-0",children:We.map(([Re,be])=>e.jsxs("div",{className:"py-1 flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${be} mr-3 flex-shrink-0`}),e.jsx("span",{className:"text-xs text-gray-300 truncate",children:Kx(Re)})]},Re))})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!_),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-300 transition-colors",children:[e.jsxs("span",{className:"truncate",children:[m," ",h]}),e.jsx("svg",{className:`h-3 w-3 transform transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-700",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:H,onChange:Re=>O(Re.target.value),className:"w-full pl-8 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:ring-1 focus:ring-sky-500"}),e.jsx("svg",{className:"absolute left-5 top-5 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:Fe.map(Re=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-gray-900 border-b border-gray-700 sticky top-0",children:e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:Re})}),_e[Re].map(be=>e.jsxs("button",{onClick:()=>pe(be),className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors flex items-center justify-between ${be.name===h?"bg-gray-700 text-sky-400":"text-gray-300"}`,children:[e.jsxs("span",{children:[be.rank," ",be.name]}),be.name===h&&e.jsx("svg",{className:"h-4 w-4 text-sky-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},be.name))]},Re))}),e.jsx("div",{className:"p-2 border-t border-gray-700",children:e.jsx("button",{onClick:()=>R(!1),className:"w-full px-3 py-1 text-sm text-gray-400 hover:text-gray-300",children:"Cancel"})})]})]}),e.jsx("span",{children:"v1.0.0"})]})]})]}),y&&e.jsx(kv,{onClose:()=>T(!1),onSave:Le,existingCourses:s}),E&&e.jsx(Y5,{onClose:()=>A(!1),onArchive:ye,activeCourses:s}),V&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[90] flex items-center justify-center",onClick:()=>U(!1),children:e.jsx("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-md border border-gray-700",onClick:Re=>Re.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Confirm User Switch"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Switch from ",e.jsxs("span",{className:"font-semibold text-sky-400",children:[m," ",h]})," to:"]}),e.jsxs("p",{className:"font-semibold text-white text-lg",children:[W.rank," ",W.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Enter PIN for ",W.name,":"]}),e.jsx("input",{type:"password",value:D,onChange:Re=>$(Re.target.value),onKeyPress:Re=>Re.key==="Enter"&&ce(),placeholder:"Enter PIN",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:M})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{U(!1),ne(null),$(""),P("")},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700",children:"Switch User"})]})]})})})]})},X5=({onAddTile:n,onAddGroundEvent:t,showValidation:s,setShowValidation:i,locations:o,activeLocation:l,onLocationChange:d,isMagnifierEnabled:u,setIsMagnifierEnabled:f,isMultiSelectMode:h,setIsMultiSelectMode:m,isOracleMode:v,onToggleOracleMode:x,showAircraftAvailability:y,onToggleAircraftAvailability:T,showDepartureDensityOverlay:E,onToggleDepartureDensityOverlay:A})=>e.jsx(e.Fragment,{children:e.jsxs("header",{className:"bg-gray-800 h-16 flex-shrink-0 flex items-center justify-between px-4 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx("select",{value:l,onChange:_=>d(_.target.value),className:"bg-gray-700 border-gray-600 rounded-md text-white py-1 px-2 text-sm focus:ring-sky-500 focus:border-sky-500 focus:outline-none w-full text-center",children:o.map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(Qa,{pageName:"Program Schedule",className:""})}),e.jsx("button",{onClick:()=>m(!h),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${h?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle multi-select mode",children:e.jsx("img",{src:"./multi-select-icon.png",alt:"Multi-select mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:()=>f(!u),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${u?"bg-sky-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,"aria-label":"Toggle Magnifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8zm6-3a1 1 0 011 1v2h2a1 1 0 110 2H9v2a1 1 0 11-2 0V9H5a1 1 0 110-2h2V6a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>i(!s),className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${s?"bg-orange-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"Toggle validation",children:e.jsx("img",{src:"./warning-icon.png",alt:"Validation mode",style:{height:"20px",width:"20px",display:"block"}})}),e.jsx("button",{onClick:A,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${E?"bg-purple-600 text-white":"bg-gray-600 text-white hover:bg-gray-500"}`,title:"When enabled, shows a translucent overlay in Validate mode that counts flight start times within a 1-hour window (30 minutes before/after mouse position).",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})}),T&&e.jsx("button",{onClick:T,className:`p-1.5 rounded-md transition-colors text-xs font-semibold shadow-sm ${y?"bg-pink-600":"bg-gray-600 hover:bg-gray-500"}`,title:"Toggle aircraft availability",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 2 L12 8 M12 8 L4 10 L4 12 L12 10 M12 8 L20 10 L20 12 L12 10 M12 10 L12 18 M10 18 L10 20 L14 20 L14 18",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:x,className:`w-36 text-center py-1 rounded-md text-sm font-semibold transition-all duration-200 shadow-lg flex items-center justify-center space-x-2 ${v?"btn-gold-brushed active animate-pulse":"btn-gold-brushed"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})}),e.jsx("span",{children:"Oracle"})]}),e.jsx("button",{onClick:t,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Ground Event"}),e.jsx("button",{onClick:n,className:"w-36 text-center py-1 rounded-md text-sm font-semibold btn-aluminium-brushed",children:"Add Tile"})]})})]})}),Yf=n=>{const t=Math.floor(n),s=Math.round(n%1*60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},K5=(n,t)=>{if(n.type!=="flight")return"";const s=new Date().toISOString().split("T")[0];if(n.date!==s)return"";const i=!!(n.authoSignedBy&&n.captainSignedBy),o=!!(n.authoSignedBy||n.isVerbalAuth),l=!o&&!n.captainSignedBy;if(i)return"text-green-400";const d=t.getHours()+t.getMinutes()/60,u=n.startTime+n.duration;if(d>=u)return"";if(o&&!n.captainSignedBy)return"text-sky-400";if(l){const f=n.startTime-d;if(f<=.25)return"text-red-500";if(f<=2)return"text-amber-400"}return""},Gc=({event:n,traineesData:t,onSelectEvent:s,onMouseDown:i,onMouseEnter:o,onMouseLeave:l,pixelsPerHour:d,rowHeight:u,startHour:f,row:h,isDragging:m,isConflicting:v,conflictedPersonnelName:x,personnelData:y,seatConfigs:T,isDraggable:E=!0,currentTime:A,isUnavailabilityConflict:_,unavailablePersonnel:R,isSelected:H=!1,isChanged:O=!1,isPreview:W=!1})=>{try{const Ge=T}catch{}const ne=n,V=ne.segmentStartTime!==void 0?ne.segmentStartTime:n.startTime,U=ne.segmentDuration!==void 0?ne.segmentDuration:n.duration,D=(U||0)*d,$=n.resourceId==="Duty Sup",M=D<60,ae=ne.segmentType==="start"||V+U>22,Q={left:`${(V-f)*d}px`,top:`${h*u}px`,width:`${D}px`,height:`${u-4}px`,marginTop:"2px"},Te=()=>{if(v||_)return"ring-red-400";const Ge=new Date().toISOString().split("T")[0];if(n.date!==Ge)return"ring-transparent";if(!!(n.authoSignedBy&&n.captainSignedBy))return"ring-green-400";const vt=A.getHours()+A.getMinutes()/60,Ht=n.startTime+n.duration;if(vt>=Ht||!!(n.authoSignedBy||n.isVerbalAuth))return"ring-transparent";const we=n.startTime-vt;return we<=.25?"ring-red-500":we<=2?"ring-amber-400":"ring-transparent"},Y=7,fe=13;let Ne=11;D<120?Ne=Y:D<160?Ne=9:(D<220||D<239)&&(Ne=10),Ne=Math.max(Y,Math.min(fe,Ne));const X=n.eventCategory==="sct",ee=X||n.flightType==="Solo"?n.pilot:n.instructor,K=X?n.student:n.student||(n.flightType==="Solo"?n.pilot:"");let ue="font-semibold truncate",xe="truncate";if(W)ee!=null&&ee.includes("✓")?ue="font-bold truncate text-green-400":ee!=null&&ee.includes("✕")&&(ue="font-bold truncate text-red-500"),K!=null&&K.includes("✓")?xe="font-bold truncate text-green-400":K!=null&&K.includes("✕")&&(xe="font-bold truncate text-red-500");else{const Ge=K5(n,A),ht=R&&R.includes(ee||""),vt=R&&R.includes(K||""),Ht=A.getHours()+A.getMinutes()/60,ze=n.startTime+n.duration,we=Ht>=ze&&n.date===new Date().toISOString().split("T")[0];x===ee||ht&&!we?ue="font-bold truncate text-red-500":Ge&&(ue+=` ${Ge}`),x===K||vt&&!we?xe="font-bold truncate text-red-500":xe+=" text-white/80"}const ye=(()=>{if(W)return K;if(n.flightType==="Solo")return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(X&&n.flightType==="Dual"&&n.student)return n.student.split(" – ")[0];if(n.pilot&&n.student&&n.pilot===n.student)return e.jsx("span",{className:"bg-yellow-500/20 text-yellow-100 px-1.5 py-0.5 rounded-sm font-bold",style:{fontSize:M?"10px":`${Ne*.85}px`},children:"SOLO"});if(n.groupTraineeIds&&n.groupTraineeIds.length>1||n.attendees&&n.attendees.length>1||n.student==="Multiple")return"Group";if(n.student&&n.student!=="Multiple")return n.student.split(" – ")[0];if(n.attendees&&n.attendees.length===1)return n.attendees[0].split(" – ")[0];if(n.groupTraineeIds&&n.groupTraineeIds.length===1){const Ge=t.find(ht=>ht.idNumber===n.groupTraineeIds[0]);return Ge?Ge.name.split(",")[0]:"Group"}return""})(),pe=Ge=>{if(!Ge)return"";const ht=T.get(Ge);if(!ht)return"";switch(ht){case"Normal":return" (N)";case"FWD/SHORT":return" (F/S)";case"FWD/LONG":return" (F/L)";case"REAR/SHORT":return" (R/S)";default:return""}},ce=pe(ee),He=pe(typeof ye=="string"?ye:""),_e=n.callsign||"",Z=ee?y.get(ee):void 0,Fe=Z&&Z.callsignNumber>0?`${Z.callsignPrefix} ${String(Z.callsignNumber).padStart(3,"0")}`:"",Xe=n.flightType==="Solo";let ft=_e||Fe;if(Xe&&n.pilot){const Ge=t.find(ht=>ht.fullName===n.pilot);Ge!=null&&Ge.traineeCallsign&&(ft=Ge.traineeCallsign)}const tt=()=>{var Re,be;if(M)return null;const Ge={fontSize:`${Ne}px`,lineHeight:"1.3"},ht=U<=1.1,vt=Ze=>{if(!Ze)return Ze;const ot=Ze.split(", ");if(ot.length!==2)return Ze;const Vt=ot[0],yn=ot[1].charAt(0);return`${Vt}, ${yn}`},Ht=ht?vt(ee||""):ee,ze=ht?vt(K||""):K,we=n.flightNumber.includes("CPT")||n.flightNumber.includes("MB")||n.flightNumber.includes("TUT")||n.flightNumber.includes("QUIZ");return n.type==="deployment"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-white/80 font-medium text-sm",children:"DEPLOYMENT"}),e.jsx("div",{className:"font-mono text-white/60 truncate",children:"deployed"}),e.jsxs("div",{className:"text-xs text-white/50 mt-1",children:[(Re=n.deploymentStartTime)==null?void 0:Re.replace(/:/g,"")," - ",(be=n.deploymentEndTime)==null?void 0:be.replace(/:/g,"")]})]})}):n.type==="unavailability"?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsx("div",{className:"text-red-300 font-medium text-sm",children:"UNAVAILABLE"}),e.jsx("div",{className:"font-mono text-red-400 truncate",children:(n.reason||"Other").toUpperCase()}),n.notes&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate",children:n.notes})]})}):n.type==="ftd"||n.type==="ground"||we?$?e.jsx("div",{className:"flex justify-center items-center h-full w-full px-2",style:Ge,children:e.jsxs("div",{className:"overflow-hidden text-center",children:[e.jsxs("div",{className:ue,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsxs("div",{className:"font-mono text-white/80 truncate",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})]})}):e.jsxs("div",{className:"flex justify-between items-center h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:[e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})}),e.jsx("div",{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between h-full w-full px-2",style:Ge,children:[e.jsxs("div",{className:"flex-1 overflow-hidden pr-1",style:{paddingLeft:"10%",minWidth:0},children:[e.jsxs("div",{className:ue.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:[Ht==null?void 0:Ht.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate","overflow-hidden text-ellipsis whitespace-nowrap"),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ze==null?void 0:ze.split(" – ")[0],He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ze==null?void 0:ze.split(" – ")[0]})]}),e.jsx("div",{className:"flex flex-col items-end justify-between h-full pl-1 flex-shrink-0",style:{minWidth:"fit-content"},children:e.jsx("div",{children:e.jsxs("div",{className:"font-mono text-white/80 text-right whitespace-nowrap",children:[e.jsxs("span",{style:{fontSize:`${Ne-2}px`},children:["[",(n.duration||0).toFixed(1),"]"]})," ",n.flightNumber]})})})]}),n.aircraftNumber&&e.jsxs("div",{className:"absolute bottom-0.5 left-1 font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:["#",n.aircraftNumber]}),e.jsxs("div",{className:"absolute bottom-0.5 right-3 flex items-center gap-1",children:[n.area&&e.jsx("div",{className:`font-sans font-light ${["A","B","C","D","E","F","G","H"].includes(n.area)?"text-white":"text-yellow-300"}`,style:{fontSize:`${Ne}px`,lineHeight:"1",opacity:.7},children:n.area}),ft&&e.jsx("div",{className:"font-mono text-white/80",style:{fontSize:`${Ne-2}px`,lineHeight:"1",opacity:.8},children:ft})]})]})},Ke=`absolute rounded-sm ${E?"cursor-grab":"cursor-pointer"} transition-all duration-200 ${m?"opacity-80 z-50":"z-10"} ${m?"shadow-xl":"shadow-md"}`,nt=n.resourceId&&(n.resourceId.startsWith("STBY")||n.resourceId.startsWith("BNF-STBY")),Ct=n.type==="deployment"?"bg-gray-600/30 border border-white/60":n.type==="unavailability"?"bg-red-900/80 border border-red-600/60":_?"bg-red-800/90":v?"bg-red-600/70":n.color,xt=Te(),dn=$?"border border-black":"",on=H?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-gray-900":"",st=[Ke];W?(st.push(n.color),st.push("border-2 border-dashed border-sky-300")):(st.push(Ct),st.push(`ring-[0.92px] ${xt}`),st.push(dn),st.push(on)),M||st.push("overflow-hidden");const kt=()=>{if(!M)return null;const Ge={position:"absolute",top:0,[ae?"right":"left"]:"100%",marginLeft:ae?0:"4px",marginRight:ae?"4px":0,whiteSpace:"nowrap",zIndex:60};return e.jsx("div",{style:Ge,className:"flex items-center",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 shadow-lg flex items-center space-x-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${ue.replace("truncate","")}`,children:[ee==null?void 0:ee.split(" – ")[0],ce&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:ce})]}),e.jsx("div",{className:xe.replace("truncate",""),children:typeof ye=="string"?e.jsxs(e.Fragment,{children:[ye,He&&e.jsx("span",{style:{fontWeight:"normal",color:"rgba(255, 255, 255, 0.8)"},children:He})]}):ye})]}),e.jsx("div",{className:"h-6 w-px bg-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-semibold text-sky-400",children:n.flightNumber}),e.jsx("div",{className:"font-mono text-gray-400",children:Yf(V)})]}),ft&&e.jsx("div",{className:"font-mono text-gray-500 text-[10px]",children:ft})]})})};return e.jsxs("div",{"data-is-flight-tile":"true",style:Q,className:st.join(" "),onClick:s,onMouseDown:Ge=>{Ge.stopPropagation(),i(Ge)},onMouseEnter:o,onMouseLeave:l,children:[O&&!W&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 changed-bar-stripes z-20 pointer-events-none"}),nt&&!W&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{backgroundImage:"repeating-linear-gradient(45deg, rgba(209, 213, 219, 0.4) 0px, rgba(209, 213, 219, 0.4) 3px, transparent 3px, transparent 8px)"}}),n.isCancelled&&!W&&e.jsxs("svg",{className:"absolute inset-0 pointer-events-none z-20",style:{width:"100%",height:"100%"},children:[e.jsx("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"}),e.jsx("line",{x1:"100%",y1:"0",x2:"0",y2:"100%",stroke:"rgb(239, 68, 68)",strokeWidth:"2"})]}),e.jsxs("div",{className:"relative w-full h-full text-white",children:[$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V)}),e.jsx("div",{className:"absolute top-1 right-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.825}px`},children:Yf(V+U)})]}):!M&&e.jsx("div",{className:"absolute -top-px left-1 font-mono text-white/60 pointer-events-none",style:{fontSize:`${Ne*.75}px`},children:Yf(V)}),tt(),kt()]})]})},Zx=n=>!n||typeof n!="string"?"Other":n.startsWith("PC-21")||n.startsWith("Deployed")?"PC-21":n.startsWith("STBY")?"STBY":n==="Duty Sup"?"Duty Sup":n==="TWR DI"?"TWR DI":n.startsWith("FTD")?"FTD":n.startsWith("CPT")?"CPT":n.startsWith("Ground")?"Ground":"Other",Dv=({resources:n,onReorder:t,rowHeight:s,airframeCount:i,standbyCount:o,ftdCount:l,cptCount:d,events:u=[]})=>{const[f,h]=C.useState(null),m=E=>{h(E)},v=E=>{E.preventDefault()},x=E=>{if(f===null||f===E){h(null);return}const A=[...n],_=A.splice(f,1)[0];A.splice(E,0,_),t(A),h(null)},y=[];for(let E=1;E<=24;E++)y.push(`PC-21 ${E}`);y.push("Duty Sup"),y.push("TWR DI");let T=4;if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&(_.resourceId.startsWith("STBY")||_.resourceId.startsWith("BNF-STBY"))),A=new Set(E.map(_=>_.resourceId));T=Math.max(A.size,4)}for(let E=0;E<T;E++)y.push("STBY");for(let E=0;E<5;E++)y.push("FTD");for(let E=0;E<4;E++)y.push("CPT");if(u.length>0){const E=u.filter(_=>(_==null?void 0:_.resourceId)&&_.resourceId.startsWith("Ground"));new Set(E.map(_=>_.resourceId)).forEach(()=>y.push("Ground"))}return e.jsx("div",{className:"w-36 bg-gray-800 flex-shrink-0 h-full",children:e.jsx("ul",{children:y.map((E,A)=>{var P;let _=E,R="text-gray-400",H=!0;E==="Duty Sup"?(R="text-amber-300 font-semibold",H=!1):E==="TWR DI"?(R="text-green-300 font-semibold",H=!1):E.startsWith("Deployed")?(R="text-purple-300 font-semibold",H=!1):E.startsWith("PC-21")?(R="text-gray-400",H=!0):E==="STBY"?(R="text-gray-400",H=!1):E==="FTD"?(R="text-indigo-300",H=!0):E==="CPT"?(R="text-cyan-300",H=!1):E==="Ground"&&(R="text-gray-400",H=!1);const O=Zx(E),W=A>0?Zx(y[A-1]):O,ne=A>0&&O!==W,V="flex items-center justify-center text-xs font-mono transition-all duration-150",U=H?"cursor-move":"",D=ne?"border-t-2 border-t-gray-500 border-b border-b-gray-700/50":"border-b border-gray-700/50",$=H?"hover:bg-gray-700":"",M=f===A?"opacity-50 bg-sky-900":"";return e.jsx("li",{draggable:H,onDragStart:()=>H&&m(A),onDragOver:v,onDrop:()=>H&&x(A),onDragEnd:()=>h(null),className:`${V} ${R} ${U} ${D} ${$} ${M}`,style:{height:s},children:E.startsWith("PC-21")?e.jsxs("div",{className:"relative w-full text-center",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-gray-400 text-xs",children:((P=E.match(/\d+$/))==null?void 0:P[0])||""}),e.jsx("span",{children:"PC-21"})]}):e.jsx("div",{className:"w-full text-center",children:e.jsx("span",{children:_})})},`${E}-${A}`)})})})};function Z5(n,t,s){console.log(`
public/flight-school-app/assets/index-CmDcbMTV.js: */const WE="gl-node/";class YE{constructor(t){var s;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(s=t.vertexai)!==null&&s!==void 0?s:!1,this.apiKey=t.apiKey;const i=CS(t.httpOptions,t.vertexai,void 0,void 0);i&&(t.httpOptions?t.httpOptions.baseUrl=i:t.httpOptions={baseUrl:i}),this.apiVersion=t.apiVersion;const o=new VE(this.apiKey);this.apiClient=new cj({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:WE+"web",uploader:new qE,downloader:new ME}),this.models=new Aj(this.apiClient),this.live=new wj(this.apiClient,o,new GE),this.batches=new QC(this.apiClient),this.chats=new MT(this.models,this.apiClient),this.caches=new _T(this.apiClient),this.files=new GT(this.apiClient),this.operations=new kj(this.apiClient),this.authTokens=new zj(this.apiClient),this.tunings=new LE(this.apiClient),this.fileSearchStores=new mE(this.apiClient)}}const d2=[{category:"Core Dimensions",elements:["Airmanship","Preparation","Technique"]},{category:"Procedural Framework",elements:["Pre-Post Flight","Walk Around","Strap-in","Ground Checks","Airborne Checks"]},{category:"Takeoff",elements:["Stationary"]},{category:"Departure",elements:["Visual"]},{category:"Core Handling Skills",elements:["Effects of Control","Trimming","Straight and Level"]},{category:"Turns",elements:["Level medium Turn","Level Steep turn"]},{category:"Recovery",elements:["Visual - Initial & Pitch"]},{category:"Landing",elements:["Landing","Crosswind"]},{category:"Domestics",elements:["Radio Comms","Situational Awareness","Lookout","Knowledge"]}],JE=d2.flatMap(n=>n.elements),z1=["DEMO",0,1,2,3,4,5],XE=["No Grade",0,1,2,3,4,5],Hm=["QFI","Weather","Profile","Overall","NEST"],KE=n=>{const t={QFI:"",Weather:"",Profile:"",Overall:"",NEST:""};if(!n)return t;const s={...t};return Hm.forEach((i,o)=>{const l=Hm[o+1],d=`${i}:`,u=n.indexOf(d);if(u!==-1){let f=u+d.length,h=-1;if(l){const v=`${l}:`;h=n.indexOf(v,f)}let m="";h!==-1?m=n.substring(f,h):m=n.substring(f),s[i]=m.trim()}}),s};function ZE(n){let t="";const s=n.byteLength;for(let i=0;i<s;i++)t+=String.fromCharCode(n[i]);return btoa(t)}const QE=({element:n,onClose:t,onInsert:s,phraseBank:i})=>{const[o,l]=C.useState(new Set);let d=i==null?void 0:i[n];const u=["Airmanship","Preparation","Technique"].includes(n);!d&&!u&&(d=i==null?void 0:i["Generic Flying Elements"]);const f=v=>{const x=new Set(o);x.has(v)?x.delete(v):x.add(v),l(x)},h=()=>{const v=Array.from(o).join(" ");s(v)},m=v=>{switch(v){case"5":return"5 - Excellent";case"4":return"4 - High Satisfactory";case"3":return"3 - Satisfactory";case"2":return"2 - Low Satisfactory";case"1":return"1 - Marginal";case"0":return"0 - Unsatisfactory";default:return v}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[80] flex items-center justify-center animate-fade-in",onClick:t,children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg border border-gray-700 flex flex-col max-h-[80vh]",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-bold text-white",children:["Select Phrases: ",e.jsx("span",{className:"text-sky-400",children:n})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 overflow-y-auto flex-1 space-y-4",children:d?Object.entries(d).sort((v,x)=>Number(x[0])-Number(v[0])).map(([v,x])=>{const y=x;return y.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2 border-b border-gray-700 pb-1",children:m(v)}),e.jsx("div",{className:"space-y-2",children:y.map((T,E)=>e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer p-2 rounded hover:bg-gray-700/50",children:[e.jsx("input",{type:"checkbox",checked:o.has(T),onChange:()=>f(T),className:"mt-1 h-4 w-4 accent-sky-500 bg-gray-600 border-gray-500 rounded"}),e.jsx("span",{className:"text-sm text-gray-200",children:T})]},E))})]},v)}):e.jsxs("div",{className:"text-center py-8 text-gray-500 italic",children:[e.jsx("p",{children:"No phrase list available for this element."}),e.jsx("p",{className:"text-xs mt-2",children:"Configure in Settings → Scoring Matrix."})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-900/50 flex justify-end space-x-3",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm font-semibold",children:"Cancel"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 text-sm font-semibold",children:"Insert Selected"})]})]})})},eA=new YE({apiKey:""}),tA=({trainee:n,event:t,onBack:s,onSave:i,onDeleteAssessment:o,onEventUpdate:l,initialAssessment:d,instructors:u,pt051Assessments:f,events:h,lmpScores:m,syllabusDetails:v,registerDirtyCheck:x,phraseBank:y,currentUserPin:T})=>{const[E,A]=C.useState(!1),[_,R]=C.useState(!1),[H,O]=C.useState("Saved"),W=C.useRef(!0),[ne,V]=C.useState(null),U=C.useRef(null),D=C.useRef(null),$=C.useRef(null),M=C.useRef(null),P=C.useRef(null),[ae,Q]=C.useState(!1),[Te,Y]=C.useState(null),fe=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500",ge=we=>we===0?"accent-red-500":we===1?"accent-amber-500":"accent-sky-500";C.useMemo(()=>t.instructor&&u.find(we=>we.name===t.instructor)||null,[t.instructor,u]);const[Ne,Oe]=C.useState(()=>d&&(d.startTime!==void 0||d.duration!==void 0)?{...t,startTime:d.startTime||t.startTime,duration:d.duration||t.duration}:t),[se,F]=C.useState(()=>d||{id:_r(),traineeFullName:n.fullName,eventId:t.id,flightNumber:t.flightNumber,date:t.date,instructorName:t.instructor||"",scores:JE.map(we=>({element:we,grade:null,comment:""})),overallGrade:null,overallResult:null,groundSchoolAssessment:{isAssessment:!1,result:void 0}}),J=we=>{const Re={...Ne,...we};Oe(Re),l&&l(Re)},[X,ee]=C.useState(()=>{const we=KE(d==null?void 0:d.overallComments);return!we.QFI&&t.instructor&&(we.QFI=t.instructor),we}),[K,ue]=C.useState((d==null?void 0:d.overallGrade)||null),[xe,Le]=C.useState((d==null?void 0:d.overallResult)||null),[ye,pe]=C.useState((d==null?void 0:d.groundSchoolAssessment)||{isAssessment:!1,result:void 0}),[ce,He]=C.useState((d==null?void 0:d.dcoResult)||""),_e=C.useMemo(()=>{const we=[],Re=ot=>{const Vt=v.find(yn=>yn.id===ot||yn.code===ot);if(Vt)return Vt.type==="Flight"||Vt.type==="FTD";const Pt=ot.toUpperCase();return!!((Pt.includes("FTD")||Pt.startsWith("BGF")||Pt.startsWith("BIF")||Pt.startsWith("BNF")||Pt.startsWith("BNAV")||Pt.startsWith("SCT"))&&!Pt.includes("MB")&&!Pt.includes("TUT")&&!Pt.includes("CPT"))};m.forEach(ot=>{Re(ot.event)&&we.push({name:ot.event,score:ot.score,date:ot.date,timestamp:new Date(ot.date).getTime()})}),f.forEach(ot=>{ot.traineeFullName===n.fullName&&ot.eventId!==t.id&&ot.overallGrade!==null&&ot.overallGrade!=="No Grade"&&Re(ot.flightNumber)&&we.push({name:ot.flightNumber,score:ot.overallGrade,date:ot.date,timestamp:new Date(ot.date).getTime()})}),we.sort((ot,Vt)=>Vt.timestamp-ot.timestamp);const be=new Date(t.date).getTime(),Ze=we.filter(ot=>ot.timestamp<be);return Ze.length>0?Ze[0]:null},[m,f,n.fullName,v,t.date,t.id]);C.useEffect(()=>{K===1&&_e&&Number(_e.score)===1?(A(!0),Le("F")):A(!1)},[K,_e]),C.useEffect(()=>{K==="No Grade"||K===null?Le(null):K===0?Le("F"):K>=1&&K<=5&&Le("P")},[K]);const Z=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,grade:Re}:Ze)}))},Fe=(we,Re)=>{F(be=>({...be,scores:be.scores.map(Ze=>Ze.element===we?{...Ze,comment:Re}:Ze)}))},Xe=(we,Re)=>{ee(be=>({...be,[we]:Re})),we==="QFI"&&F(be=>({...be,instructorName:Re}))},ft=C.useMemo(()=>u.filter(we=>we.unit===n.unit),[u,n.unit]),tt=we=>{F(Re=>({...Re,instructorName:we})),ee(Re=>({...Re,QFI:we}))},We=we=>{if(we==null)return"";let Re=we;Re>=24&&(Re-=24);const be=Math.floor(Re),Ze=Math.round((Re-be)*60);return`${be.toString().padStart(2,"0")}${Ze.toString().padStart(2,"0")}`},Ke=(we,Re)=>{let be=we.currentTarget.value;be=be.replace(/\D/g,""),be.length>4&&(be=be.substring(0,4)),we.currentTarget.value=be},nt=we=>{const Re=t==null?void 0:t.target;if(!Re)return;let be=Re.value;if(be.length>0){const Ze=be.padStart(4,"0"),ot=parseInt(Ze);if(!isNaN(ot)&&ot>=0&&ot<=2359&&ot%100<60){const Vt=Math.floor(ot/100),Pt=ot%100,yn=Vt+Pt/60;if(Re.value=Ze,we==="startTime"){const Tt={...Ne,startTime:yn};Oe(Tt),J(Tt)}else{const Tt=Ne.startTime||0,lt=yn-Tt;if(lt>0){const Et={...Ne,duration:lt};Oe(Et),J(Et)}}}else if(Re.value="",we==="startTime"){const Vt={...Ne,startTime:null};Oe(Vt),J(Vt)}}},Ct=(we,Re)=>{if(we.key==="Enter"&&(we.preventDefault(),nt(Re),Re==="startTime")){const be=document.querySelector('input[placeholder="hhmm"]:last-of-type');be==null||be.focus()}},xt=()=>{U.current&&(U.current.then(we=>we.close()),U.current=null),P.current&&(P.current.disconnect(),P.current=null),M.current&&(M.current.disconnect(),M.current=null),$.current&&($.current.getTracks().forEach(we=>we.stop()),$.current=null),D.current&&D.current.state!=="closed"&&(D.current.close(),D.current=null),V(null)},dn=async(we,Re)=>{if(ne===we){xt();return}ne&&xt(),V(we);try{const be=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3});D.current=be;const Ze=await navigator.mediaDevices.getUserMedia({audio:!0});$.current=Ze;const ot=be.createMediaStreamSource(Ze);P.current=ot;const Vt=be.createScriptProcessor(4096,1,1);M.current=Vt;const Pt=eA.live.connect({model:"gemini-2.5-flash-native-audio-preview-09-2025",config:{responseModalities:[sf.AUDIO],inputAudioTranscription:{}},callbacks:{onopen:()=>console.log("Gemini Live Connected"),onmessage:yn=>{var Tt;if((Tt=yn.serverContent)!=null&&Tt.inputTranscription){const lt=yn.serverContent.inputTranscription.text;if(lt&&Re==="section"){const Et=we;ee(Bt=>({...Bt,[Et]:(Bt[Et]||"")+lt}))}}},onclose:()=>{ne===we&&xt()},onerror:()=>xt()}});U.current=Pt,Vt.onaudioprocess=yn=>{const Tt=yn.inputBuffer.getChannelData(0),lt=on(Tt);U.current&&U.current.then(Et=>{Et&&Et.sendRealtimeInput({media:lt})})},ot.connect(Vt),Vt.connect(be.destination)}catch(be){console.error("Failed to start voice input:",be),xt()}};function on(we){const Re=we.length,be=new Int16Array(Re);for(let Ze=0;Ze<Re;Ze++)be[Ze]=we[Ze]*32768;return{data:ZE(new Uint8Array(be.buffer)),mimeType:"audio/pcm;rate=16000"}}C.useEffect(()=>()=>{xt()},[]);const st=we=>{Y(we),Q(!0)},kt=we=>{Te&&F(Re=>({...Re,scores:Re.scores.map(be=>be.element===Te?{...be,comment:(be.comment?be.comment+" ":"")+we}:be)})),Q(!1),Y(null)};C.useEffect(()=>{const we=Hm.map(Re=>`${Re}:
