model User {
  id                  String        @id @default(cuid())
  
  // Login credentials (NEW: userId is the login identifier, NOT email)
  userId              String        @unique  // Login identifier (e.g., employee ID, service number)
  email               String?       @unique  // Optional, for recovery/notifications only
  passwordHash        String?                // bcrypt hash, null until set
  
  // User information
  displayName         String?
  firstName           String?
  lastName            String?
  
  // Status and permissions
  status              UserStatus    @default(active)
  permissionsRoleId   String
  permissionsRole     PermissionsRole @relation(fields: [permissionsRoleId], references: [id])
  
  // Password management
  mustChangePassword  Boolean       @default(true)
  passwordSetAt       DateTime?
  lastLoginAt         DateTime?
  
  // Legacy fields (keeping for backward compatibility)
  username            String?       @unique  // Deprecated, use userId
  password            String?                // Deprecated, use passwordHash
  role                Role          @default(USER)  // Deprecated, use permissionsRole
  isActive            Boolean       @default(true)  // Deprecated, use status
  
  // Timestamps
  createdAt           DateTime      @default(now())
  updatedAt           DateTime      @updatedAt
  
  // Relations
  sessions            Session[]
  accounts            Account[]
  inviteTokens        InviteToken[]
  passwordResetTokens PasswordResetToken[]
  auditLogsAsActor    AuditLog[]    @relation("AuditLogActor")
  auditLogsAsTarget   AuditLog[]    @relation("AuditLogTarget")
  
  // Legacy relations (keeping for backward compatibility)
  schedules           Schedule[]
  settings            UserSettings?
  createdBy           User?         @relation("UserCreatedBy", fields: [createdById], references: [id])
  createdById         String?
  createdUsers        User[]        @relation("UserCreatedBy")
  flightSchedules     FlightSchedule[] @relation("FlightSchedules")
  personnel           Personnel[]   @relation("Personnel")
  aircraft            Aircraft[]    @relation("Aircraft")
  cancellations       CancellationHistory[] @relation("CancellationHistory")
