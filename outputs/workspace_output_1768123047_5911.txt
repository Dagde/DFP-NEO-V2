2:import React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';
109:import { initializeData } from './lib/dataService';
341:  instructors: Instructor[];
967:        instructors: originalInstructors, trainees, syllabus: syllabusDetails, scores, 
1495:    let instructors = [...originalInstructors.map(i => ({...i, unavailability: [...(i.unavailability || [])]}))]; 
1500:        const instructorsNeeded = bnfTraineeCount;
1506:        console.log(`ðŸŒ™ Need ${instructorsNeeded} instructors for ${bnfTraineeCount} BNF trainees`);
1508:        // CRITICAL: Filter out instructors who already have day events (including from Active DFP)
1523:        console.log(`ðŸŒ™ Eligible pool: ${nightEligiblePool.length} instructors`);
1525:        const nightFlyingInstructors = [...nightEligiblePool].sort(() => 0.5 - Math.random()).slice(0, instructorsNeeded);
1526:        console.log(`ðŸŒ™ Selected instructors: ${nightFlyingInstructors.map(i => i.name).join(', ')}`);
1536:                const instructorToUpdate = instructors.find(i => i.idNumber === nfi.idNumber);
1626:                                if (ipCounts) ipCounts.ground++; // Count ground events for instructors
1629:                                if (ipCounts) ipCounts.cpt++; // Count CPT events for instructors
1694:                const instructor = instructors.find(i => i.name === pairedInstructorName);
1778:                // NEW RULE: COMPLETE separation - NO day events for instructors with night events
1779:                const simIps = instructors
1786:                // NEW RULE: COMPLETE separation - NO day events for instructors with night events
1787:                const availableQfis = instructors.filter(i => 
1808:                const qualified = instructors.filter(ip => {
1812:                    // NEW RULE: COMPLETE separation - NO day events for instructors with night events
2041:        const nightSupPool = instructors.filter(s => 
2075:    // NEW RULE: COMPLETE separation - NO day events for instructors with night events
2076:    const dutySupEligible = instructors.filter(i => 
2445:        // Get qualified instructors
2449:            const simIps = instructors.filter(i => i.role === 'SIM IP');
2450:            const qfis = instructors.filter(i => i.role === 'QFI');
2453:            candidates = instructors.filter(i => i.role === 'QFI');
2456:        // Filter to only available instructors
2472:        // Get all instructors with minimum count
2475:        // Random selection among tied instructors
2540:    console.log('PASS 1: Scheduling STBY with instructors available...');
2614:    console.log(`PASS 1 complete: ${scheduledTrainees.size} STBY flights with instructors`);
2913:    React.useEffect(() => {
2931:    React.useEffect(() => {
2976:    useEffect(() => {
3061:    const [instructorsData, setInstructorsData] = useState<Instructor[]>(ESL_DATA.instructors);
3069:    const currentUser = instructorsData.find(inst => inst.name === currentUserName) || instructorsData[0];
3073:    useEffect(() => {
3080:    useEffect(() => {
