  const archivedCourses = loadFromStorage<{ [key: string]: string }>(
    STORAGE_KEYS.ARCHIVED_COURSES, 
    {}
  );
  let coursePriorities = loadFromStorage<string[]>(
    STORAGE_KEYS.COURSE_PRIORITIES, 
    []
  );
  const coursePercentages = loadFromStorage<Map<string, number>>(
    STORAGE_KEYS.COURSE_PERCENTAGES, 
    new Map()
  );
  const traineeLMPs = loadFromStorage<Map<string, SyllabusItemDetail[]>>(
    STORAGE_KEYS.TRAINEE_LMPS, 
    new Map()
  );

  // Ensure arrays are actually arrays
  courses = Array.isArray(courses) ? courses : [];
  coursePriorities = Array.isArray(coursePriorities) ? coursePriorities : [];

  let instructors: Instructor[] = [];
  let trainees: Trainee[] = [];
  let events: ScheduleEvent[] = [];

  if (USE_API) {
    console.log('Initializing data from API...');
    
    try {
      // Try to fetch from API
      const [instructorsResult, traineesResult, scheduleResult, scoresResult] = await Promise.all([
        fetchInstructors(),
        fetchTrainees(),
        fetchSchedule(),
        fetchScores(),
      ]);

      // Ensure arrays
      instructors = Array.isArray(instructorsResult) ? instructorsResult : [];
      trainees = Array.isArray(traineesResult) ? traineesResult : [];
      events = Array.isArray(scheduleResult) ? scheduleResult : [];

      console.log('Data loaded from API:', {
        instructors: instructors.length,
        trainees: trainees.length,
        events: events.length,
        courses: courses.length,
        coursePriorities: coursePriorities.length,
        scores: scoresResult.size,
        pt051Assessments: pt051Assessments.size,
        coursePercentages: coursePercentages.size,
