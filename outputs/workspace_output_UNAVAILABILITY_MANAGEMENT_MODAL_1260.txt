{'role': 'user', 'content': '<tool_result> <execute-command> ToolResult(success=True, output=\'{\\n  "output": "`),Math.round(y*10)/10}function Qx(n){return n.toISOString().split(\\\\"T\\\\")[0]}function Q5(n){return n.map(t=>({time:new Date(t.timestamp).toLocaleTimeString(\\\\"en-US\\\\",{hour12:!1,hour:\\\\"2-digit\\\\",minute:\\\\"2-digit\\\\"}),availability:t.available}))}const ew=({currentDate:n,totalAircraft:t,plannedAvailability:s,dayFlyingStart:i,dayFlyingEnd:o,gridHeight:l,rowHeight:d,pixelsPerHour:u,startHour:f,onAvailabilityChange:h})=>{const[m,v]=C.useState(s),[x,y]=C.useState([]),T=C.useRef(null);C.useEffect(()=>{var F;const Oe=Qx(n),se=localStorage.getItem(`aircraft-availability-${Oe}`);if(se){const J=JSON.parse(se);y(J.snapshots.map(X=>({...X,timestamp:new Date(X.timestamp)}))),v(((F=J.snapshots[J.snapshots.length-1])==null?void 0:F.available)||s)}else{const J={timestamp:(()=>{const K=new Date(n);return K.setHours(0,0,1,0),K})(),available:s,total:t,notes:\\\\"Initial planned availability at start of day\\\\"};y([J]),v(s);const X=`Aircraft availability initialized at ${s} (${t-s} aircraft unavailable)`,ee=`Time: ${new Date().toLocaleTimeString()} | Initial: ${s} | Total: ${t} | Type: Initial setup`;Pn({page:\\\\"Program Schedule\\\\",action:\\\\"Add\\\\",description:X,changes:ee})}},[n,s,t]),C.useEffect(()=>{if(x.length>0){const Oe=Q5(x),se=Z5(Oe,i.replace(\\\\":\\\\",\\\\"\\\\"),o.replace(\\\\":\\\\",\\\\"\\\\")),F={date:Qx(n),snapshots:x,averageAvailability:se,dayFlyingStart:i,dayFlyingEnd:o};localStorage.setItem(`aircraft-availability-${F.date}`,JSON.stringify(F)),h(F)}},[x,i,o,n,h]);const E=Oe=>Oe*d,A=Oe=>(Oe.getHours()+Oe.getMinutes()/60-f)*u,_=()=>{const Oe=new Date(n);return Oe.setHours(23,59,59),A(Oe)},[R,H]=C.useState(!1),[O,W]=C.useState(0),[ne,V]=C.useState(0),U=Oe=>{if(!T.current)return;Oe.preventDefault();const se=T.current.getBoundingClientRect(),F=Oe.clientY-se.top,J=Oe.clientX-se.left;console.log(\\\\"\\\\ud83d\\\\uddb1\\\\ufe0f DRAG START:\\\\",{timestamp:new Date().toISOString(),mouseY:F,mouseX:J,currentAvailable:m,snapshotsCount:x.length,snapshots:x.map(X=>({time:X.timestamp.toLocaleTimeString(),available:X.available}))}),H(!0),W(F),V(J)},D=Oe=>{if(!R||!T.current)return;const se=T.current.getBoundingClientRect(),F=Oe.clientY-se.top,J=Oe.clientX-se.left;W(F),V(J);const X=F/d,ee=X,K=Math.max(0,Math.min(t,ee));console.log(\\\\"\\\\ud83d\\\\udd04 DRAGGING:\\\\",{mouseY:F,rowsFromTop:X.toFixed(2),exactCount:ee.toFixed(2),clampedCount:K.toFixed(2),currentAvailable:m.toFixed(2)}),v(K)},$=()=>{var Oe;if(R){H(!1);const se=O/d,F=se,J=Math.round(Math.max(0,Math.min(t,F))),X=((Oe=x[x.length-1])==null?void 0:Oe.available)||s,ee=J!==X;console.log(\\\\"\\\\u2705 DRAG END:\\\\",{timestamp:new Date().toISOString(),dragY:O.toFixed(2),rowsFromTop:se.toFixed(2),exactCount:F.toFixed(2),snappedCount:J,previousAvailability:X,valueChanged:ee,snapshotsBeforeUpdate:x.length}),v(J);const K=`Aircraft availability changed from ${X} to ${J} (${t-J} aircraft unavailable)`,ue=`Time: ${new Date().toLocaleTimeString()} | Previous: ${X} | New: ${J} | Total: ${t}`;if(Pn({page:\\\\"Program Schedule\\\\",action:\\\\"Edit\\\\",description:K,changes:ue}),ee){const xe=new Date,Le=new Date(n.getFullYear(),n.getMonth(),n.getDate(),xe.getHours(),xe.getMinutes(),xe.getSeconds(),xe.getMilliseconds());console.log(\\\\"\\\\ud83d\\\\udd50 TIMESTAMP DEBUG:\\\\",{now:xe.toISOString(),nowLocal:xe.toLocaleString(),currentDate:n.toISOString(),currentDateLocal:n.toLocaleString(),snapshotTime:Le.toISOString(),snapshotTimeLocal:Le.toLocaleString(),nowHours:xe.getHours(),nowMinutes:xe.getMinutes(),snapshotHours:Le.getHours(),snapshotMinutes:Le.getMinutes()});const ye={timestamp:Le,available:J,total:t,notes:`Availability changed to ${J}`};console.log(\\\\"\\\\ud83d\\\\udcf8 CREATING NEW SNAPSHOT:\\\\",{newSnapshot:{time:ye.timestamp.toLocaleTimeString(),available:ye.available,total:ye.total},snapshotsAfterUpdate:x.length+1}),y(pe=>{const ce=[...pe,ye];return console.log(\\\\"\\\\ud83d\\\\udcca SNAPSHOTS UPDATED:\\\\",{count:ce.length,all:ce.map(He=>({time:He.timestamp.toLocaleTimeString(),available:He.available}))}),ce})}else console.log(\\\\"\\\\u23ed\\\\ufe0f NO SNAPSHOT CREATED - Value unchanged\\\\")}};C.useEffect(()=>{if(R)return window.addEventListener(\\\\"mousemove\\\\",D),window.addEventListener(\\\\"mouseup\\\\",$),()=>{window.removeEventListener(\\\\"mousemove\\\\",D),window.removeEventListener(\\\\"mouseup\\\\",$)}},[R,m,t,d,x]);const[,M]=C.useState(new Date);C.useEffect(()=>{const Oe=setInterval(()=>{M(new Date)},6e4);return()=>clearInterval(Oe)},[]);const P=R?O:E(m),ae=_(),Q=()=>{if(x.length===0)return console.log(\\\\"\\\\ud83d\\\\udccf RENDER HISTORICAL LINES: No snapshots\\\\"),null;const se=A(new Date),F=x;console.log(\\\\"\\\\ud83d\\\\udccf RENDER HISTORICAL LINES:\\\\",{originalCount:x.length,filteredCount:F.length,isDragging:R,currentAvailable:m,currentTimeX:se.toFixed(2)});const J=[];for(let X=0;X<F.length;X++){const ee=F[X],K=A(ee.timestamp);if(X===F.length-1&&K>=se){console.log(`  \\\\u23ed\\\\ufe0f Skipping Line ${X} (most recent, at/after current time)`);continue}const ue=X===0?0:K,xe=X===F.length-1?se:A(F[X+1].timestamp),Le=E(ee.available);if((X===0||X===5||X===F.length-1)&&console.log(`  \\\\ud83d\\\\udccd Line ${X}:`,{time:ee.timestamp.toLocaleTimeString(),available:ee.available,startX:ue.toFixed(2),endX:xe.toFixed(2),y:Le.toFixed(2),timestampRaw:ee.timestamp.toISOString()}),J.push(e.jsx(\\\\"line\\\\",{x1:ue,y1:Le,x2:xe,y2:Le,stroke:\\\\"rgba(236, 72, 153, 0.4)\\\\",strokeWidth:\\\\"2\\\\",strokeDasharray:\\\\"8 4\\\\",className:\\\\"pointer-events-none\\\\"},`history-${X}`)),X>0){const ye=F[X-1],pe=E(ye.available);ye.available!==ee.available&&J.push(e.jsx(\\\\"line\\\\",{x1:ue,y1:pe,x2:ue,y2:Le,stroke:\\\\"rgba(236, 72, 153, 0.4)\\\\",strokeWidth:\\\\"2\\\\",strokeDasharray:\\\\"8 4\\\\",className:\\\\"pointer-events-none\\\\"},`vertical-${X}`))}}return J},Te=x.length>0?x[x.length-1]:null,Y=Te?A(Te.timestamp):0,fe=new Date,ge=A(fe);Te&&console.log(\\\\"\\\\ud83d\\\\udd50 TIMESTAMP COMPARISON:\\\\",{now:fe.toISOString(),nowLocal:fe.toLocaleTimeString(),nowHours:fe.getHours(),nowMinutes:fe.getMinutes(),lastSnapshotTime:Te.timestamp.toISOString(),lastSnapshotLocal:Te.timestamp.toLocaleTimeString(),lastSnapshotHours:Te.timestamp.getHours(),lastSnapshotMinutes:Te.timestamp.getMinutes(),currentTimeX:ge.toFixed(2),lastChangeX:Y.toFixed(2),difference:(ge-Y).toFixed(2)});const Ne=Te&&ge>Y&&ge<ae;return console.log(\\\\"\\\\ud83c\\\\udfaf SOLID LINE CALCULATION:\\\\",{hasLastSnapshot:!!Te,lastSnapshotTime:Te==null?void 0:Te.timestamp.toLocaleTimeString(),lastSnapshotTimestamp:Te==null?void 0:Te.timestamp.toISOString(),lastSnapshotAvailable:Te==null?void 0:Te.available,lastChangeX:Y.toFixed(2),currentTimeX:ge.toFixed(2),endOfDayX:ae.toFixed(2),displayY:P.toFixed(2),isDragging:R,needsSplit:Ne,currentTime:fe.toISOString(),currentDate:n.toISOString()}),e.jsx(e.Fragment,{children:e.jsxs(\\\\"svg\\\\",{ref:T,className:\\\\"absolute top-0 left-0 w-full h-full\\\\",style:{zIndex:5,pointerEvents:\\\\"none\\\\"},children:[Q(),Te&&e.jsx(\\\\"g\\\\",{children:Ne?e.jsxs(e.Fragment,{children:[e.jsx(\\\\"line\\\\",{x1:ge,y1:P,x2:ae,y2:P,stroke:\\\\"rgba(236, 72, 153, 0.4)\\\\",strokeWidth:\\\\"2\\\\",className:\\\\"pointer-events-none\\\\"}),e.jsx(\\\\"line\\\\",{x1:ge,y1:P,x2:ae,y2:P,stroke:\\\\"transparent\\\\",strokeWidth:\\\\"20\\\\",style:{pointerEvents:\\\\"auto\\\\",cursor:\\\\"ns-resize\\\\"},onMouseDown:U})]}):e.jsx(e.Fragment,{children:ge<Y?e.jsxs(e.Fragment,{children:[e.jsx(\\\\"line\\\\",{x1:Y,y1:E(Te.available),x2:ge,y2:E(Te.available),stroke:\\\\"rgba(236, 72, 153, 0.4)\\\\",strokeWidth:\\\\"2\\\\",strokeDasharray:\\\\"8 4\\\\",className:\\\\"pointer-events-none\\\\"}),e.jsx(\\\\"line\\\\",{x1:ge,y1:P,x2:ae,y2:P,stroke:\\\\"rgba(236, 72, 153, 0.4)\\\\",strokeWidth:\\\\"2\\\\",className:\\\\"pointer-events-none\\\\"}),e.jsx(\\\\"line\\\\",{x1:ge,y1:P,x2:ae,y2:P,stroke:\\\\"transparent\\\\",strokeWidth:\\\\"20\\\\",style:{pointerEvents:\\\\"auto\\\\",cursor:\\\\"ns-resize\\\\"},onMouseDown:U})]}):e.jsxs(e.Fragment,{children:[e.jsx(\\\\"line\\\\",{x1:Y,y1:P,x2:ae,y2:P,stroke:\\\\"rgba(236, 72, 153, 0.4)\\\\",strokeWidth:\\\\"2\\\\",strokeDasharray:ge>=ae?\\\\"8 4\\\\":void 0,className:\\\\"pointer-events-none\\\\"}),ge<ae&&e.jsx(\\\\"line\\\\",{x1:Y,y1:P,x2:ae,y2:P,stroke:\\\\"transparent\\\\",strokeWidth:\\\\"20\\\\",style:{pointerEvents:\\\\"auto\\\\",cursor:\\\\"ns-resize\\\\"},onMouseDown:U})]})})})]})})},_v=({event:n,onTimeChange:t,scheduleStartHour:s=0,scheduleEndHour:i=24,pixelsPerHour:o=200,totalWidth:l})=>{console.log(\\\\"VisualAdjustGuide rendered with event:\\\\",n),console.log(\\\\"pixelsPerHour:\\\\",o);const[d,u]=C.useState(!1),[f,h]=C.useState(!1),[m,v]=C.useState(n.startTime),[x,y]=C.useState(n.startTime+n.duration),T=C.useRef(null),E=ne=>(ne-s)*o,A=ne=>{const V=ne/o,U=s+V;return Math.round(U*12)/12},_=ne=>V=>{V.preventDefault(),ne?u(!0):h(!0)},R=ne=>{if(!T.current||!d&&!f)return;const V=T.current.getBoundingClientRect(),U=ne.clientX-V.left,D=A(U);d?D<x&&(v(D),t(D,x)):f&&D>m&&(y(D),t(m,D))},H=()=>{u(!1),h(!1)};C.useEffect(()=>{if(d||f)return document.addEventListener(\\\\"mousemove\\\\",R),document.addEventListener(\\\\"mouseup\\\\",H),()=>{document.removeEventListener(\\\\"mousemove\\\\",R),document.removeEventListener(\\\\"mouseup\\\\",H)}},[d,f,m,x]);const O=E(m),W=E(x);return console.log(\\\\"Guide positions - startX:\\\\",O,\\\\"endX:\\\\",W),console.log(\\\\"Current times - start:\\\\",m,\\\\"end:\\\\",x),e.jsxs(\\\\"div\\\\",{ref:T,className:\\\\"absolute inset-0 pointer-events-none\\\\",style:{zIndex:100},children:[e.jsxs(\\\\"div\\\\",{className:\\\\"absolute top-0 bottom-0 w-0.5 border-l-2 border-dashed border-blue-500 pointer-events-auto cursor-ew-resize\\\\",style:{left:`${O}px`},onMouseDown:_(!0),children:[e.jsx(\\\\"div\\\\",{className:\\\\"absolute -top-1 -left-2 w-4 h-4 bg-blue-500 rounded-full cursor-ew-resize\\\\"}),e.jsx(\\\\"div\\\\",{className:\\\\"absolute -bottom-1 -left-2 w-4 h-4 bg-blue-500 rounded-full cursor-ew-resize\\\\"})]}),e.jsxs(\\\\"div\\\\",{className:\\\\"absolute top-0 bottom-0 w-0.5 border-l-2 border-dashed border-red-500 pointer-events-auto cursor-ew-resize\\\\",style:{left:`${W}px`},onMouseDown:_(!1),children:[e.jsx(\\\\"div\\\\",{className:\\\\"absolute -top-1 -left-2 w-4 h-4 bg-red-500 rounded-full cursor-ew-resize\\\\"}),e.jsx(\\\\"div\\\\",{className:\\\\"absolute -bottom-1 -left-2 w-4 h-4 bg-red-500 rounded-full cursor-ew-resize\\\\"})]}),e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 bottom-0 bg-purple-500/20 pointer-events-none\\\\",style:{left:`${O}px`,width:`${W-O}px`}})]})},sr=200,zi=32,ur=0,El=24,tw=El-ur,ey=144,ty=40,nw=(n,t)=>{if(!n||!t||n.duration<=0||t.duration<=0)return!1;const s=n.startTime+n.duration,i=t.startTime+t.duration;return n.startTime<i&&s>t.startTime},Y0=n=>{const t=[];return n.flightType===\\\\"Solo\\\\"?n.pilot&&t.push(n.pilot):(n.instructor&&t.push(n.instructor),n.student&&t.push(n.student)),n.attendees&&t.push(...n.attendees),t},sw=(n,t)=>{if(!t)return!1;const s=t.find(o=>o.id===n.id);if(!s)return!0;const i=.001;return Math.abs(n.startTime-s.startTime)>i||Math.abs(n.duration-s.duration)>i?!0:n.resourceId!==s.resourceId||n.instructor!==s.instructor||n.student!==s.student||n.pilot!==s.pilot||(n.area||\\\\"\\\\")!==(s.area||\\\\"\\\\")},ny=n=>n.startsWith(\\\\"PC-21\\\\")||n.startsWith(\\\\"Deployed\\\\")?\\\\"PC-21\\\\":n.startsWith(\\\\"STBY\\\\")?\\\\"STBY\\\\":n===\\\\"Duty Sup\\\\"?\\\\"Duty Sup\\\\":n===\\\\"TWR DI\\\\"?\\\\"TWR DI\\\\":n.startsWith(\\\\"FTD\\\\")?\\\\"FTD\\\\":n.startsWith(\\\\"CPT\\\\")?\\\\"CPT\\\\":n.startsWith(\\\\"Ground\\\\")?\\\\"Ground\\\\":\\\\"Other\\\\",rw=({date:n,onDateChange:t,events:s,resources:i,instructors:o,traineesData:l,airframeCount:d,standbyCount:u,ftdCount:f,cptCount:h,onUpdateEvent:m,onSelectEvent:v,onReorderResources:x,zoomLevel:y,showValidation:T,showPrePost:E,syllabusDetails:A,personnelData:_,seatConfigs:R,daylightTimes:H,personnelConflicts:O,personnelConflictIds:W,unavailabilityConflicts:ne,onCptConflict:V,isMultiSelectMode:U,selectedEventIds:D,setSelectedEventIds:$,baselineEvents:M,isVisualAdjustMode:P=!1,visualAdjustEvent:ae=null,onVisualAdjustTimeChange:Q,isOracleMode:Te,oraclePreviewEvent:Y,onOracleMouseDown:fe,onOracleMouseMove:ge,onOracleMouseUp:Ne,detectConflictsForEvent:Oe,showDepartureDensityOverlay:se,showAircraftAvailability:F,plannedAvailability:J,dayFlyingStart:X,dayFlyingEnd:ee,onAvailabilityChange:K,timezoneOffset:ue=11})=>{const xe=C.useRef(null),Le=C.useRef(null),[ye,pe]=C.useState(()=>{const Tt=new Date,lt=ue*60*60*1e3;return new Date(Tt.getTime()+lt)}),ce=C.useRef(!0),He=C.useRef(y);C.useEffect(()=>{const Tt=()=>{const Et=new Date,Bt=ue*60*60*1e3,Kt=new Date(Et.getTime()+Bt);pe(Kt)};Tt();const lt=setInterval(Tt,1e3);return()=>clearInterval(lt)},[ue]);const[_e,Z]=C.useState(null),[Fe,Xe]=C.useState(null),[ft,tt]=C.useState(null),[We,Ke]=C.useState(null),nt=C.useRef(!1),Ct=C.useRef(null),[xt,dn]=C.useState(null),[on,st]=C.useState(null);C.useEffect(()=>{const Tt=setInterval(()=>{const Bt=new Date,Kt=ue*60*60*1e3,Mt=new Date(Bt.getTime()+Kt);pe(Mt)},1e3),lt=Bt=>{_e&&(console.log(\\\\"Global mouse move - drag state active\\\\"),vt(Bt))},Et=Bt=>{console.log(\\\\"Global mouse up called, draggingState exists:\\\\",!!_e),_e&&(console.log(\\\\"Global mouse up - ending drag\\\\"),document.body.classList.remove(\\\\"no-select\\\\"),Z(null),Xe(null),tt(null),Ke(null))};return document.addEventListener(\\\\"mousemove\\\\",lt),document.addEventListener(\\\\"mouseup\\\\",Et),()=>{clearInterval(Tt),document.removeEventListener(\\\\"mousemove\\\\",lt),document.removeEventListener(\\\\"mouseup\\\\",Et)}},[_e]);const kt=C.useMemo(()=>{const[Tt,lt,Et]=n.split(\\\\"-\\\\").map(Number);return new Date(Date.UTC(Tt,lt-1,Et)).toLocaleDateString(\\\\"en-GB\\\\",{day:\\\\"2-digit\\\\",month:\\\\"short\\\\",timeZone:\\\\"UTC\\\\"})},[n]);C.useEffect(()=>{const Tt=xe.current;if(Tt){if(ce.current){const Et=(8-ur)*sr*y;Tt.scrollLeft=Et,ce.current=!1}else{const lt=He.current;if(lt===y)return;const{scrollLeft:Et,clientWidth:Bt}=Tt,Mt=(Et+Bt/2)/(sr*lt)*sr*y-Bt/2;Tt.scrollLeft=Mt}He.current=y}},[y]);const Ge=C.useCallback((Tt,lt)=>{for(const Et of Tt){const Bt=A.find(Ve=>Ve.id===Et.flightNumber);if(!Bt)continue;const Kt=Et.startTime-(Bt.preFlightTime||0),Mt=Et.startTime+Et.duration+(Bt.postFlightTime||0);for(const Ve of lt){const qt=A.find(je=>je.id===Ve.flightNumber);if(!qt)continue;const Mn=Ve.startTime-(qt.preFlightTime||0),jn=Ve.startTime+Ve.duration+(qt.postFlightTime||0);if(Kt<jn&&Mt>Mn){const je=Y0(Et),$e=Y0(Ve),Ye=je.find(Dt=>$e.includes(Dt));if(Ye)return{conflictingEvent:Ve,personName:Ye}}}}return null},[A]),ht=(Tt,lt)=>{if(console.log(\\\\"handleMouseDown called, event:\\\\",lt==null?void 0:lt.id,\\\\"isMultiSelectMode:\\\\",U),console.log(\\\\"Event target:\\\\",Tt.target),console.log(\\\\"Current target:\\\\",Tt.currentTarget),Tt.button===0){if(nt.current=!1,document.body.classList.add(\\\\"no-select\\\\"),Te&&!lt){if(!Le.current)return;const Et=Le.current.getBoundingClientRect(),Kt=(Tt.clientX-Et.left)/(sr*y)+ur,Mt=Tt.clientY-Et.top,Ve=Math.floor(Mt/zi),qt=i[Ve]||i[0];fe(Kt,qt);return}if(lt){const Bt=Tt.currentTarget.getBoundingClientRect(),Kt=new Map,Mt=new Map,Ve=qt=>{console.log(\\\\"\\\\ud83d\\\\udc0d Processing event for drag:\\\\",qt.id,\\\\"resourceId:\\\\",qt.resourceId),console.log(\\\\"\\\\ud83d\\\\udc0d Available resources:\\\\",i);const Mn=i.indexOf(qt.resourceId);console.log(\\\\"\\\\ud83d\\\\udc0d Found row index:\\\\",Mn),Mn!==-1?(Kt.set(qt.id,{startTime:qt.startTime,rowIndex:Mn}),Mt.set(qt.id,qt.resourceId),console.log(\\\\"\\\\ud83d\\\\udc0d Event added to initialPositions\\\\")):console.log(\\\\"\\\\ud83d\\\\udc0d Event NOT added - resourceId not found in resources\\\\")};U&&D.has(lt.id)?D.forEach(qt=>{const Mn=s.find(jn=>jn.id===qt);Mn&&Ve(Mn)}):Ve(lt),Kt.size>0?(console.log(\\\\"Setting dragging state with\\\\",Kt.size,\\\\"events for event:\\\\",lt.id),console.log(\\\\"initialPositions:\\\\",Kt),Z({mainEventId:lt.id,xOffset:(Tt.clientX-Bt.left)/y,yOffset:Tt.clientY-Bt.top,initialPositions:Kt,originalResourceIds:Mt}),console.log(\\\\"setDraggingState called with:\\\\",_e)):console.log(\\\\"No initial positions - drag state not set\\\\")}else{if(!U||!Le.current)return;const Et=Le.current.getBoundingClientRect(),Bt=Tt.clientX-Et.left,Kt=Tt.clientY-Et.top;Ct.current={x:Bt,y:Kt},dn({x:Bt,y:Kt,width:0,height:0})}}},vt=Tt=>{if(console.log(\\\\"handleMouseMove called, draggingState exists:\\\\",!!_e),!Le.current){console.log(\\\\"Early return: no scheduleGridRef\\\\");return}nt.current=!0;const lt=Le.current.getBoundingClientRect(),Et=Tt.clientX-lt.left,Bt=Tt.clientY-lt.top;if(T){const Kt=Et/(sr*y)+ur;st(Kt)}if(Te&&Y){console.log(\\\\"Early return: Oracle mode with preview event\\\\");const Kt=Et/(sr*y)+ur,Mt=i[Math.floor(Bt/zi)]||i[0];ge(Kt,Mt)}else{if(Ct.current){console.log(\\\\"Early return: selectionStartPoint active (marquee selection)\\\\");const Ye=Tt.clientX-lt.left,Dt=Tt.clientY-lt.top,St=Math.min(Ct.current.x,Ye),hn=Math.min(Ct.current.y,Dt),Ce=Math.abs(Ye-Ct.current.x),At=Math.abs(Dt-Ct.current.y);dn({x:St,y:hn,width:Ce,height:At});const B=St,Ae=St+Ce,rt=hn,yt=hn+At,et=new Set;s.forEach($t=>{const pn=i.indexOf($t.resourceId);if(pn===-1)return;const kn=pn*zi,ts=kn+zi,un=($t.startTime-ur)*sr*y,Nn=un+$t.duration*sr*y;B<Nn&&Ae>un&&rt<ts&&yt>kn&&et.add($t.id)}),$(et);return}if(!_e){console.log(\\\\"Early return: no draggingState\\\\");return}const Kt=_e.initialPositions.get(_e.mainEventId);if(!Kt)return;const Mt=(Et/y-_e.xOffset)/sr-Kt.startTime,Ve=Math.floor((Bt-_e.yOffset+zi/2)/zi)-Kt.rowIndex;console.log(\\\\"Drag calculation - timeShift:\\\\",Mt,\\\\"rowShift:\\\\",Ve,\\\\"xInGrid:\\\\",Et,\\\\"yInGrid:\\\\",Bt);const qt=[],Mn=[...s];let jn=null,je=null;for(const[Ye,Dt]of _e.initialPositions.entries()){const St=s.find(yt=>yt.id===Ye);if(!St)continue;let hn=Dt.startTime+Mt,Ce=Dt.rowIndex+Ve;Ce<0&&(Ce=0),Ce>=i.length&&(Ce=i.length-1),hn<ur&&(hn=ur),hn+St.duration>El&&(hn=El-St.duration);const At=Math.round(hn*12)/12,B=i[Ce];qt.push({eventId:Ye,newStartTime:At,newResourceId:B});const Ae=Mn.findIndex(yt=>yt.id===Ye);Ae!==-1&&(Mn[Ae]={...Mn[Ae],startTime:At,resourceId:B});const rt=s.find(yt=>yt.id!==Ye&&!_e.initialPositions.has(yt.id)&&yt.resourceId===B&&nw({...St,startTime:At},yt));rt&&(jn=rt.id)}if(qt.find(Ye=>Ye.eventId===_e.mainEventId)){const Ye=Mn.find(hn=>hn.id===_e.mainEventId),Dt=Mn.filter(hn=>!_e.initialPositions.has(hn.id));let St=null;if(Oe)if(St=Oe(Ye,Dt),console.log(\\\\"\\\\ud83d\\\\udd0d Drag conflict check:\\\\",{eventId:Ye.id,hasConflict:St.hasConflict,conflictType:St.conflictType}),St.hasConflict){if(Xe({conflictingEventId:St.conflictingEventId,conflictedPersonName:St.conflictedPersonnel||\\\\"\\\\"}),Ye.flightNumber.includes(\\\\"CPT\\\\")&&St.conflictType===\\\\"personnel\\\\"){const hn=Dt.find(Ce=>Ce.id===St.conflictingEventId);hn&&(je={conflictingEvent:hn,newEvent:Ye,conflictedPerson:\\\\"trainee\\\\"})}}else Xe(null);else{const hn=Ge([Ye],Dt);hn?(Xe({conflictingEventId:hn.conflictingEvent.id,conflictedPersonName:hn.personName}),Ye.flightNumber.includes(\\\\"CPT\\\\")&&(je={conflictingEvent:hn.conflictingEvent,newEvent:Ye,conflictedPerson:\\\\"trainee\\\\",personName:hn.personName})):Xe(null)}}tt(jn),Ke(je),console.log(\\\\"\\\\ud83d\\\\udc0d DRAG COMPLETE - Calling onUpdateEvent with\\\\",qt.length,\\\\"updates:\\\\"),console.log(\\\\"\\\\ud83d\\\\udc0d Updates:\\\\",qt),m(qt)}},Ht=Tt=>{if(console.log(\\\\"Local handleMouseUp called - ignoring when dragState exists:\\\\",!!_e),_e){console.log(\\\\"Ignoring local mouse up - global handler will manage\\\\");return}document.body.classList.remove(\\\\"no-select\\\\"),Te&&Ne(),We&&V(We),console.log(\\\\"Clearing drag state in local handleMouseUp\\\\"),Z(null),Xe(null),tt(null),Ke(null),st(null),Ct.current&&U&&(Ct.current=null,dn(null),!nt.current&&!Tt.shiftKey&&(Tt.target.closest(\\\'[data-is-flight-tile=\\\\"true\\\\"]\\\')||$(new Set))),setTimeout(()=>{nt.current=!1},0)},ze=C.useCallback(Tt=>{if(!Tt||!/^\\\\\\\\d{2}:\\\\\\\\d{2}$/.test(Tt))return null;const[lt,Et]=Tt.split(\\\\":\\\\").map(Number);return lt+Et/60},[]),we=()=>{const Tt=[];for(let Bt=ur;Bt<=El;Bt++)Tt.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0 text-xs text-gray-500 flex items-center\\\\",style:{left:(Bt-ur)*sr*y},children:e.jsx(\\\\"span\\\\",{className:\\\\"-translate-x-1/2\\\\",children:`${String(Bt).padStart(2,\\\\"0\\\\")}:00`})},Bt));const lt=ze(H.firstLight),Et=ze(H.lastLight);if(lt!==null){const Bt=(lt-ur)*sr*y;Tt.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0 text-xs text-white font-bold flex items-center\\\\",style:{left:Bt},children:e.jsx(\\\\"span\\\\",{className:\\\\"-translate-x-1/2\\\\",children:`FL ${H.firstLight}`})},\\\\"fl-label\\\\"))}if(Et!==null){const Bt=(Et-ur)*sr*y;Tt.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0 text-xs text-white font-bold flex items-center\\\\",style:{left:Bt},children:e.jsx(\\\\"span\\\\",{className:\\\\"-translate-x-1/2\\\\",children:`LL ${H.lastLight}`})},\\\\"ll-label\\\\"))}return Tt},Re=()=>{const Tt=[];for(let lt=ur;lt<=El;lt++)Tt.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0\\\\",style:{left:(lt-ur)*sr*y},children:e.jsx(\\\\"div\\\\",{className:\\\\"w-px h-full bg-gray-700/50\\\\"})},`v-${lt}`)),lt<El&&Tt.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0\\\\",style:{left:(lt-ur+.5)*sr*y},children:e.jsx(\\\\"div\\\\",{className:\\\\"w-px h-full bg-gray-700/25\\\\"})},`v-${lt}-30`));for(let lt=1;lt<=i.length;lt++)Tt.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute left-0 w-full bg-gray-700/25\\\\",style:{top:lt*zi,height:\\\\"1px\\\\"}},`h-${lt}`));return Tt},be=()=>{const Tt=[];let lt=ny(i[0]);for(let Et=1;Et<i.length;Et++){const Bt=ny(i[Et]);Bt!==lt&&(Tt.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute left-0 w-full border-t-2 border-gray-500 z-10\\\\",style:{top:Et*zi}},`sep-${Et}`)),lt=Bt)}return Tt},Ze=()=>{const Tt=ze(H.firstLight),lt=ze(H.lastLight);return e.jsxs(e.Fragment,{children:[Tt!==null&&e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full z-[5] pointer-events-none border-l border-dashed border-white/30\\\\",style:{left:`${(Tt-ur)*sr*y}px`}}),lt!==null&&e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full z-[5] pointer-events-none border-l border-dashed border-white/30\\\\",style:{left:`${(lt-ur)*sr*y}px`}})]})},ot=()=>{const Tt=ze(H.firstLight),lt=ze(H.lastLight),Et=[];if(Tt!==null&&Tt>ur){const Bt=(Tt-ur)*sr*y;Et.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 left-0 h-full bg-white/5 pointer-events-none z-[1]\\\\",style:{width:`${Bt}px`}},\\\\"night-shade-morning\\\\"))}if(lt!==null&&lt<El){const Bt=(lt-ur)*sr*y,Kt=(El-lt)*sr*y;Et.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full bg-white/5 pointer-events-none z-[1]\\\\",style:{left:`${Bt}px`,width:`${Kt}px`}},\\\\"night-shade-evening\\\\"))}return e.jsx(e.Fragment,{children:Et})},Vt=()=>{const lt=(Mt=>{const Ve=Mt.getUTCFullYear(),qt=String(Mt.getUTCMonth()+1).padStart(2,\\\\"0\\\\"),Mn=String(Mt.getUTCDate()).padStart(2,\\\\"0\\\\");return`${Ve}-${qt}-${Mn}`})(ye);if(n!==lt)return null;const Et=ye,Bt=Et.getUTCHours()+Et.getUTCMinutes()/60+Et.getUTCSeconds()/3600;if(Bt<ur||Bt>El)return null;const Kt=(Bt-ur)*sr*y;return e.jsxs(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full z-[30] pointer-events-none\\\\",style:{left:`${Kt}px`},children:[e.jsx(\\\\"div\\\\",{className:\\\\"w-0.5 h-full bg-white animate-pulse\\\\"}),e.jsx(\\\\"div\\\\",{className:\\\\"absolute -top-2.5 -translate-x-1/2 w-0 h-0\\\\",style:{borderLeft:\\\\"5px solid transparent\\\\",borderRight:\\\\"5px solid transparent\\\\",borderTop:\\\\"7px solid white\\\\"}})]})},Pt=()=>{if(!T||on===null||!se)return null;const Tt=on-.5,lt=on+.5,Et=s.filter(Ve=>Ve.type!==\\\\"flight\\\\"?!1:Ve.startTime>=Tt&&Ve.startTime<lt).length,Bt=(Tt-ur)*sr*y,Kt=(lt-ur)*sr*y,Mt=Kt-Bt;return e.jsxs(e.Fragment,{children:[e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full bg-white/10 pointer-events-none z-[25]\\\\",style:{left:`${Bt}px`,width:`${Mt}px`}}),e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full w-0.5 bg-white/40 pointer-events-none z-[26]\\\\",style:{left:`${Bt}px`}}),e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full w-0.5 bg-white/40 pointer-events-none z-[26]\\\\",style:{left:`${Kt}px`}}),e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-2 bg-gray-800/95 border border-white/30 rounded px-3 py-1.5 shadow-lg pointer-events-none z-[27]\\\\",style:{left:`${Bt+Mt/2}px`,transform:\\\\"translateX(-50%)\\\\"},children:e.jsxs(\\\\"div\\\\",{className:\\\\"text-white text-xs font-semibold whitespace-nowrap\\\\",children:[\\\\"Flights starting in this hour: \\\\",e.jsx(\\\\"span\\\\",{className:\\\\"text-sky-400\\\\",children:Et})]})})]})},yn=()=>i.flatMap((Tt,lt)=>s.filter(Bt=>Bt.resourceId===Tt).map(Bt=>{const Kt=!!(_e&&_e.initialPositions.has(Bt.id)),Mt=Bt.id===(Fe==null?void 0:Fe.conflictingEventId)||Bt.id===ft,Ve=T&&W.has(Bt.id)||Mt||Kt&&!!(Fe||ft),qt=ne.get(Bt.id),Mn=!!qt,jn=qt||[];let je=null;if(Fe){const Dt=Y0(Bt);(Kt||Mt)&&Dt.includes(Fe.conflictedPersonName)&&(je=Fe.conflictedPersonName)}const $e=D.has(Bt.id),Ye=sw(Bt,M);return e.jsx(Gc,{event:Bt,traineesData:l,onSelectEvent:()=>{if(!nt.current)if(U){const Dt=new Set(D);Dt.has(Bt.id)?Dt.delete(Bt.id):Dt.add(Bt.id),$(Dt)}else v(Bt)},onMouseDown:Dt=>ht(Dt,Bt),onMouseEnter:()=>{},onMouseLeave:()=>{},pixelsPerHour:sr*y,rowHeight:zi,startHour:ur,row:lt,isDragging:Kt,isConflicting:Ve,isUnavailabilityConflict:Mn,unavailablePersonnel:jn,conflictedPersonnelName:je,personnelData:_,seatConfigs:R,isDraggable:!0,currentTime:ye,isSelected:$e,isChanged:Ye},Bt.id)}));return e.jsx(\\\\"div\\\\",{ref:xe,className:\\\\"flex-1 overflow-auto relative bg-gray-900 select-none\\\\",children:e.jsxs(\\\\"div\\\\",{style:{width:`${ey+tw*sr*y}px`,height:`${ty+i.length*zi}px`,display:\\\\"grid\\\\",gridTemplateColumns:`${ey}px 1fr`,gridTemplateRows:`${ty}px 1fr`},children:[e.jsx(\\\\"div\\\\",{className:\\\\"sticky top-0 left-0 z-40 bg-gray-800 border-r border-b border-gray-700 p-1\\\\",children:e.jsxs(\\\\"div\\\\",{className:\\\\"bg-gray-700 rounded-md w-full h-full flex items-center justify-center px-2 space-x-2\\\\",children:[e.jsx(\\\\"button\\\\",{onClick:()=>t(-1),className:\\\\"p-1 rounded-full hover:bg-gray-600 text-white flex-shrink-0\\\\",children:\\\\"<\\\\"}),e.jsx(\\\\"span\\\\",{className:\\\\"flex-grow min-w-0 text-center font-semibold text-white cursor-default truncate text-xs\\\\",children:kt}),e.jsx(\\\\"button\\\\",{onClick:()=>t(1),className:\\\\"p-1 rounded-full hover:bg-gray-600 text-white flex-shrink-0\\\\",children:\\\\">\\\\"})]})}),e.jsx(\\\\"div\\\\",{className:\\\\"sticky top-0 z-20 bg-gray-800 border-b border-gray-700 relative\\\\",children:we()}),e.jsx(\\\\"div\\\\",{className:\\\\"sticky left-0 z-30 bg-gray-800 border-r border-gray-700\\\\",children:e.jsx(Dv,{resources:i,onReorder:x,rowHeight:zi,airframeCount:d,standbyCount:u,ftdCount:f,cptCount:h,events:s})}),e.jsxs(\\\\"div\\\\",{ref:Le,className:\\\\"relative bg-gray-900\\\\",onMouseDown:Tt=>ht(Tt),onMouseMove:vt,onMouseUp:Ht,onMouseLeave:Ht,children:[Re(),ot(),Ze(),be(),Vt(),Pt(),F&&J!==void 0&&X&&ee&&K&&e.jsx(ew,{currentDate:new Date(n),totalAircraft:d,plannedAvailability:J,dayFlyingStart:X,dayFlyingEnd:ee,gridHeight:i.length*zi,rowHeight:zi,pixelsPerHour:sr*y,startHour:ur,onAvailabilityChange:K}),yn(),P&&ae&&Q&&e.jsx(_v,{event:ae,onTimeChange:Q,scheduleStartHour:ur,scheduleEndHour:El,pixelsPerHour:sr*y}),Te&&Y&&e.jsxs(e.Fragment,{children:[e.jsx(Gc,{isPreview:!0,event:Y,onSelectEvent:()=>{},onMouseDown:()=>{},onMouseEnter:()=>{},onMouseLeave:()=>{},pixelsPerHour:sr*y,rowHeight:zi,startHour:ur,row:i.indexOf(Y.resourceId),isDragging:!1,traineesData:l,personnelData:_,seatConfigs:new Map,currentTime:new Date}),e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-1/2 -translate-y-1/2 h-1 bg-sky-300/40 pointer-events-none z-50\\\\",style:{left:`${(Y.startTime-(Y.preStart||1)-ur)*sr*y}px`,width:`${(Y.preStart||1)*sr*y}px`,top:`${i.indexOf(Y.resourceId)*zi+zi/2}px`}}),e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-1/2 -translate-y-1/2 h-1 bg-sky-300/40 pointer-events-none z-50\\\\",style:{left:`${(Y.startTime+Y.duration-ur)*sr*y}px`,width:`${(Y.postEnd||.5)*sr*y}px`,top:`${i.indexOf(Y.resourceId)*zi+zi/2}px`}})]}),xt&&e.jsx(\\\\"div\\\\",{className:\\\\"absolute bg-sky-500/20 border border-sky-400 z-50 pointer-events-none\\\\",style:{left:xt.x,top:xt.y,width:xt.width,height:xt.height}})]})]})})},sy=n=>{const t={\\\\"1FTS\\\\":\\\\"text-blue-300\\\\",\\\\"2FTS\\\\":\\\\"text-green-300\\\\",CFS:\\\\"text-purple-300\\\\",CFTS:\\\\"text-orange-300\\\\",RMC:\\\\"text-red-300\\\\",ARFTU:\\\\"text-yellow-300\\\\",AWMU:\\\\"text-teal-300\\\\",\\\\"No. 1 Squadron\\\\":\\\\"text-indigo-300\\\\",\\\\"No. 2 Squadron\\\\":\\\\"text-pink-300\\\\",\\\\"No. 3 Squadron\\\\":\\\\"text-cyan-300\\\\",\\\\"No. 75 Squadron\\\\":\\\\"text-amber-300\\\\",\\\\"No. 76 Squadron\\\\":\\\\"text-lime-300\\\\",\\\\"No. 77 Squadron\\\\":\\\\"text-emerald-300\\\\"};return console.log(\\\\"\\\\ud83c\\\\udfa8 UNIT COLOR DEBUG - Unit:\\\\",n,\\\\"Color:\\\\",t[n||\\\\"\\\\"]||\\\\"text-gray-300\\\\"),t[n||\\\\"\\\\"]||\\\\"text-gray-300\\\\"},iw=n=>({\\\\"1FTS\\\\":\\\\"bg-blue-500/20 border-blue-500/50 text-blue-300\\\\",\\\\"2FTS\\\\":\\\\"bg-green-500/20 border-green-500/50 text-green-300\\\\",CFS:\\\\"bg-purple-500/20 border-purple-500/50 text-purple-300\\\\",CFTS:\\\\"bg-orange-500/20 border-orange-500/50 text-orange-300\\\\",RMC:\\\\"bg-red-500/20 border-red-500/50 text-red-300\\\\",ARFTU:\\\\"bg-yellow-500/20 border-yellow-500/50 text-yellow-300\\\\",AWMU:\\\\"bg-teal-500/20 border-teal-500/50 text-teal-300\\\\",\\\\"No. 1 Squadron\\\\":\\\\"bg-indigo-500/20 border-indigo-500/50 text-indigo-300\\\\",\\\\"No. 2 Squadron\\\\":\\\\"bg-pink-500/20 border-pink-500/50 text-pink-300\\\\",\\\\"No. 3 Squadron\\\\":\\\\"bg-cyan-500/20 border-cyan-500/50 text-cyan-300\\\\",\\\\"No. 75 Squadron\\\\":\\\\"bg-amber-500/20 border-amber-500/50 text-amber-300\\\\",\\\\"No. 76 Squadron\\\\":\\\\"bg-lime-500/20 border-lime-500/50 text-lime-300\\\\",\\\\"No. 77 Squadron\\\\":\\\\"bg-emerald-500/20 border-emerald-500/50 text-emerald-300\\\\"})[n||\\\\"\\\\"]||\\\\"bg-gray-600/20 border-gray-500/50 text-gray-300\\\\",Iv=({personnel:n,rowHeight:t,onRowEnter:s,onRowLeave:i,onPersonClick:o,onRowRef:l,showUnits:d=!1,useUnitColors:u=!1})=>{console.log(\\\\"\\\\ud83d\\\\udd0d PERSONNEL COLUMN DEBUG - Props:\\\\",{personnelCount:n.length,showUnits:d,useUnitColors:u,samplePersonnel:n.slice(0,3).map(h=>({name:h.name,unit:h.unit}))});const f=Ua.useMemo(()=>{if(!d)return n;const h={};return h.Unassigned=n.filter(m=>!m.unit),n.forEach(m=>{m.unit&&(h[m.unit]||(h[m.unit]=[]),h[m.unit].push(m))}),h},[n,d]);return d?e.jsx(\\\\"div\\\\",{className:\\\\"w-48 bg-gray-800 flex-shrink-0 h-full\\\\",children:e.jsx(\\\\"ul\\\\",{children:Object.entries(f).map(([h,m])=>e.jsxs(Ua.Fragment,{children:[e.jsx(\\\\"li\\\\",{className:\\\\"bg-gray-900/80 border-b border-gray-600 px-3 py-1\\\\",children:e.jsxs(\\\\"span\\\\",{className:`text-xs font-semibold ${u&&iw(h).split(\\\\" \\\\").find(v=>v.startsWith(\\\\"text-\\\\"))||\\\\"text-gray-400\\\\"}`,children:[h,\\\\" (\\\\",m.length,\\\\")\\\\"]})}),m.map(({name:v,rank:x,unit:y},T)=>e.jsxs(\\\\"li\\\\",{ref:E=>l==null?void 0:l(v,E),className:`flex items-center justify-start pl-3 pr-2 py-1 text-xs transition-colors duration-150 border-b border-gray-700/50 bg-gray-800 ${o?\\\\"cursor-pointer hover:bg-gray-700\\\\":\\\\"\\\\"}`,style:{height:t,minHeight:t},onMouseEnter:()=>s==null?void 0:s(T),onMouseLeave:()=>i==null?void 0:i(),onClick:()=>o==null?void 0:o(v),children:[e.jsx(\\\\"span\\\\",{className:\\\\"font-mono text-gray-500 w-10 text-xs\\\\",children:x}),e.jsx(\\\\"span\\\\",{className:`truncate font-medium flex-1 ${u?sy(y):\\\\"text-gray-300\\\\"}`,children:v})]},`${h}-${v}`))]},h))})}):e.jsx(\\\\"div\\\\",{className:\\\\"w-40 bg-gray-800 flex-shrink-0 h-full\\\\",children:e.jsx(\\\\"ul\\\\",{children:n.map(({name:h,rank:m,unit:v},x)=>e.jsxs(\\\\"li\\\\",{ref:y=>l==null?void 0:l(h,y),className:`flex items-center justify-start pl-3 text-xs transition-colors duration-150 border-b border-gray-700/50 ${o?\\\\"cursor-pointer hover:bg-gray-700\\\\":\\\\"\\\\"}`,style:{height:t},onMouseEnter:()=>s==null?void 0:s(x),onMouseLeave:()=>i==null?void 0:i(),onClick:()=>o==null?void 0:o(h),children:[e.jsx(\\\\"span\\\\",{className:\\\\"font-mono text-gray-500 w-12 flex-shrink-0\\\\",children:m}),e.jsx(\\\\"span\\\\",{className:`truncate font-medium ${u?sy(v):\\\\"text-gray-300\\\\"}`,children:h})]},h))})})},Si=200,Cl=32,fi=0,ac=24,ry=ac-fi,iy=160,J0=40,X0=n=>{const t=[];return n.flightType===\\\\"Solo\\\\"?n.pilot&&t.push(n.pilot):(n.instructor&&t.push(n.instructor),n.student&&t.push(n.student)),t},aw=(n,t,s=!0)=>{const i=[];return t.forEach(o=>{(o.unavailability||[]).forEach(d=>{const u=new Date(n+\\\\"T00:00:00Z\\\\"),f=new Date(d.startDate+\\\\"T00:00:00Z\\\\"),h=new Date(d.endDate+\\\\"T00:00:00Z\\\\"),m=new Date(h);if(d.allDay&&m.setDate(m.getDate()-1),u>=f&&u<=m){let v=d.allDay?.0167:parseFloat(d.startTime)/100,x=d.allDay?23.983:parseFloat(d.endTime)/100;d.allDay||(u.getTime()===f.getTime()&&u.getTime()===m.getTime()?(v=d.startTime?parseFloat(d.startTime)/100:.0167,x=d.endTime?parseFloat(d.endTime)/100:23.983):u.getTime()===f.getTime()&&d.startTime?(v=parseFloat(d.startTime)/100,x=23.983):u.getTime()===m.getTime()&&d.endTime?(v=.0167,x=parseFloat(d.endTime)/100):u>f&&u<m&&(v=.0167,x=23.983));const y=x-v,T={id:`unavailability-${o.name||o.fullName}-${d.id}`,date:n,startTime:v,duration:y,type:\\\\"unavailability\\\\",instructor:s?o.name:void 0,student:s?void 0:o.fullName,pilot:s?void 0:o.fullName,flightNumber:\\\\"UNAVAIL\\\\",resourceName:s?o.name:o.fullName,resourceId:s?`INST-${o.name}`:`TRAINEE-${o.fullName}`,eventType:\\\\"UNAVAILABILITY\\\\",allDay:d.allDay,reason:d.reason,notes:d.notes};i.push(T)}})}),i},ow=({date:n,onDateChange:t,events:s,instructors:i,instructorsData:o,onSelectEvent:l,onUpdateEvent:d,zoomLevel:u,daylightTimes:f,personnelData:h,seatConfigs:m,syllabusDetails:v,conflictingEventIds:x,showValidation:y,unavailabilityConflicts:T,onSelectInstructor:E,traineesData:A})=>{console.log(\\\\"\\\\ud83d\\\\udd0d INSTRUCTOR SCHEDULE ERROR TRACKING - Props received:\\\\"),console.log(\\\\"  - date:\\\\",n),console.log(\\\\"  - events count:\\\\",s==null?void 0:s.length),console.log(\\\\"  - instructors count:\\\\",i==null?void 0:i.length),console.log(\\\\"  - instructorsData count:\\\\",o==null?void 0:o.length),console.log(\\\\"  - traineesData count:\\\\",A==null?void 0:A.length),console.log(\\\\"  - zoomLevel:\\\\",u),console.log(\\\\"  - daylightTimes:\\\\",f),console.log(\\\\"  - personnelData size:\\\\",h==null?void 0:h.size),console.log(\\\\"  - seatConfigs type:\\\\",typeof m),console.log(\\\\"  - seatConfigs value:\\\\",m),console.log(\\\\"  - seatConfigs === undefined:\\\\",m===void 0),console.log(\\\\"  - seatConfigs === null:\\\\",m===null),console.log(\\\\"  - syllabusDetails count:\\\\",v==null?void 0:v.length),console.log(\\\\"  - conflictingEventIds size:\\\\",x==null?void 0:x.size),console.log(\\\\"  - showValidation:\\\\",y),console.log(\\\\"  - unavailabilityConflicts size:\\\\",T==null?void 0:T.size),console.log(\\\\"  - Function props:\\\\"),console.log(\\\\"    - onDateChange type:\\\\",typeof t),console.log(\\\\"    - onSelectEvent type:\\\\",typeof l),console.log(\\\\"    - onUpdateEvent type:\\\\",typeof d),console.log(\\\\"    - onSelectInstructor type:\\\\",typeof E);try{const pe=m;console.log(\\\\"\\\\u2705 seatConfigs access successful in InstructorScheduleView\\\\")}catch(pe){console.error(\\\\"\\\\u274c seatConfigs access failed in InstructorScheduleView:\\\\",pe),console.error(\\\\"\\\\u274c Error stack:\\\\",pe.stack)}n||console.error(\\\\"\\\\u274c CRITICAL: date is undefined\\\\"),s||console.error(\\\\"\\\\u274c CRITICAL: events is undefined\\\\"),i||console.error(\\\\"\\\\u274c CRITICAL: instructors is undefined\\\\"),f||console.error(\\\\"\\\\u274c CRITICAL: daylightTimes is undefined\\\\"),(s==null?void 0:s.length)>0&&console.log(\\\\"\\\\ud83d\\\\udd0d Sample event structure:\\\\",s[0]),(i==null?void 0:i.length)>0&&console.log(\\\\"\\\\ud83d\\\\udd0d Sample instructor structure:\\\\",i[0]);const _=C.useRef(null),[R,H]=C.useState(new Date),[O,W]=C.useState(null),[ne,V]=C.useState(null),[U,D]=C.useState(null),[$,M]=C.useState(null),P=C.useRef(null),ae=C.useRef(!0),Q=C.useRef(u),Te=C.useRef(!1);C.useEffect(()=>{const pe=setInterval(()=>H(new Date),1e3);return()=>clearInterval(pe)},[]);const Y=C.useMemo(()=>{const[pe,ce,He]=n.split(\\\\"-\\\\").map(Number);return new Date(Date.UTC(pe,ce-1,He)).toLocaleDateString(\\\\"en-GB\\\\",{day:\\\\"2-digit\\\\",month:\\\\"short\\\\",timeZone:\\\\"UTC\\\\"})},[n]),fe=C.useMemo(()=>{const pe=aw(n,o,!0);return[...s,...pe]},[n,s,o]);C.useEffect(()=>{const pe=_.current;if(pe){if(ae.current){const He=(8-fi)*Si*u;pe.scrollLeft=He,ae.current=!1}else{const ce=Q.current;if(ce===u)return;const{scrollLeft:He,clientWidth:_e}=pe,Fe=(He+_e/2)/(Si*ce)*Si*u-_e/2;pe.scrollLeft=Fe}Q.current=u}},[u]);const ge=C.useCallback((pe,ce)=>{for(const He of pe){const _e=v.find(Xe=>Xe.id===He.flightNumber);if(!_e)continue;const Z=He.startTime-_e.preFlightTime,Fe=He.startTime+He.duration+_e.postFlightTime;for(const Xe of ce){const ft=v.find(Ke=>Ke.id===Xe.flightNumber);if(!ft)continue;const tt=Xe.startTime-ft.preFlightTime,We=Xe.startTime+Xe.duration+ft.postFlightTime;if(Z<We&&Fe>tt){const Ke=X0(He),nt=X0(Xe),Ct=Ke.find(xt=>nt.includes(xt));if(Ct)return{conflictingEvent:Xe,personName:Ct}}}}return null},[v]),Ne=(pe,ce)=>{if(pe.button!==0)return;Te.current=!1,document.body.classList.add(\\\\"no-select\\\\");const _e=pe.currentTarget.getBoundingClientRect(),Z=new Map,Fe=ce.instructor||\\\\"\\\\",Xe=i.findIndex(ft=>ft.name===Fe);Xe!==-1&&Z.set(ce.id,{startTime:ce.startTime,rowIndex:Xe}),Z.size>0&&W({mainEventId:ce.id,xOffset:(pe.clientX-_e.left)/u,initialPositions:Z})},Oe=pe=>{if(!O||!P.current)return;Te.current=!0;const ce=P.current.getBoundingClientRect(),_e=((pe.clientX-ce.left)/u-O.xOffset)/Si+fi,Z=fe.find(nt=>nt.id===O.mainEventId);if(!Z)return;let Fe=_e;Fe<fi&&(Fe=fi),Fe+Z.duration>ac&&(Fe=ac-Z.duration);const Xe=Math.round(Fe*12)/12,ft={...Z,startTime:Xe},tt=fe.filter(nt=>nt.id!==O.mainEventId),We=ge([ft],tt);V(We?{conflictingEventId:We.conflictingEvent.id,conflictedPersonName:We.personName}:null),Xe!==Z.startTime&&d([{eventId:O.mainEventId,newStartTime:Xe}])},se=()=>{document.body.classList.remove(\\\\"no-select\\\\"),W(null),V(null),setTimeout(()=>{Te.current=!1},0)},F=i.length;console.log(\\\\"\\\\ud83d\\\\udccf CALCULATING DIMENSIONS:\\\\"),console.log(\\\\"  - TOTAL_HOURS:\\\\",ry),console.log(\\\\"  - PIXELS_PER_HOUR:\\\\",Si),console.log(\\\\"  - zoomLevel:\\\\",u),console.log(\\\\"  - ROW_HEIGHT:\\\\",Cl),console.log(\\\\"  - totalRows (instructors.length):\\\\",F);const J=ry*Si*u,X=F*Cl;console.log(\\\\"\\\\ud83d\\\\udccf CALCULATED VALUES:\\\\"),console.log(\\\\"  - timelineWidth:\\\\",J),console.log(\\\\"  - containerHeight:\\\\",X);const ee=C.useCallback(pe=>{if(!pe||!/^\\\\\\\\d{2}:\\\\\\\\d{2}$/.test(pe))return null;const[ce,He]=pe.split(\\\\":\\\\").map(Number);return ce+He/60},[]),K=()=>{const pe=[];for(let _e=fi;_e<=ac;_e++)pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0 text-xs text-gray-500 flex items-center\\\\",style:{left:(_e-fi)*Si*u},children:e.jsx(\\\\"span\\\\",{className:\\\\"-translate-x-1/2\\\\",children:`${String(_e).padStart(2,\\\\"0\\\\")}:00`})},_e));const ce=ee(f.firstLight),He=ee(f.lastLight);if(ce!==null){const _e=(ce-fi)*Si*u;pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0 text-xs text-white font-bold flex items-center\\\\",style:{left:_e},children:e.jsx(\\\\"span\\\\",{className:\\\\"-translate-x-1/2\\\\",children:`FL ${f.firstLight}`})},\\\\"fl-label\\\\"))}if(He!==null){const _e=(He-fi)*Si*u;pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0 text-xs text-white font-bold flex items-center\\\\",style:{left:_e},children:e.jsx(\\\\"span\\\\",{className:\\\\"-translate-x-1/2\\\\",children:`LL ${f.lastLight}`})},\\\\"ll-label\\\\"))}return pe},ue=()=>{const pe=[];for(let ce=fi;ce<=ac;ce++)pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0\\\\",style:{left:(ce-fi)*Si*u},children:e.jsx(\\\\"div\\\\",{className:\\\\"w-px h-full bg-gray-700/50\\\\"})},`v-${ce}`)),ce<ac&&pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0\\\\",style:{left:(ce-fi+.5)*Si*u},children:e.jsx(\\\\"div\\\\",{className:\\\\"w-px h-full bg-gray-700/25\\\\"})},`v-${ce}-30`));for(let ce=1;ce<=F;ce++)pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute left-0 w-full bg-gray-700/25\\\\",style:{top:ce*Cl,height:\\\\"1px\\\\"}},`h-${ce}`));return pe},xe=()=>{const pe=ee(f.firstLight),ce=ee(f.lastLight);return e.jsxs(e.Fragment,{children:[pe!==null&&e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full z-[5] pointer-events-none border-l border-dashed border-white/30\\\\",style:{left:`${(pe-fi)*Si*u}px`}}),ce!==null&&e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full z-[5] pointer-events-none border-l border-dashed border-white/30\\\\",style:{left:`${(ce-fi)*Si*u}px`}})]})},Le=()=>{const pe=ee(f.firstLight),ce=ee(f.lastLight),He=[];if(pe!==null&&pe>fi){const _e=(pe-fi)*Si*u;He.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 left-0 h-full bg-white/5 pointer-events-none z-[1]\\\\",style:{width:`${_e}px`}},\\\\"night-shade-morning\\\\"))}if(ce!==null&&ce<ac){const _e=(ce-fi)*Si*u,Z=(ac-ce)*Si*u;He.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full bg-white/5 pointer-events-none z-[1]\\\\",style:{left:`${_e}px`,width:`${Z}px`}},\\\\"night-shade-evening\\\\"))}return e.jsx(e.Fragment,{children:He})},ye=()=>{const ce=parseFloat(localStorage.getItem(\\\\"timezoneOffset\\\\")||\\\\"0\\\\")*60*60*1e3,He=new Date(Date.now()+ce),_e=`${He.getUTCFullYear()}-${String(He.getUTCMonth()+1).padStart(2,\\\\"0\\\\")}-${String(He.getUTCDate()).padStart(2,\\\\"0\\\\")}`;if(n!==_e)return null;const Z=R,Fe=Z.getHours()+Z.getMinutes()/60+Z.getSeconds()/3600;if(Fe<fi||Fe>ac)return null;const Xe=(Fe-fi)*Si*u;return e.jsxs(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full z-[30] pointer-events-none\\\\",style:{left:`${Xe}px`},children:[e.jsx(\\\\"div\\\\",{className:\\\\"w-0.5 h-full bg-white animate-pulse\\\\"}),e.jsx(\\\\"div\\\\",{className:\\\\"absolute -top-2.5 -translate-x-1/2 w-0 h-0\\\\",style:{borderLeft:\\\\"5px solid transparent\\\\",borderRight:\\\\"5px solid transparent\\\\",borderTop:\\\\"7px solid white\\\\"}})]})};return console.log(\\\\"\\\\ud83c\\\\udfaf INSTRUCTOR SCHEDULE VIEW - About to render\\\\"),console.log(\\\\"\\\\ud83c\\\\udfaf Final calculations:\\\\"),console.log(\\\\"  - totalRows:\\\\",i==null?void 0:i.length),console.log(\\\\"  - timelineWidth:\\\\",typeof J<\\\\"u\\\\"?J:\\\\"NOT_CALCULATED\\\\"),console.log(\\\\"  - containerHeight:\\\\",typeof X<\\\\"u\\\\"?X:\\\\"NOT_CALCULATED\\\\"),typeof J>\\\\"u\\\\"&&console.error(\\\\"\\\\u274c CRITICAL: timelineWidth is undefined - this will cause rendering failure\\\\"),typeof X>\\\\"u\\\\"&&console.error(\\\\"\\\\u274c CRITICAL: containerHeight is undefined - this will cause rendering failure\\\\"),console.log(\\\\"\\\\ud83c\\\\udfaf Returning JSX...\\\\"),e.jsx(\\\\"div\\\\",{ref:_,className:\\\\"flex-1 overflow-auto relative bg-gray-900\\\\",children:e.jsxs(\\\\"div\\\\",{style:{width:`${iy+J}px`,height:`${J0+X}px`,display:\\\\"grid\\\\",gridTemplateColumns:`${iy}px 1fr`,gridTemplateRows:`${J0}px 1fr`},children:[e.jsx(\\\\"div\\\\",{className:\\\\"sticky top-0 left-0 z-40 bg-gray-800 border-r border-b border-gray-700 p-1\\\\",children:e.jsxs(\\\\"div\\\\",{className:\\\\"bg-gray-700 rounded-md w-full h-full flex items-center justify-center px-2 space-x-2\\\\",children:[e.jsx(\\\\"button\\\\",{onClick:()=>t(-1),className:\\\\"p-1 rounded-full hover:bg-gray-600 text-white flex-shrink-0\\\\",children:e.jsx(\\\\"svg\\\\",{xmlns:\\\\"http://www.w3.org/2000/svg\\\\",className:\\\\"h-4 w-4\\\\",viewBox:\\\\"0 0 20 20\\\\",fill:\\\\"currentColor\\\\",children:e.jsx(\\\\"path\\\\",{fillRule:\\\\"evenodd\\\\",d:\\\\"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z\\\\",clipRule:\\\\"evenodd\\\\"})})}),e.jsx(\\\\"span\\\\",{className:\\\\"flex-grow min-w-0 text-center font-semibold text-white cursor-default truncate\\\\",children:Y}),e.jsx(\\\\"button\\\\",{onClick:()=>t(1),className:\\\\"p-1 rounded-full hover:bg-gray-600 text-white flex-shrink-0\\\\",children:e.jsx(\\\\"svg\\\\",{xmlns:\\\\"http://www.w3.org/2000/svg\\\\",className:\\\\"h-4 w-4\\\\",viewBox:\\\\"0 0 20 20\\\\",fill:\\\\"currentColor\\\\",children:e.jsx(\\\\"path\\\\",{fillRule:\\\\"evenodd\\\\",d:\\\\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\\\\",clipRule:\\\\"evenodd\\\\"})})})]})}),e.jsxs(\\\\"div\\\\",{className:\\\\"sticky top-0 z-20 bg-gray-800 border-b border-gray-700\\\\",children:[\\\\" \\\\",e.jsx(\\\\"div\\\\",{className:\\\\"relative\\\\",style:{width:J,height:J0},children:K()})]}),e.jsxs(\\\\"div\\\\",{className:\\\\"sticky left-0 z-30 bg-gray-800 border-r border-gray-700\\\\",children:[\\\\" \\\\",e.jsx(Iv,{personnel:i,rowHeight:Cl,onPersonClick:E,onRowEnter:M,onRowLeave:()=>M(null),showUnits:!1,useUnitColors:!0})]}),e.jsxs(\\\\"div\\\\",{ref:P,className:\\\\"relative\\\\",onMouseMove:Oe,onMouseUp:se,onMouseLeave:se,children:[ue(),Le(),xe(),ye(),i.flatMap((pe,ce)=>{const He=$===ce?e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 left-0 right-0 pointer-events-none z-10\\\\",style:{height:Cl,top:ce*Cl,backgroundColor:\\\\"rgba(255, 255, 255, 0.05)\\\\"}},`row-highlight-${ce}`):null,_e=[];if(y){const Xe=fe.filter(ft=>ft.instructor===pe.name).sort((ft,tt)=>ft.startTime-tt.startTime);for(let ft=0;ft<Xe.length;ft++){const tt=Xe[ft],We=Xe[ft-1],Ke=Xe[ft+1],nt=v.find(kt=>kt.id===tt.flightNumber);if(!nt)continue;const Ct=We&&(()=>{const kt=v.find(vt=>vt.id===We.flightNumber);if(!kt)return!1;const Ge=We.startTime+We.duration+kt.postFlightTime,ht=tt.startTime-nt.preFlightTime;return Ge>ht})(),xt=Ke&&(()=>{const kt=v.find(vt=>vt.id===Ke.flightNumber);if(!kt)return!1;const Ge=tt.startTime+tt.duration+nt.postFlightTime,ht=Ke.startTime-kt.preFlightTime;return Ge>ht})();if(!(U===tt.id)&&!(Ct||xt))continue;const st=(kt,Ge,ht,vt)=>{const Ht=kt*Si*u,ze=Cl*.25,we=ce*Cl+(Cl-ze)/2,Re=(Ge-fi)*Si*u,Ze=`absolute pointer-events-none z-20 rounded-full border shadow-lg backdrop-blur-sm transition-colors duration-200 ${ht?\\\\"bg-red-500/50 border-red-400/30\\\\":\\\\"bg-white/50 border-white/30\\\\"}`,ot={left:`${Re}px`,top:`${we}px`,width:`${Ht}px`,height:`${ze}px`};_e.push(e.jsx(\\\\"div\\\\",{style:ot,className:Ze},vt))};if(nt.preFlightTime>0){const kt=tt.startTime-nt.preFlightTime;st(nt.preFlightTime,kt,Ct||!1,`${tt.id}-pre-${ce}`)}if(nt.postFlightTime>0){const kt=tt.startTime+tt.duration;st(nt.postFlightTime,kt,xt||!1,`${tt.id}-post-${ce}`)}}}const Fe=fe.filter(Xe=>Xe.instructor===pe.name||Xe.flightType===\\\\"Dual\\\\"&&Xe.student===pe.name).sort((Xe,ft)=>Xe.startTime-ft.startTime).map(Xe=>{const ft=!!(O&&O.mainEventId===Xe.id),tt=Xe.id===(ne==null?void 0:ne.conflictingEventId),We=y&&x.has(Xe.id)||tt||ft&&!!ne,Ke=T.get(Xe.id),nt=!!Ke,Ct=Ke||[];let xt=null;if(ne){const dn=X0(Xe);(ft||tt)&&dn.includes(ne.conflictedPersonName)&&(xt=ne.conflictedPersonName)}return e.jsx(Gc,{event:Xe,traineesData:A,onSelectEvent:()=>{Te.current||l(Xe)},onMouseDown:dn=>Ne(dn,Xe),onMouseEnter:()=>D(Xe.id),onMouseLeave:()=>D(null),pixelsPerHour:Si*u,rowHeight:Cl,startHour:fi,row:ce,isDragging:ft,isConflicting:We,isUnavailabilityConflict:nt,unavailablePersonnel:Ct,conflictedPersonnelName:xt,personnelData:h,seatConfigs:m,isDraggable:!0,currentTime:R},`${Xe.id}-${pe.name}`)});return[He,..._e,...Fe]})]})]})})},Lv=({trainees:n,rowHeight:t,onRowEnter:s,onRowLeave:i,onTraineeClick:o,onRowRef:l,courseColors:d={}})=>{const u=h=>{const m=h.split(\\\\" \\\\u2013 \\\\");return{name:m[0]||h,course:m[1]||\\\\"\\\\"}},f=h=>({\\\\"bg-sky-400/50\\\\":\\\\"#38BDF8\\\\",\\\\"bg-purple-400/50\\\\":\\\\"#C084FC\\\\",\\\\"bg-yellow-400/50\\\\":\\\\"#FACC15\\\\",\\\\"bg-pink-400/50\\\\":\\\\"#F472B6\\\\",\\\\"bg-teal-400/50\\\\":\\\\"#2DD4BF\\\\",\\\\"bg-indigo-400/50\\\\":\\\\"#818CF8\\\\",\\\\"bg-cyan-400/50\\\\":\\\\"#22D3EE\\\\",\\\\"bg-blue-400/50\\\\":\\\\"#60A5FA\\\\",\\\\"bg-green-400/50\\\\":\\\\"#4ADE80\\\\",\\\\"bg-orange-400/50\\\\":\\\\"#FB923C\\\\",\\\\"bg-red-400/50\\\\":\\\\"#F87171\\\\",\\\\"bg-gray-400/50\\\\":\\\\"#9CA3AF\\\\"})[h]||\\\\"#9CA3AF\\\\";return e.jsx(\\\\"div\\\\",{className:\\\\"w-40 bg-gray-800 flex-shrink-0 h-full\\\\",children:e.jsx(\\\\"ul\\\\",{children:n.map((h,m)=>{const{name:v,course:x}=u(h);return e.jsx(\\\\"li\\\\",{ref:y=>l==null?void 0:l(h,y),className:`flex items-center justify-start pl-3 text-xs transition-colors duration-150 text-gray-300 border-b border-gray-700/50 ${o?\\\\"cursor-pointer hover:bg-gray-700\\\\":\\\\"\\\\"}`,style:{height:t},onMouseEnter:()=>s==null?void 0:s(m),onMouseLeave:()=>i==null?void 0:i(),onClick:()=>o==null?void 0:o(h),children:e.jsxs(\\\\"div\\\\",{className:\\\\"flex flex-col\\\\",children:[e.jsx(\\\\"span\\\\",{className:\\\\"truncate font-medium leading-tight\\\\",children:v}),x&&e.jsx(\\\\"span\\\\",{className:\\\\"font-mono leading-tight\\\\",style:{color:f(d[x]||\\\\"bg-gray-400/50\\\\")},children:x})]})})})})})},Di=200,ec=32,hi=0,oc=24,lw=oc-hi,ay=160,K0=40,Z0=n=>{const t=[];return n.flightType===\\\\"Solo\\\\"?n.pilot&&t.push(n.pilot):(n.instructor&&t.push(n.instructor),n.student&&t.push(n.student)),t},cw=(n,t)=>{const s=[];return t.forEach(i=>{(i.unavailability||[]).forEach(l=>{const d=new Date(n+\\\\"T00:00:00Z\\\\"),u=new Date(l.startDate+\\\\"T00:00:00Z\\\\"),f=new Date(l.endDate+\\\\"T00:00:00Z\\\\"),h=new Date(f);if(l.allDay&&h.setDate(h.getDate()-1),d>=u&&d<=h){let m=l.allDay?.0167:parseFloat(l.startTime)/100,v=l.allDay?23.983:parseFloat(l.endTime)/100;l.allDay||(d.getTime()===u.getTime()&&d.getTime()===h.getTime()?(m=l.startTime?parseFloat(l.startTime)/100:.0167,v=l.endTime?parseFloat(l.endTime)/100:23.983):d.getTime()===u.getTime()&&l.startTime?(m=parseFloat(l.startTime)/100,v=23.983):d.getTime()===h.getTime()&&l.endTime?(m=.0167,v=parseFloat(l.endTime)/100):d>u&&d<h&&(m=.0167,v=23.983));const x=v-m,y={id:`unavailability-${i.fullName}-${l.id}`,date:n,startTime:m,duration:x,type:\\\\"unavailability\\\\",student:i.fullName,pilot:i.fullName,flightNumber:\\\\"UNAVAIL\\\\",resourceName:i.fullName,resourceId:`TRAINEE-${i.fullName}`,eventType:\\\\"UNAVAILABILITY\\\\",allDay:l.allDay,reason:l.reason,notes:l.notes};s.push(y)}})}),s},dw=({date:n,onDateChange:t,events:s,trainees:i,onSelectEvent:o,onUpdateEvent:l,zoomLevel:d,daylightTimes:u,personnelData:f,seatConfigs:h,syllabusDetails:m,conflictingEventIds:v,showValidation:x,unavailabilityConflicts:y,onSelectTrainee:T,traineesData:E,courseColors:A})=>{const _=C.useRef(null),[R,H]=C.useState(new Date),[O,W]=C.useState(null),[ne,V]=C.useState(null),[U,D]=C.useState(null),[$,M]=C.useState(null),P=C.useRef(null),ae=C.useRef(!0),Q=C.useRef(d),Te=C.useRef(!1);C.useEffect(()=>{const pe=setInterval(()=>H(new Date),1e3);return()=>clearInterval(pe)},[]);const Y=C.useMemo(()=>{const[pe,ce,He]=n.split(\\\\"-\\\\").map(Number);return new Date(Date.UTC(pe,ce-1,He)).toLocaleDateString(\\\\"en-GB\\\\",{day:\\\\"2-digit\\\\",month:\\\\"short\\\\",timeZone:\\\\"UTC\\\\"})},[n]),fe=C.useMemo(()=>{const pe=cw(n,E);return[...s,...pe]},[n,s,E]);C.useEffect(()=>{const pe=_.current;if(pe){if(ae.current){const He=(8-hi)*Di*d;pe.scrollLeft=He,ae.current=!1}else{const ce=Q.current;if(ce===d)return;const{scrollLeft:He,clientWidth:_e}=pe,Fe=(He+_e/2)/(Di*ce)*Di*d-_e/2;pe.scrollLeft=Fe}Q.current=d}},[d]);const ge=C.useCallback((pe,ce)=>{for(const He of pe){const _e=m.find(Xe=>Xe.id===He.flightNumber);if(!_e)continue;const Z=He.startTime-_e.preFlightTime,Fe=He.startTime+He.duration+_e.postFlightTime;for(const Xe of ce){const ft=m.find(Ke=>Ke.id===Xe.flightNumber);if(!ft)continue;const tt=Xe.startTime-ft.preFlightTime,We=Xe.startTime+Xe.duration+ft.postFlightTime;if(Z<We&&Fe>tt){const Ke=Z0(He),nt=Z0(Xe),Ct=Ke.find(xt=>nt.includes(xt));if(Ct)return{conflictingEvent:Xe,personName:Ct}}}}return null},[m]),Ne=(pe,ce)=>{if(pe.button!==0)return;Te.current=!1,document.body.classList.add(\\\\"no-select\\\\");const _e=pe.currentTarget.getBoundingClientRect(),Z=new Map,Fe=ce.student||ce.pilot||\\\\"\\\\",Xe=i.findIndex(ft=>ft===Fe);Xe!==-1&&Z.set(ce.id,{startTime:ce.startTime,rowIndex:Xe}),Z.size>0&&W({mainEventId:ce.id,xOffset:(pe.clientX-_e.left)/d,initialPositions:Z})},Oe=pe=>{if(!O||!P.current)return;Te.current=!0;const ce=P.current.getBoundingClientRect(),_e=((pe.clientX-ce.left)/d-O.xOffset)/Di+hi,Z=fe.find(nt=>nt.id===O.mainEventId);if(!Z)return;let Fe=_e;Fe<hi&&(Fe=hi),Fe+Z.duration>oc&&(Fe=oc-Z.duration);const Xe=Math.round(Fe*12)/12,ft={...Z,startTime:Xe},tt=fe.filter(nt=>nt.id!==O.mainEventId),We=ge([ft],tt);V(We?{conflictingEventId:We.conflictingEvent.id,conflictedPersonName:We.personName}:null),Xe!==Z.startTime&&l([{eventId:O.mainEventId,newStartTime:Xe}])},se=()=>{document.body.classList.remove(\\\\"no-select\\\\"),W(null),V(null),setTimeout(()=>{Te.current=!1},0)},F=i.length,J=lw*Di*d,X=F*ec,ee=C.useCallback(pe=>{if(!pe||!/^\\\\\\\\d{2}:\\\\\\\\d{2}$/.test(pe))return null;const[ce,He]=pe.split(\\\\":\\\\").map(Number);return ce+He/60},[]),K=()=>{const pe=[];for(let _e=hi;_e<=oc;_e++)pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0 text-xs text-gray-500 flex items-center\\\\",style:{left:(_e-hi)*Di*d},children:e.jsx(\\\\"span\\\\",{className:\\\\"-translate-x-1/2\\\\",children:`${String(_e).padStart(2,\\\\"0\\\\")}:00`})},_e));const ce=ee(u.firstLight),He=ee(u.lastLight);if(ce!==null){const _e=(ce-hi)*Di*d;pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0 text-xs text-white font-bold flex items-center\\\\",style:{left:_e},children:e.jsx(\\\\"span\\\\",{className:\\\\"-translate-x-1/2\\\\",children:`FL ${u.firstLight}`})},\\\\"fl-label\\\\"))}if(He!==null){const _e=(He-hi)*Di*d;pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0 text-xs text-white font-bold flex items-center\\\\",style:{left:_e},children:e.jsx(\\\\"span\\\\",{className:\\\\"-translate-x-1/2\\\\",children:`LL ${u.lastLight}`})},\\\\"ll-label\\\\"))}return pe},ue=()=>{const pe=[];for(let ce=hi;ce<=oc;ce++)pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0\\\\",style:{left:(ce-hi)*Di*d},children:e.jsx(\\\\"div\\\\",{className:\\\\"w-px h-full bg-gray-700/50\\\\"})},`v-${ce}`)),ce<oc&&pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute h-full top-0\\\\",style:{left:(ce-hi+.5)*Di*d},children:e.jsx(\\\\"div\\\\",{className:\\\\"w-px h-full bg-gray-700/25\\\\"})},`v-${ce}-30`));for(let ce=1;ce<=F;ce++)pe.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute left-0 w-full bg-gray-700/25\\\\",style:{top:ce*ec,height:\\\\"1px\\\\"}},`h-${ce}`));return pe},xe=()=>{const pe=ee(u.firstLight),ce=ee(u.lastLight);return e.jsxs(e.Fragment,{children:[pe!==null&&e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full z-[5] pointer-events-none border-l border-dashed border-white/30\\\\",style:{left:`${(pe-hi)*Di*d}px`}}),ce!==null&&e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full z-[5] pointer-events-none border-l border-dashed border-white/30\\\\",style:{left:`${(ce-hi)*Di*d}px`}})]})},Le=()=>{const pe=ee(u.firstLight),ce=ee(u.lastLight),He=[];if(pe!==null&&pe>hi){const _e=(pe-hi)*Di*d;He.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 left-0 h-full bg-white/5 pointer-events-none z-[1]\\\\",style:{width:`${_e}px`}},\\\\"night-shade-morning\\\\"))}if(ce!==null&&ce<oc){const _e=(ce-hi)*Di*d,Z=(oc-ce)*Di*d;He.push(e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full bg-white/5 pointer-events-none z-[1]\\\\",style:{left:`${_e}px`,width:`${Z}px`}},\\\\"night-shade-evening\\\\"))}return e.jsx(e.Fragment,{children:He})},ye=()=>{const ce=parseFloat(localStorage.getItem(\\\\"timezoneOffset\\\\")||\\\\"0\\\\")*60*60*1e3,He=new Date(Date.now()+ce),_e=`${He.getUTCFullYear()}-${String(He.getUTCMonth()+1).padStart(2,\\\\"0\\\\")}-${String(He.getUTCDate()).padStart(2,\\\\"0\\\\")}`;if(n!==_e)return null;const Z=R,Fe=Z.getHours()+Z.getMinutes()/60+Z.getSeconds()/3600;if(Fe<hi||Fe>oc)return null;const Xe=(Fe-hi)*Di*d;return e.jsxs(\\\\"div\\\\",{className:\\\\"absolute top-0 h-full z-[30] pointer-events-none\\\\",style:{left:`${Xe}px`},children:[e.jsx(\\\\"div\\\\",{className:\\\\"w-0.5 h-full bg-white animate-pulse\\\\"}),e.jsx(\\\\"div\\\\",{className:\\\\"absolute -top-2.5 -translate-x-1/2 w-0 h-0\\\\",style:{borderLeft:\\\\"5px solid transparent\\\\",borderRight:\\\\"5px solid transparent\\\\",borderTop:\\\\"7px solid white\\\\"}})]})};return e.jsx(\\\\"div\\\\",{ref:_,className:\\\\"flex-1 overflow-auto relative bg-gray-900\\\\",children:e.jsxs(\\\\"div\\\\",{style:{width:`${ay+J}px`,height:`${K0+X}px`,display:\\\\"grid\\\\",gridTemplateColumns:`${ay}px 1fr`,gridTemplateRows:`${K0}px 1fr`},children:[e.jsx(\\\\"div\\\\",{className:\\\\"sticky top-0 left-0 z-40 bg-gray-800 border-r border-b border-gray-700 p-1\\\\",children:e.jsxs(\\\\"div\\\\",{className:\\\\"bg-gray-700 rounded-md w-full h-full flex items-center justify-center px-2 space-x-2\\\\",children:[e.jsx(\\\\"button\\\\",{onClick:()=>t(-1),className:\\\\"p-1 rounded-full hover:bg-gray-600 text-white flex-shrink-0\\\\",children:e.jsx(\\\\"svg\\\\",{xmlns:\\\\"http://www.w3.org/2000/svg\\\\",className:\\\\"h-4 w-4\\\\",viewBox:\\\\"0 0 20 20\\\\",fill:\\\\"currentColor\\\\",children:e.jsx(\\\\"path\\\\",{fillRule:\\\\"evenodd\\\\",d:\\\\"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z\\\\",clipRule:\\\\"evenodd\\\\"})})}),e.jsx(\\\\"span\\\\",{className:\\\\"flex-grow min-w-0 text-center font-semibold text-white cursor-default truncate\\\\",children:Y}),e.jsx(\\\\"button\\\\",{onClick:()=>t(1),className:\\\\"p-1 rounded-full hover:bg-gray-600 text-white flex-shrink-0\\\\",children:e.jsx(\\\\"svg\\\\",{xmlns:\\\\"http://www.w3.org/2000/svg\\\\",className:\\\\"h-4 w-4\\\\",viewBox:\\\\"0 0 20 20\\\\",fill:\\\\"currentColor\\\\",children:e.jsx(\\\\"path\\\\",{fillRule:\\\\"evenodd\\\\",d:\\\\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\\\\",clipRule:\\\\"evenodd\\\\"})})})]})}),e.jsx(\\\\"div\\\\",{className:\\\\"sticky top-0 z-20 bg-gray-800 border-b border-gray-700\\\\",children:e.jsx(\\\\"div\\\\",{className:\\\\"relative\\\\",style:{width:J,height:K0},children:K()})}),e.jsx(\\\\"div\\\\",{className:\\\\"sticky left-0 z-30 bg-gray-800 border-r border-gray-700\\\\",children:e.jsx(Lv,{trainees:i,rowHeight:ec,onTraineeClick:T,courseColors:A,onRowEnter:M,onRowLeave:()=>M(null)})}),e.jsxs(\\\\"div\\\\",{ref:P,className:\\\\"relative\\\\",onMouseMove:Oe,onMouseUp:se,onMouseLeave:se,children:[ue(),Le(),xe(),ye(),i.flatMap((pe,ce)=>{const He=$===ce?e.jsx(\\\\"div\\\\",{className:\\\\"absolute top-0 left-0 right-0 pointer-events-none z-10\\\\",style:{height:ec,top:ce*ec,backgroundColor:\\\\"rgba(255, 255, 255, 0.05)\\\\"}},`row-highlight-${ce}`):null,_e=[];if(x){const Xe=s.filter(ft=>ft.student===pe||ft.flightType===\\\\"Solo\\\\"&&ft.pilot===pe).sort((ft,tt)=>ft.startTime-tt.startTime);for(let ft=0;ft<Xe.length;ft++){const tt=Xe[ft],We=Xe[ft-1],Ke=Xe[ft+1],nt=m.find(kt=>kt.id===tt.flightNumber);if(!nt)continue;const Ct=We&&(()=>{const kt=m.find(vt=>vt.id===We.flightNumber);if(!kt)return!1;const Ge=We.startTime+We.duration+kt.postFlightTime,ht=tt.startTime-nt.preFlightTime;return Ge>ht})(),xt=Ke&&(()=>{const kt=m.find(vt=>vt.id===Ke.flightNumber);if(!kt)return!1;const Ge=tt.startTime+tt.duration+nt.postFlightTime,ht=Ke.startTime-kt.preFlightTime;return Ge>ht})();if(!(U===tt.id)&&!(Ct||xt))continue;const st=(kt,Ge,ht,vt)=>{const Ht=kt*Di*d,ze=ec*.25,we=ce*ec+(ec-ze)/2,Re=(Ge-hi)*Di*d,Ze=`absolute pointer-events-none z-20 rounded-full border shadow-lg backdrop-blur-sm transition-colors duration-200 ${ht?\\\\"bg-red-500/50 border-red-400/30\\\\":\\\\"bg-white/50 border-white/30\\\\"}`,ot={left:`${Re}px`,top:`${we}px`,width:`${Ht}px`,height:`${ze}px`};_e.push(e.jsx(\\\\"div\\\\",{style:ot,className:Ze},vt))};if(nt.preFlightTime>0){const kt=tt.startTime-nt.preFlightTime;st(nt.preFlightTime,kt,Ct||!1,`${tt.id}-pre-${ce}`)}if(nt.postFlightTime>0){const kt=tt.startTime+tt.duration;st(nt.postFlightTime,kt,xt||!1,`${tt.id}-post-${ce}`)}}}const Fe=fe.filter(Xe=>Xe.student===pe||Xe.flightType===\\\\"Solo\\\\"&&Xe.pilot===pe).sort((Xe,ft)=>Xe.startTime-ft.startTime).map(Xe=>{const ft=!!(O&&O.mainEventId===Xe.id),tt=Xe.id===(ne==null?void 0:ne.conflictingEventId),We=x&&v.has(Xe.id)||tt||ft&&!!ne,Ke=y.get(Xe.id),nt=!!Ke,Ct=Ke||[];let xt=null;if(ne){const dn=Z0(Xe);(ft||tt)&&dn.includes(ne.conflictedPersonName)&&(xt=ne.conflictedPersonName)}return e.jsx(Gc,{event:Xe,traineesData:E,onSelectEvent:()=>{Te.current||o(Xe)},onMouseDown:dn=>Ne(dn,Xe),onMouseEnter:()=>D(Xe.id),onMouseLeave:()=>D(null),pixelsPerHour:Di*d,rowHeight:ec,startHour:hi,row:ce,isDragging:ft,isConflicting:We,isUnavailabilityConflict:nt,unavailablePersonnel:Ct,conflictedPersonnelName:xt,personnelData:f,seatConfigs:h,isDraggable:!0,currentTime:R},`${Xe.id}-${pe}`)});return[He,..._e,...Fe]})]})]})})};function oy(n,t,s,i,o,l){const d=[],u=[];n||d.push({type:\\\\"error\\\\",field:\\\\"startDate\\\\",message:\\\\"Start date is required\\\\",remediation:\\\\"Please select a start date from the calendar\\\\"}),t||d.push({type:\\\\"error\\\\",field:\\\\"endDate\\\\",message:\\\\"End date is required\\\\",remediation:\\\\"Please select an end date from the calendar\\\\"});const f=(E,A)=>{if(!E)return!0;if(E.length!==4)return d.push({type:\\\\"error\\\\",field:A,message:`Invalid ${A===\\\\"startTime\\\\"?\\\\"start\\\\":\\\\"end\\\\"} time format`,remediation:\\\\"Time must be exactly 4 digits in HHMM format (e.g., 0900 for 9:00 AM, 1400 for 2:00 PM)\\\\"}),!1;const _=parseInt(E.substring(0,2)),R=parseInt(E.substring(2,4));return isNaN(_)||isNaN(R)?(d.push({type:\\\\"error\\\\",field:A,message:`Invalid ${A===\\\\"startTime\\\\"?\\\\"start\\\\":\\\\"end\\\\"} time values`,remediation:\\\\"Time must contain only numbers. Hours (00-23) and minutes (00-59)\\\\"}),!1):_<0||_>23?(d.push({type:\\\\"error\\\\",field:A,message:`${A===\\\\"startTime\\\\"?\\\\"Start\\\\":\\\\"End\\\\"} hour out of range`,remediation:\\\\"Hours must be between 00 and 23. Use 24-hour format (e.g., 09 for 9 AM, 14 for 2 PM, 23 for 11 PM)\\\\"}),!1):R<0||R>59?(d.push({type:\\\\"error\\\\",field:A,message:`${A===\\\\"startTime\\\\"?\\\\"Start\\\\":\\\\"End\\\\"} minutes out of range`,remediation:\\\\"Minutes must be between 00 and 59 (e.g., 00, 15, 30, 45)\\\\"}),!1):!0},h=f(s,\\\\"startTime\\\\"),m=f(i,\\\\"endTime\\\\");if(d.some(E=>E.field===\\\\"startTime\\\\"||E.field===\\\\"endDate\\\\"||E.field===\\\\"startDate\\\\"))return{isValid:!1,errors:d,warnings:u};const v=new Date(n+\\\\"T00:00:00Z\\\\"),x=new Date(t+\\\\"T00:00:00Z\\\\");if(x<v)return d.push({type:\\\\"error\\\\",field:\\\\"endDate\\\\",message:\\\\"End date cannot be before start date\\\\",remediation:\\\\"Select an end date that is the same as or after the start date\\\\"}),{isValid:!1,errors:d,warnings:u};const y=!s&&!i;if(y&&x.getTime()===v.getTime()&&d.push({type:\\\\"error\\\\",field:\\\\"endDate\\\\",message:\\\\"All-day unavailability must span at least one full day\\\\",remediation:\\\\"For a single all-day unavailability, set the end date to the next day. Example: If unavailable on Dec 15, set start date to Dec 15 and end date to Dec 16.\\\\"}),!y&&h&&m){const E=parseFloat(s)/100,A=parseFloat(i)/100;E>=A&&v.getTime()===x.getTime()&&d.push({type:\\\\"error\\\\",field:\\\\"endTime\\\\",message:\\\\"End time must be after start time for same-day events\\\\",remediation:\\\\"Set an end time that is later than the start time. Example: Start 0900, End 1200\\\\"}),(E<6||A>22)&&u.push({type:\\\\"warning\\\\",field:\\\\"startTime\\\\",message:\\\\"Unavailability times are outside normal operating hours\\\\",remediation:\\\\"Consider if these times are correct. Normal operating hours are 0600-2200 (6:00 AM - 10:00 PM)\\\\"}),E>0&&A>0&&A-E<.5&&u.push({type:\\\\"warning\\\\",field:\\\\"startTime\\\\",message:\\\\"Very short unavailability period\\\\",remediation:\\\\"This is less than 30 minutes. Consider if this duration is correct or if it should be longer\\\\"}),v.getTime()!==x.getTime()&&E>0&&A<23.983&&u.push({type:\\\\"warning\\\\",field:\\\\"endTime\\\\",message:\\\\"Multi-day timed event with specific end time\\\\",remediation:\\\\"For multi-day unavailability, consider using full-day (0001-2359) or setting end time to 2359 for last day\\\\"})}if((!o||o.trim()===\\\\"\\\\")&&d.push({type:\\\\"error\\\\",field:\\\\"general\\\\",message:\\\\"Reason for unavailability is required\\\\",remediation:\\\\"Please select a reason from the dropdown menu\\\\"}),l&&l.length>0){const E=uw({startDate:n,endDate:t,allDay:y},l);E.length>0&&u.push({type:\\\\"warning\\\\",field:\\\\"overlap\\\\",message:`Overlaps with ${E.length} existing unavailability period(s)`,remediation:\\\\"Review existing unavailability periods to avoid duplication. Overlapping periods may not display correctly in the schedule.\\\\"})}return Math.ceil((x.getTime()-v.getTime())/(1e3*60*60*24))>30&&u.push({type:\\\\"warning\\\\",field:\\\\"endDate\\\\",message:\\\\"Very long unavailability period\\\\",remediation:\\\\"This unavailability spans more than 30 days. Please verify this is correct or consider breaking it into shorter periods\\\\"}),{isValid:d.length===0,errors:d,warnings:u}}function uw(n,t){const s=[];for(const i of t)fw(n,i)&&s.push(i);return s}function fw(n,t){const s=new Date(n.startDate+\\\\"T00:00:00Z\\\\"),i=new Date(n.endDate+\\\\"T00:00:00Z\\\\"),o=new Date(t.startDate+\\\\"T00:00:00Z\\\\"),l=new Date(t.endDate+\\\\"T00:00:00Z\\\\");return n.allDay&&i.setUTCDate(i.getUTCDate()-1),t.allDay&&l.setUTCDate(l.getUTCDate()-1),s<=l&&o<=i}const hw=({validation:n,className:t=\\\\"\\\\"})=>{if(n.isValid)return null;const s=()=>e.jsx(\\\\"svg\\\\",{className:\\\\"w-5 h-5 text-red-400 flex-shrink-0\\\\",fill:\\\\"currentColor\\\\",viewBox:\\\\"0 0 20 20\\\\",children:e.jsx(\\\\"path\\\\",{fillRule:\\\\"evenodd\\\\",d:\\\\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\\\\",clipRule:\\\\"evenodd\\\\"})}),i=()=>e.jsx(\\\\"svg\\\\",{className:\\\\"w-5 h-5 text-yellow-400 flex-shrink-0\\\\",fill:\\\\"currentColor\\\\",viewBox:\\\\"0 0 20 20\\\\",children:e.jsx(\\\\"path\\\\",{fillRule:\\\\"evenodd\\\\",d:\\\\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\\\\",clipRule:\\\\"evenodd\\\\"})}),o=()=>e.jsx(\\\\"svg\\\\",{className:\\\\"w-4 h-4 text-gray-400 flex-shrink-0\\\\",fill:\\\\"currentColor\\\\",viewBox:\\\\"0 0 20 20\\\\",children:e.jsx(\\\\"path\\\\",{fillRule:\\\\"evenodd\\\\",d:\\\\"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z\\\\",clipRule:\\\\"evenodd\\\\"})});return e.jsxs(\\\\"div\\\\",{className:`space-y-3 ${t}`,children:[n.errors.length>0&&e.jsx(\\\\"div\\\\",{className:\\\\"bg-red-900/20 border border-red-700 rounded-lg p-4\\\\",children:e.jsxs(\\\\"div\\\\",{className:\\\\"flex items-start space-x-3\\\\",children:[e.jsx(s,{}),e.jsxs(\\\\"div\\\\",{className:\\\\"flex-1\\\\",children:[e.jsxs(\\\\"h4\\\\",{className:\\\\"text-red-400 font-semibold mb-2\\\\",children:[\\\\"Data Entry Errors (\\\\",n.errors.length,\\\\")\\\\"]}),e.jsx(\\\\"div\\\\",{className:\\\\"space-y-2\\\\",children:n.errors.map((l,d)=>e.jsxs(\\\\"div\\\\",{className:\\\\"text-sm\\\\",children:[e.jsx(\\\\"p\\\\",{className:\\\\"text-red-300 font-medium\\\\",children:l.message}),e.jsxs(\\\\"div\\\\",{className:\\\\"flex items-start mt-1 space-x-2\\\\",children:[e.jsx(o,{}),e.jsx(\\\\"p\\\\",{className:\\\\"text-red-200\\\\",children:l.remediation})]})]},d))})]})]})}),n.warnings.length>0&&e.jsx(\\\\"div\\\\",{className:\\\\"bg-yellow-900/20 border border-yellow-700 rounded-lg p-4\\\\",children:e.jsxs(\\\\"div\\\\",{className:\\\\"flex items-start space-x-3\\\\",children:[e.jsx(i,{}),e.jsxs(\\\\"div\\\\",{className:\\\\"flex-1\\\\",children:[e.jsxs(\\\\"h4\\\\",{className:\\\\"text-yellow-400 font-semibold mb-2\\\\",children:[\\\\"Warnings (\\\\",n.warnings.length,\\\\")\\\\"]}),e.jsx(\\\\"div\\\\",{className:\\\\"space-y-2\\\\",children:n.warnings.map((l,d)=>e.jsxs(\\\\"div\\\\",{className:\\\\"text-sm\\\\",children:[e.jsx(\\\\"p\\\\",{className:\\\\"text-yellow-300 font-medium\\\\",children:l.message}),e.jsxs(\\\\"div\\\\",{className:\\\\"flex items-start mt-1 space-x-2\\\\",children:[e.jsx(o,{}),e.jsx(\\\\"p\\\\",{className:\\\\"text-yellow-200\\\\",children:l.remediation})]})]},d))})]})]})})]})},Mv=({onClose:n,onTodayOnly:t,onSave:s,unavailabilityPeriods:i,onRemove:o})=>{const[l,d]=C.useState(\\\\"\\\\"),[u,f]=C.useState(\\\\"\\\\"),[h,m]=C.useState(\\\\"\\\\"),[v,x]=C.useState(\\\\"\\\\"),[y,T]=C.useState(\\\\"Appointment\\\\"),[E,A]=C.useState(null),[_,R]=C.useState(!1),H=[\\\\"TMUF\\\\",\\\\"TMUF - Ground Duties only\\\\",\\\\"Leave\\\\",\\\\"Appointment\\\\",\\\\"Other\\\\"],O=()=>{d(\\\\"\\\\"),f(\\\\"\\\\"),m(\\\\"\\\\"),x(\\\\"\\\\"),T(\\\\"Appointment\\\\"),A(null),R(!1)},W=()=>{if(l||u||h||v){const D=oy(l,u,h,v,y,i);A(D)}else A(null)};Ua.useEffect(()=>{_&&W()},[l,u,h,v,y,_]);const ne=()=>{console.log(\\\\"handleSave called\\\\",{startDate:l,endDate:u,startTime:h,endTime:v,reason:y});const D=oy(l,u,h,v,y,i);if(A(D),R(!0),!D.isValid){if(D.errors[0]){const P=document.getElementById(\\\\"validation-errors\\\\");P==null||P.scrollIntoView({behavior:\\\\"smooth\\\\",block:\\\\"nearest\\\\"})}return}if(D.warnings.length>0&&!window.confirm(`This unavailability has ${D.warnings.length} warning(s):\\\\n",\\n  "exit_code": 0,\\n  "cwd": "/workspace"\\n}\') </execute-command> </tool_result>'}
{'role': 'user', 'content': '<tool_result> <execute-command> ToolResult(success=True, output=\'{\\n  "output": "                                                onFocus={handleSyllabusFocus}\\\\n                                                disabled={isDeploy || (isOracleContext && filteredSyllabusOptions.length === 0)}\\\\n                                                className={`mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm disabled:bg-gray-700/50 disabled:cursor-not-allowed`}\\\\n                                            >\\\\n                                                <option value=\\\\"\\\\" disabled>\\\\n                                                    {isOracleContext ? \\\'Select a crew member first\\\' : \\\'Select an item\\\'}\\\\n                                                </option>\\\\n                                                {isAddingTile && <option value=\\\\"SCT FORM\\\\">SCT FORM</option>}\\\\n                                                {filteredSyllabusOptions.filter(item => item !== \\\'SCT FORM\\\').map(item => <option key={item} value={item}>{item}</option>)}\\\\n                                            </select>\\\\n                                            {syllabusSelectionError && (\\\\n                                                <div className=\\\\"absolute -bottom-6 left-0 text-xs text-red-400 animate-fade-in\\\\">Select a crew member first.</div>\\\\n                                            )}\\\\n                                        </div>\\\\n                                        {eventType === \\\'flight\\\' && (\\\\n                                        <>\\\\n                                        <div>\\\\n                                            <label className=\\\\"block text-sm font-medium text-gray-400\\\\">Area</label>\\\\n                                            <select value={area} onChange={e => setArea(e.target.value)} disabled={isDeploy} className=\\\\"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm disabled:bg-gray-700/50 disabled:cursor-not-allowed\\\\">\\\\n                                                {areas.map(a => <option key={a} value={a}>{a}</option>)}\\\\n                                            </select>\\\\n                                        </div>\\\\n                                        <div>\\\\n                                            <label className=\\\\"block text-sm font-medium text-gray-400\\\\">Aircraft Number</label>\\\\n                                            <select value={aircraftNumber} onChange={e => setAircraftNumber(e.target.value)} disabled={isDeploy} className=\\\\"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm disabled:bg-gray-700/50 disabled:cursor-not-allowed\\\\">\\\\n                                                {Array.from({ length: 49 }, (_, i) => String(i + 1).padStart(3, \\\'0\\\')).map(num => <option key={num} value={num}>{num}</option>)}\\\\n                                            </select>\\\\n                                        </div>\\\\n                                        </>\\\\n                                        )}\\\\n                                        <div>\\\\n                                            <label className=\\\\"block text-sm font-medium text-gray-400\\\\">Start Time</label>\\\\n                                            <select \\\\n                                                value={startTime} \\\\n                                                onChange={e => {\\\\n                                                    setStartTime(parseFloat(e.target.value));\\\\n                                                    setLocalHighlight(null);\\\\n                                                }} \\\\n                                                disabled={isDeploy}\\\\n                                                className={`mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm transition-all duration-200 disabled:bg-gray-700/50 disabled:cursor-not-allowed ${localHighlight === \\\'startTime\\\' ? \\\'ring-2 ring-red-500\\\' : \\\'\\\'}`}\\\\n                                            >\\\\n                                                {timeOptions.map(opt => <option key={opt.value} value={opt.value}>{opt.label}</option>)}\\\\n                                            </select>\\\\n                                        </div>\\\\n                                        <div>\\\\n                                            <label className=\\\\"block text-sm font-medium text-gray-400\\\\">Duration</label>\\\\n                                            <input \\\\n                                                type=\\\\"number\\\\" \\\\n                                                step=\\\\"0.1\\\\" \\\\n                                                min=\\\\"0.1\\\\"\\\\n                                                value={duration} \\\\n                                                onChange={e => setDuration(e.target.value === \\\'\\\' ? \\\'\\\' : parseFloat(e.target.value))}\\\\n                                                disabled={isDeploy}\\\\n                                                className=\\\\"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm disabled:bg-gray-700/50 disabled:cursor-not-allowed\\\\"\\\\n                                            />\\\\n                                        </div>\\\\n                                    </div>\\\\n        \\\\n                                    {eventType === \\\'flight\\\' && (\\\\n                                        <div>\\\\n                                            <label className=\\\\"block text-sm font-medium text-gray-400\\\\">Location</label>\\\\n                                            <select\\\\n                                                value={locationType}\\\\n                                                onChange={e => setLocationType(e.target.value as \\\'Local\\\' | \\\'Land Away\\\')}\\\\n                                                disabled={isDeploy}\\\\n                                                className=\\\\"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm disabled:bg-gray-700/50 disabled:cursor-not-allowed\\\\"\\\\n                                            >\\\\n                                                <option value=\\\\"Local\\\\">Local</option>\\\\n                                                <option value=\\\\"Land Away\\\\">Land Away</option>\\\\n                                            </select>\\\\n                                        </div>\\\\n                                    )}\\\\n                                    {eventType === \\\'flight\\\' && locationType === \\\'Land Away\\\' && !isDeploy && (\\\\n                                        <div className=\\\\"flex items-center gap-4\\\\">\\\\n                                            <div className=\\\\"flex-1\\\\">\\\\n                                                <label className=\\\\"block text-sm font-medium text-gray-400\\\\">Origin</label>\\\\n                                                <input\\\\n                                                    type=\\\\"text\\\\"\\\\n                                                    value={origin}\\\\n                                                    onChange={e => setOrigin(e.target.value.toUpperCase())}\\\\n                                                    maxLength={3}\\\\n                                                    placeholder=\\\\"e.g. ESL\\\\"\\\\n                                                    className=\\\\"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm\\\\"\\\\n                                                />\\\\n                                            </div>\\\\n                                            <div className=\\\\"flex-1\\\\">\\\\n                                                <label className=\\\\"block text-sm font-medium text-gray-400\\\\">Destination</label>\\\\n                                                <input\\\\n                                                    type=\\\\"text\\\\"\\\\n                                                    value={destination}\\\\n                                                    onChange={e => setDestination(e.target.value.toUpperCase())}\\\\n                                                    maxLength={3}\\\\n                                                    placeholder=\\\\"e.g. PEA\\\\"\\\\n                                                    className=\\\\"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm\\\\"\\\\n                                                />\\\\n                                            </div>\\\\n                                        </div>\\\\n                                    )}\\\\n\\\\n                                    {eventType === \\\'flight\\\' && locationType === \\\'Land Away\\\' && (\\\\n                                        <>\\\\n                                            <fieldset className=\\\\"p-4 border border-gray-600 rounded-lg mb-4\\\\">\\\\n                                                <legend className=\\\\"px-2 text-sm font-semibold text-gray-300\\\\">Deployment Period</legend>\\\\n                                                <div className=\\\\"mt-2 grid grid-cols-4 gap-2 bg-gray-700/30 p-3 rounded-lg\\\\">\\\\n                                                    <div>\\\\n                                                        <label className=\\\\"block text-xs font-medium text-gray-400\\\\">Start Time</label>\\\\n                                                        <input type=\\\\"text\\\\" value={deploymentStartTime} onChange={e => {\\\\n                                                            // Remove colon and ensure 24-hour format\\\\n                                                            const value = e.target.value.replace(/:/g, \\\'\\\').replace(/\\\\\\\\D/g, \\\'\\\').slice(0, 4);\\\\n                                                            setDeploymentStartTime(value);\\\\n                                                        }} placeholder=\\\\"0800\\\\" className=\\\\"mt-1 w-full bg-gray-800 border-gray-600 rounded py-1 px-2 text-sm text-center\\\\"/>\\\\n                                                    </div>\\\\n                                                    <div>\\\\n                                                        <label className=\\\\"block text-xs font-medium text-gray-400\\\\">Start Date</label>\\\\n                                                        <input type=\\\\"date\\\\" value={deploymentStartDate} onChange={e => setDeploymentStartDate(e.target.value)} style={{colorScheme: \\\'dark\\\'}} className=\\\\"mt-1 w-full bg-gray-800 border-gray-600 rounded py-1 px-2 text-sm\\\\"/>\\\\n                                                    </div>\\\\n                                                    <div>\\\\n                                                        <label className=\\\\"block text-xs font-medium text-gray-400\\\\">End Time</label>\\\\n                                                        <input type=\\\\"text\\\\" value={deploymentEndTime} onChange={e => {\\\\n                                                            // Remove colon and ensure 24-hour format\\\\n                                                            const value = e.target.value.replace(/:/g, \\\'\\\').replace(/\\\\\\\\D/g, \\\'\\\').slice(0, 4);\\\\n                                                            setDeploymentEndTime(value);\\\\n                                                        }} placeholder=\\\\"1700\\\\" className=\\\\"mt-1 w-full bg-gray-800 border-gray-600 rounded py-1 px-2 text-sm text-center\\\\"/>\\\\n                                                    </div>\\\\n                                                    <div>\\\\n                                                        <label className=\\\\"block text-xs font-medium text-gray-400\\\\">End Date</label>\\\\n                                                        <input type=\\\\"date\\\\" value={deploymentEndDate} onChange={e => setDeploymentEndDate(e.target.value)} style={{colorScheme: \\\'dark\\\'}} className=\\\\"mt-1 w-full bg-gray-800 border-gray-600 rounded py-1 px-2 text-sm\\\\"/>\\\\n                                                    </div>\\\\n                                                </div>\\\\n                                                   <div className=\\\\"mt-2 bg-gray-700/30 p-3 rounded-lg\\\\">\\\\n                                                       <label className=\\\\"block text-xs font-medium text-gray-400 mb-1\\\\">Number of Aircraft</label>\\\\n                                                       <input \\\\n                                                           type=\\\\"number\\\\" \\\\n                                                           min=\\\\"1\\\\" \\\\n                                                           max=\\\\"20\\\\" \\\\n                                                           value={deploymentAircraftCount} \\\\n                                                           onChange={e => setDeploymentAircraftCount(parseInt(e.target.value) || 1)} \\\\n                                                           className=\\\\"w-24 bg-gray-800 border-gray-600 rounded py-1 px-2 text-sm text-center\\\\"\\\\n                                                       />\\\\n                                                       <span className=\\\\"ml-2 text-xs text-gray-500\\\\">aircraft deploying</span>\\\\n                                                   </div>\\\\n                                            </fieldset>\\\\n\\\\n                                        </>\\\\n                                    )}\\\\n        \\\\n                                    {flightNumber === \\\'SCT FORM\\\' && (\\\\n                                        <div className=\\\\"p-3 bg-gray-900/50 rounded-lg space-y-4\\\\">\\\\n                                            <h3 className=\\\\"font-semibold text-gray-300\\\\">Formation Details</h3>\\\\n                                            <div className=\\\\"grid grid-cols-2 gap-4\\\\">\\\\n                                                <div>\\\\n                                                    <label className=\\\\"block text-sm font-medium text-gray-400\\\\">Formation Callsign</label>\\\\n                                                    <select value={formationType} onChange={e => setFormationType(e.target.value)} disabled={isDeploy} className=\\\\"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm disabled:bg-gray-700/50 disabled:cursor-not-allowed\\\\">\\\\n                                                           {filteredCallsigns ? (\\\\n                                                               filteredCallsigns.map(cs => (\\\\n                                                                   <option key={cs.code} value={cs.code}>\\\\n                                                                       {cs.name} ({cs.code}) - {cs.unit}\\\\n                                                                   </option>\\\\n                                                               ))\\\\n                                                           ) : (\\\\n                                                               formationTypes.map(type => <option key={type} value={type}>{type}</option>)\\\\n                                                           )}\\\\n                                                    </select>\\\\n                                                </div>\\\\n                                                <div>\\\\n                                                    <label className=\\\\"block text-sm font-medium text-gray-400\\\\">Aircraft Count</label>\\\\n                                                    <select value={aircraftCount} onChange={e => setAircraftCount(parseInt(e.target.value))} disabled={isDeploy} className=\\\\"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm disabled:bg-gray-700/50 disabled:cursor-not-allowed\\\\">\\\\n                                                        {Array.from({length: 7}, (_, i) => i + 2).map(n => <option key={n} value={n}>{n}</option>)}\\\\n                                                    </select>\\\\n                                                </div>\\\\n                                            </div>\\\\n                                        </div>\\\\n                                    )}\\\\n                                    <div className=\\\\"space-y-4\\\\">{crew.map(renderCrewFields)}</div>\\\\n                                    \\\\n                                    {/* Add to Deployment Section */}\\\\n                                    {(eventType === \\\'flight\\\' || eventType === \\\'ftd\\\' || eventType === \\\'cpt\\\') && (\\\\n                                        <div className=\\\\"border-t border-gray-600 pt-6 mt-6\\\\">\\\\n                                            <h3 className=\\\\"text-lg font-semibold text-white mb-4\\\\">Add to Deployment</h3>\\\\n                                            <div className=\\\\"space-y-3\\\\">\\\\n                                                {getCurrentDeployments().length > 0 ? (\\\\n                                                    getCurrentDeployments().map(deployment => (\\\\n                                                        <label key={deployment.id} className=\\\\"flex items-center space-x-3 cursor-pointer hover:bg-gray-700 p-2 rounded\\\\">\\\\n                                                            <input\\\\n                                                                type=\\\\"checkbox\\\\"\\\\n                                                                checked={selectedDeploymentId === deployment.id}\\\\n                                                                onChange={(e) => {\\\\n                                                                    if (e.target.checked) {\\\\n                                                                        setSelectedDeploymentId(deployment.id);\\\\n                                                                    } else {\\\\n                                                                        setSelectedDeploymentId(\\\'\\\');\\\\n                                                                    }\\\\n                                                                }}\\\\n                                                                className=\\\\"h-4 w-4 text-sky-600 bg-gray-700 border-gray-600 rounded focus:ring-sky-500\\\\"\\\\n                                                            />\\\\n                                                            <span className=\\\\"text-sm text-gray-300\\\\">\\\\n                                                                {formatDeploymentTitle(deployment)}\\\\n                                                            </span>\\\\n                                                            <span className=\\\\"text-xs text-gray-500 ml-2\\\\">\\\\n                                                                ({deployment.resourceId})\\\\n                                                            </span>\\\\n                                                        </label>\\\\n                                                    ))\\\\n                                                ) : (\\\\n                                                    <p className=\\\\"text-sm text-gray-500 italic\\\\">\\\\n                                                        No deployments available for this event type\\\\n                                                    </p>\\\\n                                                )}\\\\n                                            </div>\\\\n                                        </div>\\\\n                                    )}\\\\n                                </div>\\\\n                            ) : (\\\\n                                <div className=\\\\"text-gray-300 space-y-2\\\\">\\\\n                                    <p><strong>Syllabus Item:</strong> {event.flightNumber}</p>\\\\n                                    {event.type === \\\'flight\\\' && <p><strong>Route:</strong> {event.origin}-{event.destination}</p>}\\\\n                                    {event.type === \\\'flight\\\' && event.area && <p><strong>Area:</strong> {event.area}</p>}\\\\n                                    <p><strong>Dual/Solo:</strong> <span className=\\\\"font-semibold\\\\">{event.flightType}</span></p>\\\\n                                    {event.flightType === \\\'Dual\\\' ? (\\\\n                                        <>\\\\n                                            {event.eventCategory === \\\'sct\\\' ? (\\\\n                                                <p><strong>Instructor:</strong> {event.instructor || event.pilot}</p>\\\\n                                            ) : (\\\\n                                                <p><strong>Instructor:</strong> {event.instructor}</p>\\\\n                                            )}\\\\n                                            {(event.type === \\\'ground\\\' && event.attendees && event.attendees.length > 0) ? (\\\\n                                                <div>\\\\n                                                    <p><strong>Attendees ({event.attendees.length}):</strong></p>\\\\n                                                    <div className=\\\\"mt-1 bg-gray-700/50 p-2 rounded-md max-h-32 overflow-y-auto\\\\">\\\\n                                                        <ul className=\\\\"space-y-1\\\\">\\\\n                                                            {event.attendees.map(attendee => (\\\\n                                                                <li key={attendee} className=\\\\"text-sm text-gray-300\\\\">{attendee.split(\\\' \\\\u2013 \\\')[0]}</li>\\\\n                                                            ))}\\\\n                                                        </ul>\\\\n                                                    </div>\\\\n                                                </div>\\\\n                                            ) : event.eventCategory === \\\'sct\\\' ? null : (\\\\n                                                <p><strong>Student:</strong> {event.student || event.group}</p>\\\\n                                            )}\\\\n                                        </>\\\\n                                    ) : <p><strong>Pilot:</strong> {event.pilot}</p>}\\\\n                                    <p><strong>Duration:</strong> {event.duration.toFixed(1)} hours</p>\\\\n                                    <p><strong>Start Time:</strong> {Math.floor(event.startTime)}:{String(Math.round((event.startTime % 1) * 60)).padStart(2, \\\'0\\\')}</p>\\\\n                                </div>\\\\n                            )}\\\\n                        </div>\\\\n                        \\\\n                        {/* Button Panel */}\\\\n                        <div className=\\\\"w-56 flex-shrink-0 border-l border-gray-700 bg-gray-800/50 p-4 flex flex-col space-y-3\\\\">\\\\n                            {!isEditing && (\\\\n                                <>\\\\n                                    <div className=\\\\"p-3 border border-gray-600 rounded-lg text-center\\\\">\\\\n                                        <label className=\\\\"block text-sm font-semibold text-gray-400\\\\">Conflict?</label>\\\\n                                        {isConflict ? (\\\\n                                            <p className=\\\\"text-2xl font-bold text-red-500\\\\">YES</p>\\\\n                                        ) : (\\\\n                                            <p className=\\\\"text-2xl font-bold text-green-500\\\\">NO</p>\\\\n                                        )}\\\\n                                    </div>\\\\n                                    <button\\\\n                                        onClick={() => onNeoClick(event)}\\\\n                                        className=\\\\"w-full px-4 py-2 rounded-md text-sm font-semibold shadow-md text-center btn-orange-brushed\\\\"\\\\n                                    >\\\\n                                        NEO\\\\n                                    </button>\\\\n                                    <button\\\\n                                        onClick={handleTraineeScoresClick}\\\\n                                        disabled={!traineeObject}\\\\n                                        className=\\\\"w-full px-4 py-2 rounded-md text-sm font-semibold shadow-md text-center btn-aluminium-brushed disabled:opacity-50 disabled:cursor-not-allowed\\\\"\\\\n                                    >\\\\n                                        Trainee Scores\\\\n                                    </button>\\\\n                                    <button\\\\n                                        onClick={handleLmpClick}\\\\n                                        className=\\\\"w-full px-4 py-2 rounded-md text-sm font-semibold shadow-md text-center btn-aluminium-brushed\\\\"\\\\n                                    >\\\\n                                        LMP\\\\n                                    </button>\\\\n                                    {event.type === \\\'flight\\\' && (\\\\n                                        <button onClick={handleAuthClick} className=\\\\"w-full px-4 py-2 rounded-md text-sm font-semibold shadow-md text-center btn-aluminium-brushed\\\\">\\\\n                                            Auth\\\\n                                        </button>\\\\n                                    )}\\\\n                                    {((traineeObject && event.type === \\\'ground\\\') || (event.flightNumber.includes(\\\'MB\\\') || event.flightNumber.includes(\\\' MB\\\'))) && (\\\\n                                        <button\\\\n                                            onClick={handleCompleteClick}\\\\n                                            className=\\\\"w-full px-4 py-2 rounded-md text-sm font-semibold shadow-md text-center btn-aluminium-brushed\\\\"\\\\n                                        >\\\\n                                            Complete\\\\n                                        </button>\\\\n                                    )}\\\\n                                    {traineeObject && (\\\\n                                        <button\\\\n                                            onClick={handlePt051Click}\\\\n                                            className=\\\\"w-full px-4 py-2 rounded-md text-sm font-semibold shadow-md text-center btn-aluminium-brushed\\\\"\\\\n                                        >\\\\n                                            PT-051\\\\n                                        </button>\\\\n                                    )}\\\\n                                    {event.type === \\\'flight\\\' && (\\\\n                                        <button onClick={handlePostFlightClick} className=\\\\"w-full px-4 py-2 rounded-md text-sm font-semibold shadow-md text-center btn-shape-fill\\\\">\\\\n                                            Post Flight\\\\n                                        </button>\\\\n                                    )}\\\\n                                </>\\\\n                            )}\\\\n                            <div className=\\\\"flex-grow\\\\" /> {/* Spacer */}\\\\n                            {isEditing ? (\\\\n                                   <>\\\\n                                <button onClick={handleSave} className=\\\\"w-full px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold shadow-md text-center bg-sky-600 hover:bg-sky-700 disabled:bg-gray-500 disabled:cursor-not-allowed\\\\">Save</button>\\\\n                                       <button onClick={handleVisualAdjust} className=\\\\"w-full px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold shadow-md text-center bg-purple-600 hover:bg-purple-700\\\\">Visual Adjust</button>\\\\n                                   </>\\\\n                            ) : (\\\\n                                <button onClick={() => setIsEditing(true)} className=\\\\"w-full px-4 py-2 text-white rounded-md transition-colors text-sm font-semibold shadow-md text-center bg-gray-600 hover:bg-gray-700\\\\">Edit</button>\\\\n                            )}\\\\n                        </div>\\\\n                    </div>\\\\n                    \\\\n                    <div className=\\\\"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex justify-end flex-shrink-0\\\\">\\\\n                        <button onClick={onClose} className=\\\\"px-4 py-2 bg-transparent border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 hover:text-white transition-colors text-sm\\\\">Close</button>\\\\n                    </div>\\\\n                </div>\\\\n            </div>\\\\n            {showCancelConfirm && (\\\\n                <CancelEventFlyout \\\\n                    eventId={event.id}\\\\n                    eventType={event.type === \\\'ftd\\\' ? \\\'ftd\\\' : \\\'flight\\\'}\\\\n                    onConfirm={(eventId, cancellationCode, manualCodeEntry) => {\\\\n                        if (onCancelEvent) {\\\\n                            onCancelEvent(eventId, cancellationCode, manualCodeEntry);\\\\n                        } else {\\\\n                            // Fallback to old delete behavior if onCancelEvent not provided\\\\n                            onDeleteRequest();\\\\n                        }\\\\n                        setShowCancelConfirm(false);\\\\n                    }}\\\\n                    onClose={() => setShowCancelConfirm(false)}\\\\n                    cancellationCodes={cancellationCodes}\\\\n                />\\\\n            )}\\\\n            {showMassBriefComplete && (\\\\n                <MassBriefCompleteFlyout\\\\n                    isOpen={showMassBriefComplete}\\\\n                    onClose={() => setShowMassBriefComplete(false)}\\\\n                    event={event}\\\\n                    trainees={\\\\n                        (() => {\\\\n                            console.log(\\\'\\\\ud83d\\\\udd0d Processing trainees for MassBriefCompleteFlyout\\\');\\\\n                            console.log(\\\'\\\\ud83d\\\\udd0d Event:\\\', event);\\\\n                            console.log(\\\'\\\\ud83d\\\\udd0d Event.attendees:\\\', event.attendees);\\\\n                            console.log(\\\'\\\\ud83d\\\\udd0d Event.group:\\\', event.group);\\\\n                            console.log(\\\'\\\\ud83d\\\\udd0d Event.selectedTrainees:\\\', event.selectedTrainees);\\\\n                            console.log(\\\'\\\\ud83d\\\\udd0d Event.trainees:\\\', event.trainees);\\\\n                            console.log(\\\'\\\\ud83d\\\\udd0d Event keys:\\\', Object.keys(event));\\\\n                            console.log(\\\'\\\\ud83d\\\\udd0d Available trainees (strings):\\\', trainees);\\\\n                            console.log(\\\'\\\\ud83d\\\\udd0d Available traineesData (objects):\\\', traineesData);\\\\n                            \\\\n                            // First try attendees array\\\\n                            if (event.attendees) {\\\\n                                console.log(\\\'\\\\ud83d\\\\udd0d Processing attendees array\\\');\\\\n                                const processedAttendees = event.attendees.map((attendeeName, index) => {\\\\n                                    console.log(`\\\\ud83d\\\\udd0d Processing attendee ${index}: \\\\"${attendeeName}\\\\"`);\\\\n                                    \\\\n                                    // Find the trainee object from the traineesData list\\\\n                                    const trainee = traineesData.find(t => {\\\\n                                        const fullName = `${t.rank} ${t.name}`;\\\\n                                        console.log(`\\\\ud83d\\\\udd0d Comparing \\\\"${fullName}\\\\" with \\\\"${attendeeName.split(\\\' \\\\u2013 \\\')[0]}\\\\"`);\\\\n                                        return fullName === attendeeName.split(\\\' \\\\u2013 \\\')[0];\\\\n                                    });\\\\n                                    \\\\n                                    if (trainee) {\\\\n                                        console.log(\\\'\\\\ud83d\\\\udd0d Found matching trainee:\\\', trainee);\\\\n                                        return trainee;\\\\n                                    } else {\\\\n                                        console.log(\\\'\\\\ud83d\\\\udd0d Creating fallback trainee object\\\');\\\\n                                        const nameParts = attendeeName.split(\\\' \\\\u2013 \\\');\\\\n                                        const fullName = nameParts[0];\\\\n                                        const course = nameParts[1] || \\\'\\\';\\\\n                                        \\\\n                                        // Parse \\\\"Last, First\\\\" format\\\\n                                        let rank = \\\'\\\';\\\\n                                        let name = fullName;\\\\n                                        const commaIndex = fullName.indexOf(\\\',\\\');\\\\n                                        if (commaIndex !== -1) {\\\\n                                            const lastName = fullName.substring(0, commaIndex).trim();\\\\n                                            const firstName = fullName.substring(commaIndex + 1).trim();\\\\n                                            name = `${firstName} ${lastName}`;\\\\n                                        } else {\\\\n                                            // Try \\\\"Rank Last First\\\\" format\\\\n                                            const parts = fullName.trim().split(\\\' \\\');\\\\n                                            if (parts.length >= 2) {\\\\n                                                rank = parts[0];\\\\n                                                name = parts.slice(1).join(\\\' \\\');\\\\n                                            }\\\\n                                        }\\\\n                                        \\\\n                                        const fallbackTrainee = {\\\\n                                            idNumber: 0,\\\\n                                            fullName: fullName,\\\\n                                            name: name,\\\\n                                            rank: rank,\\\\n",\\n  "exit_code": 0,\\n  "cwd": "/workspace"\\n}\') </execute-command> </tool_result>'}
